<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Mirai: loader/src/headers/server.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Mirai
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('server_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">server.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;sys/epoll.h&gt;</code><br />
<code>#include &quot;<a class="el" href="loader_2src_2headers_2includes_8h_source.html">includes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="telnet__info_8h_source.html">telnet_info.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="connection_8h_source.html">connection.h</a>&quot;</code><br />
</div>
<p><a href="server_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structserver.html">server</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structserver__worker.html">server_worker</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2cf30fe0bab904fee00364d90af96a01"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structserver.html">server</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_8h.html#a2cf30fe0bab904fee00364d90af96a01">server_create</a> (uint8_t threads, uint8_t addr_len, <a class="el" href="loader_2src_2headers_2includes_8h.html#aaadf2e480fd246ff9e932039b223baed">ipv4_t</a> *addrs, uint32_t max_open, char *wghip, <a class="el" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a> wghp, char *thip)</td></tr>
<tr class="separator:a2cf30fe0bab904fee00364d90af96a01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15c57c2a3267d6e72f11825bf46ab806"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_8h.html#a15c57c2a3267d6e72f11825bf46ab806">server_destroy</a> (struct <a class="el" href="structserver.html">server</a> *<a class="el" href="loader_2src_2main_8c.html#a1b6916fd6bd625513f86cc35333623c9">srv</a>)</td></tr>
<tr class="separator:a15c57c2a3267d6e72f11825bf46ab806"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a619e9617d6a9c0458a29c25761a31fd1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_8h.html#a619e9617d6a9c0458a29c25761a31fd1">server_queue_telnet</a> (struct <a class="el" href="structserver.html">server</a> *<a class="el" href="loader_2src_2main_8c.html#a1b6916fd6bd625513f86cc35333623c9">srv</a>, struct <a class="el" href="structtelnet__info.html">telnet_info</a> *info)</td></tr>
<tr class="separator:a619e9617d6a9c0458a29c25761a31fd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87188a72b71cc1291721d426413f1290"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_8h.html#a87188a72b71cc1291721d426413f1290">server_telnet_probe</a> (struct <a class="el" href="structserver.html">server</a> *<a class="el" href="loader_2src_2main_8c.html#a1b6916fd6bd625513f86cc35333623c9">srv</a>, struct <a class="el" href="structtelnet__info.html">telnet_info</a> *info)</td></tr>
<tr class="separator:a87188a72b71cc1291721d426413f1290"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9085c60470ef6f94cdff3dcb4bf03f48"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_8h.html#a9085c60470ef6f94cdff3dcb4bf03f48">bind_core</a> (int core)</td></tr>
<tr class="separator:a9085c60470ef6f94cdff3dcb4bf03f48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3aa5bbc2215e215af2afeb31b29bfca"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_8h.html#af3aa5bbc2215e215af2afeb31b29bfca">worker</a> (void *arg)</td></tr>
<tr class="separator:af3aa5bbc2215e215af2afeb31b29bfca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06facb7139019d572418232827e73738"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_8h.html#a06facb7139019d572418232827e73738">handle_output_buffers</a> (struct <a class="el" href="structserver__worker.html">server_worker</a> *)</td></tr>
<tr class="separator:a06facb7139019d572418232827e73738"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac37d85fa12abeeeccfe98a3fcf729294"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_8h.html#ac37d85fa12abeeeccfe98a3fcf729294">handle_event</a> (struct <a class="el" href="structserver__worker.html">server_worker</a> *wrker, struct epoll_event *ev)</td></tr>
<tr class="separator:ac37d85fa12abeeeccfe98a3fcf729294"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00144b644a217fc5f75a8e1597fd7d49"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_8h.html#a00144b644a217fc5f75a8e1597fd7d49">timeout_thread</a> (void *)</td></tr>
<tr class="separator:a00144b644a217fc5f75a8e1597fd7d49"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a9085c60470ef6f94cdff3dcb4bf03f48"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void bind_core </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>core</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ac37d85fa12abeeeccfe98a3fcf729294"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void handle_event </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structserver__worker.html">server_worker</a> *&#160;</td>
          <td class="paramname"><em>wrker</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct epoll_event *&#160;</td>
          <td class="paramname"><em>ev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a06facb7139019d572418232827e73738"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void handle_output_buffers </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structserver__worker.html">server_worker</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a2cf30fe0bab904fee00364d90af96a01"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structserver.html">server</a>* server_create </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>threads</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>addr_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="loader_2src_2headers_2includes_8h.html#aaadf2e480fd246ff9e932039b223baed">ipv4_t</a> *&#160;</td>
          <td class="paramname"><em>addrs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>max_open</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>wghip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a>&#160;</td>
          <td class="paramname"><em>wghp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>thip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="server_8c_source.html#l00019">19</a> of file <a class="el" href="server_8c_source.html">server.c</a>.</p>

<p>References <a class="el" href="server_8h_source.html#l00015">server::bind_addrs</a>, <a class="el" href="server_8h_source.html#l00018">server::bind_addrs_len</a>, <a class="el" href="server_8h_source.html#l00024">server_worker::efd</a>, <a class="el" href="server_8h_source.html#l00014">server::estab_conns</a>, <a class="el" href="ForumPost_8txt_source.html#l00030">free</a>, <a class="el" href="connection_8h_source.html#l00009">connection::lock</a>, <a class="el" href="server_8h_source.html#l00009">server::max_open</a>, <a class="el" href="loader_2src_2main_8c_source.html#l00017">srv</a>, <a class="el" href="server_8h_source.html#l00023">server_worker::srv</a>, <a class="el" href="server_8h_source.html#l00012">server::tftp_host_ip</a>, <a class="el" href="server_8h_source.html#l00025">server_worker::thread</a>, <a class="el" href="server_8h_source.html#l00026">server_worker::thread_id</a>, <a class="el" href="server_8c_source.html#l00597">timeout_thread()</a>, <a class="el" href="server_8h_source.html#l00016">server::to_thrd</a>, <a class="el" href="server_8h_source.html#l00012">server::wget_host_ip</a>, <a class="el" href="server_8h_source.html#l00017">server::wget_host_port</a>, <a class="el" href="server_8c_source.html#l00165">worker()</a>, <a class="el" href="server_8h_source.html#l00013">server::workers</a>, and <a class="el" href="server_8h_source.html#l00018">server::workers_len</a>.</p>

<p>Referenced by <a class="el" href="loader_2src_2main_8c_source.html#l00021">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keyword">struct </span><a class="code" href="structserver.html">server</a> *<a class="code" href="loader_2src_2main_8c.html#a1b6916fd6bd625513f86cc35333623c9">srv</a> = calloc(1, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structserver.html">server</a>));</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keyword">struct </span><a class="code" href="structserver__worker.html">server_worker</a> *workers = calloc(threads, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structserver__worker.html">server_worker</a>));</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="comment">// Fill out the structure</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    srv-&gt;<a class="code" href="structserver.html#ab16b9ed36cc105da325d0bbbb533635e">bind_addrs_len</a> = addr_len;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    srv-&gt;<a class="code" href="structserver.html#ab1a292223f727e8dc33b7b32971d0ac1">bind_addrs</a> = addrs;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    srv-&gt;<a class="code" href="structserver.html#a3dc885b39e0b71d53698b376f161d9df">max_open</a> = max_open;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    srv-&gt;<a class="code" href="structserver.html#a3429acc7dc3373cd09b6b10348ae41e6">wget_host_ip</a> = wghip;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    srv-&gt;<a class="code" href="structserver.html#a1e2b34c57e3b5606aa8446e64823d725">wget_host_port</a> = wghp;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    srv-&gt;<a class="code" href="structserver.html#a04a30da3dd86aa73499c6d5e2e48311c">tftp_host_ip</a> = thip;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    srv-&gt;<a class="code" href="structserver.html#a712c73b78adff8b0f9d0c824d87eb2c1">estab_conns</a> = calloc(max_open * 2, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structconnection.html">connection</a> *));</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    srv-&gt;<a class="code" href="structserver.html#a33515ab0c529621ecc5d317770637cb2">workers</a> = calloc(threads, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structserver__worker.html">server_worker</a>));</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    srv-&gt;<a class="code" href="structserver.html#ab158131791f1fea8a823fc2388d9ab82">workers_len</a> = threads;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">if</span> (srv-&gt;<a class="code" href="structserver.html#a712c73b78adff8b0f9d0c824d87eb2c1">estab_conns</a> == NULL)</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    {</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        printf(<span class="stringliteral">&quot;Failed to allocate establisted_connections array\n&quot;</span>);</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        exit(0);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    }</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">// Allocate locks internally</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; max_open * 2; i++)</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        srv-&gt;<a class="code" href="structserver.html#a712c73b78adff8b0f9d0c824d87eb2c1">estab_conns</a>[i] = calloc(1, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structconnection.html">connection</a>));</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="keywordflow">if</span> (srv-&gt;<a class="code" href="structserver.html#a712c73b78adff8b0f9d0c824d87eb2c1">estab_conns</a>[i] == NULL)</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        {</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            printf(<span class="stringliteral">&quot;Failed to allocate connection %d\n&quot;</span>, i);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            exit(-1);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        }</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        pthread_mutex_init(&amp;(srv-&gt;<a class="code" href="structserver.html#a712c73b78adff8b0f9d0c824d87eb2c1">estab_conns</a>[i]-&gt;<a class="code" href="structconnection.html#aaecdd2ee669a3728ae131c4d09fb3a33">lock</a>), NULL);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    }</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">// Create worker threads</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; threads; i++)</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    {</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keyword">struct </span><a class="code" href="structserver__worker.html">server_worker</a> *wrker = &amp;srv-&gt;<a class="code" href="structserver.html#a33515ab0c529621ecc5d317770637cb2">workers</a>[i];</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        wrker-&gt;<a class="code" href="structserver__worker.html#ae7be5e0b65257ad1a73cb9de934342e8">srv</a> = <a class="code" href="loader_2src_2main_8c.html#a1b6916fd6bd625513f86cc35333623c9">srv</a>;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        wrker-&gt;<a class="code" href="structserver__worker.html#a291525712de364e6d7aabbbd69f593be">thread_id</a> = i;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keywordflow">if</span> ((wrker-&gt;<a class="code" href="structserver__worker.html#a34827de4a680ff23c1c2bd27e446edf2">efd</a> = epoll_create1(0)) == -1)</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            printf(<span class="stringliteral">&quot;Failed to initialize epoll context. Error code %d\n&quot;</span>, errno);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            <a class="code" href="ForumPost_8txt.html#ab292715cb198b54d1912ed6209d567dc">free</a>(srv-&gt;<a class="code" href="structserver.html#a33515ab0c529621ecc5d317770637cb2">workers</a>);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            <a class="code" href="ForumPost_8txt.html#ab292715cb198b54d1912ed6209d567dc">free</a>(srv);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        }</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        pthread_create(&amp;wrker-&gt;<a class="code" href="structserver__worker.html#aef6ffc9c0b7ab0c33e0ef9e450a38c36">thread</a>, NULL, <a class="code" href="server_8c.html#af3aa5bbc2215e215af2afeb31b29bfca">worker</a>, wrker);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    }</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    pthread_create(&amp;srv-&gt;<a class="code" href="structserver.html#ad8123701a3acf99403ac059a5f541cbd">to_thrd</a>, NULL, <a class="code" href="server_8c.html#ad0ffd480caf2f4573b8ededde26577e2">timeout_thread</a>, srv);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="loader_2src_2main_8c.html#a1b6916fd6bd625513f86cc35333623c9">srv</a>;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;}</div><div class="ttc" id="structserver_html_a1e2b34c57e3b5606aa8446e64823d725"><div class="ttname"><a href="structserver.html#a1e2b34c57e3b5606aa8446e64823d725">server::wget_host_port</a></div><div class="ttdeci">port_t wget_host_port</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00017">server.h:17</a></div></div>
<div class="ttc" id="structserver__worker_html_aef6ffc9c0b7ab0c33e0ef9e450a38c36"><div class="ttname"><a href="structserver__worker.html#aef6ffc9c0b7ab0c33e0ef9e450a38c36">server_worker::thread</a></div><div class="ttdeci">pthread_t thread</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00025">server.h:25</a></div></div>
<div class="ttc" id="loader_2src_2main_8c_html_a1b6916fd6bd625513f86cc35333623c9"><div class="ttname"><a href="loader_2src_2main_8c.html#a1b6916fd6bd625513f86cc35333623c9">srv</a></div><div class="ttdeci">static struct server * srv</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2main_8c_source.html#l00017">main.c:17</a></div></div>
<div class="ttc" id="structserver_html_a3dc885b39e0b71d53698b376f161d9df"><div class="ttname"><a href="structserver.html#a3dc885b39e0b71d53698b376f161d9df">server::max_open</a></div><div class="ttdeci">uint32_t max_open</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00009">server.h:9</a></div></div>
<div class="ttc" id="structserver__worker_html_a34827de4a680ff23c1c2bd27e446edf2"><div class="ttname"><a href="structserver__worker.html#a34827de4a680ff23c1c2bd27e446edf2">server_worker::efd</a></div><div class="ttdeci">int efd</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00024">server.h:24</a></div></div>
<div class="ttc" id="ForumPost_8txt_html_ab292715cb198b54d1912ed6209d567dc"><div class="ttname"><a href="ForumPost_8txt.html#ab292715cb198b54d1912ed6209d567dc">free</a></div><div class="ttdeci">try harder skiddo Your skeleton tool sucks it thought the attack decoder was sinden but it does not even use a text based protocol CNC and bot communicate over binary protocol you say some others kill based on cwd It shows how out of the loop you are with real malware Go back to skidland slaps for you Why are you writing reverse engineer tools You cannot even correctly reverse in the first place Please learn some skills first before trying to impress others Your arrogance in declaring how you beat me with your dumb kung fu statement made me laugh so hard while eating my SO had to pat me on the back Just as I forever be free</div><div class="ttdef"><b>Definition:</b> <a href="ForumPost_8txt_source.html#l00030">ForumPost.txt:30</a></div></div>
<div class="ttc" id="structconnection_html"><div class="ttname"><a href="structconnection.html">connection</a></div><div class="ttdef"><b>Definition:</b> <a href="connection_8h_source.html#l00008">connection.h:8</a></div></div>
<div class="ttc" id="structserver_html_a04a30da3dd86aa73499c6d5e2e48311c"><div class="ttname"><a href="structserver.html#a04a30da3dd86aa73499c6d5e2e48311c">server::tftp_host_ip</a></div><div class="ttdeci">char * tftp_host_ip</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00012">server.h:12</a></div></div>
<div class="ttc" id="structserver_html_ab1a292223f727e8dc33b7b32971d0ac1"><div class="ttname"><a href="structserver.html#ab1a292223f727e8dc33b7b32971d0ac1">server::bind_addrs</a></div><div class="ttdeci">ipv4_t * bind_addrs</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00015">server.h:15</a></div></div>
<div class="ttc" id="structserver__worker_html_ae7be5e0b65257ad1a73cb9de934342e8"><div class="ttname"><a href="structserver__worker.html#ae7be5e0b65257ad1a73cb9de934342e8">server_worker::srv</a></div><div class="ttdeci">struct server * srv</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00023">server.h:23</a></div></div>
<div class="ttc" id="structserver_html"><div class="ttname"><a href="structserver.html">server</a></div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00008">server.h:8</a></div></div>
<div class="ttc" id="structserver_html_ab158131791f1fea8a823fc2388d9ab82"><div class="ttname"><a href="structserver.html#ab158131791f1fea8a823fc2388d9ab82">server::workers_len</a></div><div class="ttdeci">uint8_t workers_len</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00018">server.h:18</a></div></div>
<div class="ttc" id="server_8c_html_af3aa5bbc2215e215af2afeb31b29bfca"><div class="ttname"><a href="server_8c.html#af3aa5bbc2215e215af2afeb31b29bfca">worker</a></div><div class="ttdeci">static void * worker(void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="server_8c_source.html#l00165">server.c:165</a></div></div>
<div class="ttc" id="structserver_html_ab16b9ed36cc105da325d0bbbb533635e"><div class="ttname"><a href="structserver.html#ab16b9ed36cc105da325d0bbbb533635e">server::bind_addrs_len</a></div><div class="ttdeci">uint8_t bind_addrs_len</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00018">server.h:18</a></div></div>
<div class="ttc" id="server_8c_html_ad0ffd480caf2f4573b8ededde26577e2"><div class="ttname"><a href="server_8c.html#ad0ffd480caf2f4573b8ededde26577e2">timeout_thread</a></div><div class="ttdeci">static void * timeout_thread(void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="server_8c_source.html#l00597">server.c:597</a></div></div>
<div class="ttc" id="structserver__worker_html"><div class="ttname"><a href="structserver__worker.html">server_worker</a></div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00022">server.h:22</a></div></div>
<div class="ttc" id="structconnection_html_aaecdd2ee669a3728ae131c4d09fb3a33"><div class="ttname"><a href="structconnection.html#aaecdd2ee669a3728ae131c4d09fb3a33">connection::lock</a></div><div class="ttdeci">pthread_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="connection_8h_source.html#l00009">connection.h:9</a></div></div>
<div class="ttc" id="structserver_html_ad8123701a3acf99403ac059a5f541cbd"><div class="ttname"><a href="structserver.html#ad8123701a3acf99403ac059a5f541cbd">server::to_thrd</a></div><div class="ttdeci">pthread_t to_thrd</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00016">server.h:16</a></div></div>
<div class="ttc" id="structserver__worker_html_a291525712de364e6d7aabbbd69f593be"><div class="ttname"><a href="structserver__worker.html#a291525712de364e6d7aabbbd69f593be">server_worker::thread_id</a></div><div class="ttdeci">uint8_t thread_id</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00026">server.h:26</a></div></div>
<div class="ttc" id="structserver_html_a33515ab0c529621ecc5d317770637cb2"><div class="ttname"><a href="structserver.html#a33515ab0c529621ecc5d317770637cb2">server::workers</a></div><div class="ttdeci">struct server_worker * workers</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00013">server.h:13</a></div></div>
<div class="ttc" id="structserver_html_a3429acc7dc3373cd09b6b10348ae41e6"><div class="ttname"><a href="structserver.html#a3429acc7dc3373cd09b6b10348ae41e6">server::wget_host_ip</a></div><div class="ttdeci">char * wget_host_ip</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00012">server.h:12</a></div></div>
<div class="ttc" id="structserver_html_a712c73b78adff8b0f9d0c824d87eb2c1"><div class="ttname"><a href="structserver.html#a712c73b78adff8b0f9d0c824d87eb2c1">server::estab_conns</a></div><div class="ttdeci">struct connection ** estab_conns</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00014">server.h:14</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a15c57c2a3267d6e72f11825bf46ab806"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void server_destroy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structserver.html">server</a> *&#160;</td>
          <td class="paramname"><em>srv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="server_8c_source.html#l00078">78</a> of file <a class="el" href="server_8c_source.html">server.c</a>.</p>

<p>References <a class="el" href="server_8h_source.html#l00015">server::bind_addrs</a>, <a class="el" href="ForumPost_8txt_source.html#l00030">free</a>, and <a class="el" href="server_8h_source.html#l00013">server::workers</a>.</p>
<div class="fragment"><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;{</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">if</span> (srv == NULL)</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordflow">if</span> (srv-&gt;<a class="code" href="structserver.html#ab1a292223f727e8dc33b7b32971d0ac1">bind_addrs</a> != NULL)</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <a class="code" href="ForumPost_8txt.html#ab292715cb198b54d1912ed6209d567dc">free</a>(srv-&gt;<a class="code" href="structserver.html#ab1a292223f727e8dc33b7b32971d0ac1">bind_addrs</a>);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">if</span> (srv-&gt;<a class="code" href="structserver.html#a33515ab0c529621ecc5d317770637cb2">workers</a> != NULL)</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="ForumPost_8txt.html#ab292715cb198b54d1912ed6209d567dc">free</a>(srv-&gt;<a class="code" href="structserver.html#a33515ab0c529621ecc5d317770637cb2">workers</a>);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="ForumPost_8txt.html#ab292715cb198b54d1912ed6209d567dc">free</a>(srv);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;}</div><div class="ttc" id="ForumPost_8txt_html_ab292715cb198b54d1912ed6209d567dc"><div class="ttname"><a href="ForumPost_8txt.html#ab292715cb198b54d1912ed6209d567dc">free</a></div><div class="ttdeci">try harder skiddo Your skeleton tool sucks it thought the attack decoder was sinden but it does not even use a text based protocol CNC and bot communicate over binary protocol you say some others kill based on cwd It shows how out of the loop you are with real malware Go back to skidland slaps for you Why are you writing reverse engineer tools You cannot even correctly reverse in the first place Please learn some skills first before trying to impress others Your arrogance in declaring how you beat me with your dumb kung fu statement made me laugh so hard while eating my SO had to pat me on the back Just as I forever be free</div><div class="ttdef"><b>Definition:</b> <a href="ForumPost_8txt_source.html#l00030">ForumPost.txt:30</a></div></div>
<div class="ttc" id="structserver_html_ab1a292223f727e8dc33b7b32971d0ac1"><div class="ttname"><a href="structserver.html#ab1a292223f727e8dc33b7b32971d0ac1">server::bind_addrs</a></div><div class="ttdeci">ipv4_t * bind_addrs</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00015">server.h:15</a></div></div>
<div class="ttc" id="structserver_html_a33515ab0c529621ecc5d317770637cb2"><div class="ttname"><a href="structserver.html#a33515ab0c529621ecc5d317770637cb2">server::workers</a></div><div class="ttdeci">struct server_worker * workers</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00013">server.h:13</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a619e9617d6a9c0458a29c25761a31fd1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void server_queue_telnet </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structserver.html">server</a> *&#160;</td>
          <td class="paramname"><em>srv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structtelnet__info.html">telnet_info</a> *&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="server_8c_source.html#l00089">89</a> of file <a class="el" href="server_8c_source.html">server.c</a>.</p>

<p>References <a class="el" href="loader_2src_2headers_2includes_8h_source.html#l00022">ATOMIC_GET</a>, <a class="el" href="loader_2src_2headers_2includes_8h_source.html#l00020">ATOMIC_INC</a>, <a class="el" href="server_8h_source.html#l00010">server::curr_open</a>, <a class="el" href="server_8h_source.html#l00009">server::max_open</a>, and <a class="el" href="server_8c_source.html#l00103">server_telnet_probe()</a>.</p>

<p>Referenced by <a class="el" href="loader_2src_2main_8c_source.html#l00021">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;{</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#a97726887df4104b2cef8b87f76005317">ATOMIC_GET</a>(&amp;srv-&gt;<a class="code" href="structserver.html#a8f7152bb17f4276b2d863369d3a3468c">curr_open</a>) &gt;= srv-&gt;<a class="code" href="structserver.html#a3dc885b39e0b71d53698b376f161d9df">max_open</a>)</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    {</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        sleep(1);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    }</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#a66c32fe2ced559e246bb8a27ac57cd0e">ATOMIC_INC</a>(&amp;srv-&gt;<a class="code" href="structserver.html#a8f7152bb17f4276b2d863369d3a3468c">curr_open</a>);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">if</span> (srv == NULL)</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        printf(<span class="stringliteral">&quot;srv == NULL 3\n&quot;</span>);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="server_8c.html#a87188a72b71cc1291721d426413f1290">server_telnet_probe</a>(srv, info);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;}</div><div class="ttc" id="structserver_html_a8f7152bb17f4276b2d863369d3a3468c"><div class="ttname"><a href="structserver.html#a8f7152bb17f4276b2d863369d3a3468c">server::curr_open</a></div><div class="ttdeci">volatile uint32_t curr_open</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00010">server.h:10</a></div></div>
<div class="ttc" id="structserver_html_a3dc885b39e0b71d53698b376f161d9df"><div class="ttname"><a href="structserver.html#a3dc885b39e0b71d53698b376f161d9df">server::max_open</a></div><div class="ttdeci">uint32_t max_open</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00009">server.h:9</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_a97726887df4104b2cef8b87f76005317"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#a97726887df4104b2cef8b87f76005317">ATOMIC_GET</a></div><div class="ttdeci">#define ATOMIC_GET(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00022">includes.h:22</a></div></div>
<div class="ttc" id="server_8c_html_a87188a72b71cc1291721d426413f1290"><div class="ttname"><a href="server_8c.html#a87188a72b71cc1291721d426413f1290">server_telnet_probe</a></div><div class="ttdeci">void server_telnet_probe(struct server *srv, struct telnet_info *info)</div><div class="ttdef"><b>Definition:</b> <a href="server_8c_source.html#l00103">server.c:103</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_a66c32fe2ced559e246bb8a27ac57cd0e"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#a66c32fe2ced559e246bb8a27ac57cd0e">ATOMIC_INC</a></div><div class="ttdeci">#define ATOMIC_INC(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00020">includes.h:20</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a87188a72b71cc1291721d426413f1290"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void server_telnet_probe </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structserver.html">server</a> *&#160;</td>
          <td class="paramname"><em>srv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structtelnet__info.html">telnet_info</a> *&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="server_8c_source.html#l00103">103</a> of file <a class="el" href="server_8c_source.html">server.c</a>.</p>

<p>References <a class="el" href="telnet__info_8h_source.html#l00007">telnet_info::addr</a>, <a class="el" href="loader_2src_2headers_2includes_8h_source.html#l00021">ATOMIC_DEC</a>, <a class="el" href="loader_2src_2headers_2includes_8h_source.html#l00020">ATOMIC_INC</a>, <a class="el" href="ForumPost_8txt_source.html#l00001">connect</a>, <a class="el" href="connection_8c_source.html#l00033">connection_close()</a>, <a class="el" href="connection_8c_source.html#l00013">connection_open()</a>, <a class="el" href="server_8h_source.html#l00010">server::curr_open</a>, <a class="el" href="server_8h_source.html#l00019">server::curr_worker_child</a>, <a class="el" href="server_8h_source.html#l00024">server_worker::efd</a>, <a class="el" href="server_8h_source.html#l00014">server::estab_conns</a>, <a class="el" href="connection_8h_source.html#l00013">connection::fd</a>, <a class="el" href="connection_8h_source.html#l00012">connection::info</a>, <a class="el" href="server_8h_source.html#l00009">server::max_open</a>, <a class="el" href="telnet__info_8h_source.html#l00008">telnet_info::port</a>, <a class="el" href="connection_8h_source.html#l00010">connection::srv</a>, <a class="el" href="loader_2src_2main_8c_source.html#l00017">srv</a>, <a class="el" href="loader_2src_2util_8c_source.html#l00064">util_socket_and_bind()</a>, <a class="el" href="server_8h_source.html#l00013">server::workers</a>, and <a class="el" href="server_8h_source.html#l00018">server::workers_len</a>.</p>

<p>Referenced by <a class="el" href="server_8c_source.html#l00089">server_queue_telnet()</a>.</p>
<div class="fragment"><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;{</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordtype">int</span> fd = <a class="code" href="loader_2src_2headers_2util_8h.html#ab0861eca69488783c03d10dd318bb02d">util_socket_and_bind</a>(srv);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keyword">struct </span>sockaddr_in addr;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keyword">struct </span><a class="code" href="structconnection.html">connection</a> *conn;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keyword">struct </span>epoll_event event;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keyword">struct </span><a class="code" href="structserver__worker.html">server_worker</a> *wrker = &amp;srv-&gt;<a class="code" href="structserver.html#a33515ab0c529621ecc5d317770637cb2">workers</a>[<a class="code" href="loader_2src_2headers_2includes_8h.html#a66c32fe2ced559e246bb8a27ac57cd0e">ATOMIC_INC</a>(&amp;srv-&gt;<a class="code" href="structserver.html#a0123bc1e1ea7a40a3421b475e70702a9">curr_worker_child</a>) % srv-&gt;<a class="code" href="structserver.html#ab158131791f1fea8a823fc2388d9ab82">workers_len</a>];</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">if</span> (fd == -1)</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    {</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordflow">if</span> (time(NULL) % 10 == 0)</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            printf(<span class="stringliteral">&quot;Failed to open and bind socket\n&quot;</span>);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <a class="code" href="loader_2src_2headers_2includes_8h.html#a993f1d32fc9cf3ab12b313462da9dd57">ATOMIC_DEC</a>(&amp;srv-&gt;<a class="code" href="structserver.html#a8f7152bb17f4276b2d863369d3a3468c">curr_open</a>);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    }</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">while</span> (fd &gt;= (srv-&gt;<a class="code" href="structserver.html#a3dc885b39e0b71d53698b376f161d9df">max_open</a> * 2))</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        printf(<span class="stringliteral">&quot;fd too big\n&quot;</span>);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        conn-&gt;<a class="code" href="structconnection.html#aa9a96cc6c66ef5a617f51247b2809a40">fd</a> = fd;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        printf(<span class="stringliteral">&quot;Can&#39;t utilize socket because client buf is not large enough\n&quot;</span>);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <a class="code" href="connection_8c.html#abfa9e4a1232d41a78e5de0a510ed5752">connection_close</a>(conn);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    }</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">if</span> (srv == NULL)</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        printf(<span class="stringliteral">&quot;srv == NULL 4\n&quot;</span>);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    conn = srv-&gt;<a class="code" href="structserver.html#a712c73b78adff8b0f9d0c824d87eb2c1">estab_conns</a>[fd];</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    memcpy(&amp;conn-&gt;<a class="code" href="structconnection.html#a8ee851eb5e6fa61a5d361029c0e05a82">info</a>, info, sizeof (<span class="keyword">struct</span> <a class="code" href="structtelnet__info.html">telnet_info</a>));</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    conn-&gt;<a class="code" href="structconnection.html#a85d448ea156e4e2129e1e7b0b3effcad">srv</a> = <a class="code" href="loader_2src_2main_8c.html#a1b6916fd6bd625513f86cc35333623c9">srv</a>;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    conn-&gt;<a class="code" href="structconnection.html#aa9a96cc6c66ef5a617f51247b2809a40">fd</a> = fd;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="connection_8c.html#a162617f2f61ea5b24a221a6cc34d30e1">connection_open</a>(conn);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    addr.sin_family = AF_INET;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    addr.sin_addr.s_addr = info-&gt;<a class="code" href="structtelnet__info.html#aad0667b76ed78d53e874aeacdee342a9">addr</a>;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    addr.sin_port = info-&gt;<a class="code" href="structtelnet__info.html#aa5ee1ca4f4da0455d35a2407dfc7e2a0">port</a>;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    ret = <a class="code" href="ForumPost_8txt.html#a3eaa76d3cfe977972a9bf87dbc12c50f">connect</a>(fd, (<span class="keyword">struct</span> sockaddr *)&amp;addr, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> sockaddr_in));</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">if</span> (ret == -1 &amp;&amp; errno != EINPROGRESS)</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    {</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        printf(<span class="stringliteral">&quot;got connect error\n&quot;</span>);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keyword">event</span>.data.fd = fd;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keyword">event</span>.events = EPOLLOUT;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    epoll_ctl(wrker-&gt;<a class="code" href="structserver__worker.html#a34827de4a680ff23c1c2bd27e446edf2">efd</a>, EPOLL_CTL_ADD, fd, &amp;event);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div><div class="ttc" id="structtelnet__info_html_aa5ee1ca4f4da0455d35a2407dfc7e2a0"><div class="ttname"><a href="structtelnet__info.html#aa5ee1ca4f4da0455d35a2407dfc7e2a0">telnet_info::port</a></div><div class="ttdeci">port_t port</div><div class="ttdef"><b>Definition:</b> <a href="telnet__info_8h_source.html#l00008">telnet_info.h:8</a></div></div>
<div class="ttc" id="loader_2src_2headers_2util_8h_html_ab0861eca69488783c03d10dd318bb02d"><div class="ttname"><a href="loader_2src_2headers_2util_8h.html#ab0861eca69488783c03d10dd318bb02d">util_socket_and_bind</a></div><div class="ttdeci">int util_socket_and_bind(struct server *srv)</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2util_8c_source.html#l00064">util.c:64</a></div></div>
<div class="ttc" id="loader_2src_2main_8c_html_a1b6916fd6bd625513f86cc35333623c9"><div class="ttname"><a href="loader_2src_2main_8c.html#a1b6916fd6bd625513f86cc35333623c9">srv</a></div><div class="ttdeci">static struct server * srv</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2main_8c_source.html#l00017">main.c:17</a></div></div>
<div class="ttc" id="structtelnet__info_html"><div class="ttname"><a href="structtelnet__info.html">telnet_info</a></div><div class="ttdef"><b>Definition:</b> <a href="telnet__info_8h_source.html#l00005">telnet_info.h:5</a></div></div>
<div class="ttc" id="structserver_html_a8f7152bb17f4276b2d863369d3a3468c"><div class="ttname"><a href="structserver.html#a8f7152bb17f4276b2d863369d3a3468c">server::curr_open</a></div><div class="ttdeci">volatile uint32_t curr_open</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00010">server.h:10</a></div></div>
<div class="ttc" id="structserver_html_a3dc885b39e0b71d53698b376f161d9df"><div class="ttname"><a href="structserver.html#a3dc885b39e0b71d53698b376f161d9df">server::max_open</a></div><div class="ttdeci">uint32_t max_open</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00009">server.h:9</a></div></div>
<div class="ttc" id="structserver__worker_html_a34827de4a680ff23c1c2bd27e446edf2"><div class="ttname"><a href="structserver__worker.html#a34827de4a680ff23c1c2bd27e446edf2">server_worker::efd</a></div><div class="ttdeci">int efd</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00024">server.h:24</a></div></div>
<div class="ttc" id="structconnection_html"><div class="ttname"><a href="structconnection.html">connection</a></div><div class="ttdef"><b>Definition:</b> <a href="connection_8h_source.html#l00008">connection.h:8</a></div></div>
<div class="ttc" id="structtelnet__info_html_aad0667b76ed78d53e874aeacdee342a9"><div class="ttname"><a href="structtelnet__info.html#aad0667b76ed78d53e874aeacdee342a9">telnet_info::addr</a></div><div class="ttdeci">ipv4_t addr</div><div class="ttdef"><b>Definition:</b> <a href="telnet__info_8h_source.html#l00007">telnet_info.h:7</a></div></div>
<div class="ttc" id="structconnection_html_a8ee851eb5e6fa61a5d361029c0e05a82"><div class="ttname"><a href="structconnection.html#a8ee851eb5e6fa61a5d361029c0e05a82">connection::info</a></div><div class="ttdeci">struct telnet_info info</div><div class="ttdef"><b>Definition:</b> <a href="connection_8h_source.html#l00012">connection.h:12</a></div></div>
<div class="ttc" id="structserver_html_ab158131791f1fea8a823fc2388d9ab82"><div class="ttname"><a href="structserver.html#ab158131791f1fea8a823fc2388d9ab82">server::workers_len</a></div><div class="ttdeci">uint8_t workers_len</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00018">server.h:18</a></div></div>
<div class="ttc" id="connection_8c_html_abfa9e4a1232d41a78e5de0a510ed5752"><div class="ttname"><a href="connection_8c.html#abfa9e4a1232d41a78e5de0a510ed5752">connection_close</a></div><div class="ttdeci">void connection_close(struct connection *conn)</div><div class="ttdef"><b>Definition:</b> <a href="connection_8c_source.html#l00033">connection.c:33</a></div></div>
<div class="ttc" id="structserver__worker_html"><div class="ttname"><a href="structserver__worker.html">server_worker</a></div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00022">server.h:22</a></div></div>
<div class="ttc" id="connection_8c_html_a162617f2f61ea5b24a221a6cc34d30e1"><div class="ttname"><a href="connection_8c.html#a162617f2f61ea5b24a221a6cc34d30e1">connection_open</a></div><div class="ttdeci">void connection_open(struct connection *conn)</div><div class="ttdef"><b>Definition:</b> <a href="connection_8c_source.html#l00013">connection.c:13</a></div></div>
<div class="ttc" id="structserver_html_a0123bc1e1ea7a40a3421b475e70702a9"><div class="ttname"><a href="structserver.html#a0123bc1e1ea7a40a3421b475e70702a9">server::curr_worker_child</a></div><div class="ttdeci">int curr_worker_child</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00019">server.h:19</a></div></div>
<div class="ttc" id="structconnection_html_a85d448ea156e4e2129e1e7b0b3effcad"><div class="ttname"><a href="structconnection.html#a85d448ea156e4e2129e1e7b0b3effcad">connection::srv</a></div><div class="ttdeci">struct server * srv</div><div class="ttdef"><b>Definition:</b> <a href="connection_8h_source.html#l00010">connection.h:10</a></div></div>
<div class="ttc" id="structconnection_html_aa9a96cc6c66ef5a617f51247b2809a40"><div class="ttname"><a href="structconnection.html#aa9a96cc6c66ef5a617f51247b2809a40">connection::fd</a></div><div class="ttdeci">int fd</div><div class="ttdef"><b>Definition:</b> <a href="connection_8h_source.html#l00013">connection.h:13</a></div></div>
<div class="ttc" id="ForumPost_8txt_html_a3eaa76d3cfe977972a9bf87dbc12c50f"><div class="ttname"><a href="ForumPost_8txt.html#a3eaa76d3cfe977972a9bf87dbc12c50f">connect</a></div><div class="ttdeci">World s Largest Echo CNC source code release Anna When I first go in DDoS I wasn t planning on staying in it long I made my there s lots of eyes looking at IOT so it s time to GTFO I know every skid and their it s their wet dream to have something besides qbot So I have an amazing release for you With I usually pull max bots from telnet alone after the Kreb ISPs been slowly shutting down and cleaning up their act max pull is about and dropping I am your and I will treat you real my hf chan And to everyone that thought they were doing anything by hitting my I had good this bot uses domain for CNC It takes seconds for all bots to lol shoutout to this blog post by malwaremustdie thought you were good but you really just completely and totally failed in reversing this binary We still have better kung fu than you kiddos don t make me laugh you made so many mistakes and even confused some different binaries with my LOL Let me give you some slaps back port is not for back connect</div><div class="ttdef"><b>Definition:</b> <a href="ForumPost_8txt_source.html#l00001">ForumPost.txt:1</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_a66c32fe2ced559e246bb8a27ac57cd0e"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#a66c32fe2ced559e246bb8a27ac57cd0e">ATOMIC_INC</a></div><div class="ttdeci">#define ATOMIC_INC(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00020">includes.h:20</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_a993f1d32fc9cf3ab12b313462da9dd57"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#a993f1d32fc9cf3ab12b313462da9dd57">ATOMIC_DEC</a></div><div class="ttdeci">#define ATOMIC_DEC(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00021">includes.h:21</a></div></div>
<div class="ttc" id="structserver_html_a33515ab0c529621ecc5d317770637cb2"><div class="ttname"><a href="structserver.html#a33515ab0c529621ecc5d317770637cb2">server::workers</a></div><div class="ttdeci">struct server_worker * workers</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00013">server.h:13</a></div></div>
<div class="ttc" id="structserver_html_a712c73b78adff8b0f9d0c824d87eb2c1"><div class="ttname"><a href="structserver.html#a712c73b78adff8b0f9d0c824d87eb2c1">server::estab_conns</a></div><div class="ttdeci">struct connection ** estab_conns</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00014">server.h:14</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a00144b644a217fc5f75a8e1597fd7d49"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* timeout_thread </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af3aa5bbc2215e215af2afeb31b29bfca"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* worker </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_4d1b2d0cbfbe3c7e279f07c0f553de4a.html">loader</a></li><li class="navelem"><a class="el" href="dir_2772e0b00f08f6631187cc490dafe1e0.html">src</a></li><li class="navelem"><a class="el" href="dir_817426efb63985321050810e4a72f9d7.html">headers</a></li><li class="navelem"><a class="el" href="server_8h.html">server.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
